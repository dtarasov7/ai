Коротко: в «воздушной» (air‑gapped) сети удобнее проверять не «docker save»‑тарболы, а один архив в формате OCI Image Layout, куда вместе с образом уже вложены cosign‑подписи/аттестации. Тогда вы проверяете локально (без выхода наружу) и затем публикуете в Nexus, сохраняя подписи. Ниже — как это организовать и автоматизировать.

Что попросить у поставщиков
- Формат поставки: OCI Image Layout, упакованный в tar/zip.
  - Как подготовить: cosign save IMAGE --dir ./pkg && tar czf pkg.tgz ./pkg. Это кладет в каталог ./pkg сам образ и его cosign‑артефакты (подписи/аттестации). 
- Подписи ключом (key‑based), а не «keyless». Открытые ключи вы уже получили — отлично: это снимает зависимость от внешних сервисов (Fulcio/Rekor).
- Опционально: ин‑тото аттестации (SBOM, SLSA‑provenance) как отдельные cosign‑аттачменты.

Как проверять офлайн из полученного архива
1) Распаковать в staging:
- tar xzf pkg.tgz  # внутри будет OCI layout (oci-layout, index.json, blobs/*)

2) Криптопроверка подписи локально:
- cosign verify --key /keys/vendor.pub --offline --local-image ./pkg
  - --local-image говорит cosign проверять образ из локального OCI‑каталога, а не из реестра. 

3) (Опционально) Проверка аттестаций и политики:
- cosign verify-attestation --key /keys/vendor.pub --type https://spdx.dev/Document --local-image ./pkg
- cosign verify-attestation --key /keys/vendor.pub --type slsaprovenance --policy ./policies/slsa.rego --local-image ./pkg
  - verify-attestation поддерживает --local-image и валидацию по CUE/Rego‑политике. 

4) Импорт в внутренний Nexus с сохранением подписей:
- oras cp --oci-layout ./pkg:TAG registry.internal/project/image:TAG -r
  - -r скопирует сам образ и все «референты» (referrers) — т.е. подписи и прочие OCI‑артефакты. ORAS умеет работать и с реестрами без API referrers, используя теговую схему, поэтому это «дружит» с большинством реализаций Docker v2/OCI (включая Nexus). 

Почему лучше OCI Image Layout, а не «docker save»
- Подписи cosign — отдельные OCI‑артефакты (referrers) для манифеста образа, в реестре это отдельные объекты/теги вида sha256-<digest>.sig. С «docker save» вы получите только слои, но не подписи; их пришлось бы прикладывать/подгружать отдельно и «сшивать» руками. В OCI layout подписи едут рядом и проверяются одной командой cosign verify --local-image. 

Если поставщик всё же присылает «обычный» tar
- Минимально возможный путь (не столь удобный):
  - Вычислить digest образа внутри тарбола: crane digest <name> --tarball path/to/image.tar. 
  - Попросить у поставщика отдельно cosign‑подпись и payload в совместимом формате, либо «bundle». Проверять тогда придётся не cosign verify (для контейнеров), а либо cosign verify --key против образа в реестре, либо verify‑blob против согласованного payload. Этот путь заметно сложнее и требует строгой договорённости о формате. Документация рекомендует локальные проверки через --local-image (см. выше). 

Как минимизировать ручные операции
Соберите маленький «импортёр» (скрипт/джобу в CI) на изолированном сервере:
- Триггер: появление файла *.tgz в «входной» папке.
- Шаги:
  1. Распаковать в temp‑каталог.
  2. cosign verify --key /keys/<vendor>.pub --offline --local-image ./pkg
     - Проверять также обязательные аннотации (-a key=value), если договорились добавлять метки в подпись. 
  3. cosign verify-attestation при наличии политик/аттестаций. 
  4. oras cp -r --oci-layout ./pkg:TAG registry.internal/...:TAG
  5. Логировать результат (в JSON), перемещать пакет в «принято/отклонено».
- Ключи поставщиков хранить централизованно (например, /keys/vendorA.pub, /keys/vendorB.pub). Выбор ключа — по имени пакета/вендора в метаданных или по каталогу.
- При желании разделить хранение подписей от самих образов в Nexus — при подписи можно использовать COSIGN_REPOSITORY, чтобы складывать подписи в отдельный репозиторий. Это поддерживается экосистемой Sigstore/политик и облегчает сопровождение. 

Примечания для «keyless» (если когда‑нибудь понадобится)
- В air‑gapped режиме возможна офлайн‑проверка «bundle» (включается по умолчанию при keyless), но тогда нужно периодически офлайн‑обновлять TUF trusted root. Для изолированных сетей проще и надёжнее оставаться на key‑based, как у вас сейчас. 

Итоговая схема
- Сторона поставщика: подпись образа ключом + cosign save в OCI layout + архивирование.
- Сторона получателя: автоматический импортёр — verify (--local-image) -> verify‑attestation (по политике) -> oras cp -r в Nexus.
- Дальше внутри кластеров можно дополнительно включить валидацию при запуске (Kyverno/OPA Gatekeeper), но это уже «второй рубеж». 

Если нужно, накину пример bash‑скрипта «импортёра» под вашу структуру каталогов и имена репозиториев Nexus.
