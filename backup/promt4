Имеется объектное хранилище s3 на базе ceph 17.2.7
rclone v 1.65.2
При формировании команд обязательно учти специфики версий ПО.
Объекты пишутся в бакеты с именами storage-<год><месяц><декада>, где декада - число 1,2,3
То есть в начале каждой декады (1-ого, 11-ого и 21-ого числа месяца) создается новый бакет и новые объекты пишутся уже в новый бакет. Предыдущий бакет после этого - не изменяется.
Для резервного копирования объектов есть файловый сервер.
Предлагается следующий алгоритм.
В начале каждой декады в 00:00 создается каталог storage-<год><месяц><декада>-backup
Раз в полчаса по cron запускается скрипт который:
- с помощью rclone копируются объекты, изменившиеся с момента предыдущего копирования (отбор объектов по времени изменения/создания) в подкаталог с именем dd-hh-mm,
  где dd-hh-mm - день, час, минута запуска скрипта
- с помощью rclone получаем список объектов, которые были удалены с момента предыдущего запуска скрипта.
  Сравнивается полный список объектов при предыдущем запуске и полный список объектов при текущем запуске.
  Список сохраняется в файл с именем YYYY-mm-dd-hh-MM-deleted. 
Момент (дата и время ) предыдущего запуска скрипта (начало работы скрипта) храниться в файле.
Лог rclone'а , созданный при копировании сохранять для каждого запуска с именем содержащем дату и время запуска скрипта
Лог должен быть в формате json
В концу работы скрипт должен создавать текстовый файл метриками в формате prometheus со следующими метриками:
- кол-во скопированных объектов
- кол-во удаленных  объектов
- время выполнения копирования
- время выполнения скрипта
- общий размер скопированных данных
- флаг успешного выполнения (0/1)
- если были ошибки то метрику с меткой содержащей текст ошибки. Если ошибок было несколько - то несколько метрик с разными меками
Каждая метрика должна иметь метку  со значение YYYY-mm-dd-hh-MM , где YYYY-mm-dd-hh-MM - год, месяц, день, час, минута запуска скрипта
Имена метрик должны иметь префиксы s3-backup
Если считаешь, что полезно еще добавить какие-то метрики, то напиши об этом.
rclone запускает с настройками на максимальную производительность.
В процессе работы должен вестись лог работы скрипта, где отображается старт, стоп  и все этапы. Файл лога - один на все запуски. Расположен в storage-<год><месяц><декада>-backup.
Ротироваться будет средствами операционной системы.
Скрипт должен содержать проверку исключающую запуск второго экземпляра.
Напиши пожалуйста скрипт. Проанализируй и сообщи, какие возможны сбои в алгоритме и как их можно обработать

Также напиши отдельный скрипт, для подготвки данных для архивации.
В начале каждой декады создается каталог с именем предыдущего бакета. В этот каталог копируется полное содержимое бакета.
В концу работы скрипт должен создавать текстовый файл метриками в формате prometheus со следующими метриками:
- кол-во скопированных объектов
- время выполнения копирования
- время выполнения скрипта
- общий размер скопированных данных
- флаг успешного выполнения (0/1)
- если были ошибки то метрику с меткой содержащей текст ошибки. Если ошибок было несколько - то несколько метрик с разными меками
Имена метрик должны иметь префикы s3-archive.
Каждая метрика должна иметь метку  со значение YYYY-mm-dd-hh-MM
Если считаешь, что полезно еще добавить какие-то метрики, то напиши об этом.
Должен вестись общий лог как и для первого скрипта. Должна проводится проверка на одновременный запуск второго экземпляра.
Для клонирования данных надо использовать rclone sync.
Этот второй скрипт должен запускаться в щадящем режиме , чтобы не замедлять работу первого скрипт
