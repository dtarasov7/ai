cmVkaXNfY29tbWFuZGVyX3R1aS12MC43LjAucHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA3NzAAMDAwMDAw
MAAwMDAxNzM0ADAwMDAwMjUzNjIwADE1MTMxNDQwNTYzADAxNTM0NQAgMAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAdmJveHNmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAj
IS91c3IvYmluL2VudiBweXRob24zCiIiIgpSZWRpcyBDb21tYW5kZXIgVFVJIC0gVGVybWluYWwg
VXNlciBJbnRlcmZhY2Ug0LIg0YHRgtC40LvQtSBSZWRpcyBDb21tYW5kZXIK0J/QvtC70L3QsNGP
INGE0YPQvdC60YbQuNC+0L3QsNC70YzQvdC+0YHRgtGMOiDQv9GA0L7RgdC80L7RgtGAINC60LvR
jtGH0LXQuSwg0LLRi9C/0L7Qu9C90LXQvdC40LUg0LrQvtC80LDQvdC0LCDQtNC+0LHQsNCy0LvQ
tdC90LjQtSDQutC70Y7Rh9C10LkKIiIiCgppbXBvcnQgdXJ3aWQKaW1wb3J0IHJlZGlzCmltcG9y
dCBqc29uCmltcG9ydCBvcwppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmZyb20gZGF0ZXRpbWUgaW1w
b3J0IGRhdGV0aW1lCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0LCBEaWN0LCBBbnksIE9wdGlvbmFs
LCBUdXBsZQpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBPcmRlcmVkRGljdCwgZGVmYXVsdGRpY3QK
aW1wb3J0IGxvZ2dpbmcKCl9fVkVSU0lPTl9fID0gIjAuNy4wIgpfX0FVVEhPUl9fID0gItCi0LDR
gNCw0YHQvtCyINCU0LzQuNGC0YDQuNC5IgoKIyDQndCw0YHRgtGA0L7QudC60LAg0LvQvtCz0LjR
gNC+0LLQsNC90LjRjwpsb2dnaW5nLmJhc2ljQ29uZmlnKAogICAgZmlsZW5hbWU9J3JlZGlzX3R1
aV9hdWRpdC5sb2cnLAogICAgbGV2ZWw9bG9nZ2luZy5JTkZPLAogICAgZm9ybWF0PSclKGFzY3Rp
bWUpcyAtICUobGV2ZWxuYW1lKXMgLSAlKG1lc3NhZ2UpcycKKQpsb2dnZXIgPSBsb2dnaW5nLmdl
dExvZ2dlcigncmVkaXNfY29tbWFuZGVyX3R1aScpCgoKY2xhc3MgQ29ubmVjdGlvblByb2ZpbGU6
CiAgICAiIiLQn9GA0L7RhNC40LvRjCDQv9C+0LTQutC70Y7Rh9C10L3QuNGPINC6IFJlZGlzIiIi
CiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZTogc3RyLCBob3N0OiBzdHIgPSAnbG9jYWxob3N0
JywgcG9ydDogaW50ID0gNjM3OSwKICAgICAgICAgICAgIHBhc3N3b3JkOiBPcHRpb25hbFtzdHJd
ID0gTm9uZSwgdXNlcm5hbWU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICAgc3Ns
OiBib29sID0gRmFsc2UsIHNzbF9jYV9jZXJ0czogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAg
ICAgICAgICBzc2xfY2VydGZpbGU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBzc2xfa2V5ZmlsZTog
T3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICBzb2NrZXRfcGF0aDogT3B0aW9uYWxb
c3RyXSA9IE5vbmUsIHJlYWRvbmx5OiBib29sID0gRmFsc2UsCiAgICAgICAgICAgICBjbHVzdGVy
X21vZGU6IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgIGNsdXN0ZXJfbm9kZXM6IE9wdGlvbmFs
W0xpc3RbVHVwbGVbc3RyLCBpbnRdXV0gPSBOb25lKTogICMg0J3QvtC00Ysg0LTQu9GPINC60LvQ
sNGB0YLQtdGA0LAKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCiAgICAgICAgc2VsZi5ob3N0ID0g
aG9zdAogICAgICAgIHNlbGYucG9ydCA9IHBvcnQKICAgICAgICBzZWxmLnBhc3N3b3JkID0gcGFz
c3dvcmQKICAgICAgICBzZWxmLnVzZXJuYW1lID0gdXNlcm5hbWUKICAgICAgICBzZWxmLnNzbCA9
IHNzbAogICAgICAgIHNlbGYuc3NsX2NhX2NlcnRzID0gc3NsX2NhX2NlcnRzCiAgICAgICAgc2Vs
Zi5zc2xfY2VydGZpbGUgPSBzc2xfY2VydGZpbGUKICAgICAgICBzZWxmLnNzbF9rZXlmaWxlID0g
c3NsX2tleWZpbGUKICAgICAgICBzZWxmLnNvY2tldF9wYXRoID0gc29ja2V0X3BhdGgKICAgICAg
ICBzZWxmLnJlYWRvbmx5ID0gcmVhZG9ubHkKICAgICAgICBzZWxmLmNsdXN0ZXJfbW9kZSA9IGNs
dXN0ZXJfbW9kZQogICAgICAgIHNlbGYuY2x1c3Rlcl9ub2RlcyA9IGNsdXN0ZXJfbm9kZXMgb3Ig
Wyhob3N0LCBwb3J0KV0KCiAgICBkZWYgdG9fZGljdChzZWxmKSAtPiBEaWN0OgogICAgICAgIHJl
dHVybiB7CiAgICAgICAgICAgICduYW1lJzogc2VsZi5uYW1lLAogICAgICAgICAgICAnaG9zdCc6
IHNlbGYuaG9zdCwKICAgICAgICAgICAgJ3BvcnQnOiBzZWxmLnBvcnQsCiAgICAgICAgICAgICdz
c2wnOiBzZWxmLnNzbCwKICAgICAgICAgICAgJ3JlYWRvbmx5Jzogc2VsZi5yZWFkb25seQogICAg
ICAgIH0KCgpjbGFzcyBSZWRpc0Nvbm5lY3Rpb246CiAgICAiIiLQnNC10L3QtdC00LbQtdGAINC/
0L7QtNC60LvRjtGH0LXQvdC40Lkg0LogUmVkaXMiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwg
cHJvZmlsZTogQ29ubmVjdGlvblByb2ZpbGUpOgogICAgICAgIHNlbGYucHJvZmlsZSA9IHByb2Zp
bGUKICAgICAgICBzZWxmLmNsaWVudDogT3B0aW9uYWxbcmVkaXMuUmVkaXNdID0gTm9uZQogICAg
ICAgIHNlbGYuY2x1c3Rlcl9jbGllbnQ6IE9wdGlvbmFsW3JlZGlzLlJlZGlzQ2x1c3Rlcl0gPSBO
b25lICAjINCd0L7QstGL0Lkg0LrQu9C40LXQvdGCCiAgICAgICAgc2VsZi5jb25uZWN0ZWQgPSBG
YWxzZQogICAgICAgIHNlbGYuY3VycmVudF9kYiA9IDAKICAgICAgICBzZWxmLmlzX2NsdXN0ZXIg
PSBwcm9maWxlLmNsdXN0ZXJfbW9kZQoKICAgIGRlZiBjb25uZWN0KHNlbGYpIC0+IFR1cGxlW2Jv
b2wsIHN0cl06CiAgICAgICAgIiIi0J/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiBSZWRpcyDQuNC7
0LggUmVkaXMgQ2x1c3RlciIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgc2VsZi5wcm9m
aWxlLmNsdXN0ZXJfbW9kZToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9jb25uZWN0X2Ns
dXN0ZXIoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2Nv
bm5lY3Rfc3RhbmRhbG9uZSgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
ICAgICBzZWxmLmNvbm5lY3RlZCA9IEZhbHNlCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkNv
bm5lY3Rpb24gZmFpbGVkOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gRmFsc2UsIHN0cihlKQoK
ICAgIGRlZiBfY29ubmVjdF9zdGFuZGFsb25lKHNlbGYpIC0+IFR1cGxlW2Jvb2wsIHN0cl06CiAg
ICAgICAgIiIi0J/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiBzdGFuZGFsb25lIFJlZGlzIiIiCiAg
ICAgICAgIiIi0J/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiBSZWRpcyIiIgogICAgICAgIHRyeToK
ICAgICAgICAgICAga3dhcmdzID0gewogICAgICAgICAgICAgICAgJ2RiJzogMCwgICMg0JLRgdC1
0LPQtNCwINC90LDRh9C40L3QsNC10Lwg0YEgREIwCiAgICAgICAgICAgICAgICAnc29ja2V0X3Rp
bWVvdXQnOiA1LAogICAgICAgICAgICAgICAgJ2RlY29kZV9yZXNwb25zZXMnOiBGYWxzZQogICAg
ICAgICAgICB9CgogICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc29ja2V0X3BhdGg6CiAgICAg
ICAgICAgICAgICBrd2FyZ3NbJ3VuaXhfc29ja2V0X3BhdGgnXSA9IHNlbGYucHJvZmlsZS5zb2Nr
ZXRfcGF0aAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAga3dhcmdzWydob3N0J10g
PSBzZWxmLnByb2ZpbGUuaG9zdAogICAgICAgICAgICAgICAga3dhcmdzWydwb3J0J10gPSBzZWxm
LnByb2ZpbGUucG9ydAoKICAgICAgICAgICAgaWYgc2VsZi5wcm9maWxlLnBhc3N3b3JkOgogICAg
ICAgICAgICAgICAga3dhcmdzWydwYXNzd29yZCddID0gc2VsZi5wcm9maWxlLnBhc3N3b3JkCgog
ICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUudXNlcm5hbWU6CiAgICAgICAgICAgICAgICBrd2Fy
Z3NbJ3VzZXJuYW1lJ10gPSBzZWxmLnByb2ZpbGUudXNlcm5hbWUKCiAgICAgICAgICAgIGlmIHNl
bGYucHJvZmlsZS5zc2w6CiAgICAgICAgICAgICAgICBrd2FyZ3NbJ3NzbCddID0gVHJ1ZQogICAg
ICAgICAgICAgICAgaWYgc2VsZi5wcm9maWxlLnNzbF9jYV9jZXJ0czoKICAgICAgICAgICAgICAg
ICAgICBrd2FyZ3NbJ3NzbF9jYV9jZXJ0cyddID0gc2VsZi5wcm9maWxlLnNzbF9jYV9jZXJ0cwog
ICAgICAgICAgICAgICAgaWYgc2VsZi5wcm9maWxlLnNzbF9jZXJ0ZmlsZToKICAgICAgICAgICAg
ICAgICAgICBrd2FyZ3NbJ3NzbF9jZXJ0ZmlsZSddID0gc2VsZi5wcm9maWxlLnNzbF9jZXJ0Zmls
ZQogICAgICAgICAgICAgICAgaWYgc2VsZi5wcm9maWxlLnNzbF9rZXlmaWxlOgogICAgICAgICAg
ICAgICAgICAgIGt3YXJnc1snc3NsX2tleWZpbGUnXSA9IHNlbGYucHJvZmlsZS5zc2xfa2V5Zmls
ZQoKICAgICAgICAgICAgc2VsZi5jbGllbnQgPSByZWRpcy5SZWRpcygqKmt3YXJncykKICAgICAg
ICAgICAgc2VsZi5jbGllbnQucGluZygpCiAgICAgICAgICAgIHNlbGYuY29ubmVjdGVkID0gVHJ1
ZQogICAgICAgICAgICBzZWxmLmN1cnJlbnRfZGIgPSAwCiAgICAgICAgICAgIGxvZ2dlci5pbmZv
KGYiQ29ubmVjdGVkIHRvIHtzZWxmLnByb2ZpbGUuaG9zdH06e3NlbGYucHJvZmlsZS5wb3J0fSIp
CiAgICAgICAgICAgIHJldHVybiBUcnVlLCAiQ29ubmVjdGVkIgoKICAgICAgICBleGNlcHQgRXhj
ZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuY29ubmVjdGVkID0gRmFsc2UKICAgICAgICAg
ICAgbG9nZ2VyLmVycm9yKGYiQ29ubmVjdGlvbiBmYWlsZWQ6IHtlfSIpCiAgICAgICAgICAgIHJl
dHVybiBGYWxzZSwgc3RyKGUpCgogICAgZGVmIF9jb25uZWN0X2NsdXN0ZXIoc2VsZikgLT4gVHVw
bGVbYm9vbCwgc3RyXToKICAgICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IFJlZGlz
IENsdXN0ZXIgLSDQv9GA0L7RgdGC0LDRjyDQstC10YDRgdC40Y8iIiIKICAgICAgICB0cnk6CiAg
ICAgICAgICAgICMg0J/RgNC+0YHRgtC+INC/0LXRgNC10LTQsNC10Lwg0YHQv9C40YHQvtC6INGD
0LfQu9C+0LIg0LrQsNC6INC10YHRgtGMCiAgICAgICAgICAgIGt3YXJncyA9IHsKICAgICAgICAg
ICAgICAgICdob3N0Jzogc2VsZi5wcm9maWxlLmhvc3QsCiAgICAgICAgICAgICAgICAncG9ydCc6
IHNlbGYucHJvZmlsZS5wb3J0LAogICAgICAgICAgICAgICAgJ2RlY29kZV9yZXNwb25zZXMnOiBG
YWxzZSwKICAgICAgICAgICAgICAgICdza2lwX2Z1bGxfY292ZXJhZ2VfY2hlY2snOiBUcnVlLAog
ICAgICAgICAgICAgICAgJ3NvY2tldF90aW1lb3V0JzogNSwKICAgICAgICAgICAgfQoKICAgICAg
ICAgICAgaWYgc2VsZi5wcm9maWxlLnBhc3N3b3JkOgogICAgICAgICAgICAgICAga3dhcmdzWydw
YXNzd29yZCddID0gc2VsZi5wcm9maWxlLnBhc3N3b3JkCgogICAgICAgICAgICBpZiBzZWxmLnBy
b2ZpbGUuc3NsOgogICAgICAgICAgICAgICAga3dhcmdzWydzc2wnXSA9IFRydWUKICAgICAgICAg
ICAgICAgIGlmIHNlbGYucHJvZmlsZS5zc2xfY2FfY2VydHM6CiAgICAgICAgICAgICAgICAgICAg
a3dhcmdzWydzc2xfY2FfY2VydHMnXSA9IHNlbGYucHJvZmlsZS5zc2xfY2FfY2VydHMKICAgICAg
ICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS5zc2xfY2VydGZpbGU6CiAgICAgICAgICAgICAgICAg
ICAga3dhcmdzWydzc2xfY2VydGZpbGUnXSA9IHNlbGYucHJvZmlsZS5zc2xfY2VydGZpbGUKICAg
ICAgICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS5zc2xfa2V5ZmlsZToKICAgICAgICAgICAgICAg
ICAgICBrd2FyZ3NbJ3NzbF9rZXlmaWxlJ10gPSBzZWxmLnByb2ZpbGUuc3NsX2tleWZpbGUKCiAg
ICAgICAgICAgICMg0JTQu9GPINC+0YLQu9Cw0LTQutC4CiAgICAgICAgICAgIGxvZ2dlci5pbmZv
KGYiQ29ubmVjdGluZyB0byBSZWRpcyBDbHVzdGVyIGF0IHtzZWxmLnByb2ZpbGUuaG9zdH06e3Nl
bGYucHJvZmlsZS5wb3J0fSIpCgogICAgICAgICAgICAjIFJlZGlzQ2x1c3RlciDQsNCy0YLQvtC8
0LDRgtC40YfQtdGB0LrQuCDQvtCx0L3QsNGA0YPQttC40YIg0LTRgNGD0LPQuNC1INGD0LfQu9GL
CiAgICAgICAgICAgIHNlbGYuY2x1c3Rlcl9jbGllbnQgPSByZWRpcy5SZWRpc0NsdXN0ZXIoKipr
d2FyZ3MpCiAgICAgICAgICAgIHNlbGYuY2x1c3Rlcl9jbGllbnQucGluZygpCiAgICAgICAgICAg
IHNlbGYuY29ubmVjdGVkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmlzX2NsdXN0ZXIgPSBUcnVl
CgogICAgICAgICAgICAjINCf0YDQvtCy0LXRgNGP0LXQvCwg0YfRgtC+INGN0YLQviDQtNC10LnR
gdGC0LLQuNGC0LXQu9GM0L3QviDQutC70LDRgdGC0LXRgAogICAgICAgICAgICB0cnk6CiAgICAg
ICAgICAgICAgICBjbHVzdGVyX2luZm8gPSBzZWxmLmNsdXN0ZXJfY2xpZW50LmNsdXN0ZXJfaW5m
bygpCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkNsdXN0ZXIgc3RhdGU6IHtjbHVzdGVy
X2luZm8uZ2V0KCdjbHVzdGVyX3N0YXRlJywgJ3Vua25vd24nKX0iKQogICAgICAgICAgICBleGNl
cHQ6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICByZXR1cm4gVHJ1ZSwgIkNvbm5l
Y3RlZCB0byBjbHVzdGVyIgoKICAgICAgICBleGNlcHQgcmVkaXMuZXhjZXB0aW9ucy5SZWRpc0Ns
dXN0ZXJFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiUmVkaXMgQ2x1
c3RlciBlcnJvcjoge2V9IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBmIkNsdXN0ZXIgZXJy
b3I6IHtzdHIoZSl9IgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAg
bG9nZ2VyLmVycm9yKGYiQ29ubmVjdGlvbiBmYWlsZWQ6IHtlfSIpCiAgICAgICAgICAgIHJldHVy
biBGYWxzZSwgc3RyKGUpCgogICAgQHByb3BlcnR5CiAgICBkZWYgYWN0aXZlX2NsaWVudChzZWxm
KToKICAgICAgICAiIiLQktC+0LfQstGA0LDRidCw0LXRgiDQsNC60YLQuNCy0L3Ri9C5INC60LvQ
uNC10L3RgiIiIgogICAgICAgIGlmIHNlbGYuaXNfY2x1c3RlcjoKICAgICAgICAgICAgcmV0dXJu
IHNlbGYuY2x1c3Rlcl9jbGllbnQKICAgICAgICByZXR1cm4gc2VsZi5jbGllbnQKCiAgICBkZWYg
c2VsZWN0X2RiKHNlbGYsIGRiOiBpbnQpIC0+IFR1cGxlW2Jvb2wsIHN0cl06CiAgICAgICAgIiIi
0J/QtdGA0LXQutC70Y7Rh9C10L3QuNC1INC90LAg0LTRgNGD0LPRg9GOINCx0LDQt9GDINC00LDQ
vdC90YvRhSAo0L3QtSDQv9C+0LTQtNC10YDQttC40LLQsNC10YLRgdGPINCyINC60LvQsNGB0YLQ
tdGA0LUpIiIiCiAgICAgICAgaWYgc2VsZi5pc19jbHVzdGVyOgogICAgICAgICAgICByZXR1cm4g
RmFsc2UsICJSZWRpcyBDbHVzdGVyIHN1cHBvcnRzIG9ubHkgREIwIgoKICAgICAgICBpZiBub3Qg
c2VsZi5jb25uZWN0ZWQ6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgIk5vdCBjb25uZWN0ZWQi
CgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5jbGllbnQuc2VsZWN0KGRiKQogICAgICAg
ICAgICBzZWxmLmN1cnJlbnRfZGIgPSBkYgogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIlN3aXRj
aGVkIHRvIERCOntkYn0iKQogICAgICAgICAgICByZXR1cm4gVHJ1ZSwgZiJTd2l0Y2hlZCB0byBE
Qjp7ZGJ9IgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2Vy
LmVycm9yKGYiRmFpbGVkIHRvIHN3aXRjaCBEQjoge2V9IikKICAgICAgICAgICAgcmV0dXJuIEZh
bHNlLCBzdHIoZSkKCiAgICBkZWYgZGlzY29ubmVjdChzZWxmKToKICAgICAgICBpZiBzZWxmLmNs
aWVudDoKICAgICAgICAgICAgc2VsZi5jbGllbnQuY2xvc2UoKQogICAgICAgICAgICBzZWxmLmNv
bm5lY3RlZCA9IEZhbHNlCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiRGlzY29ubmVjdGVkIGZy
b20ge3NlbGYucHJvZmlsZS5ob3N0fTp7c2VsZi5wcm9maWxlLnBvcnR9IikKCgpjbGFzcyBBZGRL
ZXlEaWFsb2codXJ3aWQuV2lkZ2V0V3JhcCk6CiAgICAiIiLQlNC40LDQu9C+0LMg0LTQvtCx0LDQ
stC70LXQvdC40Y8g0L3QvtCy0L7Qs9C+INC60LvRjtGH0LAiIiIKICAgIHNpZ25hbHMgPSBbJ2Ns
b3NlJ10KCiAgICBkZWYgX19pbml0X18oc2VsZiwgY29ubmVjdGlvbjogUmVkaXNDb25uZWN0aW9u
LCBvbl9zdWNjZXNzX2NhbGxiYWNrKToKICAgICAgICBzZWxmLmNvbm5lY3Rpb24gPSBjb25uZWN0
aW9uCiAgICAgICAgc2VsZi5vbl9zdWNjZXNzID0gb25fc3VjY2Vzc19jYWxsYmFjawoKICAgICAg
ICAjINCf0L7Qu9GPINCy0LLQvtC00LAKICAgICAgICBzZWxmLmtleV9lZGl0ID0gdXJ3aWQuRWRp
dCgnS2V5OiAnKQogICAgICAgIHNlbGYudHlwZV9ncm91cCA9IFtdCiAgICAgICAgc2VsZi50eXBl
X2J1dHRvbnMgPSBbCiAgICAgICAgICAgIHVyd2lkLlJhZGlvQnV0dG9uKHNlbGYudHlwZV9ncm91
cCwgJ1N0cmluZycsIHN0YXRlPVRydWUpLAogICAgICAgICAgICB1cndpZC5SYWRpb0J1dHRvbihz
ZWxmLnR5cGVfZ3JvdXAsICdIYXNoJyksCiAgICAgICAgICAgIHVyd2lkLlJhZGlvQnV0dG9uKHNl
bGYudHlwZV9ncm91cCwgJ0xpc3QnKSwKICAgICAgICAgICAgdXJ3aWQuUmFkaW9CdXR0b24oc2Vs
Zi50eXBlX2dyb3VwLCAnU2V0JyksCiAgICAgICAgICAgIHVyd2lkLlJhZGlvQnV0dG9uKHNlbGYu
dHlwZV9ncm91cCwgJ1pTZXQnKSwKICAgICAgICBdCiAgICAgICAgc2VsZi52YWx1ZV9lZGl0ID0g
dXJ3aWQuRWRpdCgnVmFsdWU6ICcsIG11bHRpbGluZT1UcnVlKQogICAgICAgIHNlbGYudHRsX2Vk
aXQgPSB1cndpZC5FZGl0KCdUVEwgKHNlY29uZHMsIG9wdGlvbmFsKTogJykKCiAgICAgICAgIyDQ
mtC90L7Qv9C60LgKICAgICAgICBzYXZlX2J0biA9IHVyd2lkLkJ1dHRvbignU2F2ZScsIG9uX3By
ZXNzPXNlbGYub25fc2F2ZSkKICAgICAgICBjYW5jZWxfYnRuID0gdXJ3aWQuQnV0dG9uKCdDYW5j
ZWwnLCBvbl9wcmVzcz1zZWxmLm9uX2NhbmNlbCkKCiAgICAgICAgIyDQmtC+0LzQv9C+0L3QvtCy
0LrQsAogICAgICAgIGJvZHkgPSBbCiAgICAgICAgICAgIHNlbGYua2V5X2VkaXQsCiAgICAgICAg
ICAgIHVyd2lkLkRpdmlkZXIoKSwKICAgICAgICAgICAgdXJ3aWQuVGV4dCgnVHlwZTonKSwKICAg
ICAgICBdCiAgICAgICAgYm9keS5leHRlbmQoc2VsZi50eXBlX2J1dHRvbnMpCiAgICAgICAgYm9k
eS5leHRlbmQoWwogICAgICAgICAgICB1cndpZC5EaXZpZGVyKCksCiAgICAgICAgICAgIHNlbGYu
dmFsdWVfZWRpdCwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAogICAgICAgICAgICBzZWxm
LnR0bF9lZGl0LAogICAgICAgICAgICB1cndpZC5EaXZpZGVyKCksCiAgICAgICAgICAgIHVyd2lk
LkNvbHVtbnMoWwogICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChzYXZlX2J0biwgJ2J1dHRv
bicsICdidXR0b25fZm9jdXMnKSwKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoY2FuY2Vs
X2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSwKICAgICAgICAgICAgXSksCiAgICAgICAg
XSkKCiAgICAgICAgcGlsZSA9IHVyd2lkLlBpbGUoYm9keSkKICAgICAgICBmaWxsID0gdXJ3aWQu
RmlsbGVyKHBpbGUsIHZhbGlnbj0ndG9wJykKICAgICAgICBwYWRkaW5nID0gdXJ3aWQuUGFkZGlu
ZyhmaWxsLCBsZWZ0PTIsIHJpZ2h0PTIpCiAgICAgICAgbGluZWJveCA9IHVyd2lkLkxpbmVCb3go
cGFkZGluZywgdGl0bGU9J0FkZCBOZXcgS2V5JykKCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyh1
cndpZC5BdHRyTWFwKGxpbmVib3gsICdkaWFsb2cnKSkKCiAgICBkZWYgZ2V0X3NlbGVjdGVkX3R5
cGUoc2VsZikgLT4gc3RyOgogICAgICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg0LLRi9Cx0YDQsNC9
0L3Ri9C5INGC0LjQvyIiIgogICAgICAgIGZvciBpLCBidG4gaW4gZW51bWVyYXRlKHNlbGYudHlw
ZV9idXR0b25zKToKICAgICAgICAgICAgaWYgYnRuLnN0YXRlOgogICAgICAgICAgICAgICAgcmV0
dXJuIFsnc3RyaW5nJywgJ2hhc2gnLCAnbGlzdCcsICdzZXQnLCAnenNldCddW2ldCiAgICAgICAg
cmV0dXJuICdzdHJpbmcnCgogICAgZGVmIG9uX3NhdmUoc2VsZiwgYnV0dG9uKToKICAgICAgICAi
IiLQodC+0YXRgNCw0L3QtdC90LjQtSDQutC70Y7Rh9CwINGBINC/0YDQvtCy0LXRgNC60L7QuSDQ
tNC70Y8g0LrQu9Cw0YHRgtC10YDQsCIiIgogICAgICAgIGtleSA9IHNlbGYua2V5X2VkaXQuZ2V0
X2VkaXRfdGV4dCgpLnN0cmlwKCkKICAgICAgICB2YWx1ZSA9IHNlbGYudmFsdWVfZWRpdC5nZXRf
ZWRpdF90ZXh0KCkuc3RyaXAoKQogICAgICAgIGtleV90eXBlID0gc2VsZi5nZXRfc2VsZWN0ZWRf
dHlwZSgpCiAgICAgICAgdHRsX3RleHQgPSBzZWxmLnR0bF9lZGl0LmdldF9lZGl0X3RleHQoKS5z
dHJpcCgpCgogICAgICAgIGlmIG5vdCBrZXk6CiAgICAgICAgICAgIHNlbGYuc2hvd19lcnJvcigi
S2V5IGNhbm5vdCBiZSBlbXB0eSIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjINCf0YDQ
vtCy0LXRgNC60LAg0LTQu9GPINC60LvQsNGB0YLQtdGA0LAKICAgICAgICBpZiBzZWxmLmNvbm5l
Y3Rpb24uaXNfY2x1c3RlcjoKICAgICAgICAgICAgIyDQkiDQutC70LDRgdGC0LXRgNC1INC90LXQ
u9GM0LfRjyDQuNGB0L/QvtC70YzQt9C+0LLQsNGC0Ywge30g0LTQu9GPINGF0Y3RiC3RgtC10LPQ
vtCyINCx0LXQtyDQv9GA0LDQstC40LvRjNC90L7Qs9C+INGE0L7RgNC80LDRgtCwCiAgICAgICAg
ICAgIGlmICd7JyBpbiBrZXkgYW5kICd9JyBpbiBrZXk6CiAgICAgICAgICAgICAgICAjINCf0YDQ
vtCy0LXRgNGP0LXQvCDRhNC+0YDQvNCw0YIg0YXRjdGILdGC0LXQs9CwCiAgICAgICAgICAgICAg
ICBpbXBvcnQgcmUKICAgICAgICAgICAgICAgIGlmIG5vdCByZS5zZWFyY2gocidcey4qP1x9Jywg
a2V5KToKICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoIkludmFsaWQgaGFzaCB0
YWcgZm9ybWF0LiBVc2Uge3RhZ30gdG8gZW5zdXJlIGtleXMgbGFuZCBvbiBzYW1lIG5vZGUuIikK
ICAgICAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0dGwg
PSBpbnQodHRsX3RleHQpIGlmIHR0bF90ZXh0IGVsc2UgTm9uZQoKICAgICAgICAgICAgIyDQodC+
0LfQtNCw0LXQvCDQutC70Y7RhyDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YIg0YLQuNC/
0LAKICAgICAgICAgICAgY2xpZW50ID0gc2VsZi5jb25uZWN0aW9uLmFjdGl2ZV9jbGllbnQKCiAg
ICAgICAgICAgIGlmIGtleV90eXBlID09ICdzdHJpbmcnOgogICAgICAgICAgICAgICAgY2xpZW50
LnNldChrZXksIHZhbHVlKQogICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdoYXNoJzoKICAg
ICAgICAgICAgICAgIHBhaXJzID0ge30KICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIHZhbHVl
LnNwbGl0KCdcbicpOgogICAgICAgICAgICAgICAgICAgIGlmICc6JyBpbiBsaW5lOgogICAgICAg
ICAgICAgICAgICAgICAgICBrLCB2ID0gbGluZS5zcGxpdCgnOicsIDEpCiAgICAgICAgICAgICAg
ICAgICAgICAgIHBhaXJzW2suc3RyaXAoKV0gPSB2LnN0cmlwKCkKICAgICAgICAgICAgICAgIGlm
IHBhaXJzOgogICAgICAgICAgICAgICAgICAgIGNsaWVudC5oc2V0KGtleSwgbWFwcGluZz1wYWly
cykKICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnbGlzdCc6CiAgICAgICAgICAgICAgICBp
dGVtcyA9IFtpdGVtLnN0cmlwKCkgZm9yIGl0ZW0gaW4gdmFsdWUuc3BsaXQoJ1xuJykgaWYgaXRl
bS5zdHJpcCgpXQogICAgICAgICAgICAgICAgaWYgaXRlbXM6CiAgICAgICAgICAgICAgICAgICAg
Y2xpZW50LnJwdXNoKGtleSwgKml0ZW1zKQogICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdz
ZXQnOgogICAgICAgICAgICAgICAgaXRlbXMgPSBbaXRlbS5zdHJpcCgpIGZvciBpdGVtIGluIHZh
bHVlLnNwbGl0KCdcbicpIGlmIGl0ZW0uc3RyaXAoKV0KICAgICAgICAgICAgICAgIGlmIGl0ZW1z
OgogICAgICAgICAgICAgICAgICAgIGNsaWVudC5zYWRkKGtleSwgKml0ZW1zKQogICAgICAgICAg
ICBlbGlmIGtleV90eXBlID09ICd6c2V0JzoKICAgICAgICAgICAgICAgIHBhaXJzID0ge30KICAg
ICAgICAgICAgICAgIGZvciBsaW5lIGluIHZhbHVlLnNwbGl0KCdcbicpOgogICAgICAgICAgICAg
ICAgICAgIGlmICc6JyBpbiBsaW5lOgogICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIsIHNj
b3JlID0gbGluZS5yc3BsaXQoJzonLCAxKQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwYWlyc1ttZW1iZXIuc3RyaXAoKV0gPSBmbG9hdChz
Y29yZS5zdHJpcCgpKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHBhaXJz
OgogICAgICAgICAgICAgICAgICAgIGNsaWVudC56YWRkKGtleSwgcGFpcnMpCgogICAgICAgICAg
ICAjINCj0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8IFRUTCDQtdGB0LvQuCDRg9C60LDQt9Cw0L0K
ICAgICAgICAgICAgaWYgdHRsOgogICAgICAgICAgICAgICAgY2xpZW50LmV4cGlyZShrZXksIHR0
bCkKCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQ3JlYXRlZCBrZXk6IHtrZXl9ICh0eXBlOiB7
a2V5X3R5cGV9KSIpCiAgICAgICAgICAgIHNlbGYub25fc3VjY2VzcygpCiAgICAgICAgICAgIHNl
bGYuX2VtaXQoJ2Nsb3NlJykKCiAgICAgICAgZXhjZXB0IHJlZGlzLmV4Y2VwdGlvbnMuUmVkaXND
bHVzdGVyRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuc2hvd19lcnJvcihmIkNsdXN0
ZXIgZXJyb3I6IHtlfSIpCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkNsdXN0ZXIgZXJyb3Ig
Y3JlYXRpbmcga2V5OiB7ZX0iKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAg
ICAgICAgc2VsZi5zaG93X2Vycm9yKGYiRmFpbGVkIHRvIGNyZWF0ZSBrZXk6IHtlfSIpCiAgICAg
ICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBjcmVhdGUga2V5OiB7ZX0iKQoKICAgIGRl
ZiBzaG93X2Vycm9yKHNlbGYsIG1lc3NhZ2UpOgogICAgICAgICIiItCf0L7QutCw0LfQsNGC0Ywg
0YHQvtC+0LHRidC10L3QuNC1INC+0LEg0L7RiNC40LHQutC1IiIiCiAgICAgICAgZXJyb3JfdGV4
dCA9IHVyd2lkLlRleHQoKCdlcnJvcicsIGYiRXJyb3I6IHttZXNzYWdlfSIpKQogICAgICAgIHNl
bGYuYm9keS5jb250ZW50cy5pbnNlcnQoMCwgKGVycm9yX3RleHQsICgncGFjaycsIE5vbmUpKSkK
CiAgICBkZWYgb25fY2FuY2VsKHNlbGYsIGJ1dHRvbik6CiAgICAgICAgIiIi0J7RgtC80LXQvdCw
IiIiCiAgICAgICAgc2VsZi5fZW1pdCgnY2xvc2UnKQoKCmNsYXNzIFJlZGlzQ29tbWFuZGVyVUk6
CiAgICAiIiLQk9C70LDQstC90L7QtSDQvtC60L3QviDQsiDRgdGC0LjQu9C1IFJlZGlzIENvbW1h
bmRlciIiIgoKICAgIHBhbGV0dGUgPSBbCiAgICAgICAgKCdoZWFkZXInLCAnd2hpdGUnLCAnZGFy
ayBibHVlJywgJ2JvbGQnKSwKICAgICAgICAoJ2hlYWRlcl90ZXh0JywgJ3doaXRlJywgJ2Rhcmsg
Ymx1ZScpLAogICAgICAgICgnZm9vdGVyJywgJ3doaXRlJywgJ2RhcmsgYmx1ZScpLAogICAgICAg
ICgnc2lkZWJhcicsICdsaWdodCBncmF5JywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgnc2lkZWJh
cl9mb2N1cycsICd3aGl0ZScsICdkYXJrIGJsdWUnLCAnYm9sZCcpLAogICAgICAgICgnY29ubmVj
dGlvbicsICdsaWdodCBjeWFuJywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgnY29ubmVjdGlvbl9z
ZWxlY3RlZCcsICdibGFjaycsICdsaWdodCBjeWFuJywgJ2JvbGQnKSwKICAgICAgICAoJ2tleV9m
b2xkZXInLCAnd2hpdGUnLCAnZGFyayBibHVlJyksCiAgICAgICAgKCdrZXlfZm9sZGVyX2ZvY3Vz
JywgJ2JsYWNrJywgJ2xpZ2h0IGN5YW4nLCAnYm9sZCcpLAogICAgICAgICgna2V5X2l0ZW0nLCAn
eWVsbG93JywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgna2V5X2l0ZW1fZm9jdXMnLCAnYmxhY2sn
LCAnbGlnaHQgY3lhbicsICdib2xkJyksCiAgICAgICAgKCdidXR0b24nLCAnd2hpdGUnLCAnZGFy
ayBibHVlJyksCiAgICAgICAgKCdidXR0b25fZm9jdXMnLCAnd2hpdGUnLCAnbGlnaHQgYmx1ZScs
ICdib2xkJyksCiAgICAgICAgKCdidXR0b25fZGFuZ2VyJywgJ3doaXRlJywgJ2RhcmsgcmVkJyks
CiAgICAgICAgKCdpbmZvX2xhYmVsJywgJ2xpZ2h0IGN5YW4nLCAnZGFyayBibHVlJyksCiAgICAg
ICAgKCdpbmZvX3ZhbHVlJywgJ3doaXRlJywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgndGFiX2Fj
dGl2ZScsICd3aGl0ZScsICdsaWdodCBibHVlJywgJ2JvbGQnKSwKICAgICAgICAoJ3RhYl9pbmFj
dGl2ZScsICdsaWdodCBncmF5JywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgnZXJyb3InLCAnbGln
aHQgcmVkJywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgnc3VjY2VzcycsICdsaWdodCBncmVlbics
ICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ2RpYWxvZycsICd3aGl0ZScsICdkYXJrIGJsdWUnKSwK
ICAgICAgICAoJ2JhY2tncm91bmQnLCAnd2hpdGUnLCAnZGFyayBibHVlJyksCiAgICBdCgogICAg
ZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuY29ubmVjdGlvbnM6IERpY3Rbc3RyLCBS
ZWRpc0Nvbm5lY3Rpb25dID0ge30KICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbjogT3B0
aW9uYWxbUmVkaXNDb25uZWN0aW9uXSA9IE5vbmUKICAgICAgICBzZWxmLnByb2ZpbGVzID0gc2Vs
Zi5sb2FkX3Byb2ZpbGVzKCkKICAgICAgICBzZWxmLmtleXNfbGlzdDogTGlzdFtieXRlc10gPSBb
XSAgIyDQn9GA0L7RgdGC0L7QuSDRgdC/0LjRgdC+0Log0LrQu9GO0YfQtdC5CiAgICAgICAgc2Vs
Zi5jdXJyZW50X2tleTogT3B0aW9uYWxbYnl0ZXNdID0gTm9uZQogICAgICAgIHNlbGYuc2VwYXJh
dG9yID0gJ+KElicKICAgICAgICBzZWxmLmNvbnNvbGVfbW9kZSA9IEZhbHNlCiAgICAgICAgc2Vs
Zi5tYXhfZGIgPSAxNSAgIyBSZWRpcyDQv9C+0LTQtNC10YDQttC40LLQsNC10YIgMC0xNSDQsdCw
0Lcg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4KICAgICAgICBzZWxmLmtleV9jb3VudCA9IDAKICAg
ICAgICAjINCh0L7Qt9C00LDQtdC8INC40L3RgtC10YDRhNC10LnRgQogICAgICAgIHNlbGYuY3Jl
YXRlX3VpKCkKCiAgICAgICAgIyDQkNCy0YLQvtC80LDRgtC40YfQtdGB0LrQuCDQv9C+0LTQutC7
0Y7Rh9Cw0LXQvNGB0Y8g0Log0L/QtdGA0LLQvtC80YMg0L/RgNC+0YTQuNC70Y4KICAgICAgICBp
ZiBzZWxmLnByb2ZpbGVzOgogICAgICAgICAgICBmaXJzdF9wcm9maWxlID0gbGlzdChzZWxmLnBy
b2ZpbGVzLnZhbHVlcygpKVswXQogICAgICAgICAgICBzZWxmLmNvbm5lY3RfdG9fcHJvZmlsZShm
aXJzdF9wcm9maWxlKQoKICAgICAgICBzZWxmLmxvb3AgPSB1cndpZC5NYWluTG9vcCgKICAgICAg
ICAgICAgc2VsZi5tYWluX2ZyYW1lLAogICAgICAgICAgICBwYWxldHRlPXNlbGYucGFsZXR0ZSwK
ICAgICAgICAgICAgdW5oYW5kbGVkX2lucHV0PXNlbGYuaGFuZGxlX2lucHV0LAogICAgICAgICAg
ICBwb3BfdXBzPVRydWUKICAgICAgICApCgogICAgZGVmIGdldF9rZXlfdHlwZV9pY29uKHNlbGYs
IGtleTogc3RyKSAtPiBzdHI6CiAgICAgICAgIiIi0J/QvtC70YPRh9C40YLRjCDQuNC60L7QvdC6
0YMg0LTQu9GPINGC0LjQv9CwINC60LvRjtGH0LAgKNC/0YDQvtGB0YLRi9C1INGB0LjQvNCy0L7Q
u9GLKSIiIgoKICAgICAgICAjINCQ0LvRjNGC0LXRgNC90LDRgtC40LLQsDogQVNDSUkg0YHQuNC8
0LLQvtC70YsKICAgICAgICBhc2NpaV9pY29ucyA9IHsKICAgICAgICAgICAgJ3N0cmluZyc6ICdb
U3RdICcsCiAgICAgICAgICAgICdoYXNoJzogJ1tIc10gJywKICAgICAgICAgICAgJ2xpc3QnOiAn
W0xpXSAnLAogICAgICAgICAgICAnc2V0JzogJ1tTZV0gJywKICAgICAgICAgICAgJ3pzZXQnOiAn
W1pzXSAnLAogICAgICAgICAgICAnc3RyZWFtJzogJ1tUcl0gJywKICAgICAgICAgICAgJ25vbmUn
OiAnW05vXSAnLAogICAgICAgICAgICAndW5rbm93bic6ICdbP10gJywKICAgICAgICB9CgogICAg
ICAgICMg0JjRgdC/0L7Qu9GM0LfRg9C10LwgYXNjaWlfaWNvbnMg0LTQu9GPINC80LDQutGB0LjQ
vNCw0LvRjNC90L7QuSDRgdC+0LLQvNC10YHRgtC40LzQvtGB0YLQuAogICAgICAgIGljb25fc2V0
ID0gYXNjaWlfaWNvbnMKCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uIG9y
IG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5jb25uZWN0ZWQ6CiAgICAgICAgICAgIHJldHVy
biBpY29uX3NldFsndW5rbm93biddCgogICAgICAgIHRyeToKICAgICAgICAgICAgY2xpZW50ID0g
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uYWN0aXZlX2NsaWVudAogICAgICAgICAgICBrZXlfdHlw
ZSA9IGNsaWVudC50eXBlKGtleS5lbmNvZGUoJ3V0Zi04JywgZXJyb3JzPSdyZXBsYWNlJykpCgog
ICAgICAgICAgICBpZiBpc2luc3RhbmNlKGtleV90eXBlLCBieXRlcyk6CiAgICAgICAgICAgICAg
ICBrZXlfdHlwZSA9IGtleV90eXBlLmRlY29kZSgndXRmLTgnKS5sb3dlcigpCiAgICAgICAgICAg
IGVsc2U6CiAgICAgICAgICAgICAgICBrZXlfdHlwZSA9IHN0cihrZXlfdHlwZSkubG93ZXIoKQoK
ICAgICAgICAgICAgcmV0dXJuIGljb25fc2V0LmdldChrZXlfdHlwZSwgaWNvbl9zZXRbJ3Vua25v
d24nXSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5l
cnJvcihmIkVycm9yIGdldHRpbmcga2V5IHR5cGUgZm9yIHtrZXl9OiB7ZX0iKQogICAgICAgICAg
ICByZXR1cm4gaWNvbl9zZXRbJ3Vua25vd24nXQoKICAgIGRlZiBsb2FkX3Byb2ZpbGVzKHNlbGYp
IC0+IERpY3Rbc3RyLCBDb25uZWN0aW9uUHJvZmlsZV06CiAgICAgICAgIiIi0JfQsNCz0YDRg9C3
0LrQsCDQv9GA0L7RhNC40LvQtdC5INGBINC/0L7QtNC00LXRgNC20LrQvtC5INC60LvQsNGB0YLQ
tdGA0LAiIiIKICAgICAgICBwcm9maWxlcyA9IHt9CiAgICAgICAgcHJvZmlsZXNfZmlsZSA9ICdy
ZWRpc19wcm9maWxlcy5qc29uJwoKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwcm9maWxlc19m
aWxlKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgd2l0aCBvcGVuKHByb2ZpbGVz
X2ZpbGUsICdyJykgYXMgZjoKICAgICAgICAgICAgICAgICAgICBkYXRhID0ganNvbi5sb2FkKGYp
CiAgICAgICAgICAgICAgICAgICAgZm9yIG5hbWUsIGNvbmZpZyBpbiBkYXRhLml0ZW1zKCk6CiAg
ICAgICAgICAgICAgICAgICAgICAgICMg0J/QvtC00LPQvtGC0LDQstC70LjQstCw0LXQvCDQutC+
0L3RhNC40LMg0LTQu9GPIENvbm5lY3Rpb25Qcm9maWxlCiAgICAgICAgICAgICAgICAgICAgICAg
IGNsZWFuX2NvbmZpZyA9IHt9CgogICAgICAgICAgICAgICAgICAgICAgICAjINCR0LDQt9C+0LLR
i9C1INC/0LDRgNCw0LzQtdGC0YDRiwogICAgICAgICAgICAgICAgICAgICAgICBiYXNlX3BhcmFt
cyA9IFsnbmFtZScsICdob3N0JywgJ3BvcnQnLCAncGFzc3dvcmQnLCAndXNlcm5hbWUnLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3NsJywgJ3NvY2tldF9wYXRoJywg
J3JlYWRvbmx5JywgJ3NzbF9jYV9jZXJ0cycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICdzc2xfY2VydGZpbGUnLCAnc3NsX2tleWZpbGUnXQoKICAgICAgICAgICAgICAg
ICAgICAgICAgZm9yIHBhcmFtIGluIGJhc2VfcGFyYW1zOgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgcGFyYW0gaW4gY29uZmlnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNsZWFuX2NvbmZpZ1twYXJhbV0gPSBjb25maWdbcGFyYW1dCgogICAgICAgICAgICAgICAgICAg
ICAgICAjINCf0LDRgNCw0LzQtdGC0YDRiyDQutC70LDRgdGC0LXRgNCwCiAgICAgICAgICAgICAg
ICAgICAgICAgIGlmICdjbHVzdGVyX21vZGUnIGluIGNvbmZpZzoKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNsZWFuX2NvbmZpZ1snY2x1c3Rlcl9tb2RlJ10gPSBib29sKGNvbmZpZ1snY2x1
c3Rlcl9tb2RlJ10pCgogICAgICAgICAgICAgICAgICAgICAgICAjINCe0LHRgNCw0LHQvtGC0LrQ
sCBjbHVzdGVyX25vZGVzIC0g0LLQsNC20L3Qvjog0YHQvtGF0YDQsNC90Y/QtdC8INC60LDQuiDR
gdC/0LjRgdC+0Log0LrQvtGA0YLQtdC20LXQuQogICAgICAgICAgICAgICAgICAgICAgICBpZiAn
Y2x1c3Rlcl9ub2RlcycgaW4gY29uZmlnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9k
ZXMgPSBjb25maWdbJ2NsdXN0ZXJfbm9kZXMnXQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
aWYgaXNpbnN0YW5jZShub2RlcywgbGlzdCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZm9ybWF0dGVkX25vZGVzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm
b3Igbm9kZSBpbiBub2RlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg
aXNpbnN0YW5jZShub2RlLCBzdHIpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIyDQpNC+0YDQvNCw0YIgImhvc3Q6cG9ydCIKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGlmICc6JyBpbiBub2RlOgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGhvc3QsIHBvcnRfc3RyID0gbm9kZS5zcGxpdCgnOicsIDEpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0ID0gaW50KHBvcnRfc3Ry
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0
ZWRfbm9kZXMuYXBwZW5kKChob3N0LCBwb3J0KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJJbnZhbGlkIHBvcnQg
aW4gbm9kZSB7bm9kZX0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGlm
IGlzaW5zdGFuY2Uobm9kZSwgZGljdCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAjINCk0L7RgNC80LDRgiB7Imhvc3QiOiAiLi4uIiwgInBvcnQiOiAuLi59CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0ID0gbm9kZS5nZXQoJ2hvc3Qn
LCAnbG9jYWxob3N0JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBv
cnQgPSBub2RlLmdldCgncG9ydCcsIDYzNzkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcG9ydCA9IGludChwb3J0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGZvcm1hdHRlZF9ub2Rlcy5hcHBlbmQoKGhvc3QsIHBvcnQpKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJJbnZhbGlk
IHBvcnQgaW4gbm9kZSB7bm9kZX0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBlbGlmIGlzaW5zdGFuY2Uobm9kZSwgbGlzdCkgYW5kIGxlbihub2RlKSA9PSAyOgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQpNC+0YDQvNCw0YIgWyJob3N0Iiwg
cG9ydF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QsIHBvcnQg
PSBub2RlWzBdLCBub2RlWzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydCA9
IGludChwb3J0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZv
cm1hdHRlZF9ub2Rlcy5hcHBlbmQoKHN0cihob3N0KSwgcG9ydCkpCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIkludmFsaWQgcG9y
dCBpbiBub2RlIHtub2RlfSIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZv
cm1hdHRlZF9ub2RlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW5f
Y29uZmlnWydjbHVzdGVyX25vZGVzJ10gPSBmb3JtYXR0ZWRfbm9kZXMKCiAgICAgICAgICAgICAg
ICAgICAgICAgICMg0KHQvtC30LTQsNC10Lwg0L/RgNC+0YTQuNC70YwKICAgICAgICAgICAgICAg
ICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQo9Cx0LXQtNC40LzR
gdGPLCDRh9GC0L4g0LXRgdGC0YwgaG9zdCDQuCBwb3J0CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBpZiAnaG9zdCcgbm90IGluIGNsZWFuX2NvbmZpZzoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpZiAnY2x1c3Rlcl9ub2RlcycgaW4gY2xlYW5fY29uZmlnIGFuZCBjbGVhbl9j
b25maWdbJ2NsdXN0ZXJfbm9kZXMnXToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY2xlYW5fY29uZmlnWydob3N0J10gPSBjbGVhbl9jb25maWdbJ2NsdXN0ZXJfbm9kZXMnXVsw
XVswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhbl9jb25maWdbJ3Bv
cnQnXSA9IGNsZWFuX2NvbmZpZ1snY2x1c3Rlcl9ub2RlcyddWzBdWzFdCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY2xlYW5fY29uZmlnWydob3N0J10gPSAnbG9jYWxob3N0JwogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjbGVhbl9jb25maWdbJ3BvcnQnXSA9IDYzNzkKCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwcm9maWxlc1tuYW1lXSA9IENvbm5lY3Rpb25Qcm9maWxlKCoqY2xl
YW5fY29uZmlnKQoKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IFR5cGVFcnJvciBhcyBl
OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiSW52YWxpZCBjb25m
aWcgZm9yIHByb2ZpbGUgJ3tuYW1lfSc6IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAjINCf0YDQvtCx0YPQtdC8INGB0L7Qt9C00LDRgtGMINC/0YDQvtGE0LjQu9GMINGBINC80LjQ
vdC40LzQsNC70YzQvdGL0LzQuCDQv9Cw0YDQsNC80LXRgtGA0LDQvNC4CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBtaW5pbWFsX2NvbmZpZyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAnbmFtZSc6IG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hv
c3QnOiBjb25maWcuZ2V0KCdob3N0JywgJ2xvY2FsaG9zdCcpLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICdwb3J0JzogY29uZmlnLmdldCgncG9ydCcsIDYzNzkpLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICdjbHVzdGVyX21vZGUnOiBjb25maWcuZ2V0KCdjbHVzdGVy
X21vZGUnLCBGYWxzZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGlmICdwYXNzd29yZCcgaW4gY29uZmlnOgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG1pbmltYWxfY29uZmlnWydwYXNzd29yZCddID0gY29uZmlnWydwYXNz
d29yZCddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9maWxlc1tuYW1lXSA9IENvbm5l
Y3Rpb25Qcm9maWxlKCoqbWluaW1hbF9jb25maWcpCgogICAgICAgICAgICBleGNlcHQganNvbi5K
U09ORGVjb2RlRXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkludmFs
aWQgSlNPTiBpbiBwcm9maWxlcyBmaWxlOiB7ZX0iKQogICAgICAgICAgICAgICAgcHJvZmlsZXNb
J2xvY2FsaG9zdCddID0gQ29ubmVjdGlvblByb2ZpbGUoJ2xvY2FsaG9zdCcsICdsb2NhbGhvc3Qn
LCA2Mzc5KQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAg
ICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gbG9hZCBwcm9maWxlczoge2V9IikKICAgICAgICAg
ICAgICAgIHByb2ZpbGVzWydsb2NhbGhvc3QnXSA9IENvbm5lY3Rpb25Qcm9maWxlKCdsb2NhbGhv
c3QnLCAnbG9jYWxob3N0JywgNjM3OSkKCiAgICAgICAgIyDQn9GA0L7RhNC40LvQuCDQv9C+INGD
0LzQvtC70YfQsNC90LjRjiwg0LXRgdC70Lgg0YTQsNC50LvQsCDQvdC10YIg0LjQu9C4INC+0L0g
0L/Rg9GB0YLQvtC5CiAgICAgICAgaWYgbm90IHByb2ZpbGVzOgogICAgICAgICAgICBwcm9maWxl
c1snbG9jYWxob3N0J10gPSBDb25uZWN0aW9uUHJvZmlsZSgnbG9jYWxob3N0JywgJ2xvY2FsaG9z
dCcsIDYzNzkpCgogICAgICAgIHJldHVybiBwcm9maWxlcwoKICAgIGRlZiB2YWxpZGF0ZV9wcm9m
aWxlcyhzZWxmKToKICAgICAgICAiIiLQktCw0LvQuNC00LDRhtC40Y8g0LfQsNCz0YDRg9C20LXQ
vdC90YvRhSDQv9GA0L7RhNC40LvQtdC5IiIiCiAgICAgICAgZm9yIG5hbWUsIHByb2ZpbGUgaW4g
c2VsZi5wcm9maWxlcy5pdGVtcygpOgogICAgICAgICAgICBpZiBwcm9maWxlLmNsdXN0ZXJfbW9k
ZToKICAgICAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA0LrQsCDRg9C30LvQvtCyINC60LvQsNGB
0YLQtdGA0LAKICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNhdHRyKHByb2ZpbGUsICdjbHVzdGVy
X25vZGVzJykgb3Igbm90IHByb2ZpbGUuY2x1c3Rlcl9ub2RlczoKICAgICAgICAgICAgICAgICAg
ICBsb2dnZXIud2FybmluZyhmIlByb2ZpbGUgJ3tuYW1lfScgaGFzIGNsdXN0ZXJfbW9kZT1UcnVl
IGJ1dCBubyBjbHVzdGVyX25vZGVzIGRlZmluZWQiKQogICAgICAgICAgICAgICAgICAgIHByb2Zp
bGUuY2x1c3Rlcl9tb2RlID0gRmFsc2UgICMg0J7RgtC60LvRjtGH0LDQtdC8INGA0LXQttC40Lwg
0LrQu9Cw0YHRgtC10YDQsAoKICAgICAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA0LrQsCDRhNC+
0YDQvNCw0YLQsCDRg9C30LvQvtCyCiAgICAgICAgICAgICAgICBmb3IgaSwgbm9kZSBpbiBlbnVt
ZXJhdGUocHJvZmlsZS5jbHVzdGVyX25vZGVzKToKICAgICAgICAgICAgICAgICAgICBpZiBub3Qg
aXNpbnN0YW5jZShub2RlLCAobGlzdCwgdHVwbGUpKSBvciBsZW4obm9kZSkgIT0gMjoKICAgICAg
ICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiUHJvZmlsZSAne25hbWV9JzogSW52YWxp
ZCBub2RlIGZvcm1hdCBhdCBpbmRleCB7aX06IHtub2RlfSIpCiAgICAgICAgICAgICAgICAgICAg
ZWxpZiBub3QgaXNpbnN0YW5jZShub2RlWzBdLCBzdHIpIG9yIG5vdCBpc2luc3RhbmNlKG5vZGVb
MV0sIGludCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIlByb2ZpbGUg
J3tuYW1lfSc6IE5vZGUge2l9IHNob3VsZCBiZSAoaG9zdDpzdHIsIHBvcnQ6aW50KSIpCgogICAg
ICAgICAgICAjINCf0YDQvtCy0LXRgNC60LAg0L7QsdGP0LfQsNGC0LXQu9GM0L3Ri9GFINC/0L7Q
u9C10Lkg0LTQu9GPIHN0YW5kYWxvbmUKICAgICAgICAgICAgZWxpZiBub3QgcHJvZmlsZS5zb2Nr
ZXRfcGF0aCBhbmQgKG5vdCBwcm9maWxlLmhvc3Qgb3Igbm90IHByb2ZpbGUucG9ydCk6CiAgICAg
ICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJQcm9maWxlICd7bmFtZX0nIG1pc3NpbmcgaG9zdC9w
b3J0IGZvciBzdGFuZGFsb25lIGNvbm5lY3Rpb24iKQoKICAgICAgICBsb2dnZXIuaW5mbyhmIlZh
bGlkYXRlZCB7bGVuKHNlbGYucHJvZmlsZXMpfSBwcm9maWxlcyIpCgogICAgZGVmIGNyZWF0ZV91
aShzZWxmKToKICAgICAgICAiIiLQodC+0LfQtNCw0L3QuNC1INC40L3RgtC10YDRhNC10LnRgdCw
IiIiCiAgICAgICAgIyBIZWFkZXIKICAgICAgICBoZWFkZXJfdGV4dCA9IHVyd2lkLlRleHQoWwog
ICAgICAgICAgICAoJ2hlYWRlcl90ZXh0JywgJyDil48gJyksCiAgICAgICAgICAgICgnaGVhZGVy
X3RleHQnLCAnUmVkaXMgQ29tbWFuZGVyIFRVSScpCiAgICAgICAgXSwgYWxpZ249J2xlZnQnKQoK
ICAgICAgICBzZWxmLmhlYWRlciA9IHVyd2lkLkF0dHJNYXAoCiAgICAgICAgICAgIHVyd2lkLlBh
ZGRpbmcoaGVhZGVyX3RleHQsIGxlZnQ9MSwgcmlnaHQ9MSksCiAgICAgICAgICAgICdoZWFkZXIn
CiAgICAgICAgKQoKICAgICAgICAjIFRvb2xiYXIKICAgICAgICBzZWxmLmNvbW1hbmRzX2J0biA9
IHVyd2lkLkJ1dHRvbignRjU6IENvbW1hbmRzJykKICAgICAgICBzZWxmLmFkZF9rZXlfYnRuID0g
dXJ3aWQuQnV0dG9uKCdGNDogQWRkIE5ldyBLZXknKQogICAgICAgIHNlbGYucmVmcmVzaF9idG4g
PSB1cndpZC5CdXR0b24oJ0YyOiBSZWZyZXNoJykKICAgICAgICAjIHNlbGYubW9yZV9idG4gPSB1
cndpZC5CdXR0b24oJ0YxMTogTW9yZS4uLicpCiAgICAgICAgc2VsZi5kaXNjb25uZWN0X2J0biA9
IHVyd2lkLkJ1dHRvbignRjk6IERpc2Nvbm5lY3QnKQogICAgICAgIHNlbGYuaGVscF9idG4gPSB1
cndpZC5CdXR0b24oJ0YxOiBIZWxwJykKICAgICAgICBzZWxmLmV4aXRfYnRuID0gdXJ3aWQuQnV0
dG9uKCdGMTA6IEV4aXQnKQoKICAgICAgICB1cndpZC5jb25uZWN0X3NpZ25hbChzZWxmLnJlZnJl
c2hfYnRuLCAnY2xpY2snLCBsYW1iZGEgYjogc2VsZi5yZWZyZXNoX2tleXMoKSkKICAgICAgICB1
cndpZC5jb25uZWN0X3NpZ25hbChzZWxmLmNvbW1hbmRzX2J0biwgJ2NsaWNrJywgbGFtYmRhIGI6
IHNlbGYudG9nZ2xlX2NvbnNvbGUoKSkKICAgICAgICB1cndpZC5jb25uZWN0X3NpZ25hbChzZWxm
LmFkZF9rZXlfYnRuLCAnY2xpY2snLCBsYW1iZGEgYjogc2VsZi5zaG93X2FkZF9rZXlfZGlhbG9n
KCkpCiAgICAgICAgdXJ3aWQuY29ubmVjdF9zaWduYWwoc2VsZi5kaXNjb25uZWN0X2J0biwgJ2Ns
aWNrJywgbGFtYmRhIGI6IHNlbGYuZGlzY29ubmVjdCgpKQogICAgICAgIHVyd2lkLmNvbm5lY3Rf
c2lnbmFsKHNlbGYuZXhpdF9idG4sICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLmV4aXRfbWFpbigp
KQogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKHNlbGYuaGVscF9idG4sICdjbGljaycsIGxh
bWJkYSBiOiBzZWxmLnNob3dfaGVscCgpKQoKICAgICAgICB0b29sYmFyID0gdXJ3aWQuQ29sdW1u
cyhbCiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5yZWZyZXNoX2J0biwg
J2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLlRl
eHQoJyAnKSksCiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5hZGRfa2V5
X2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAgICgncGFjaycsIHVy
d2lkLlRleHQoJyAnKSksCiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5j
b21tYW5kc19idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAojICAgICAgICAgICAgKCdw
YWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKIyAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJN
YXAoc2VsZi5tb3JlX2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAg
ICgnd2VpZ2h0JywgMSwgdXJ3aWQuVGV4dCgnJykpLAogICAgICAgICAgICAoJ3BhY2snLCB1cndp
ZC5BdHRyTWFwKHNlbGYuZGlzY29ubmVjdF9idG4sICdidXR0b25fZGFuZ2VyJywgJ2J1dHRvbl9m
b2N1cycpKSwKICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAg
ICAgKCdwYWNrJywgdXJ3aWQuQXR0ck1hcChzZWxmLmhlbHBfYnRuLCAnYnV0dG9uJywgJ2J1dHRv
bl9mb2N1cycpKSwKICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAg
ICAgICAgKCdwYWNrJywgdXJ3aWQuQXR0ck1hcChzZWxmLmV4aXRfYnRuLCAnYnV0dG9uJywgJ2J1
dHRvbl9mb2N1cycpKSwKICAgICAgICBdLCBkaXZpZGVjaGFycz0wKQoKICAgICAgICAjINCb0LXQ
stCw0Y8g0L/QsNC90LXQu9GMCiAgICAgICAgc2VsZi5jb25uZWN0aW9uX3RyZWUgPSB1cndpZC5T
aW1wbGVMaXN0V2Fsa2VyKFtdKQogICAgICAgIHNlbGYuY29ubmVjdGlvbl9saXN0Ym94ID0gdXJ3
aWQuTGlzdEJveChzZWxmLmNvbm5lY3Rpb25fdHJlZSkKCiAgICAgICAgbGVmdF9wYW5lbCA9IHVy
d2lkLkxpbmVCb3goCiAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoc2VsZi5jb25uZWN0aW9uX2xp
c3Rib3gsICdzaWRlYmFyJyksCiAgICAgICAgICAgIHRpdGxlPSdDb25uZWN0aW9ucyAmIEtleXMn
CiAgICAgICAgKQoKICAgICAgICAjINCf0YDQsNCy0LDRjyDQv9Cw0L3QtdC70YwKICAgICAgICBz
ZWxmLmRldGFpbF93YWxrZXIgPSB1cndpZC5TaW1wbGVMaXN0V2Fsa2VyKFtdKQogICAgICAgIHNl
bGYuZGV0YWlsX2xpc3Rib3ggPSB1cndpZC5MaXN0Qm94KHNlbGYuZGV0YWlsX3dhbGtlcikKCiAg
ICAgICAgcmlnaHRfcGFuZWwgPSB1cndpZC5MaW5lQm94KAogICAgICAgICAgICB1cndpZC5BdHRy
TWFwKHNlbGYuZGV0YWlsX2xpc3Rib3gsICdiYWNrZ3JvdW5kJyksCiAgICAgICAgICAgIHRpdGxl
PSdEZXRhaWxzJwogICAgICAgICkKCiAgICAgICAgIyDQntGB0L3QvtCy0L3QsNGPINC+0LHQu9Cw
0YHRgtGMCiAgICAgICAgY29udGVudCA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAoJ3dl
aWdodCcsIDEsIGxlZnRfcGFuZWwpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDMsIHJpZ2h0X3Bh
bmVsKSwKICAgICAgICBdLCBkaXZpZGVjaGFycz0xKQoKICAgICAgICAjIFRhYnMKICAgICAgICBz
ZWxmLnRhYl90ZXh0ID0gdXJ3aWQuVGV4dCgnJykKCiAgICAgICAgIyDQodGC0LDRgtGD0YEKICAg
ICAgICBzZWxmLnN0YXR1c190ZXh0ID0gdXJ3aWQuVGV4dCgnUmVhZHknKQoKICAgICAgICAjINCa
0L7QvdGB0L7Qu9GMIC0g0LjRgdGC0L7RgNC40Y8g0LrQvtC80LDQvdC0INC4INGA0LXQt9GD0LvR
jNGC0LDRgtC+0LIKICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeSA9IHVyd2lkLlNpbXBsZUxp
c3RXYWxrZXIoW10pCiAgICAgICAgc2VsZi5jb25zb2xlX2xpc3Rib3ggPSB1cndpZC5MaXN0Qm94
KHNlbGYuY29uc29sZV9oaXN0b3J5KQoKICAgICAgICAjINCf0YDQvtC80L/RgiDQtNC70Y8g0LLQ
stC+0LTQsCDQutC+0LzQsNC90LTRiwogICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHQgPSB1cndp
ZC5FZGl0KCdyZWRpcz4gJykKCiAgICAgICAgIyDQn9Cw0L3QtdC70Ywg0LrQvtC90YHQvtC70LgK
ICAgICAgICBjb25zb2xlX2NvbnRlbnQgPSB1cndpZC5QaWxlKFsKICAgICAgICAgICAgKCd3ZWln
aHQnLCAxLCB1cndpZC5BdHRyTWFwKHNlbGYuY29uc29sZV9saXN0Ym94LCAnYmFja2dyb3VuZCcp
KSwKICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuRGl2aWRlcign4pSAJykpLAogICAgICAgICAg
ICAoJ3BhY2snLCB1cndpZC5BdHRyTWFwKHNlbGYuY29tbWFuZF9wcm9tcHQsICdmb290ZXInKSks
CiAgICAgICAgXSkKCiAgICAgICAgc2VsZi5jb25zb2xlX3BhbmVsID0gdXJ3aWQuTGluZUJveCgK
ICAgICAgICAgICAgY29uc29sZV9jb250ZW50LAogICAgICAgICAgICB0aXRsZT0nUmVkaXMgQ29u
c29sZScKICAgICAgICApCgogICAgICAgICMg0J7RgdC90L7QstC90L7QtSDRgtC10LvQviDRgSDQ
stC+0LfQvNC+0LbQvdC+0YHRgtGM0Y4g0L/QtdGA0LXQutC70Y7Rh9C10L3QuNGPCiAgICAgICAg
c2VsZi5tYWluX2NvbnRlbnQgPSB1cndpZC5QaWxlKFsKICAgICAgICAgICAgKCdwYWNrJywgdXJ3
aWQuQXR0ck1hcCh1cndpZC5QYWRkaW5nKHRvb2xiYXIsIGxlZnQ9MSwgcmlnaHQ9MSksICdiYWNr
Z3JvdW5kJykpLAogICAgICAgICAgICAjICgncGFjaycsIHVyd2lkLkRpdmlkZXIoJ+KUgCcpKSwK
ICAgICAgICAgICAgKCd3ZWlnaHQnLCAxLCB1cndpZC5BdHRyTWFwKGNvbnRlbnQsICdiYWNrZ3Jv
dW5kJykpLAogICAgICAgIF0pCgogICAgICAgICMgRm9vdGVyIHBpbGUKICAgICAgICBzZWxmLmZv
b3Rlcl9waWxlID0gdXJ3aWQuUGlsZShbCiAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoc2VsZi50
YWJfdGV4dCwgJ2Zvb3RlcicpLAogICAgICAgICAgICB1cndpZC5BdHRyTWFwKHNlbGYuc3RhdHVz
X3RleHQsICdmb290ZXInKSwKICAgICAgICBdKQoKICAgICAgICBzZWxmLm1haW5fZnJhbWUgPSB1
cndpZC5GcmFtZSgKICAgICAgICAgICAgaGVhZGVyPXNlbGYuaGVhZGVyLAogICAgICAgICAgICBi
b2R5PXNlbGYubWFpbl9jb250ZW50LAogICAgICAgICAgICBmb290ZXI9c2VsZi5mb290ZXJfcGls
ZQogICAgICAgICkKCiAgICAgICAgc2VsZi51cGRhdGVfY29ubmVjdGlvbl90cmVlKCkKCiAgICBk
ZWYgdG9nZ2xlX2NvbnNvbGUoc2VsZik6CiAgICAgICAgIiIi0J/QtdGA0LXQutC70Y7Rh9C10L3Q
uNC1INC60L7QvdGB0L7Qu9C4IiIiCiAgICAgICAgaWYgc2VsZi5jb25zb2xlX21vZGU6CiAgICAg
ICAgICAgICMg0JLRi9C60LvRjtGH0LDQtdC8INC60L7QvdGB0L7Qu9GMIC0g0L/QvtC60LDQt9GL
0LLQsNC10Lwg0L7RgdC90L7QstC90L7QuSDQutC+0L3RgtC10L3RggogICAgICAgICAgICBzZWxm
Lm1haW5fY29udGVudC5jb250ZW50cyA9IFsKICAgICAgICAgICAgICAgICh1cndpZC5BdHRyTWFw
KHVyd2lkLlBhZGRpbmcoCiAgICAgICAgICAgICAgICAgICAgdXJ3aWQuQ29sdW1ucyhbCiAgICAg
ICAgICAgICAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5yZWZyZXNoX2J0
biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAgICAgICAgICAgICAgICgn
cGFjaycsIHVyd2lkLlRleHQoJyAnKSksCiAgICAgICAgICAgICAgICAgICAgICAgICgncGFjaycs
IHVyd2lkLkF0dHJNYXAoc2VsZi5hZGRfa2V5X2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMn
KSksCiAgICAgICAgICAgICAgICAgICAgICAgICgncGFjaycsIHVyd2lkLlRleHQoJyAnKSksCiAg
ICAgICAgICAgICAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5jb21tYW5k
c19idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAojICAgICAgICAgICAgICAgICAgICAg
ICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKIyAgICAgICAgICAgICAgICAgICAgICAgICgn
cGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5tb3JlX2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9j
dXMnKSksCiAgICAgICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuVGV4dCgn
JykpLAogICAgICAgICAgICAgICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5BdHRyTWFwKHNlbGYu
ZGlzY29ubmVjdF9idG4sICdidXR0b25fZGFuZ2VyJywgJ2J1dHRvbl9mb2N1cycpKSwKICAgICAg
ICAgICAgICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAg
ICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuQXR0ck1hcChzZWxmLmhlbHBfYnRuLCAnYnV0dG9u
JywgJ2J1dHRvbl9mb2N1cycpKSwKICAgICAgICAgICAgICAgICAgICAgICAgKCdwYWNrJywgdXJ3
aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuQXR0
ck1hcChzZWxmLmV4aXRfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpKSwKICAgICAgICAg
ICAgICAgICAgICBdLCBkaXZpZGVjaGFycz0wKSwgbGVmdD0xLCByaWdodD0xKSwgJ2JhY2tncm91
bmQnKSwgKCdwYWNrJywgTm9uZSkpLAogICAgICAgICAgICAgICAgIyAodXJ3aWQuRGl2aWRlcign
4pSAJyksICgncGFjaycsIE5vbmUpKSwKICAgICAgICAgICAgICAgICh1cndpZC5BdHRyTWFwKHVy
d2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuTGlu
ZUJveCgKICAgICAgICAgICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChzZWxmLmNvbm5lY3Rp
b25fbGlzdGJveCwgJ3NpZGViYXInKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9J0Nv
bm5lY3Rpb25zICYgS2V5cycKICAgICAgICAgICAgICAgICAgICApKSwKICAgICAgICAgICAgICAg
ICAgICAoJ3dlaWdodCcsIDMsIHVyd2lkLkxpbmVCb3goCiAgICAgICAgICAgICAgICAgICAgICAg
IHVyd2lkLkF0dHJNYXAoc2VsZi5kZXRhaWxfbGlzdGJveCwgJ2JhY2tncm91bmQnKSwKICAgICAg
ICAgICAgICAgICAgICAgICAgdGl0bGU9J0RldGFpbHMnCiAgICAgICAgICAgICAgICAgICAgKSks
CiAgICAgICAgICAgICAgICBdLCBkaXZpZGVjaGFycz0xKSwgJ2JhY2tncm91bmQnKSwgKCd3ZWln
aHQnLCAxKSksCiAgICAgICAgICAgIF0KICAgICAgICAgICAgc2VsZi5jb25zb2xlX21vZGUgPSBG
YWxzZQogICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoIkNvbnNvbGUgY2xvc2VkIikKICAgICAg
ICBlbHNlOgogICAgICAgICAgICAjINCS0LrQu9GO0YfQsNC10Lwg0LrQvtC90YHQvtC70YwgLSDR
gNCw0LfQtNC10LvRj9C10Lwg0Y3QutGA0LDQvQogICAgICAgICAgICB0b29sYmFyID0gdXJ3aWQu
Q29sdW1ucyhbCiAgICAgICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5BdHRyTWFwKHNlbGYuY29t
bWFuZHNfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpKSwKICAgICAgICAgICAgICAgICgn
cGFjaycsIHVyd2lkLlRleHQoJyAnKSksCiAgICAgICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5B
dHRyTWFwKHNlbGYuYWRkX2tleV9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAg
ICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgn
cGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5yZWZyZXNoX2J0biwgJ2J1dHRvbicsICdidXR0b25f
Zm9jdXMnKSksCiAgICAgICAgICAgICAgICAjICgncGFjaycsIHVyd2lkLlRleHQoJyAnKSksCiAg
ICAgICAgICAgICAgICAjICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5tb3JlX2J0biwgJ2J1
dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVy
d2lkLlRleHQoJycpKSwKICAgICAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2Vs
Zi5kaXNjb25uZWN0X2J0biwgJ2J1dHRvbl9kYW5nZXInLCAnYnV0dG9uX2ZvY3VzJykpLAogICAg
ICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgn
cGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5oZWxwX2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9j
dXMnKSksCiAgICAgICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5UZXh0KCcgJykpLAogICAgICAg
ICAgICAgICAgKCdwYWNrJywgdXJ3aWQuQXR0ck1hcChzZWxmLmV4aXRfYnRuLCAnYnV0dG9uJywg
J2J1dHRvbl9mb2N1cycpKSwKICAgICAgICAgICAgXSwgZGl2aWRlY2hhcnM9MCkKCiAgICAgICAg
ICAgIGNvbnRlbnRfYXJlYSA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgKCd3ZWln
aHQnLCAxLCB1cndpZC5MaW5lQm94KAogICAgICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAo
c2VsZi5jb25uZWN0aW9uX2xpc3Rib3gsICdzaWRlYmFyJyksCiAgICAgICAgICAgICAgICAgICAg
dGl0bGU9J0Nvbm5lY3Rpb25zICYgS2V5cycKICAgICAgICAgICAgICAgICkpLAogICAgICAgICAg
ICAgICAgKCd3ZWlnaHQnLCAzLCB1cndpZC5MaW5lQm94KAogICAgICAgICAgICAgICAgICAgIHVy
d2lkLkF0dHJNYXAoc2VsZi5kZXRhaWxfbGlzdGJveCwgJ2JhY2tncm91bmQnKSwKICAgICAgICAg
ICAgICAgICAgICB0aXRsZT0nRGV0YWlscycKICAgICAgICAgICAgICAgICkpLAogICAgICAgICAg
ICBdLCBkaXZpZGVjaGFycz0xKQoKICAgICAgICAgICAgc2VsZi5tYWluX2NvbnRlbnQuY29udGVu
dHMgPSBbCiAgICAgICAgICAgICAgICAodXJ3aWQuQXR0ck1hcCh1cndpZC5QYWRkaW5nKHRvb2xi
YXIsIGxlZnQ9MSwgcmlnaHQ9MSksICdiYWNrZ3JvdW5kJyksICgncGFjaycsIE5vbmUpKSwKICAg
ICAgICAgICAgICAgICMgKHVyd2lkLkRpdmlkZXIoJ+KUgCcpLCAoJ3BhY2snLCBOb25lKSksCiAg
ICAgICAgICAgICAgICAodXJ3aWQuQXR0ck1hcChjb250ZW50X2FyZWEsICdiYWNrZ3JvdW5kJyks
ICgnd2VpZ2h0JywgMikpLAogICAgICAgICAgICAgICAgIyAodXJ3aWQuRGl2aWRlcign4pSAJyks
ICgncGFjaycsIE5vbmUpKSwKICAgICAgICAgICAgICAgICh1cndpZC5BdHRyTWFwKHNlbGYuY29u
c29sZV9wYW5lbCwgJ2JhY2tncm91bmQnKSwgKCd3ZWlnaHQnLCAxKSksCiAgICAgICAgICAgIF0K
ICAgICAgICAgICAgc2VsZi5jb25zb2xlX21vZGUgPSBUcnVlCgogICAgICAgICAgICAjINCU0L7Q
sdCw0LLQu9GP0LXQvCDQv9GA0LjQstC10YLRgdGC0LLQtdC90L3QvtC1INGB0L7QvtCx0YnQtdC9
0LjQtSDQtdGB0LvQuCDQutC+0L3RgdC+0LvRjCDQv9GD0YHRgtCw0Y8KICAgICAgICAgICAgaWYg
bGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSA9PSAwOgogICAgICAgICAgICAgICAgc2VsZi5jb25z
b2xlX2hpc3RvcnkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHVyd2lkLlRleHQoKCdzdWNj
ZXNzJywgJ1JlZGlzIENvbnNvbGUgLSBUeXBlIGNvbW1hbmRzIGFuZCBwcmVzcyBFbnRlci4gVHlw
ZSAiZXhpdCIgb3IgcHJlc3MgRXNjIHRvIGNsb3NlLicpKQogICAgICAgICAgICAgICAgKQogICAg
ICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkK
CiAgICAgICAgICAgICMg0KPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0YTQvtC60YPRgSDQvdCw
INC60L7QvdGB0L7Qu9GM0L3Rg9GOINC/0LDQvdC10LvRjAogICAgICAgICAgICBzZWxmLm1haW5f
Y29udGVudC5mb2N1c19wb3NpdGlvbiA9IDIKICAgICAgICAgICAgIyDQpNC+0LrRg9GBINC90LAg
0L/RgNC+0LzQv9GCINCy0L3Rg9GC0YDQuCDQutC+0L3RgdC+0LvRjNC90L7QuSDQv9Cw0L3QtdC7
0LgKICAgICAgICAgICAgc2VsZi5jb25zb2xlX3BhbmVsLm9yaWdpbmFsX3dpZGdldC5mb2N1c19w
b3NpdGlvbiA9IDIKICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKCJDb25zb2xlIG9wZW5lZCAo
cHJlc3MgRjIgdG8gY2xvc2UpIikKCiAgICBkZWYgZXhlY3V0ZV9jb21tYW5kKHNlbGYpOgogICAg
ICAgICIiItCS0YvQv9C+0LvQvdC10L3QuNC1INC60L7QvNCw0L3QtNGLINC40Lcg0LrQvtC90YHQ
vtC70Lgg0YEg0L/QvtC00LTQtdGA0LbQutC+0Lkg0LrQu9Cw0YHRgtC10YDQsCIiIgogICAgICAg
IGlmIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBub3Qgc2VsZi5jdXJyZW50X2Nvbm5l
Y3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQo
dXJ3aWQuVGV4dCgoJ2Vycm9yJywgJ+KclyBOb3QgY29ubmVjdGVkIHRvIFJlZGlzJykpKQogICAg
ICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQogICAg
ICAgICAgICBpZiBsZW4oc2VsZi5jb25zb2xlX2hpc3RvcnkpID4gMDoKICAgICAgICAgICAgICAg
IHNlbGYuY29uc29sZV9saXN0Ym94LnNldF9mb2N1cyhsZW4oc2VsZi5jb25zb2xlX2hpc3Rvcnkp
IC0gMSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGNvbW1hbmQgPSBzZWxmLmNvbW1hbmRf
cHJvbXB0LmdldF9lZGl0X3RleHQoKS5zdHJpcCgpCiAgICAgICAgaWYgbm90IGNvbW1hbmQ6CiAg
ICAgICAgICAgIHJldHVybgoKICAgICAgICAjINCf0YDQvtCy0LXRgNGP0LXQvCDQvdCwINC60L7Q
vNCw0L3QtNGDINCy0YvRhdC+0LTQsAogICAgICAgIGlmIGNvbW1hbmQubG93ZXIoKSBpbiBbJ2V4
aXQnLCAncXVpdCddOgogICAgICAgICAgICBzZWxmLnRvZ2dsZV9jb25zb2xlKCkKICAgICAgICAg
ICAgcmV0dXJuCgogICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INC60L7QvNCw0L3QtNGDINCy
INC40YHRgtC+0YDQuNGOCiAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lk
LlRleHQoKCdpbmZvX2xhYmVsJywgZidyZWRpcz4ge2NvbW1hbmR9JykpKQoKICAgICAgICB0cnk6
CiAgICAgICAgICAgIGNsaWVudCA9IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmFjdGl2ZV9jbGll
bnQKICAgICAgICAgICAgaXNfY2x1c3RlciA9IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmlzX2Ns
dXN0ZXIKCiAgICAgICAgICAgICMg0KDQsNC30LHQuNGA0LDQtdC8INC60L7QvNCw0L3QtNGDCiAg
ICAgICAgICAgIHBhcnRzID0gY29tbWFuZC5zcGxpdCgpCiAgICAgICAgICAgIGNtZCA9IHBhcnRz
WzBdLnVwcGVyKCkKICAgICAgICAgICAgYXJncyA9IHBhcnRzWzE6XQoKICAgICAgICAgICAgIyDQ
odC/0LXRhtC40LDQu9GM0L3QsNGPINC+0LHRgNCw0LHQvtGC0LrQsCDQtNC70Y8g0LrQu9Cw0YHR
gtC10YDQsAogICAgICAgICAgICBpZiBpc19jbHVzdGVyOgogICAgICAgICAgICAgICAgIyDQmtC+
0LzQsNC90LTRiywg0LrQvtGC0L7RgNGL0LUg0L3QtSDQv9C+0LTQtNC10YDQttC40LLQsNGO0YLR
gdGPINCyINC60LvQsNGB0YLQtdGA0LUKICAgICAgICAgICAgICAgIHVuc3VwcG9ydGVkX2NvbW1h
bmRzID0gWydTRUxFQ1QnLCAnTU9WRScsICdTV0FQREInLCAnTUlHUkFURScsICdSQU5ET01LRVkn
XQogICAgICAgICAgICAgICAgaWYgY21kIGluIHVuc3VwcG9ydGVkX2NvbW1hbmRzOgogICAgICAg
ICAgICAgICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5LmFwcGVuZCgKICAgICAgICAgICAgICAg
ICAgICAgICAgdXJ3aWQuVGV4dCgoJ2Vycm9yJywgZiIoZXJyb3IpIENvbW1hbmQgJ3tjbWR9JyBu
b3Qgc3VwcG9ydGVkIGluIFJlZGlzIENsdXN0ZXIiKSkKICAgICAgICAgICAgICAgICAgICApCiAg
ICAgICAgICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLkRpdmlk
ZXIoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbW1hbmRfcHJvbXB0LnNldF9lZGl0X3Rl
eHQoJycpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICAgICAgIyDQmtC+
0LzQsNC90LTRiyDQutC70LDRgdGC0LXRgNCwICjQvdCw0YfQuNC90LDRjtGJ0LjQtdGB0Y8g0YEg
Q0xVU1RFUikKICAgICAgICAgICAgICAgIGlmIGNtZC5zdGFydHN3aXRoKCdDTFVTVEVSJyk6CiAg
ICAgICAgICAgICAgICAgICAgIyDQktGL0L/QvtC70L3Rj9C10Lwg0LrQsNC6INC10YHRgtGMCiAg
ICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gY2xpZW50LmV4ZWN1dGVfY29tbWFuZChjbWQsICph
cmdzKQoKICAgICAgICAgICAgICAgICMgS0VZUyAtINGC0YDQtdCx0YPQtdGCINGB0LrQsNC90LjR
gNC+0LLQsNC90LjRjyDQstGB0LXRhSDRg9C30LvQvtCyCiAgICAgICAgICAgICAgICBlbGlmIGNt
ZCA9PSAnS0VZUyc6CiAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9IGFyZ3NbMF0gaWYgYXJn
cyBlbHNlICcqJwogICAgICAgICAgICAgICAgICAgIGtleXMgPSBbXQogICAgICAgICAgICAgICAg
ICAgIGZvciBub2RlIGluIGNsaWVudC5nZXRfbm9kZXMoKToKICAgICAgICAgICAgICAgICAgICAg
ICAgaWYgbm9kZS5zZXJ2ZXJfdHlwZSA9PSAnbWFzdGVyJzoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2tleXMgPSBu
b2RlLmtleXMocGF0dGVybikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzLmV4
dGVuZChub2RlX2tleXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0
aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmco
ZiJFcnJvciBnZXR0aW5nIGtleXMgZnJvbSBub2RlOiB7ZX0iKQogICAgICAgICAgICAgICAgICAg
IHJlc3VsdCA9IGtleXMKCiAgICAgICAgICAgICAgICAjIFNDQU4gLSDRgtGA0LXQsdGD0LXRgiDQ
vtCx0YDQsNCx0L7RgtC60Lgg0LLRgdC10YUg0YPQt9C70L7QsgogICAgICAgICAgICAgICAgZWxp
ZiBjbWQgPT0gJ1NDQU4nOgogICAgICAgICAgICAgICAgICAgIGN1cnNvciA9IGludChhcmdzWzBd
KSBpZiBhcmdzIGFuZCBhcmdzWzBdLmlzZGlnaXQoKSBlbHNlIDAKICAgICAgICAgICAgICAgICAg
ICBwYXR0ZXJuID0gYXJnc1sxXSBpZiBsZW4oYXJncykgPiAxIGVsc2UgJyonCiAgICAgICAgICAg
ICAgICAgICAgY291bnQgPSBpbnQoYXJnc1syXSkgaWYgbGVuKGFyZ3MpID4gMiBlbHNlIDEwCgog
ICAgICAgICAgICAgICAgICAgIGFsbF9rZXlzID0gW10KICAgICAgICAgICAgICAgICAgICBmb3Ig
bm9kZSBpbiBjbGllbnQuZ2V0X25vZGVzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5v
ZGUuc2VydmVyX3R5cGUgPT0gJ21hc3Rlcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0
cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9jdXJzb3IgPSAwCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbm9kZV9jdXJzb3IsIGJhdGNoID0gbm9kZS5zY2FuKG5vZGVfY3Vy
c29yLCBtYXRjaD1wYXR0ZXJuLCBjb3VudD1jb3VudCkKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYWxsX2tleXMuZXh0ZW5kKGJhdGNoKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpZiBub2RlX2N1cnNvciA9PSAwOgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2Vw
dCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIu
d2FybmluZyhmIkVycm9yIHNjYW5uaW5nIG5vZGU6IHtlfSIpCgogICAgICAgICAgICAgICAgICAg
ICMg0K3QvNGD0LvQuNGA0YPQtdC8INC/0L7QstC10LTQtdC90LjQtSBTQ0FOCiAgICAgICAgICAg
ICAgICAgICAgcmVzdWx0ID0gWzAsIGFsbF9rZXlzWzpjb3VudF1dIGlmIGFsbF9rZXlzIGVsc2Ug
WzAsIFtdXQoKICAgICAgICAgICAgICAgICMgSU5GTyAtINGB0L7QsdC40YDQsNC10Lwg0LjQvdGE
0L7RgNC80LDRhtC40Y4g0YHQviDQstGB0LXRhSDRg9C30LvQvtCyCiAgICAgICAgICAgICAgICBl
bGlmIGNtZCA9PSAnSU5GTyc6CiAgICAgICAgICAgICAgICAgICAgaWYgYXJncyBhbmQgYXJnc1sw
XS5sb3dlcigpIGluIFsnY2x1c3RlcicsICdrZXlzcGFjZScsICdtZW1vcnknLCAnY3B1J106CiAg
ICAgICAgICAgICAgICAgICAgICAgICMgSU5GTyDQv9C+INGB0LXQutGG0LjRj9C8CiAgICAgICAg
ICAgICAgICAgICAgICAgIHNlY3Rpb24gPSBhcmdzWzBdLmxvd2VyKCkKICAgICAgICAgICAgICAg
ICAgICAgICAgaW5mb19yZXN1bHRzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG5v
ZGUgaW4gY2xpZW50LmdldF9ub2RlcygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg
bm9kZS5zZXJ2ZXJfdHlwZSA9PSAnbWFzdGVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfaW5mbyA9
IG5vZGUuaW5mbyhzZWN0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bmZvX3Jlc3VsdHMuYXBwZW5kKGYiLS0tIHtub2RlLmhvc3R9Ontub2RlLnBvcnR9IC0tLVxue25v
ZGVfaW5mb30iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRp
b24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb19yZXN1bHRz
LmFwcGVuZChmIi0tLSB7bm9kZS5ob3N0fTp7bm9kZS5wb3J0fSBFUlJPUjoge2V9IC0tLSIpCiAg
ICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9ICJcbiIuam9pbihpbmZvX3Jlc3VsdHMpCiAg
ICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgIyBJTkZPINC/
0L4g0YPQvNC+0LvRh9Cw0L3QuNGOICjRgtC+0LvRjNC60L4g0LTQu9GPINGC0LXQutGD0YnQtdCz
0L4g0YPQt9C70LApCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNsaWVudC5leGVj
dXRlX2NvbW1hbmQoY21kLCAqYXJncykKCiAgICAgICAgICAgICAgICAjIERCU0laRSAtINGB0YPQ
vNC80LjRgNGD0LXQvCDQv9C+INCy0YHQtdC8INGD0LfQu9Cw0LwKICAgICAgICAgICAgICAgIGVs
aWYgY21kID09ICdEQlNJWkUnOgogICAgICAgICAgICAgICAgICAgIHRvdGFsID0gMAogICAgICAg
ICAgICAgICAgICAgIGZvciBub2RlIGluIGNsaWVudC5nZXRfbm9kZXMoKToKICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgbm9kZS5zZXJ2ZXJfdHlwZSA9PSAnbWFzdGVyJzoKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3Rh
bCArPSBub2RlLmRic2l6ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhj
ZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5p
bmcoZiJFcnJvciBnZXR0aW5nIGRic2l6ZSBmcm9tIG5vZGU6IHtlfSIpCiAgICAgICAgICAgICAg
ICAgICAgcmVzdWx0ID0gdG90YWwKCiAgICAgICAgICAgICAgICAjIEZMVVNIQUxML0ZMVVNIREIg
LSDQstGL0L/QvtC70L3Rj9C10Lwg0L3QsCDQstGB0LXRhSDRg9C30LvQsNGFCiAgICAgICAgICAg
ICAgICBlbGlmIGNtZCBpbiBbJ0ZMVVNIQUxMJywgJ0ZMVVNIREInXToKICAgICAgICAgICAgICAg
ICAgICByZXN1bHRzID0gW10KICAgICAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBjbGllbnQu
Z2V0X25vZGVzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vZGUuc2VydmVyX3R5cGUg
PT0gJ21hc3Rlcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbm9kZV9yZXN1bHQgPSBub2RlLmV4ZWN1dGVfY29tbWFuZChj
bWQsICphcmdzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5k
KGYie25vZGUuaG9zdH06e25vZGUucG9ydH06IHtub2RlX3Jlc3VsdH0iKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKGYie25vZGUuaG9zdH06e25vZGUucG9ydH06IEVS
Uk9SIC0ge2V9IikKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSAiXG4iLmpvaW4ocmVzdWx0
cykKCiAgICAgICAgICAgICAgICAjINCe0LHRi9GH0L3Ri9C1INC60L7QvNCw0L3QtNGLIC0g0LLR
i9C/0L7Qu9C90Y/QtdC8INGH0LXRgNC10Lcg0LrQu9C40LXQvdGCINC60LvQsNGB0YLQtdGA0LAK
ICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gY2xpZW50
LmV4ZWN1dGVfY29tbWFuZChjbWQsICphcmdzKQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAg
ICAgICAgICMgU3RhbmRhbG9uZSDRgNC10LbQuNC8IC0g0YHRg9GJ0LXRgdGC0LLRg9GO0YnQsNGP
INC70L7Qs9C40LrQsAogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2xpZW50LmV4ZWN1dGVfY29t
bWFuZChjbWQsICphcmdzKQoKICAgICAgICAgICAgIyDQpNC+0YDQvNCw0YLQuNGA0YPQtdC8INGA
0LXQt9GD0LvRjNGC0LDRgiAo0L7QsdGJ0LjQuSDQutC+0LQg0LTQu9GPINC+0LHQvtC40YUg0YDQ
tdC20LjQvNC+0LIpCiAgICAgICAgICAgIHJlc3VsdF9zdHIgPSBzZWxmLmZvcm1hdF9yZWRpc19y
ZXN1bHQoY21kLCByZXN1bHQpCgogICAgICAgICAgICAjINCU0L7QsdCw0LLQu9GP0LXQvCDRgNC1
0LfRg9C70YzRgtCw0YIg0LIg0LjRgdGC0L7RgNC40Y4KICAgICAgICAgICAgaWYgJ1xuJyBpbiBy
ZXN1bHRfc3RyOgogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gcmVzdWx0X3N0ci5zcGxpdCgn
XG4nKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3
aWQuVGV4dCgoJ3N1Y2Nlc3MnLCBsaW5lKSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAg
ICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuVGV4dCgoJ3N1Y2Nlc3MnLCBy
ZXN1bHRfc3RyKSkpCgogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkV4ZWN1dGVkOiB7Y29tbWFu
ZH0gPT4ge3Jlc3VsdF9zdHJbOjEwMF19IikKCiAgICAgICAgICAgICMg0J7Rh9C40YnQsNC10Lwg
0L/RgNC+0LzQv9GCCiAgICAgICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHQuc2V0X2VkaXRfdGV4
dCgnJykKCiAgICAgICAgICAgICMg0J7QsdC90L7QstC70Y/QtdC8INC10YHQu9C4INC60L7QvNCw
0L3QtNCwINC80L7Qs9C70LAg0LjQt9C80LXQvdC40YLRjCDQtNCw0L3QvdGL0LUKICAgICAgICAg
ICAgbW9kaWZ5aW5nX2NvbW1hbmRzID0gWwogICAgICAgICAgICAgICAgJ1NFVCcsICdERUwnLCAn
SFNFVCcsICdIREVMJywgJ0xQVVNIJywgJ1JQVVNIJywgJ0xQT1AnLCAnUlBPUCcsCiAgICAgICAg
ICAgICAgICAnU0FERCcsICdTUkVNJywgJ1pBREQnLCAnWlJFTScsICdGTFVTSERCJywgJ0ZMVVNI
QUxMJywgJ1JFTkFNRScsCiAgICAgICAgICAgICAgICAnUkVOQU1FTlgnLCAnRVhQSVJFJywgJ0VY
UElSRUFUJywgJ1BFUlNJU1QnLCAnQVBQRU5EJywgJ0RFQ1InLAogICAgICAgICAgICAgICAgJ0lO
Q1InLCAnTFNFVCcsICdMVFJJTScsICdNU0VUJywgJ1BFWFBJUkUnLCAnUEVYUElSRUFUJywgJ1BT
RVRFWCcsCiAgICAgICAgICAgICAgICAnU0VURVgnLCAnU0VUTlgnLCAnU1RSRUFNJywgJ0hTRVRO
WCcsICdITVNFVCcsICdMUFVTSFgnLCAnUlBVU0hYJywgJ1NJTlRFUlNUT1JFJywKICAgICAgICAg
ICAgICAgICdTVU5JT05TVE9SRScsICdTRElGRlNUT1JFJywgJ1pJTlRFUlNUT1JFJywgJ1pVTklP
TlNUT1JFJywgJ1pSRU0nLAogICAgICAgICAgICAgICAgJ1pSRU1SQU5HRUJZTEVYJywgJ1pSRU1S
QU5HRUJZUkFOSycsICdaUkVNUkFOR0VCWVNDT1JFJwogICAgICAgICAgICBdCgogICAgICAgICAg
ICBpZiBjbWQgaW4gbW9kaWZ5aW5nX2NvbW1hbmRzOgogICAgICAgICAgICAgICAgc2VsZi5yZWZy
ZXNoX2tleXMoKQoKICAgICAgICBleGNlcHQgcmVkaXMuUmVzcG9uc2VFcnJvciBhcyBlOgogICAg
ICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuVGV4dCgoJ2Vycm9yJywg
ZicoZXJyb3IpIHtzdHIoZSl9JykpKQogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJSZWRpcyBl
cnJvcjoge2V9IikKICAgICAgICBleGNlcHQgcmVkaXMuZXhjZXB0aW9ucy5SZWRpc0NsdXN0ZXJF
eGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVy
d2lkLlRleHQoKCdlcnJvcicsIGYnKGNsdXN0ZXIgZXJyb3IpIHtzdHIoZSl9JykpKQogICAgICAg
ICAgICBsb2dnZXIuZXJyb3IoZiJSZWRpcyBjbHVzdGVyIGVycm9yOiB7ZX0iKQogICAgICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBw
ZW5kKHVyd2lkLlRleHQoKCdlcnJvcicsIGYnKGVycm9yKSB7c3RyKGUpfScpKSkKICAgICAgICAg
ICAgbG9nZ2VyLmVycm9yKGYiQ29tbWFuZCBmYWlsZWQ6IHtlfSIpCgogICAgICAgICMg0KDQsNC3
0LTQtdC70LjRgtC10LvRjAogICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5LmFwcGVuZCh1cndp
ZC5EaXZpZGVyKCkpCgogICAgICAgICMg0J/RgNC+0LrRgNGD0YfQuNCy0LDQtdC8INCy0L3QuNC3
INC6INC/0L7RgdC70LXQtNC90LXQuSDQutC+0LzQsNC90LTQtQogICAgICAgIGlmIGxlbihzZWxm
LmNvbnNvbGVfaGlzdG9yeSkgPiAwOgogICAgICAgICAgICBzZWxmLmNvbnNvbGVfbGlzdGJveC5z
ZXRfZm9jdXMobGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSAtIDEpCgogICAgICAgICMg0J7Qs9GA
0LDQvdC40YfQuNCy0LDQtdC8INC40YHRgtC+0YDQuNGOCiAgICAgICAgaWYgbGVuKHNlbGYuY29u
c29sZV9oaXN0b3J5KSA+IDIwMDoKICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnlbOl0g
PSBzZWxmLmNvbnNvbGVfaGlzdG9yeVstMTUwOl0KCiAgICBkZWYgZm9ybWF0X3JlZGlzX3Jlc3Vs
dChzZWxmLCBjbWQ6IHN0ciwgcmVzdWx0KSAtPiBzdHI6CiAgICAgICAgIiIi0KTQvtGA0LzQsNGC
0LjRgNC+0LLQsNC90LjQtSDRgNC10LfRg9C70YzRgtCw0YLQsCBSZWRpcyDQutC+0LzQsNC90LTR
iyIiIgoKICAgICAgICBpZiBjbWQgPT0gJ1BJTkcnOgogICAgICAgICAgICBpZiByZXN1bHQgaXMg
VHJ1ZSBvciByZXN1bHQgPT0gYidQT05HJyBvciByZXN1bHQgPT0gJ1BPTkcnOgogICAgICAgICAg
ICAgICAgcmV0dXJuICdQT05HJwogICAgICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBi
eXRlcyk6CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmRlY29kZSgndXRmLTgnLCBlcnJv
cnM9J3JlcGxhY2UnKQogICAgICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBzdHIpOgog
ICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICBlbHNlOgogICAgICAgICAg
ICAgICAgcmV0dXJuICdQT05HJwoKICAgICAgICBlbGlmIHJlc3VsdCBpcyBOb25lOgogICAgICAg
ICAgICByZXR1cm4gJyhuaWwpJwoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBib29s
KToKICAgICAgICAgICAgcmV0dXJuICdPSycgaWYgcmVzdWx0IGVsc2UgJyhlcnJvciknCgogICAg
ICAgIGVsaWYgaXNpbnN0YW5jZShyZXN1bHQsIGludCk6CiAgICAgICAgICAgIHJldHVybiBmJyhp
bnRlZ2VyKSB7cmVzdWx0fScKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3VsdCwgYnl0ZXMp
OgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBkZWNvZGVkID0gcmVzdWx0LmRlY29k
ZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAgcmV0dXJuIGYnIntk
ZWNvZGVkfSInCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHJldHVybiBmJzxi
eXRlczoge2xlbihyZXN1bHQpfT4nCgogICAgICAgIGVsaWYgaXNpbnN0YW5jZShyZXN1bHQsIHN0
cik6CiAgICAgICAgICAgIHJldHVybiBmJyJ7cmVzdWx0fSInCgogICAgICAgIGVsaWYgaXNpbnN0
YW5jZShyZXN1bHQsIGxpc3QpOgogICAgICAgICAgICBpZiBsZW4ocmVzdWx0KSA9PSAwOgogICAg
ICAgICAgICAgICAgcmV0dXJuICcoZW1wdHkgbGlzdCBvciBzZXQpJwogICAgICAgICAgICBlbHNl
OgogICAgICAgICAgICAgICAgcmVzdWx0X2xpbmVzID0gW10KICAgICAgICAgICAgICAgIGZvciBp
LCBpdGVtIGluIGVudW1lcmF0ZShyZXN1bHRbOjUwXSk6ICAjINCe0LPRgNCw0L3QuNGH0LjQstCw
0LXQvCA1MCDRjdC70LXQvNC10L3RgtCw0LzQuAogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5z
dGFuY2UoaXRlbSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBkZWNvZGVkID0gaXRlbS5kZWNvZGUoInV0Zi04IiwgZXJyb3Jz
PSJyZXBsYWNlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcy5hcHBl
bmQoZid7aSArIDF9KSAie2RlY29kZWR9IicpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2Vw
dDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcy5hcHBlbmQoZid7aSAr
IDF9KSA8Ynl0ZXM6IHtsZW4oaXRlbSl9PicpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBpc2lu
c3RhbmNlKGl0ZW0sIHN0cik6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcy5h
cHBlbmQoZid7aSArIDF9KSAie2l0ZW19IicpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBpc2lu
c3RhbmNlKGl0ZW0sIGxpc3QpOgogICAgICAgICAgICAgICAgICAgICAgICAjINCS0LvQvtC20LXQ
vdC90YvQtSDRgdC/0LjRgdC60LggKNC90LDQv9GA0LjQvNC10YAsIFNDQU4pCiAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIGkgPT0gMCBhbmQgbGVuKGl0ZW0pID09IDIgYW5kIGlzaW5zdGFuY2Uo
aXRlbVswXSwgaW50KToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0K3RgtC+INGA0LXQ
t9GD0LvRjNGC0LDRgiBTQ0FOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRfbGlu
ZXMuYXBwZW5kKGYne2kgKyAxfSkgMSkgIntpdGVtWzBdfSInKQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcmVzdWx0X2xpbmVzLmFwcGVuZChmJyAgIDIpIHtzZWxmLmZvcm1hdF9yZWRpc19y
ZXN1bHQoIlNDQU4iLCBpdGVtWzFdKX0nKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0X2xpbmVzLmFwcGVuZChmJ3tpICsgMX0p
IHtpdGVtfScpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAg
ICAgcmVzdWx0X2xpbmVzLmFwcGVuZChmJ3tpICsgMX0pIHtzdHIoaXRlbSl9JykKCiAgICAgICAg
ICAgICAgICBpZiBsZW4ocmVzdWx0KSA+IDUwOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdF9s
aW5lcy5hcHBlbmQoZicuLi4gYW5kIHtsZW4ocmVzdWx0KSAtIDUwfSBtb3JlIGl0ZW1zJykKCiAg
ICAgICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKHJlc3VsdF9saW5lcykKCiAgICAgICAgZWxp
ZiBpc2luc3RhbmNlKHJlc3VsdCwgZGljdCk6CiAgICAgICAgICAgIGlmIGxlbihyZXN1bHQpID09
IDA6CiAgICAgICAgICAgICAgICByZXR1cm4gJyhlbXB0eSBoYXNoKScKICAgICAgICAgICAgZWxz
ZToKICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcyA9IFtdCiAgICAgICAgICAgICAgICBmb3Ig
aSwgKGtleSwgdmFsdWUpIGluIGVudW1lcmF0ZShsaXN0KHJlc3VsdC5pdGVtcygpKVs6NTBdKToK
ICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGtleSwgYnl0ZXMpOgogICAgICAgICAg
ICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBrZXku
ZGVjb2RlKCJ1dGYtOCIsIGVycm9ycz0icmVwbGFjZSIpCiAgICAgICAgICAgICAgICAgICAgICAg
IGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IGYnPGJ5dGVzOiB7bGVu
KGtleSl9PicKCiAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgYnl0ZXMp
OgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2YWx1ZSA9IHZhbHVlLmRlY29kZSgidXRmLTgiLCBlcnJvcnM9InJlcGxhY2UiKQogICAgICAg
ICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1
ZSA9IGYnPGJ5dGVzOiB7bGVuKHZhbHVlKX0+JwoKICAgICAgICAgICAgICAgICAgICByZXN1bHRf
bGluZXMuYXBwZW5kKGYne2kgKyAxfSkgIntrZXl9IiA9PiAie3ZhbHVlfSInKQoKICAgICAgICAg
ICAgICAgIGlmIGxlbihyZXN1bHQpID4gNTA6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0X2xp
bmVzLmFwcGVuZChmJy4uLiBhbmQge2xlbihyZXN1bHQpIC0gNTB9IG1vcmUgZmllbGRzJykKCiAg
ICAgICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKHJlc3VsdF9saW5lcykKCiAgICAgICAgZWxz
ZToKICAgICAgICAgICAgcmV0dXJuIHN0cihyZXN1bHQpCgogICAgZGVmIHVwZGF0ZV9jb25uZWN0
aW9uX3RyZWUoc2VsZik6CiAgICAgICAgIiIi0J7QsdC90L7QstC70LXQvdC40LUg0LTQtdGA0LXQ
stCwINC/0L7QtNC60LvRjtGH0LXQvdC40LkiIiIKICAgICAgICBzZWxmLmNvbm5lY3Rpb25fdHJl
ZVs6XSA9IFtdCgogICAgICAgIGZvciBuYW1lLCBwcm9maWxlIGluIHNlbGYucHJvZmlsZXMuaXRl
bXMoKToKICAgICAgICAgICAgY29ubiA9IHNlbGYuY29ubmVjdGlvbnMuZ2V0KG5hbWUpCgogICAg
ICAgICAgICBpZiBjb25uIGFuZCBjb25uLmNvbm5lY3RlZDoKICAgICAgICAgICAgICAgIGljb24g
PSAn4pePICcKCiAgICAgICAgICAgICAgICBpZiBjb25uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAg
ICAgICAgICAgc2VydmVyX2xhYmVsID0gZiJ7aWNvbn17cHJvZmlsZS5uYW1lfSBbQ0xVU1RFUl0i
CiAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSAnY29ubmVjdGlvbicKICAgICAgICAgICAgICAg
IGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VydmVyX2xhYmVsID0gZiJ7aWNvbn17cHJvZmls
ZS5uYW1lfSAoe3Byb2ZpbGUuaG9zdH06e3Byb2ZpbGUucG9ydH0pIgogICAgICAgICAgICAgICAg
ICAgIHN0eWxlID0gJ2Nvbm5lY3Rpb24nCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAg
ICBpY29uID0gJ+KXiyAnCiAgICAgICAgICAgICAgICBzZXJ2ZXJfbGFiZWwgPSBmIntpY29ufXtw
cm9maWxlLm5hbWV9ICh7cHJvZmlsZS5ob3N0fTp7cHJvZmlsZS5wb3J0fSkiCiAgICAgICAgICAg
ICAgICBzdHlsZSA9ICdjb25uZWN0aW9uJwoKICAgICAgICAgICAgIyDQl9Cw0LPQvtC70L7QstC+
0Log0YHQtdGA0LLQtdGA0LAKICAgICAgICAgICAgc2VydmVyX2J0biA9IHVyd2lkLkJ1dHRvbihz
ZXJ2ZXJfbGFiZWwsIG9uX3ByZXNzPXNlbGYub25fc2VydmVyX3NlbGVjdCwgdXNlcl9kYXRhPW5h
bWUpCgogICAgICAgICAgICBpZiBjb25uIGFuZCBjb25uLmNvbm5lY3RlZDoKICAgICAgICAgICAg
ICAgIHNlbGYuY29ubmVjdGlvbl90cmVlLmFwcGVuZCh1cndpZC5BdHRyTWFwKHNlcnZlcl9idG4s
IHN0eWxlLCAnY29ubmVjdGlvbl9zZWxlY3RlZCcpKQogICAgICAgICAgICBlbHNlOgogICAgICAg
ICAgICAgICAgc2VsZi5jb25uZWN0aW9uX3RyZWUuYXBwZW5kKHVyd2lkLkF0dHJNYXAoc2VydmVy
X2J0biwgc3R5bGUsICdzaWRlYmFyX2ZvY3VzJykpCgogICAgICAgICAgICAjINCf0L7QutCw0LfR
i9Cy0LDQtdC8INCx0LDQt9GLINC00LDQvdC90YvRhSDQtNC70Y8g0L/QvtC00LrQu9GO0YfQtdC9
0L3QvtCz0L4g0YHQtdGA0LLQtdGA0LAKICAgICAgICAgICAgaWYgY29ubiBhbmQgY29ubi5jb25u
ZWN0ZWQ6CiAgICAgICAgICAgICAgICAjINCU0LvRjyDQutC70LDRgdGC0LXRgNCwINC/0L7QutCw
0LfRi9Cy0LDQtdC8INGC0L7Qu9GM0LrQviBEQjAKICAgICAgICAgICAgICAgIGlmIGNvbm4uaXNf
Y2x1c3RlcjoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAg
ICMga2V5X2NvdW50ID0gY29ubi5hY3RpdmVfY2xpZW50LmRic2l6ZSgpCiAgICAgICAgICAgICAg
ICAgICAgICAgIGlzX2N1cnJlbnQgPSAoc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gPT0gY29ubikK
ICAgICAgICAgICAgICAgICAgICAgICAgZGJfaWNvbiA9ICcgIOKWqiAnIGlmIGlzX2N1cnJlbnQg
ZWxzZSAnICDilqsgJwogICAgICAgICAgICAgICAgICAgICAgICAjIGtleV9jb3VudCA9IGRiX2tl
eV9jb3VudHNbMF0KICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiBrZXlfY291bnQgPiAwOgog
ICAgICAgICAgICAgICAgICAgICAgICBkYl9sYWJlbCA9IGYie2RiX2ljb259REIwICh7c2VsZi5r
ZXlfY291bnR9IGtleXMpIgogICAgICAgICAgICAgICAgICAgICAgICAjZWxzZToKICAgICAgICAg
ICAgICAgICAgICAgICAgIyBkYl9sYWJlbCA9IGYie2RiX2ljb259REIwIgoKICAgICAgICAgICAg
ICAgICAgICAgICAgZGJfYnRuID0gdXJ3aWQuQnV0dG9uKGRiX2xhYmVsLCBvbl9wcmVzcz1zZWxm
Lm9uX2RiX3NlbGVjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVzZXJfZGF0YT0obmFtZSwgMCkpCgogICAgICAgICAgICAgICAgICAgICAgICBpZiBpc19j
dXJyZW50OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IHVyd2lkLkF0dHJNYXAo
ZGJfYnRuLCAnY29ubmVjdGlvbl9zZWxlY3RlZCcsICdjb25uZWN0aW9uX3NlbGVjdGVkJykKICAg
ICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0
ZW0gPSB1cndpZC5BdHRyTWFwKGRiX2J0biwgJ2tleV9mb2xkZXInLCAna2V5X2ZvbGRlcl9mb2N1
cycpCgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbm5lY3Rpb25fdHJlZS5hcHBlbmQo
aXRlbSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNfY3VycmVudDoKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHNlbGYuYWRkX2tleXNfdG9fdHJlZSgpCiAgICAgICAgICAgICAgICAg
ICAgICAgICMg0JTQtdGA0LXQstC+INC60LvRjtGH0LXQuSDRgtC+0LvRjNC60L4g0LTQu9GPINGC
0LXQutGD0YnQtdC5INCR0JQKICAgICAgICAgICAgICAgICAgICAjICAgICBpZiBpc19jdXJyZW50
OgogICAgICAgICAgICAgICAgICAgICMgICAgICAgICB0cmVlX2l0ZW1zID0gc2VsZi5idWlsZF90
cmVlX2l0ZW1zKHNlbGYua2V5X3RyZWVfcm9vdCwgbGV2ZWw9MikKICAgICAgICAgICAgICAgICAg
ICAjICAgICAgICAgc2VsZi5jb25uZWN0aW9uX3RyZWUuZXh0ZW5kKHRyZWVfaXRlbXMpCiAgICAg
ICAgICAgICAgICAgICAgIwogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMg
ZToKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZGlzcGxheWlu
ZyBjbHVzdGVyIERCOiB7ZX0iKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAg
ICAgICAjIFN0YW5kYWxvbmUgKNGB0YLQsNGA0YvQuSDQutC+0LQpCiAgICAgICAgICAgICAgICAg
ICAgZGJfa2V5X2NvdW50cyA9IHNlbGYuZ2V0X2FsbF9kYl9rZXlfY291bnRzKGNvbm4pCgogICAg
ICAgICAgICAgICAgICAgIGZvciBkYl9udW0gaW4gcmFuZ2Uoc2VsZi5tYXhfZGIgKyAxKToKICAg
ICAgICAgICAgICAgICAgICAgICAgaXNfY3VycmVudCA9IChzZWxmLmN1cnJlbnRfY29ubmVjdGlv
biA9PSBjb25uIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm4u
Y3VycmVudF9kYiA9PSBkYl9udW0pCgogICAgICAgICAgICAgICAgICAgICAgICBkYl9pY29uID0g
JyAg4paqICcgaWYgaXNfY3VycmVudCBlbHNlICcgIOKWqyAnCgogICAgICAgICAgICAgICAgICAg
ICAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQu9GO0YfQtdC5
INC00LvRjyDRjdGC0L7QuSDQkdCUCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV9jb3VudCA9
IGRiX2tleV9jb3VudHMuZ2V0KGRiX251bSwgMCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlm
IGtleV9jb3VudCA+IDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYl9sYWJlbCA9IGYi
e2RiX2ljb259REJ7ZGJfbnVtfSAoe2tleV9jb3VudH0ga2V5cykiCiAgICAgICAgICAgICAgICAg
ICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYl9sYWJlbCA9IGYie2Ri
X2ljb259REJ7ZGJfbnVtfSIKCiAgICAgICAgICAgICAgICAgICAgICAgIGRiX2J0biA9IHVyd2lk
LkJ1dHRvbihkYl9sYWJlbCwgb25fcHJlc3M9c2VsZi5vbl9kYl9zZWxlY3QsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyX2RhdGE9KG5hbWUsIGRiX251
bSkpCgogICAgICAgICAgICAgICAgICAgICAgICBpZiBpc19jdXJyZW50OgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaXRlbSA9IHVyd2lkLkF0dHJNYXAoZGJfYnRuLCAnY29ubmVjdGlvbl9z
ZWxlY3RlZCcsICdjb25uZWN0aW9uX3NlbGVjdGVkJykKICAgICAgICAgICAgICAgICAgICAgICAg
ZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSB1cndpZC5BdHRyTWFwKGRi
X2J0biwgJ2tleV9mb2xkZXInLCAna2V5X2ZvbGRlcl9mb2N1cycpCgogICAgICAgICAgICAgICAg
ICAgICAgICBzZWxmLmNvbm5lY3Rpb25fdHJlZS5hcHBlbmQoaXRlbSkKCiAgICAgICAgICAgICAg
ICAgICAgICAgICMjICMg0JTQtdGA0LXQstC+INC60LvRjtGH0LXQuSDRgtC+0LvRjNC60L4g0LTQ
u9GPINGC0LXQutGD0YnQtdC5INCR0JQKICAgICAgICAgICAgICAgICAgICAgICAgIyDQodC/0LjR
gdC+0Log0LrQu9GO0YfQtdC5INC00LvRjyDRgtC10LrRg9GJ0LXQuSDQkdCUCiAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIGlzX2N1cnJlbnQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
ZWxmLmFkZF9rZXlzX3RvX3RyZWUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB0cmVl
X2l0ZW1zID0gc2VsZi5idWlsZF90cmVlX2l0ZW1zKHNlbGYua2V5X3RyZWVfcm9vdCwgbGV2ZWw9
MikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgc2VsZi5jb25uZWN0aW9uX3RyZWUuZXh0
ZW5kKHRyZWVfaXRlbXMpCgogICAgICAgIHNlbGYudXBkYXRlX3RhYnMoKQoKICAgIGRlZiBhZGRf
a2V5c190b190cmVlKHNlbGYpOgogICAgICAgICIiItCU0L7QsdCw0LLQu9C10L3QuNC1INC60LvR
jtGH0LXQuSDQsiDQtNC10YDQtdCy0L4g0LrQsNC6INC/0YDQvtGB0YLQvtC5INGB0L/QuNGB0L7Q
uiIiIgogICAgICAgIGZvciBrZXkgaW4gc2VsZi5rZXlzX2xpc3Q6CiAgICAgICAgICAgIHRyeToK
ICAgICAgICAgICAgICAgIGtleV9zdHIgPSBrZXkuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVw
bGFjZScpCiAgICAgICAgICAgICAgICBpY29uID0gc2VsZi5nZXRfa2V5X3R5cGVfaWNvbihrZXlf
c3RyKQogICAgICAgICAgICAgICAgbGFiZWwgPSBmIiAgICB7aWNvbn17a2V5X3N0cn0iCiAgICAg
ICAgICAgICAgICBidG4gPSB1cndpZC5CdXR0b24obGFiZWwsIG9uX3ByZXNzPXNlbGYub25fa2V5
X3NlbGVjdCwgdXNlcl9kYXRhPWtleSkKICAgICAgICAgICAgICAgIGl0ZW0gPSB1cndpZC5BdHRy
TWFwKGJ0biwgJ2tleV9pdGVtJywgJ2tleV9pdGVtX2ZvY3VzJykKICAgICAgICAgICAgICAgIHNl
bGYuY29ubmVjdGlvbl90cmVlLmFwcGVuZChpdGVtKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0
aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBhZGRpbmcga2V5
IHRvIHRyZWU6IHtlfSIpCgogICAgZGVmIGdldF9hbGxfZGJfa2V5X2NvdW50cyhzZWxmLCBjb25u
OiBSZWRpc0Nvbm5lY3Rpb24pIC0+IERpY3RbaW50LCBpbnRdOgogICAgICAgICIiItCf0L7Qu9GD
0YfQuNGC0Ywg0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQu9GO0YfQtdC5INCy0L4g0LLRgdC10YUg
0LHQsNC30LDRhSDQtNCw0L3QvdGL0YUiIiIKICAgICAgICBkYl9jb3VudHMgPSB7fQoKICAgICAg
ICBpZiBub3QgY29ubiBvciBub3QgY29ubi5jb25uZWN0ZWQ6CiAgICAgICAgICAgIHJldHVybiBk
Yl9jb3VudHMKCiAgICAgICAgIyDQlNC70Y8g0LrQu9Cw0YHRgtC10YDQsCDQstC+0LfQstGA0LDR
idCw0LXQvCDRgtC+0LvRjNC60L4gREIwCiAgICAgICAgaWYgY29ubi5pc19jbHVzdGVyOgogICAg
ICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjINCSINC60LvQsNGB0YLQtdGA0LUg0LzQvtC2
0L3QviDQv9C+0LvRg9GH0LjRgtGMINC+0LHRidC10LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQ
u9GO0YfQtdC5INGH0LXRgNC10LcgREJTSVpFCiAgICAgICAgICAgICAgICB0b3RhbF9rZXlzID0g
Y29ubi5hY3RpdmVfY2xpZW50LmRic2l6ZSgpCgogICAgICAgICAgICAgICAgaWYgdG90YWxfa2V5
cyA+IDA6CiAgICAgICAgICAgICAgICAgICAgZGJfY291bnRzWzBdID0gdG90YWxfa2V5cwogICAg
ICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJy
b3IoZiJGYWlsZWQgdG8gZ2V0IGNsdXN0ZXIga2V5IGNvdW50OiB7ZX0iKQogICAgICAgICAgICBy
ZXR1cm4gZGJfY291bnRzCgogICAgICAgICMg0KHQvtGF0YDQsNC90Y/QtdC8INGC0LXQutGD0YnR
g9GOINCR0JQKICAgICAgICBjdXJyZW50X2RiID0gY29ubi5jdXJyZW50X2RiCgogICAgICAgIHRy
eToKICAgICAgICAgICAgIyDQn9GA0L7RhdC+0LTQuNC8INC/0L4g0LLRgdC10Lwg0JHQlCDQuCDR
gdGH0LjRgtCw0LXQvCDQutC70Y7Rh9C4CiAgICAgICAgICAgIGZvciBkYl9udW0gaW4gcmFuZ2Uo
c2VsZi5tYXhfZGIgKyAxKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAg
ICBjb25uLmNsaWVudC5zZWxlY3QoZGJfbnVtKQogICAgICAgICAgICAgICAgICAgIGNvdW50ID0g
Y29ubi5jbGllbnQuZGJzaXplKCkKICAgICAgICAgICAgICAgICAgICBpZiBjb3VudCA+IDA6CiAg
ICAgICAgICAgICAgICAgICAgICAgIGRiX2NvdW50c1tkYl9udW1dID0gY291bnQKICAgICAgICAg
ICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBsb2dnZXIu
ZXJyb3IoZiJGYWlsZWQgdG8gZ2V0IGtleSBjb3VudCBmb3IgREJ7ZGJfbnVtfToge2V9IikKICAg
ICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgIyDQktC+0LfQstGA0LDRidCw
0LXQvNGB0Y8g0Log0YLQtdC60YPRidC10Lkg0JHQlAogICAgICAgICAgICBjb25uLmNsaWVudC5z
ZWxlY3QoY3VycmVudF9kYikKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
ICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gZ2V0IGFsbCBEQiBrZXkgY291bnRzOiB7ZX0i
KQogICAgICAgICAgICAjINCV0YHQu9C4INGH0YLQvi3RgtC+INC/0L7RiNC70L4g0L3QtSDRgtCw
0LosINCy0L7Qt9Cy0YDQsNGJ0LDQtdC80YHRjyDQuiDRgtC10LrRg9GJ0LXQuSDQkdCUCiAgICAg
ICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGNvbm4uY2xpZW50LnNlbGVjdChjdXJyZW50X2Ri
KQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHJldHVy
biBkYl9jb3VudHMKCiAgICBkZWYgb25fc2VydmVyX3NlbGVjdChzZWxmLCBidXR0b24sIHByb2Zp
bGVfbmFtZTogc3RyKToKICAgICAgICAiIiLQktGL0LHQvtGAINGB0LXRgNCy0LXRgNCwICjQv9C+
0LTQutC70Y7Rh9C10L3QuNC1L9C/0LXRgNC10L/QvtC00LrQu9GO0YfQtdC90LjQtSkiIiIKICAg
ICAgICBwcm9maWxlID0gc2VsZi5wcm9maWxlcy5nZXQocHJvZmlsZV9uYW1lKQogICAgICAgIGlm
IG5vdCBwcm9maWxlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyDQldGB0LvQuCDRg9C2
0LUg0L/QvtC00LrQu9GO0YfQtdC90Ysg0Log0Y3RgtC+0LzRgyDRgdC10YDQstC10YDRgwogICAg
ICAgIGlmIHByb2ZpbGVfbmFtZSBpbiBzZWxmLmNvbm5lY3Rpb25zIGFuZCBzZWxmLmNvbm5lY3Rp
b25zW3Byb2ZpbGVfbmFtZV0uY29ubmVjdGVkOgogICAgICAgICAgICBzZWxmLmN1cnJlbnRfY29u
bmVjdGlvbiA9IHNlbGYuY29ubmVjdGlvbnNbcHJvZmlsZV9uYW1lXQogICAgICAgICAgICBzZWxm
LnNldF9zdGF0dXMoZiJBbHJlYWR5IGNvbm5lY3RlZCB0byB7cHJvZmlsZS5uYW1lfSIsICdzdWNj
ZXNzJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmNvbm5lY3RfdG9fcHJvZmlsZShw
cm9maWxlKQoKICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCiAgICAgICAgc2VsZi51cGRhdGVf
Y29ubmVjdGlvbl90cmVlKCkKCiAgICBkZWYgY29ubmVjdF90b19wcm9maWxlKHNlbGYsIHByb2Zp
bGU6IENvbm5lY3Rpb25Qcm9maWxlKToKICAgICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1
INC6INC/0YDQvtGE0LjQu9GOINGBINC/0L7QtNC00LXRgNC20LrQvtC5INC60LvQsNGB0YLQtdGA
0LAiIiIKICAgICAgICBpZiBwcm9maWxlLmNsdXN0ZXJfbW9kZToKICAgICAgICAgICAgIyDQlNC7
0Y8g0LrQu9Cw0YHRgtC10YDQsCDQuNGB0L/QvtC70YzQt9GD0LXQvCDQv9C10YDQstGL0Lkg0YPQ
t9C10Lsg0LTQu9GPINC40LTQtdC90YLQuNGE0LjQutCw0YbQuNC4CiAgICAgICAgICAgIGlmIHBy
b2ZpbGUuY2x1c3Rlcl9ub2RlczoKICAgICAgICAgICAgICAgIGZpcnN0X25vZGUgPSBwcm9maWxl
LmNsdXN0ZXJfbm9kZXNbMF0KICAgICAgICAgICAgICAgIHNlcnZlcl9rZXkgPSBmImNsdXN0ZXI6
e2ZpcnN0X25vZGVbMF19OntmaXJzdF9ub2RlWzFdfSIKICAgICAgICAgICAgZWxzZToKICAgICAg
ICAgICAgICAgIHNlcnZlcl9rZXkgPSBmImNsdXN0ZXI6e3Byb2ZpbGUuaG9zdH06e3Byb2ZpbGUu
cG9ydH0iCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyDQlNC70Y8gc3RhbmRhbG9uZQogICAg
ICAgICAgICBpZiBwcm9maWxlLnNvY2tldF9wYXRoOgogICAgICAgICAgICAgICAgc2VydmVyX2tl
eSA9IGYidW5peDp7cHJvZmlsZS5zb2NrZXRfcGF0aH0iCiAgICAgICAgICAgIGVsc2U6CiAgICAg
ICAgICAgICAgICBzZXJ2ZXJfa2V5ID0gZiJ7cHJvZmlsZS5ob3N0fTp7cHJvZmlsZS5wb3J0fSIK
CiAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwg0YHRg9GJ0LXRgdGC0LLRg9GO0YnQuNC1INC/
0L7QtNC60LvRjtGH0LXQvdC40Y8KICAgICAgICBmb3IgZXhpc3RpbmdfbmFtZSwgY29ubiBpbiBz
ZWxmLmNvbm5lY3Rpb25zLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGNvbm4uY29ubmVjdGVkOgog
ICAgICAgICAgICAgICAgIyDQodGA0LDQstC90LjQstCw0LXQvCDQv9Cw0YDQsNC80LXRgtGA0Ysg
0L/QvtC00LrQu9GO0YfQtdC90LjRjwogICAgICAgICAgICAgICAgaWYgKGNvbm4uaXNfY2x1c3Rl
ciA9PSBwcm9maWxlLmNsdXN0ZXJfbW9kZSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgY29u
bi5wcm9maWxlLmhvc3QgPT0gcHJvZmlsZS5ob3N0IGFuZAogICAgICAgICAgICAgICAgICAgICAg
ICBjb25uLnByb2ZpbGUucG9ydCA9PSBwcm9maWxlLnBvcnQpOgoKICAgICAgICAgICAgICAgICAg
ICAjINCU0LvRjyDQutC70LDRgdGC0LXRgNCwINC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdC+INC/
0YDQvtCy0LXRgNGP0LXQvCDRg9C30LvRiwogICAgICAgICAgICAgICAgICAgIGlmIHByb2ZpbGUu
Y2x1c3Rlcl9tb2RlOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzYXR0cihjb25uLnBy
b2ZpbGUsICdjbHVzdGVyX25vZGVzJykgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29ubi5wcm9maWxlLmNsdXN0ZXJfbm9kZXMgPT0gcHJvZmlsZS5jbHVzdGVyX25vZGVzKToK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudF9jb25uZWN0aW9uID0gY29u
bgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiQWxyZWFkeSBj
b25uZWN0ZWQgdG8gY2x1c3RlciB7c2VydmVyX2tleX0iLCAnc3VjY2VzcycpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAg
ICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9IGNvbm4KICAgICAgICAgICAgICAgICAg
ICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiQWxyZWFkeSBjb25uZWN0ZWQgdG8ge3NlcnZlcl9rZXl9
IiwgJ3N1Y2Nlc3MnKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygp
CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjINCh0L7Qt9C00LDQtdC8
INC90L7QstC+0LUg0L/QvtC00LrQu9GO0YfQtdC90LjQtQogICAgICAgIGNvbm4gPSBSZWRpc0Nv
bm5lY3Rpb24ocHJvZmlsZSkKICAgICAgICBzdWNjZXNzLCBtZXNzYWdlID0gY29ubi5jb25uZWN0
KCkKCiAgICAgICAgaWYgc3VjY2VzczoKICAgICAgICAgICAgc2VsZi5jb25uZWN0aW9uc1twcm9m
aWxlLm5hbWVdID0gY29ubgogICAgICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9IGNv
bm4KCiAgICAgICAgICAgIGlmIHByb2ZpbGUuY2x1c3Rlcl9tb2RlOgogICAgICAgICAgICAgICAg
bm9kZV9jb3VudCA9IGxlbihwcm9maWxlLmNsdXN0ZXJfbm9kZXMpIGlmIGhhc2F0dHIocHJvZmls
ZSwgJ2NsdXN0ZXJfbm9kZXMnKSBlbHNlIDEKICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1
cyhmIkNvbm5lY3RlZCB0byBSZWRpcyBDbHVzdGVyICh7bm9kZV9jb3VudH0gbm9kZXMpIiwgJ3N1
Y2Nlc3MnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVz
KGYiQ29ubmVjdGVkIHRvIHtwcm9maWxlLmhvc3R9Ontwcm9maWxlLnBvcnR9IiwgJ3N1Y2Nlc3Mn
KQoKICAgICAgICAgICAgc2VsZi5yZWZyZXNoX2tleXMoKQogICAgICAgIGVsc2U6CiAgICAgICAg
ICAgIHNlbGYuc2V0X3N0YXR1cyhmIkNvbm5lY3Rpb24gZmFpbGVkOiB7bWVzc2FnZX0iLCAnZXJy
b3InKQoKICAgIGRlZiBvbl9kYl9zZWxlY3Qoc2VsZiwgYnV0dG9uLCBkYXRhOiBUdXBsZVtzdHIs
IGludF0pOgogICAgICAgICIiItCS0YvQsdC+0YAg0LHQsNC30Ysg0LTQsNC90L3Ri9GFIiIiCiAg
ICAgICAgcHJvZmlsZV9uYW1lLCBkYl9udW0gPSBkYXRhCgogICAgICAgIGNvbm4gPSBzZWxmLmNv
bm5lY3Rpb25zLmdldChwcm9maWxlX25hbWUpCiAgICAgICAgaWYgbm90IGNvbm4gb3Igbm90IGNv
bm4uY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyDQlNC70Y8g0LrQu9Cw
0YHRgtC10YDQsCDRgNCw0LfRgNC10YjQsNC10Lwg0YLQvtC70YzQutC+IERCMAogICAgICAgIGlm
IGNvbm4uaXNfY2x1c3RlcjoKICAgICAgICAgICAgaWYgZGJfbnVtICE9IDA6CiAgICAgICAgICAg
ICAgICBzZWxmLnNldF9zdGF0dXMoIlJlZGlzIENsdXN0ZXIgc3VwcG9ydHMgb25seSBEQjAiLCAn
d2FybmluZycpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgIyDQkiDQutC70LDR
gdGC0LXRgNC1INC90LXRgiDQutC+0LzQsNC90LTRiyBTRUxFQ1QsINC/0YDQvtGB0YLQviDQvtCx
0L3QvtCy0LvRj9C10Lwg0LjQvdGC0LXRgNGE0LXQudGBCiAgICAgICAgICAgIHNlbGYuY3VycmVu
dF9jb25uZWN0aW9uID0gY29ubgogICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoIlJlZGlzIENs
dXN0ZXIgKERCMCkiLCAnc3VjY2VzcycpCiAgICAgICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkK
ICAgICAgICAgICAgc2VsZi51cGRhdGVfY29ubmVjdGlvbl90cmVlKCkKICAgICAgICBlbHNlOgog
ICAgICAgICAgICAjIFN0YW5kYWxvbmUgUmVkaXMKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2Nv
bm5lY3Rpb24gPSBjb25uCiAgICAgICAgICAgIHN1Y2Nlc3MsIG1lc3NhZ2UgPSBjb25uLnNlbGVj
dF9kYihkYl9udW0pCgogICAgICAgICAgICBpZiBzdWNjZXNzOgogICAgICAgICAgICAgICAgc2Vs
Zi5zZXRfc3RhdHVzKGYiU3dpdGNoZWQgdG8gREJ7ZGJfbnVtfSIsICdzdWNjZXNzJykKICAgICAg
ICAgICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkKICAgICAgICAgICAgICAgIHNlbGYudXBkYXRl
X2Nvbm5lY3Rpb25fdHJlZSgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxm
LnNldF9zdGF0dXMoZiJGYWlsZWQgdG8gc3dpdGNoIERCOiB7bWVzc2FnZX0iLCAnZXJyb3InKQoK
ICAgICMgZGVmIGJ1aWxkX3RyZWVfaXRlbXMoc2VsZiwgbm9kZTogS2V5VHJlZU5vZGUsIGxldmVs
OiBpbnQgPSAwKSAtPiBMaXN0OgogICAgIyAgICAgIiIi0J/QvtGB0YLRgNC+0LXQvdC40LUg0Y3Q
u9C10LzQtdC90YLQvtCyINC00LXRgNC10LLQsCDRgSDQuNC60L7QvdC60LDQvNC4INGC0LjQv9C+
0LIg0LrQu9GO0YfQtdC5IiIiCiAgICAjICAgICBpdGVtcyA9IFtdCiAgICAjCiAgICAjICAgICBm
b3IgbmFtZSwgY2hpbGQgaW4gc29ydGVkKG5vZGUuY2hpbGRyZW4uaXRlbXMoKSk6CiAgICAjICAg
ICAgICAgaW5kZW50ID0gJyAgJyAqIGxldmVsCiAgICAjCiAgICAjICAgICAgICAgaWYgY2hpbGQu
aXNfa2V5OgogICAgIyAgICAgICAgICAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0LjQutC+0L3QutGD
INGC0LjQv9CwINC60LvRjtGH0LAKICAgICMgICAgICAgICAgICAgaWNvbiA9IHNlbGYuZ2V0X2tl
eV90eXBlX2ljb24oY2hpbGQuZnVsbF9wYXRoKQogICAgIyAgICAgICAgICAgICBsYWJlbCA9IGYi
e2luZGVudH3ilJTilIAge2ljb259e25hbWV9IgogICAgIyAgICAgICAgICAgICBidG4gPSB1cndp
ZC5CdXR0b24obGFiZWwsIG9uX3ByZXNzPXNlbGYub25fa2V5X3NlbGVjdCwgdXNlcl9kYXRhPWNo
aWxkLmZ1bGxfcGF0aCkKICAgICMgICAgICAgICAgICAgaXRlbSA9IHVyd2lkLkF0dHJNYXAoYnRu
LCAna2V5X2l0ZW0nLCAna2V5X2l0ZW1fZm9jdXMnKQogICAgIyAgICAgICAgIGVsc2U6CiAgICAj
ICAgICAgICAgICAgIGljb24gPSAnKyAnIGlmIGNoaWxkLmV4cGFuZGVkIGVsc2UgJy0gJyAgIyDQ
n9Cw0L/QutC4INC30LDQutGA0YvRgtGL0LUv0L7RgtC60YDRi9GC0YvQtQogICAgIyAgICAgICAg
ICAgICBjb3VudCA9IGYiICh7Y2hpbGQua2V5X2NvdW50fSkiCiAgICAjICAgICAgICAgICAgIGxh
YmVsID0gZiJ7aW5kZW50feKUlOKUgCB7aWNvbn17bmFtZX17Y291bnR9IgogICAgIyAgICAgICAg
ICAgICBidG4gPSB1cndpZC5CdXR0b24obGFiZWwsIG9uX3ByZXNzPXNlbGYub25fZm9sZGVyX3Rv
Z2dsZSwgdXNlcl9kYXRhPWNoaWxkKQogICAgIyAgICAgICAgICAgICBpdGVtID0gdXJ3aWQuQXR0
ck1hcChidG4sICdrZXlfZm9sZGVyJywgJ2tleV9mb2xkZXJfZm9jdXMnKQogICAgIwogICAgIyAg
ICAgICAgIGl0ZW1zLmFwcGVuZChpdGVtKQogICAgIwogICAgIyAgICAgICAgIGlmIG5vdCBjaGls
ZC5pc19rZXkgYW5kIGNoaWxkLmV4cGFuZGVkOgogICAgIyAgICAgICAgICAgICBpdGVtcy5leHRl
bmQoc2VsZi5idWlsZF90cmVlX2l0ZW1zKGNoaWxkLCBsZXZlbCArIDEpKQogICAgIwogICAgIyAg
ICAgcmV0dXJuIGl0ZW1zCgoKICAgICMgZGVmIG9uX2Nvbm5lY3Rpb25fc2VsZWN0KHNlbGYsIGJ1
dHRvbiwgY29ubmVjdGlvbl9uYW1lOiBzdHIpOgogICAgIyAgICAgIiIi0JLRi9Cx0L7RgCDQv9C+
0LTQutC70Y7Rh9C10L3QuNGPIiIiCiAgICAjICAgICBwcm9maWxlID0gc2VsZi5wcm9maWxlcy5n
ZXQoY29ubmVjdGlvbl9uYW1lKQogICAgIyAgICAgaWYgcHJvZmlsZToKICAgICMgICAgICAgICBp
ZiBjb25uZWN0aW9uX25hbWUgaW4gc2VsZi5jb25uZWN0aW9uczoKICAgICMgICAgICAgICAgICAg
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gPSBzZWxmLmNvbm5lY3Rpb25zW2Nvbm5lY3Rpb25fbmFt
ZV0KICAgICMgICAgICAgICBlbHNlOgogICAgIyAgICAgICAgICAgICBzZWxmLmNvbm5lY3RfdG9f
cHJvZmlsZShwcm9maWxlKQogICAgIwogICAgIyAgICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkK
ICAgICMgICAgICAgICBzZWxmLnVwZGF0ZV9jb25uZWN0aW9uX3RyZWUoKQogICAgIwogICAgIyBk
ZWYgb25fZm9sZGVyX3RvZ2dsZShzZWxmLCBidXR0b24sIG5vZGU6IEtleVRyZWVOb2RlKToKICAg
ICMgICAgICIiItCf0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQv9Cw0L/QutC4IiIiCiAgICAjICAg
ICBub2RlLmV4cGFuZGVkID0gbm90IG5vZGUuZXhwYW5kZWQKICAgICMgICAgIHNlbGYudXBkYXRl
X2Nvbm5lY3Rpb25fdHJlZSgpCgogICAgIyBkZWYgb25fa2V5X3NlbGVjdChzZWxmLCBidXR0b24s
IGtleV9wYXRoOiBzdHIpOgogICAgIyAgICAgIiIi0JLRi9Cx0L7RgCDQutC70Y7Rh9CwIiIiCiAg
ICAjICAgICBpZiBub3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gb3Igbm90IHNlbGYuY3VycmVu
dF9jb25uZWN0aW9uLmNvbm5lY3RlZDoKICAgICMgICAgICAgICByZXR1cm4KICAgICMgICAgIHNl
bGYuY3VycmVudF9rZXkgPSBrZXkgICAgICAgICMgc2VsZi5jdXJyZW50X2tleSA9IGtleV9wYXRo
LmVuY29kZSgndXRmLTgnKQogICAgIyAgICAgc2VsZi5kaXNwbGF5X2tleV9kZXRhaWxzKHNlbGYu
Y3VycmVudF9rZXkpCgogICAgZGVmIG9uX2tleV9zZWxlY3Qoc2VsZiwgYnV0dG9uLCBrZXk6IGJ5
dGVzKToKICAgICAgICAiIiLQktGL0LHQvtGAINC60LvRjtGH0LAiIiIKICAgICAgICBpZiBub3Qg
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gb3Igbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmNv
bm5lY3RlZDoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuY3VycmVudF9rZXkgPSBr
ZXkKICAgICAgICBzZWxmLmRpc3BsYXlfa2V5X2RldGFpbHMoc2VsZi5jdXJyZW50X2tleSkKCiAg
ICAjIGRlZiBjb25uZWN0X3RvX3Byb2ZpbGUoc2VsZiwgcHJvZmlsZTogQ29ubmVjdGlvblByb2Zp
bGUpOgogICAgIyAgICAgIiIi0J/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiDQv9GA0L7RhNC40LvR
jiIiIgogICAgIyAgICAgY29ubiA9IFJlZGlzQ29ubmVjdGlvbihwcm9maWxlKQogICAgIyAgICAg
c3VjY2VzcywgbWVzc2FnZSA9IGNvbm4uY29ubmVjdCgpCiAgICAjCiAgICAjICAgICBpZiBzdWNj
ZXNzOgogICAgIyAgICAgICAgIHNlbGYuY29ubmVjdGlvbnNbcHJvZmlsZS5uYW1lXSA9IGNvbm4K
ICAgICMgICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9IGNvbm4KICAgICMgICAgICAg
ICBzZWxmLnNldF9zdGF0dXMoZiJDb25uZWN0ZWQgdG8ge3Byb2ZpbGUubmFtZX0iLCAnc3VjY2Vz
cycpCiAgICAjICAgICAgICAgc2VsZi5yZWZyZXNoX2tleXMoKQogICAgIyAgICAgZWxzZToKICAg
ICMgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJDb25uZWN0aW9uIGZhaWxlZDoge21lc3NhZ2V9
IiwgJ2Vycm9yJykKCiAgICBkZWYgZGlzY29ubmVjdChzZWxmKToKICAgICAgICAiIiLQntGC0LrQ
u9GO0YfQtdC90LjQtSDQvtGCINGC0LXQutGD0YnQtdCz0L4g0YHQtdGA0LLQtdGA0LAiIiIKICAg
ICAgICBpZiBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbjoKICAgICAgICAgICAgbmFtZSA9IHNlbGYu
Y3VycmVudF9jb25uZWN0aW9uLnByb2ZpbGUubmFtZQogICAgICAgICAgICBzZWxmLmN1cnJlbnRf
Y29ubmVjdGlvbi5kaXNjb25uZWN0KCkKICAgICAgICAgICAgZGVsIHNlbGYuY29ubmVjdGlvbnNb
bmFtZV0KICAgICAgICAgICAgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gPSBOb25lCiAgICAgICAg
ICAgIHNlbGYuc2V0X3N0YXR1cyhmIkRpc2Nvbm5lY3RlZCBmcm9tIHtuYW1lfSIsICdzdWNjZXNz
JykKICAgICAgICAgICAgc2VsZi5rZXlzX2xpc3QgPSBbXSAgICMgc2VsZi5rZXlfdHJlZV9yb290
ID0gS2V5VHJlZU5vZGUoJ3Jvb3QnKQogICAgICAgICAgICBzZWxmLnVwZGF0ZV9jb25uZWN0aW9u
X3RyZWUoKQoKICAgIGRlZiBleGl0X21haW4oc2VsZik6CiAgICAgICAgcmFpc2UgdXJ3aWQuRXhp
dE1haW5Mb29wKCkKCiAgICBkZWYgZ2V0X2NsdXN0ZXJfbWFzdGVyX25vZGVzKHNlbGYsIGNsaWVu
dCk6CiAgICAgICAgIiIi0JHQtdC30L7Qv9Cw0YHQvdC+0LUg0L/QvtC70YPRh9C10L3QuNC1INC8
0LDRgdGC0LXRgC3QvdC+0LQg0LrQu9Cw0YHRgtC10YDQsCIiIgogICAgICAgIHRyeToKICAgICAg
ICAgICAgIyDQodC/0L7RgdC+0LEgMTog0YHQvtCy0LzQtdGB0YLQuNC80YvQuSDRgSByZWRpcy1w
eS1jbHVzdGVyID49IDIuMS4wCiAgICAgICAgICAgIGlmIGhhc2F0dHIoY2xpZW50LCAnZ2V0X3By
aW1hcmllcycpOgogICAgICAgICAgICAgICAgcmV0dXJuIGNsaWVudC5nZXRfcHJpbWFyaWVzKCkK
CiAgICAgICAgICAgICMg0KHQv9C+0YHQvtCxIDI6INC00LvRjyDQsdC+0LvQtdC1INGB0YLQsNGA
0YvRhSDQstC10YDRgdC40LkKICAgICAgICAgICAgZWxpZiBoYXNhdHRyKGNsaWVudCwgJ2dldF9u
b2RlcycpOgogICAgICAgICAgICAgICAgbm9kZXMgPSBjbGllbnQuZ2V0X25vZGVzKCkKICAgICAg
ICAgICAgICAgIG1hc3Rlcl9ub2RlcyA9IFtdCiAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBu
b2RlczoKICAgICAgICAgICAgICAgICAgICAjINCf0YDQvtCy0LXRgNGP0LXQvCDRgNCw0LfQvdGL
0LzQuCDRgdC/0L7RgdC+0LHQsNC80LgKICAgICAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKG5v
ZGUsICdzZXJ2ZXJfdHlwZScpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBub2RlLnNlcnZl
cl90eXBlID09ICdtYXN0ZXInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFzdGVyX25v
ZGVzLmFwcGVuZChub2RlKQogICAgICAgICAgICAgICAgICAgIGVsaWYgaGFzYXR0cihub2RlLCAn
cmVkaXNfY29ubmVjdGlvbicpOgogICAgICAgICAgICAgICAgICAgICAgICAjINCf0L7Qv9GA0L7Q
sdGD0LXQvCDQv9C+0LvRg9GH0LjRgtGMINC40L3RhNC+0YDQvNCw0YbQuNGOINGH0LXRgNC10Lcg
0LrQvtC80LDQvdC00YMKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaW5mbyA9IG5vZGUuZXhlY3V0ZV9jb21tYW5kKCdST0xFJykKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGlmIGluZm8gYW5kIGlzaW5zdGFuY2UoaW5mbywgbGlzdCkg
YW5kIGluZm9bMF0gPT0gJ21hc3Rlcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bWFzdGVyX25vZGVzLmFwcGVuZChub2RlKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgICAgIHJl
dHVybiBtYXN0ZXJfbm9kZXMKCiAgICAgICAgICAgICMg0KHQv9C+0YHQvtCxIDM6INGH0LXRgNC1
0LcgQ0xVU1RFUiBOT0RFUwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdHJ5Ogog
ICAgICAgICAgICAgICAgICAgIG5vZGVzX2luZm8gPSBjbGllbnQuZXhlY3V0ZV9jb21tYW5kKCdD
TFVTVEVSIE5PREVTJykKICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKG5vZGVzX2lu
Zm8sIGJ5dGVzKToKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNfaW5mbyA9IG5vZGVzX2lu
Zm8uZGVjb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgICAgIG1hc3Rlcl9ub2RlcyA9IFtd
CiAgICAgICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gbm9kZXNfaW5mby5zcGxpdCgnXG4nKToK
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGluZS5zdHJpcCgpIGFuZCAnbWFzdGVyJyBpbiBs
aW5lIGFuZCAnbXlzZWxmJyBub3QgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICMg0J/QsNGA0YHQuNC8INCw0LTRgNC10YEg0L3QvtC00YsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHBhcnRzID0gbGluZS5zcGxpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
ZiBsZW4ocGFydHMpID4gMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyID0g
cGFydHNbMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnOicgaW4gYWRkcjoK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCwgcG9ydCA9IGFkZHIuc3Bs
aXQoJzonKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjINCh0L7Qt9C00LDQ
tdC8INC/0L7QtNC60LvRjtGH0LXQvdC40LUg0Log0L3QvtC00LUKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbm9kZV9jbGllbnQgPSByZWRpcy5SZWRpcygKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q9aG9zdCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBvcnQ9aW50KHBvcnQpLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZGVjb2RlX3Jlc3BvbnNlcz1GYWxzZSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldF90aW1lb3V0PTIKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBtYXN0ZXJfbm9kZXMuYXBwZW5kKG5vZGVfY2xpZW50KQoKICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gbWFzdGVyX25vZGVzCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIFtdCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAg
ICAgICAgbG9nZ2VyLmVycm9yKGYiRmFpbGVkIHRvIGdldCBtYXN0ZXIgbm9kZXM6IHtlfSIpCiAg
ICAgICAgICAgIHJldHVybiBbXQoKICAgIGRlZiByZWZyZXNoX2tleXMoc2VsZik6CiAgICAgICAg
IiIi0J7QsdC90L7QstC70LXQvdC40LUg0YHQv9C40YHQutCwINC60LvRjtGH0LXQuSDRgSDQv9C+
0LTQtNC10YDQttC60L7QuSDQutC70LDRgdGC0LXRgNCwIiIiCiAgICAgICAgaWYgbm90IHNlbGYu
Y3VycmVudF9jb25uZWN0aW9uIG9yIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5jb25uZWN0
ZWQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNsaWVudCA9
IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmFjdGl2ZV9jbGllbnQKICAgICAgICAgICAga2V5cyA9
IFtdCgogICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoIlNjYW5uaW5nIGtleXMuLi4iKQoKICAg
ICAgICAgICAgaWYgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uaXNfY2x1c3RlcjoKICAgICAgICAg
ICAgICAgICMg0JTQu9GPIFJlZGlzIENsdXN0ZXIg0YHQutCw0L3QuNGA0YPQtdC8INC60LvRjtGH
0Lgg0YfQtdGA0LXQtyDQstGB0LUg0LzQsNGB0YLQtdGALdC90L7QtNGLCiAgICAgICAgICAgICAg
ICBrZXlzX3dpdGhfdHlwZXMgPSBzZWxmLl9zY2FuX2NsdXN0ZXJfa2V5c193aXRoX3R5cGVzX2l0
ZXIoY2xpZW50KQogICAgICAgICAgICAgICAga2V5cyA9IFtrZXkgZm9yIGtleSwgXyBpbiBrZXlz
X3dpdGhfdHlwZXNdCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBTdGFuZGFs
b25lINGA0LXQttC40LwgLSDQuNGB0L/QvtC70YzQt9GD0LXQvCBTQ0FOCiAgICAgICAgICAgICAg
ICBjdXJzb3IgPSAwCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAg
ICAgIGN1cnNvciwgYmF0Y2ggPSBjbGllbnQuc2NhbihjdXJzb3IsIG1hdGNoPScqJywgY291bnQ9
MTAwKQogICAgICAgICAgICAgICAgICAgIGtleXMuZXh0ZW5kKGJhdGNoKQogICAgICAgICAgICAg
ICAgICAgIGlmIGN1cnNvciA9PSAwOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAg
ICAgICAgICAgICAgICAgIGlmIGxlbihrZXlzKSA+PSA1MDAwOgogICAgICAgICAgICAgICAgICAg
ICAgICBicmVhawoKICAgICAgICAgICAgIyAjINCh0YLRgNC+0LjQvCDQtNC10YDQtdCy0L4g0LrQ
u9GO0YfQtdC5CiAgICAgICAgICAgICMgc2VsZi5rZXlfdHJlZV9yb290ID0gS2V5VHJlZU5vZGUo
J3Jvb3QnKQogICAgICAgICAgICAjIGZvciBrZXkgaW4ga2V5czoKICAgICAgICAgICAgIyAgICAg
dHJ5OgogICAgICAgICAgICAjICAgICAgICAga2V5X3N0ciA9IGtleS5kZWNvZGUoJ3V0Zi04Jywg
ZXJyb3JzPSdyZXBsYWNlJykKICAgICAgICAgICAgIyAgICAgICAgIHBhcnRzID0ga2V5X3N0ci5z
cGxpdChzZWxmLnNlcGFyYXRvcikKICAgICAgICAgICAgIwogICAgICAgICAgICAjICAgICAgICAg
IyDQlNC+0LHQsNCy0LvRj9C10Lwg0LrQu9GO0Ycg0LIg0LTQtdGA0LXQstC+CiAgICAgICAgICAg
ICMgICAgICAgICBzZWxmLmtleV90cmVlX3Jvb3QuYWRkX2tleShwYXJ0cywga2V5X3N0ciwgc2Vs
Zi5zZXBhcmF0b3IpCiAgICAgICAgICAgICMKICAgICAgICAgICAgIyAgICAgZXhjZXB0IEV4Y2Vw
dGlvbiBhcyBlOgogICAgICAgICAgICAjICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgcHJv
Y2Vzc2luZyBrZXk6IHtlfSIpCiAgICAgICAgICAgICMg0KPQsdC40YDQsNC10Lwg0LTRg9Cx0LvQ
uNC60LDRgtGLINC4INGB0L7RgNGC0LjRgNGD0LXQvAogICAgICAgICAgICBzZWVuID0gc2V0KCkK
ICAgICAgICAgICAgdW5pcXVlX2tleXMgPSBbXQogICAgICAgICAgICBmb3Iga2V5IGluIGtleXM6
CiAgICAgICAgICAgICAgICBpZiBrZXkgbm90IGluIHNlZW46CiAgICAgICAgICAgICAgICAgICAg
c2Vlbi5hZGQoa2V5KQogICAgICAgICAgICAgICAgICAgIHVuaXF1ZV9rZXlzLmFwcGVuZChrZXkp
CgogICAgICAgICAgICAjINCh0L7RgNGC0LjRgNGD0LXQvCDQutC70Y7Rh9C4CiAgICAgICAgICAg
IHVuaXF1ZV9rZXlzLnNvcnQoKQogICAgICAgICAgICBzZWxmLmtleXNfbGlzdCA9IHVuaXF1ZV9r
ZXlzCgogICAgICAgICAgICBzZWxmLnVwZGF0ZV9jb25uZWN0aW9uX3RyZWUoKQoKICAgICAgICAg
ICAgaWYgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uaXNfY2x1c3RlcjoKICAgICAgICAgICAgICAg
ICMgc2VsZi5zZXRfc3RhdHVzKGYiTG9hZGVkIHtsZW4oa2V5cyl9IGtleXMgZnJvbSBjbHVzdGVy
IiwgJ3N1Y2Nlc3MnKQogICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiTG9hZGVkIHts
ZW4odW5pcXVlX2tleXMpfSBrZXlzIGZyb20gY2x1c3RlciIsICdzdWNjZXNzJykKICAgICAgICAg
ICAgZWxzZToKICAgICAgICAgICAgICAgICNzZWxmLnNldF9zdGF0dXMoZiJMb2FkZWQge2xlbihr
ZXlzKX0ga2V5cyIsICdzdWNjZXNzJykKICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhm
IkxvYWRlZCB7bGVuKHVuaXF1ZV9rZXlzKX0ga2V5cyIsICdzdWNjZXNzJykKCiAgICAgICAgICAg
IGlmIHNlbGYuY3VycmVudF9rZXk6CiAgICAgICAgICAgICAgICBzZWxmLmRpc3BsYXlfa2V5X2Rl
dGFpbHMoc2VsZi5jdXJyZW50X2tleSkKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgog
ICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJFcnJvciBsb2FkaW5nIGtleXM6IHtlfSIsICdl
cnJvcicpCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGxvYWRpbmcga2V5czoge2V9
IikKCiAgICBkZWYgX3NjYW5fY2x1c3Rlcl9rZXlzX3dpdGhfdHlwZXNfaXRlcihzZWxmLCBjbGll
bnQpIC0+IExpc3RbVHVwbGVbYnl0ZXMsIHN0cl1dOgogICAgICAgICIiItCh0LrQsNC90LjRgNC+
0LLQsNC90LjQtSDQutC70Y7Rh9C10Lkg0LIgUmVkaXMgQ2x1c3RlciDRgSDQv9C+0LvRg9GH0LXQ
vdC40LXQvCDQuNGFINGC0LjQv9C+0LIiIiIKICAgICAgICBrZXlzX3dpdGhfdHlwZXMgPSBbXQog
ICAgICAgIHNlbGYua2V5X2NvdW50ID0gMAogICAgICAgIHRyeToKICAgICAgICAgICAgIyDQn9GA
0L7QstC10YDRj9C10LwsINC10YHRgtGMINC70Lgg0YMg0LrQu9C40LXQvdGC0LAg0LzQtdGC0L7Q
tCBzY2FuX2l0ZXIKICAgICAgICAgICAgaWYgaGFzYXR0cihjbGllbnQsICdzY2FuX2l0ZXInKToK
ICAgICAgICAgICAgICAgICMg0JjRgdC/0L7Qu9GM0LfRg9C10Lwgc2Nhbl9pdGVyINC00LvRjyDQ
vdC10LHQu9C+0LrQuNGA0YPRjtGJ0LXQs9C+INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjwogICAg
ICAgICAgICAgICAgbWF4X2tleXMgPSA1MDAwICAjINCe0LPRgNCw0L3QuNGH0LXQvdC40LUg0LTQ
u9GPINC/0YDQvtC40LfQstC+0LTQuNGC0LXQu9GM0L3QvtGB0YLQuAogICAgICAgICAgICAgICAg
c2Nhbl9jb3VudCA9IDAKCiAgICAgICAgICAgICAgICBmb3Iga2V5IGluIGNsaWVudC5zY2FuX2l0
ZXIobWF0Y2g9JyonLCBjb3VudD0xMDApOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAg
ICAgICAgICAgICAgICAgICAgIyDQn9C+0LvRg9GH0LDQtdC8INGC0LjQvyDQutC70Y7Rh9CwCiAg
ICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlID0gcmVkaXNfY2xpZW50LnR5cGUoa2V5KQog
ICAgICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGtleV90eXBlLCBieXRlcyk6CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlfdHlwZSA9IGtleV90eXBlLmRlY29kZSgndXRm
LTgnKQogICAgICAgICAgICAgICAgICAgICAgICBrZXlzX3dpdGhfdHlwZXMuYXBwZW5kKChrZXks
IGtleV90eXBlKSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAg
ICAgICAgIGtleXNfd2l0aF90eXBlcy5hcHBlbmQoKGtleSwgJ3Vua25vd24nKSkKCiAgICAgICAg
ICAgICAgICAgICAgI2tleXMuYXBwZW5kKGtleSkKICAgICAgICAgICAgICAgICAgICBzY2FuX2Nv
dW50ICs9IDEKICAgICAgICAgICAgICAgICAgICBzZWxmLmtleV9jb3VudCArPSAxCgogICAgICAg
ICAgICAgICAgICAgICMg0J7QsdC90L7QstC70Y/QtdC8INGB0YLQsNGC0YPRgSDQutCw0LbQtNGL
0LUgMTAwINC60LvRjtGH0LXQuQogICAgICAgICAgICAgICAgICAgIGlmIHNjYW5fY291bnQgJSAx
MDAgPT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiU2Nhbm5p
bmcuLi4gRm91bmQge3NjYW5fY291bnR9IGtleXMiKQoKICAgICAgICAgICAgICAgICAgICAjINCe
0LPRgNCw0L3QuNGH0LjQstCw0LXQvCDQvtCx0YnQtdC1INC60L7Qu9C40YfQtdGB0YLQstC+CiAg
ICAgICAgICAgICAgICAgICAgaWYgc2Nhbl9jb3VudCA+PSBtYXhfa2V5czoKICAgICAgICAgICAg
ICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiU3RvcHBlZCBhdCB7bWF4X2tleXN9IGtleXMg
KGxpbWl0IHJlYWNoZWQpIikKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAg
ZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBw
cm9jZXNzaW5nIGtleXM6IHtlfSIpCgogICAgICAgICMg0KPQsdC40YDQsNC10Lwg0LTRg9Cx0LvQ
uNC60LDRgtGLCiAgICAgICAgc2VlbiA9IHNldCgpCiAgICAgICAgdW5pcXVlX2tleXMgPSBbXQog
ICAgICAgIGZvciBrZXksIGtleV90eXBlIGluIGtleXNfd2l0aF90eXBlczoKICAgICAgICAgICAg
aWYga2V5IG5vdCBpbiBzZWVuOgogICAgICAgICAgICAgICAgc2Vlbi5hZGQoa2V5KQogICAgICAg
ICAgICAgICAgdW5pcXVlX2tleXMuYXBwZW5kKChrZXksIGtleV90eXBlKSkKCiAgICAgICAgbG9n
Z2VyLmluZm8oZiJTY2FubmVkIHtsZW4odW5pcXVlX2tleXMpfSB1bmlxdWUga2V5cyB3aXRoIHR5
cGVzIikKICAgICAgICByZXR1cm4gdW5pcXVlX2tleXMKCiAgICBkZWYgZGlzcGxheV9rZXlfZGV0
YWlscyhzZWxmLCBrZXk6IGJ5dGVzKToKICAgICAgICAiIiLQntGC0L7QsdGA0LDQttC10L3QuNC1
INC00LXRgtCw0LvQtdC5INC60LvRjtGH0LAg0YEg0L/QvtC00LTQtdGA0LbQutC+0Lkg0LrQu9Cw
0YHRgtC10YDQsCIiIgogICAgICAgIGlmIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBu
b3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4K
CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlv
bi5hY3RpdmVfY2xpZW50CiAgICAgICAgICAgIGtleV9zdHIgPSBrZXkuZGVjb2RlKCd1dGYtOCcs
IGVycm9ycz0ncmVwbGFjZScpCgogICAgICAgICAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0L7RgdC9
0L7QstC90YPRjiDQuNC90YTQvtGA0LzQsNGG0LjRjiDQviDQutC70Y7Rh9C1CiAgICAgICAgICAg
IHRyeToKICAgICAgICAgICAgICAgIGtleV90eXBlID0gY2xpZW50LnR5cGUoa2V5KQogICAgICAg
ICAgICAgICAgaWYgaXNpbnN0YW5jZShrZXlfdHlwZSwgYnl0ZXMpOgogICAgICAgICAgICAgICAg
ICAgIGtleV90eXBlID0ga2V5X3R5cGUuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgICAgICB0
dGwgPSBjbGllbnQudHRsKGtleSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgog
ICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiRXJyb3IgZ2V0dGluZyBrZXkgaW5mbzog
e2V9IiwgJ2Vycm9yJykKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgIyDQndCw
0YfQuNC90LDQtdC8INGE0L7RgNC80LjRgNC+0LLQsNGC0Ywg0LLRi9Cy0L7QtAogICAgICAgICAg
ICBzZWxmLmRldGFpbF93YWxrZXJbOl0gPSBbXQoKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fs
a2VyLmFwcGVuZCh1cndpZC5UZXh0KFsKICAgICAgICAgICAgICAgICgnaW5mb19sYWJlbCcsICdL
ZXk6ICcpLAogICAgICAgICAgICAgICAgKCdpbmZvX3ZhbHVlJywga2V5X3N0cikKICAgICAgICAg
ICAgXSkpCiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuRGl2aWRl
cigpKQoKICAgICAgICAgICAgIyDQntGB0L3QvtCy0L3QsNGPINC40L3RhNC+0YDQvNCw0YbQuNGP
ICjQtNC70Y8g0LrQu9Cw0YHRgtC10YDQsCDQuCBzdGFuZGFsb25lKQogICAgICAgICAgICBpbmZv
X2l0ZW1zID0gWwogICAgICAgICAgICAgICAgKCdUeXBlJywga2V5X3R5cGUpLAogICAgICAgICAg
ICAgICAgKCdUVEwnLCBmInt0dGx9cyIgaWYgdHRsID4gMCBlbHNlICdObyBleHBpcmF0aW9uJyBp
ZiB0dGwgPT0gLTEgZWxzZSAnTi9BJyksCiAgICAgICAgICAgIF0KCiAgICAgICAgICAgICMg0JTQ
vtC/0L7Qu9C90LjRgtC10LvRjNC90LDRjyDQuNC90YTQvtGA0LzQsNGG0LjRjyDQtNC70Y8g0LrQ
u9Cw0YHRgtC10YDQsAogICAgICAgICAgICBpZiBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5pc19j
bHVzdGVyOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNsb3QgPSBj
bGllbnQua2V5c2xvdChrZXlfc3RyKQogICAgICAgICAgICAgICAgICAgIG5vZGUgPSBjbGllbnQu
Z2V0X25vZGVfZnJvbV9rZXkoa2V5X3N0cikKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1z
LmV4dGVuZChbCiAgICAgICAgICAgICAgICAgICAgICAgICgnSGFzaCBTbG90Jywgc3RyKHNsb3Qp
KSwKICAgICAgICAgICAgICAgICAgICAgICAgKCdOb2RlJywgZiJ7bm9kZS5ob3N0fTp7bm9kZS5w
b3J0fSIpLAogICAgICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgICBleGNlcHQgRXhj
ZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJDb3VsZCBu
b3QgZ2V0IGNsdXN0ZXIgaW5mbyBmb3Iga2V5OiB7ZX0iKQoKICAgICAgICAgICAgIyDQlNC+0LHQ
sNCy0LvRj9C10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L4g0YDQsNC30LzQtdGA0LUg0LIg0LfQ
sNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCINGC0LjQv9CwCiAgICAgICAgICAgIHRyeToKICAgICAg
ICAgICAgICAgIGlmIGtleV90eXBlID09ICdzdHJpbmcnOgogICAgICAgICAgICAgICAgICAgIHNp
emUgPSBjbGllbnQuc3RybGVuKGtleSkKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmFw
cGVuZCgoJ1NpemUnLCBmIntzaXplfSBieXRlcyIpKQogICAgICAgICAgICAgICAgZWxpZiBrZXlf
dHlwZSA9PSAnbGlzdCc6CiAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IGNsaWVudC5sbGVuKGtl
eSkKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmFwcGVuZCgoJ0xlbmd0aCcsIHN0cihz
aXplKSkpCiAgICAgICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdzZXQnOgogICAgICAgICAg
ICAgICAgICAgIHNpemUgPSBjbGllbnQuc2NhcmQoa2V5KQogICAgICAgICAgICAgICAgICAgIGlu
Zm9faXRlbXMuYXBwZW5kKCgnTWVtYmVycycsIHN0cihzaXplKSkpCiAgICAgICAgICAgICAgICBl
bGlmIGtleV90eXBlID09ICd6c2V0JzoKICAgICAgICAgICAgICAgICAgICBzaXplID0gY2xpZW50
LnpjYXJkKGtleSkKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmFwcGVuZCgoJ01lbWJl
cnMnLCBzdHIoc2l6ZSkpKQogICAgICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnaGFzaCc6
CiAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IGNsaWVudC5obGVuKGtleSkKICAgICAgICAgICAg
ICAgICAgICBpbmZvX2l0ZW1zLmFwcGVuZCgoJ0ZpZWxkcycsIHN0cihzaXplKSkpCiAgICAgICAg
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5n
KGYiQ291bGQgbm90IGdldCBzaXplIGluZm8gZm9yIGtleToge2V9IikKCiAgICAgICAgICAgICMg
0J7RgtC+0LHRgNCw0LbQsNC10Lwg0LLRgdGOINC40L3RhNC+0YDQvNCw0YbQuNGOCiAgICAgICAg
ICAgIGZvciBsYWJlbCwgdmFsdWUgaW4gaW5mb19pdGVtczoKICAgICAgICAgICAgICAgIHJvdyA9
IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQu
QXR0ck1hcCh1cndpZC5UZXh0KGxhYmVsKSwgJ2luZm9fbGFiZWwnKSksCiAgICAgICAgICAgICAg
ICAgICAgKCd3ZWlnaHQnLCAyLCB1cndpZC5BdHRyTWFwKHVyd2lkLlRleHQoc3RyKHZhbHVlKSks
ICdpbmZvX3ZhbHVlJykpLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgIHNlbGYu
ZGV0YWlsX3dhbGtlci5hcHBlbmQocm93KQoKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2Vy
LmFwcGVuZCh1cndpZC5EaXZpZGVyKCkpCiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5h
cHBlbmQodXJ3aWQuVGV4dCgoJ2luZm9fbGFiZWwnLCAnVmFsdWU6JykpKQogICAgICAgICAgICBz
ZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKCiAgICAgICAgICAgICMg
0J7RgtC+0LHRgNCw0LbQtdC90LjQtSDQt9C90LDRh9C10L3QuNGPINCyINC30LDQstC40YHQuNC8
0L7RgdGC0Lgg0L7RgiDRgtC40L/QsCDQutC70Y7Rh9CwCiAgICAgICAgICAgICMg0K3RgtC+0YIg
0LrQvtC0INC+0LHRidC40Lkg0LTQu9GPIGNsdXN0ZXIg0Lggc3RhbmRhbG9uZQogICAgICAgICAg
ICB0cnk6CiAgICAgICAgICAgICAgICBpZiBrZXlfdHlwZSA9PSAnc3RyaW5nJzoKICAgICAgICAg
ICAgICAgICAgICB2YWx1ZSA9IGNsaWVudC5nZXQoa2V5KQogICAgICAgICAgICAgICAgICAgIGlm
IHZhbHVlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtl
ci5hcHBlbmQodXJ3aWQuVGV4dCgoJ2Vycm9yJywgJ0tleSBub3QgZm91bmQnKSkpCiAgICAgICAg
ICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdmFsdWVfc3RyID0gdmFsdWUuZGVjb2RlKCd1dGYtOCcsIGVycm9y
cz0ncmVwbGFjZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxr
ZXIuYXBwZW5kKHVyd2lkLlRleHQodmFsdWVfc3RyKSkKICAgICAgICAgICAgICAgICAgICAgICAg
ZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFw
cGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cndpZC5UZXh0KGYnPGJpbmFy
eSBkYXRhOiB7bGVuKHZhbHVlKX0gYnl0ZXM+JykKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICkKCiAgICAgICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdoYXNoJzoKICAgICAgICAgICAg
ICAgICAgICBoYXNoX2RhdGEgPSBjbGllbnQuaGdldGFsbChrZXkpCiAgICAgICAgICAgICAgICAg
ICAgaWYgbm90IGhhc2hfZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxf
d2Fsa2VyLmFwcGVuZCh1cndpZC5UZXh0KCcoZW1wdHkgaGFzaCknKSkKICAgICAgICAgICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmllbGQsIHZhbCBpbiBoYXNo
X2RhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF9zdHIgPSBmaWVsZC5kZWNvZGUoJ3V0Zi04Jywg
ZXJyb3JzPSdyZXBsYWNlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxfc3Ry
ID0gdmFsLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHJvdyA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLlRleHQoKCdrZXlfZm9sZGVyJywg
ZmllbGRfc3RyKSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ3dlaWdo
dCcsIDIsIHVyd2lkLlRleHQodmFsX3N0cikpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2Vy
LmFwcGVuZChyb3cpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIyDQlNC70Y8g0LHQuNC90LDRgNC90YvRhSDQtNCw0L3Q
vdGL0YUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cgPSB1cndpZC5Db2x1bW5z
KFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAxLCB1cndp
ZC5UZXh0KCgna2V5X2ZvbGRlcicsICc8YmluYXJ5IGZpZWxkPicpKSksCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMiwgdXJ3aWQuVGV4dChmJzxiaW5hcnk6
IHtsZW4odmFsKX0gYnl0ZXM+JykpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0p
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVu
ZChyb3cpCgogICAgICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnbGlzdCc6CiAgICAgICAg
ICAgICAgICAgICAgIyDQn9C+0LvRg9GH0LDQtdC8INGC0L7Qu9GM0LrQviDQv9C10YDQstGL0LUg
MTAwINGN0LvQtdC80LXQvdGC0L7QsgogICAgICAgICAgICAgICAgICAgIGxpc3RfZGF0YSA9IGNs
aWVudC5scmFuZ2Uoa2V5LCAwLCA5OSkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbGlzdF9k
YXRhOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVy
d2lkLlRleHQoJyhlbXB0eSBsaXN0KScpKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAg
ICAgICAgICAgICAgICAgICAgIGZvciBpZHgsIGl0ZW0gaW4gZW51bWVyYXRlKGxpc3RfZGF0YSk6
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaXRlbV9zdHIgPSBpdGVtLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2Un
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBl
bmQodXJ3aWQuVGV4dChmIlt7aWR4fV0ge2l0ZW1fc3RyfSIpKQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0
YWlsX3dhbGtlci5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVy
d2lkLlRleHQoZiJbe2lkeH1dIDxiaW5hcnk6IHtsZW4oaXRlbSl9IGJ5dGVzPiIpCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGVsaWYga2V5X3R5cGUg
PT0gJ3NldCc6CiAgICAgICAgICAgICAgICAgICAgIyDQn9C+0LvRg9GH0LDQtdC8INGC0L7Qu9GM
0LrQviDQv9C10YDQstGL0LUgMTAwINGN0LvQtdC80LXQvdGC0L7QsgogICAgICAgICAgICAgICAg
ICAgIHNldF9kYXRhID0gbGlzdChjbGllbnQuc21lbWJlcnMoa2V5KSlbOjEwMF0KICAgICAgICAg
ICAgICAgICAgICBpZiBub3Qgc2V0X2RhdGE6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYu
ZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dCgnKGVtcHR5IHNldCknKSkKICAgICAgICAg
ICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaXRlbSBpbiBzZXRf
ZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpdGVtX3N0ciA9IGl0ZW0uZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVw
bGFjZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2Vy
LmFwcGVuZCh1cndpZC5UZXh0KGYi4oCiIHtpdGVtX3N0cn0iKSkKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRl
dGFpbF93YWxrZXIuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
cndpZC5UZXh0KGYi4oCiIDxiaW5hcnk6IHtsZW4oaXRlbSl9IGJ5dGVzPiIpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGVsaWYga2V5X3R5cGUgPT0g
J3pzZXQnOgogICAgICAgICAgICAgICAgICAgICMg0J/QvtC70YPRh9Cw0LXQvCDRgtC+0LvRjNC6
0L4g0L/QtdGA0LLRi9C1IDEwMCDRjdC70LXQvNC10L3RgtC+0LIKICAgICAgICAgICAgICAgICAg
ICB6c2V0X2RhdGEgPSBjbGllbnQuenJhbmdlKGtleSwgMCwgOTksIHdpdGhzY29yZXM9VHJ1ZSkK
ICAgICAgICAgICAgICAgICAgICBpZiBub3QgenNldF9kYXRhOgogICAgICAgICAgICAgICAgICAg
ICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoJyhlbXB0eSB6c2V0KScp
KQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBt
ZW1iZXIsIHNjb3JlIGluIHpzZXRfZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRy
eToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJfc3RyID0gbWVtYmVyLmRl
Y29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJvdyA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAoJ3dlaWdodCcsIDIsIHVyd2lkLlRleHQobWVtYmVyX3N0cikpLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLlRleHQoKCdpbmZv
X3ZhbHVlJywgc3RyKHNjb3JlKSkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBd
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBl
bmQocm93KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJvdyA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDIsIHVyd2lkLlRleHQoZic8YmluYXJ5OiB7
bGVuKG1lbWJlcil9IGJ5dGVzPicpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKCd3ZWlnaHQnLCAxLCB1cndpZC5UZXh0KCgnaW5mb192YWx1ZScsIHN0cihzY29yZSkpKSks
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHJvdykKCiAgICAgICAgICAgICAg
ICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3
aWQuVGV4dChmJ1Vua25vd24ga2V5IHR5cGU6IHtrZXlfdHlwZX0nKSkKCiAgICAgICAgICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5h
cHBlbmQoCiAgICAgICAgICAgICAgICAgICAgdXJ3aWQuVGV4dCgoJ2Vycm9yJywgZidFcnJvciBy
ZXRyaWV2aW5nIHZhbHVlOiB7c3RyKGUpfScpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAg
ICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgcmV0cmlldmluZyB2YWx1ZSBmb3Iga2V5IHtrZXlf
c3RyfToge2V9IikKCiAgICAgICAgICAgICMg0JrQvdC+0L/QutC4INC00LXQudGB0YLQstC40Lkg
KNGD0LTQsNC70LXQvdC40LUg0Lgg0YIu0LQuKQogICAgICAgICAgICBpZiBub3Qgc2VsZi5jdXJy
ZW50X2Nvbm5lY3Rpb24ucHJvZmlsZS5yZWFkb25seToKICAgICAgICAgICAgICAgIHNlbGYuZGV0
YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQogICAgICAgICAgICAgICAgZGVsZXRl
X2J0biA9IHVyd2lkLkJ1dHRvbignRGVsZXRlIEtleScsIG9uX3ByZXNzPWxhbWJkYSBiOiBzZWxm
LmRlbGV0ZV9rZXkoa2V5KSkKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBl
bmQoCiAgICAgICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChkZWxldGVfYnRuLCAnYnV0dG9u
X2RhbmdlcicsICdidXR0b25fZm9jdXMnKQogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAg
IyDQldGB0LvQuCDRjdGC0L4g0LrQu9Cw0YHRgtC10YAsINC00L7QsdCw0LLQu9GP0LXQvCDQuNC9
0YTQvtGA0LzQsNGG0LjRjiDQviDQvNC40LPRgNCw0YbQuNC4CiAgICAgICAgICAgIGlmIHNlbGYu
Y3VycmVudF9jb25uZWN0aW9uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAg
ICAgICAgICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10LwsINC90LUg0LzQuNCz0YDQuNGA0YPQ
tdGC0YHRjyDQu9C4INC60LvRjtGHCiAgICAgICAgICAgICAgICAgICAgY2x1c3Rlcl9pbmZvID0g
Y2xpZW50LmNsdXN0ZXIoJ0tFWVNMT1QnLCBrZXlfc3RyKQogICAgICAgICAgICAgICAgICAgIGlm
IGlzaW5zdGFuY2UoY2x1c3Rlcl9pbmZvLCBieXRlcyk6CiAgICAgICAgICAgICAgICAgICAgICAg
IGNsdXN0ZXJfaW5mbyA9IGNsdXN0ZXJfaW5mby5kZWNvZGUoJ3V0Zi04JykKICAgICAgICAgICAg
ICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKICAgICAg
ICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKAogICAgICAgICAgICAgICAg
ICAgICAgICB1cndpZC5UZXh0KCgnaW5mb19sYWJlbCcsIGYnQ2x1c3RlciBTbG90OiB7Y2x1c3Rl
cl9pbmZvfScpKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGV4Y2VwdDoK
ICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToK
ICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiRXJyb3IgZGlzcGxheWluZyBrZXk6IHtlfSIs
ICdlcnJvcicpCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGRpc3BsYXlpbmcga2V5
IHtrZXl9OiB7ZX0iKQogICAgICAgICAgICAjINCf0L7QutCw0LfRi9Cy0LDQtdC8INC+0YjQuNCx
0LrRgyDQsiDQtNC10YLQsNC70Y/RhQogICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXJbOl0g
PSBbCiAgICAgICAgICAgICAgICB1cndpZC5UZXh0KCgnZXJyb3InLCBmJ0Vycm9yOiB7c3RyKGUp
fScpKQogICAgICAgICAgICBdCgogICAgZGVmIGRlYnVnX2NsdXN0ZXJfaW5mbyhzZWxmKToKICAg
ICAgICAiIiLQntGC0LvQsNC00L7Rh9C90LDRjyDQuNC90YTQvtGA0LzQsNGG0LjRjyDQviDQutC7
0LDRgdGC0LXRgNC1IiIiCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uIG9y
IG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5pc19jbHVzdGVyOgogICAgICAgICAgICByZXR1
cm4KCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBzZWxmLmN1cnJlbnRfY29ubmVj
dGlvbi5hY3RpdmVfY2xpZW50CgogICAgICAgICAgICAjINCS0YvQstC+0LTQuNC8INCy0YHRjiDQ
tNC+0YHRgtGD0L/QvdGD0Y4g0LjQvdGE0L7RgNC80LDRhtC40Y4KICAgICAgICAgICAgaW5mbyA9
IHt9CgogICAgICAgICAgICAjIDEuINCf0YDQvtCy0LXRgNGP0LXQvCDQvNC10YLQvtC00Ysg0LrQ
u9C40LXQvdGC0LAKICAgICAgICAgICAgaW5mb1snY2xpZW50X21ldGhvZHMnXSA9IFttIGZvciBt
IGluIGRpcihjbGllbnQpIGlmIG5vdCBtLnN0YXJ0c3dpdGgoJ18nKV0KCiAgICAgICAgICAgICMg
Mi4g0J/RgNC+0LHRg9C10Lwg0L/QvtC70YPRh9C40YLRjCDQuNC90YTQvtGA0LzQsNGG0LjRjiDQ
viDQvdC+0LTQsNGFCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIo
Y2xpZW50LCAnZ2V0X25vZGVzJyk6CiAgICAgICAgICAgICAgICAgICAgbm9kZXMgPSBjbGllbnQu
Z2V0X25vZGVzKCkKICAgICAgICAgICAgICAgICAgICBpbmZvWydub2Rlc19jb3VudCddID0gbGVu
KG5vZGVzKQogICAgICAgICAgICAgICAgICAgIGluZm9bJ25vZGVzX2luZm8nXSA9IFtdCiAgICAg
ICAgICAgICAgICAgICAgZm9yIGksIG5vZGUgaW4gZW51bWVyYXRlKG5vZGVzWzozXSk6ICAjINCf
0LXRgNCy0YvQtSAzINC90L7QtNGLCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfaW5mbyA9
IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpbmRleCc6IGksCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAndHlwZSc6IHN0cih0eXBlKG5vZGUpKSwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICdhdHRycyc6IFthIGZvciBhIGluIGRpcihub2RlKSBpZiBub3QgYS5zdGFydHN3
aXRoKCdfJyldCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAg
ICAgIyDQn9GA0L7QsdGD0LXQvCDQv9C+0LvRg9GH0LjRgtGMINCw0LTRgNC10YEKICAgICAgICAg
ICAgICAgICAgICAgICAgaWYgaGFzYXR0cihub2RlLCAnaG9zdCcpIGFuZCBoYXNhdHRyKG5vZGUs
ICdwb3J0Jyk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2luZm9bJ2FkZHJlc3Mn
XSA9IGYie25vZGUuaG9zdH06e25vZGUucG9ydH0iCiAgICAgICAgICAgICAgICAgICAgICAgIGlu
Zm9bJ25vZGVzX2luZm8nXS5hcHBlbmQobm9kZV9pbmZvKQogICAgICAgICAgICBleGNlcHQgRXhj
ZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBpbmZvWydub2Rlc19lcnJvciddID0gc3RyKGUp
CgogICAgICAgICAgICAjIDMuINCf0YDQvtCx0YPQtdC8IENMVVNURVIgSU5GTwogICAgICAgICAg
ICB0cnk6CiAgICAgICAgICAgICAgICBjbHVzdGVyX2luZm8gPSBjbGllbnQuY2x1c3Rlcl9pbmZv
KCkKICAgICAgICAgICAgICAgIGluZm9bJ2NsdXN0ZXJfaW5mbyddID0gY2x1c3Rlcl9pbmZvCiAg
ICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGluZm9bJ2Ns
dXN0ZXJfaW5mb19lcnJvciddID0gc3RyKGUpCgogICAgICAgICAgICAjIDQuINCf0YDQvtCx0YPQ
tdC8IFJPTEUKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcm9sZSA9IGNsaWVudC5l
eGVjdXRlX2NvbW1hbmQoJ1JPTEUnKQogICAgICAgICAgICAgICAgaW5mb1sncm9sZSddID0gcm9s
ZQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBpbmZv
Wydyb2xlX2Vycm9yJ10gPSBzdHIoZSkKCiAgICAgICAgICAgICMg0JfQsNC/0LjRgdGL0LLQsNC1
0Lwg0LIg0LvQvtCzCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQ2x1c3RlciBkZWJ1ZyBpbmZv
OiB7anNvbi5kdW1wcyhpbmZvLCBkZWZhdWx0PXN0ciwgaW5kZW50PTIpfSIpCgogICAgICAgICAg
ICAjINCf0L7QutCw0LfRi9Cy0LDQtdC8INCyIFVJCiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dh
bGtlcls6XSA9IFtdCiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQu
VGV4dCgoJ2hlYWRlcl90ZXh0JywgJ0NsdXN0ZXIgRGVidWcgSW5mbzonKSkpCiAgICAgICAgICAg
IHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQoKICAgICAgICAgICAg
Zm9yIGtleSwgdmFsdWUgaW4gaW5mby5pdGVtcygpOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0
YW5jZSh2YWx1ZSwgKGxpc3QsIGRpY3QpKToKICAgICAgICAgICAgICAgICAgICB2YWx1ZV9zdHIg
PSBqc29uLmR1bXBzKHZhbHVlLCBkZWZhdWx0PXN0ciwgaW5kZW50PTIpCiAgICAgICAgICAgICAg
ICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHZhbHVlX3N0ciA9IHN0cih2YWx1ZSkKCiAgICAg
ICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoZiJ7a2V5fTog
e3ZhbHVlX3N0cn0iKSkKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQo
dXJ3aWQuRGl2aWRlcigpKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgIGxvZ2dlci5lcnJvcihmIkRlYnVnIGZhaWxlZDoge2V9IikKCgogICAgZGVmIGRlbGV0ZV9r
ZXkoc2VsZiwga2V5OiBieXRlcyk6CiAgICAgICAgIiIi0KPQtNCw0LvQtdC90LjQtSDQutC70Y7R
h9CwINGBINC/0L7QtNC00LXRgNC20LrQvtC5INC60LvQsNGB0YLQtdGA0LAiIiIKICAgICAgICBp
ZiBub3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb246CiAgICAgICAgICAgIHJldHVybgoKICAgICAg
ICB0cnk6CiAgICAgICAgICAgIGNsaWVudCA9IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmFjdGl2
ZV9jbGllbnQKICAgICAgICAgICAgZGVsZXRlZCA9IGNsaWVudC5kZWxldGUoa2V5KQoKICAgICAg
ICAgICAgaWYgZGVsZXRlZDoKICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIktleSBk
ZWxldGVkIiwgJ3N1Y2Nlc3MnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2Vs
Zi5zZXRfc3RhdHVzKGYiS2V5IG5vdCBmb3VuZCIsICd3YXJuaW5nJykKCiAgICAgICAgICAgIHNl
bGYucmVmcmVzaF9rZXlzKCkKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyWzpdID0gW10K
CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLnNldF9zdGF0
dXMoZiJEZWxldGUgZmFpbGVkOiB7ZX0iLCAnZXJyb3InKQogICAgICAgICAgICBsb2dnZXIuZXJy
b3IoZiJEZWxldGUgZmFpbGVkIGZvciBrZXkge2tleX06IHtlfSIpCgogICAgZGVmIHVwZGF0ZV90
YWJzKHNlbGYpOgogICAgICAgICIiItCe0LHQvdC+0LLQu9C10L3QuNC1INGC0LDQsdC+0LIiIiIK
ICAgICAgICB0YWJzID0gW10KCiAgICAgICAgaWYgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gYW5k
IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmNvbm5lY3RlZDoKICAgICAgICAgICAgbmFtZSA9IHNl
bGYuY3VycmVudF9jb25uZWN0aW9uLnByb2ZpbGUubmFtZQoKICAgICAgICAgICAgaWYgc2VsZi5j
dXJyZW50X2Nvbm5lY3Rpb24uaXNfY2x1c3RlcjoKICAgICAgICAgICAgICAgICMg0JTQu9GPINC6
0LvQsNGB0YLQtdGA0LAg0L/QvtC60LDQt9GL0LLQsNC10Lwg0YHQv9C10YbQuNCw0LvRjNC90YPR
jiDQuNC60L7QvdC60YMKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBj
bGllbnQgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5hY3RpdmVfY2xpZW50CiAgICAgICAgICAg
ICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwg0YHQvtGB0YLQvtGP0L3QuNC1INC60LvQsNGB
0YLQtdGA0LAKICAgICAgICAgICAgICAgICAgICBjbHVzdGVyX2luZm8gPSBjbGllbnQuY2x1c3Rl
cl9pbmZvKCkKICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IGNsdXN0ZXJfaW5mby5nZXQoJ2Ns
dXN0ZXJfc3RhdGUnLCAndW5rbm93bicpCgogICAgICAgICAgICAgICAgICAgIGlmIHN0YXRlID09
ICdvayc6CiAgICAgICAgICAgICAgICAgICAgICAgIGljb24gPSAn8J+foicKICAgICAgICAgICAg
ICAgICAgICAgICAgc3R5bGUgPSAnc3VjY2VzcycKICAgICAgICAgICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgICAgICAgICBpY29uID0gJ/CflLQnCiAgICAgICAgICAgICAgICAgICAg
ICAgIHN0eWxlID0gJ2Vycm9yJwoKICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGYiIHtpY29u
fSB7bmFtZX0gW0NsdXN0ZXJdICIKICAgICAgICAgICAgICAgICAgICB0YWJzLmFwcGVuZCgoc3R5
bGUsIGxhYmVsKSkKCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAg
ICAgICAgICAgICAgICAgbGFiZWwgPSBmIiDimqAge25hbWV9IFtDbHVzdGVyXSAiCiAgICAgICAg
ICAgICAgICAgICAgdGFicy5hcHBlbmQoKCd3YXJuaW5nJywgbGFiZWwpKQogICAgICAgICAgICBl
bHNlOgogICAgICAgICAgICAgICAgZGIgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5jdXJyZW50
X2RiCiAgICAgICAgICAgICAgICBsYWJlbCA9IGYiIOKXjyB7bmFtZX0gW0RCe2RifV0gIgogICAg
ICAgICAgICAgICAgdGFicy5hcHBlbmQoKCd0YWJfYWN0aXZlJywgbGFiZWwpKQoKICAgICAgICBz
ZWxmLnRhYl90ZXh0LnNldF90ZXh0KHRhYnMgaWYgdGFicyBlbHNlICcnKQoKICAgIGRlZiBzaG93
X2FkZF9rZXlfZGlhbG9nKHNlbGYpOgogICAgICAgICIiItCU0LjQsNC70L7QsyDQtNC+0LHQsNCy
0LvQtdC90LjRjyDQutC70Y7Rh9CwIiIiCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25u
ZWN0aW9uIG9yIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5jb25uZWN0ZWQ6CiAgICAgICAg
ICAgIHNlbGYuc2V0X3N0YXR1cygiTm90IGNvbm5lY3RlZCIsICdlcnJvcicpCiAgICAgICAgICAg
IHJldHVybgoKICAgICAgICBkaWFsb2cgPSBBZGRLZXlEaWFsb2coc2VsZi5jdXJyZW50X2Nvbm5l
Y3Rpb24sIHNlbGYub25fa2V5X2FkZGVkKQogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKGRp
YWxvZywgJ2Nsb3NlJywgc2VsZi5jbG9zZV9kaWFsb2cpCgogICAgICAgIG92ZXJsYXkgPSB1cndp
ZC5PdmVybGF5KAogICAgICAgICAgICBkaWFsb2csCiAgICAgICAgICAgIHNlbGYubWFpbl9mcmFt
ZSwKICAgICAgICAgICAgYWxpZ249J2NlbnRlcicsCiAgICAgICAgICAgIHdpZHRoPSgncmVsYXRp
dmUnLCA2MCksCiAgICAgICAgICAgIHZhbGlnbj0nbWlkZGxlJywKICAgICAgICAgICAgaGVpZ2h0
PSgncmVsYXRpdmUnLCA3MCkKICAgICAgICApCgogICAgICAgIHNlbGYubG9vcC53aWRnZXQgPSBv
dmVybGF5CgogICAgZGVmIG9uX2tleV9hZGRlZChzZWxmKToKICAgICAgICAiIiLQmtC70Y7RhyDQ
tNC+0LHQsNCy0LvQtdC9IiIiCiAgICAgICAgc2VsZi5zZXRfc3RhdHVzKCJLZXkgYWRkZWQgc3Vj
Y2Vzc2Z1bGx5IiwgJ3N1Y2Nlc3MnKQogICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkKCiAgICBk
ZWYgY2xvc2VfZGlhbG9nKHNlbGYsIGRpYWxvZyk6CiAgICAgICAgIiIi0JfQsNC60YDRi9GC0LjQ
tSDQtNC40LDQu9C+0LPQsCIiIgogICAgICAgIHNlbGYubG9vcC53aWRnZXQgPSBzZWxmLm1haW5f
ZnJhbWUKCiAgICBkZWYgc2V0X3N0YXR1cyhzZWxmLCBtZXNzYWdlOiBzdHIsIHN0eWxlOiBzdHIg
PSAnZm9vdGVyJyk6CiAgICAgICAgIiIi0KPRgdGC0LDQvdC+0LLQutCwINGB0YLQsNGC0YPRgdCw
IiIiCiAgICAgICAgc2VsZi5zdGF0dXNfdGV4dC5zZXRfdGV4dCgoc3R5bGUsIGYiIHttZXNzYWdl
fSIpKQoKICAgIGRlZiBoYW5kbGVfaW5wdXQoc2VsZiwga2V5KToKICAgICAgICAiIiLQntCx0YDQ
sNCx0L7RgtC60LAg0LrQu9Cw0LLQuNGIIiIiCiAgICAgICAgaWYga2V5ID09ICdmMTAnOgogICAg
ICAgICAgICByYWlzZSB1cndpZC5FeGl0TWFpbkxvb3AoKQogICAgICAgIGVsaWYga2V5IGluICgn
cScsICdRJyk6CiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmNvbnNvbGVfbW9kZToKICAgICAgICAg
ICAgICAgIHJhaXNlIHVyd2lkLkV4aXRNYWluTG9vcCgpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2Y1
JyBvciBrZXkgPT0gJ3InOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5jb25zb2xlX21vZGU6CiAg
ICAgICAgICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2Yx
JyBvciBrZXkgPT0gJz8nOgogICAgICAgICAgICAjIGlmIG5vdCBzZWxmLmNvbnNvbGVfbW9kZToK
ICAgICAgICAgICAgc2VsZi5zaG93X2hlbHAoKQogICAgICAgIGVsaWYga2V5IGluICgnYycsICdm
MicpOgogICAgICAgICAgICAjIGlmIG5vdCBzZWxmLmNvbnNvbGVfbW9kZToKICAgICAgICAgICAg
c2VsZi50b2dnbGVfY29uc29sZSgpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2VzYyc6CiAgICAgICAg
ICAgIGlmIHNlbGYuY29uc29sZV9tb2RlOgogICAgICAgICAgICAgICAgc2VsZi50b2dnbGVfY29u
c29sZSgpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2Y0JzoKICAgICAgICAgICAgaWYgbm90IHNlbGYu
Y29uc29sZV9tb2RlOgogICAgICAgICAgICAgICAgc2VsZi5zaG93X2FkZF9rZXlfZGlhbG9nKCkK
ICAgICAgICBlbGlmIGtleSA9PSAnZjgnOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5jb25zb2xl
X21vZGU6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgZWxpZiBrZXkgPT0gJ2Y5JzoKICAg
ICAgICAgICAgaWYgbm90IHNlbGYuY29uc29sZV9tb2RlOgogICAgICAgICAgICAgICAgc2VsZi5k
aXNjb25uZWN0KCkKICAgICAgICBlbGlmIGtleSA9PSAnZjEyJzoKICAgICAgICAgICAgaWYgbm90
IHNlbGYuY29uc29sZV9tb2RlOgogICAgICAgICAgICAgICAgIHNlbGYuZGVidWdfY2x1c3Rlcl9p
bmZvKCkKICAgICAgICBlbGlmIGtleSA9PSAnZW50ZXInOgogICAgICAgICAgICBpZiBzZWxmLmNv
bnNvbGVfbW9kZToKICAgICAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8LCDQvdCw0YXQ
vtC00LjQvNGB0Y8g0LvQuCDQvNGLINCyINC/0YDQvtC80L/RgtC1CiAgICAgICAgICAgICAgICB0
cnk6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5tYWluX2NvbnRlbnQuZm9jdXNfcG9zaXRp
b24gPT0gMjogICMg0JrQvtC90YHQvtC70YzQvdCw0Y8g0L/QsNC90LXQu9GMCiAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnNvbGVfcGlsZSA9IHNlbGYuY29uc29sZV9wYW5lbC5vcmlnaW5hbF93
aWRnZXQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29uc29sZV9waWxlLmZvY3VzX3Bvc2l0
aW9uID09IDI6ICAjINCf0YDQvtC80L/RggogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5leGVjdXRlX2NvbW1hbmQoKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAg
ICAgICAgIHBhc3MKCiAgICBkZWYgc2hvd19oZWxwKHNlbGYpOgogICAgICAgICIiItCh0L/RgNCw
0LLQutCwIiIiCiAgICAgICAgaGVscF90ZXh0ID0gIiIiClJlZGlzIENvbW1hbmRlciBUVUkgLSBI
ZWxwCgpIb3RrZXlzOgogIHEsIFEgICAgICAgLSBRdWl0ICh3aGVuIG5vdCBpbiBjb25zb2xlIG1v
ZGUpCiAgRjEwICAgICAgICAtIFF1aXQKICBGNCAgICAgICAgIC0gQWRkIG5ldyBrZXkKICByLCBG
NSAgICAgIC0gUmVmcmVzaCBrZXlzCiAgYywgRjIgICAgICAtIFRvZ2dsZSBjb25zb2xlIG1vZGUK
ICA/LCBGMSAgICAgIC0gVGhpcyBoZWxwCiAgRjIgICAgICAgICAtIEV4aXQgY29uc29sZSBtb2Rl
CiAgRW50ZXIgICAgICAtIEV4ZWN1dGUgY29tbWFuZCAoaW4gY29uc29sZSBtb2RlKQoKTmF2aWdh
dGlvbjoKICBUYWIgICAgICAgIC0gU3dpdGNoIGJldHdlZW4gcGFuZWxzCiAgVXAvRG93biAgICAt
IE5hdmlnYXRlIGl0ZW1zCiAgRW50ZXIgICAgICAtIFNlbGVjdC9FeHBhbmQKCktleXMgUGFuZWw6
CiAgQ2xpY2sgb24gY29ubmVjdGlvbiB0byBjb25uZWN0CiAgQ2xpY2sgb24gZm9sZGVyIHRvIGV4
cGFuZC9jb2xsYXBzZQogIENsaWNrIG9uIGtleSB0byB2aWV3IGRldGFpbHMKCkRldGFpbHMgUGFu
ZWw6CiAgVmlldyBrZXkgaW5mb3JtYXRpb24gYW5kIHZhbHVlCiAgRGVsZXRlIGtleSB3aXRoIERl
bGV0ZSBidXR0b24KCkNvbnNvbGUgTW9kZToKICBUeXBlIFJlZGlzIGNvbW1hbmRzIGFuZCBwcmVz
cyBFbnRlcgogIEV4YW1wbGVzOiBHRVQga2V5LCBTRVQga2V5IHZhbHVlLCBLRVlTICoKCkFkZCBL
ZXk6CiAgQ2xpY2sgIkFkZCBOZXcgS2V5Li4uIiBidXR0b24KICBTZWxlY3QgdHlwZSwgZW50ZXIg
a2V5IGFuZCB2YWx1ZQogIFNldCBvcHRpb25hbCBUVEwKIiIiCiAgICAgICAgc2VsZi5kZXRhaWxf
d2Fsa2VyWzpdID0gW10KICAgICAgICBmb3IgbGluZSBpbiBoZWxwX3RleHQuc3BsaXQoJ1xuJyk6
CiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dChsaW5lKSkK
CiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgICIiItCX0LDQv9GD0YHQuiIiIgogICAgICAgIHNl
bGYubG9vcC5ydW4oKQoKCmRlZiBtYWluKCk6CiAgICAiIiLQotC+0YfQutCwINCy0YXQvtC00LAi
IiIKICAgIHRyeToKICAgICAgICBhcHAgPSBSZWRpc0NvbW1hbmRlclVJKCkKICAgICAgICBhcHAu
cnVuKCkKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICBwYXNzCiAgICBleGNl
cHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJGYXRhbCBlcnJvcjoge2V9IiwgZmls
ZT1zeXMuc3RkZXJyKQogICAgICAgIGxvZ2dlci5leGNlcHRpb24oIkZhdGFsIGVycm9yIikKICAg
ICAgICBzeXMuZXhpdCgxKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBtYWluKCkK
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHJl
ZGlzX3Byb2ZpbGVzLmpzb24AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwNzcwADAwMDAwMDAA
MDAwMTczNAAwMDAwMDAwMDY1MQAxNTEzMTQxMDIxNQAwMTQwMTYAIDAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdXN0YXIgIAByb290AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAHZib3hzZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAewog
ICJteS1jbHVzdGVyIjogewogICAgIm5hbWUiOiAibXktY2x1c3RlciIsCiAgICAiaG9zdCI6ICIx
MjcuMC4wLjEiLAogICAgInBvcnQiOiA3MDAwLAogICAgImNsdXN0ZXJfbW9kZSI6IHRydWUsCiAg
ICAiY2x1c3Rlcl9ub2RlcyI6IFsKICAgICAgWyIxMjcuMC4wLjEiLCA3MDAwXSwKICAgICAgWyIx
MjcuMC4wLjEiLCA3MDAxXSwKICAgICAgWyIxMjcuMC4wLjEiLCA3MDAyXSwKICAgICAgWyIxMjcu
MC4wLjEiLCA3MDAzXSwKICAgICAgWyIxMjcuMC4wLjEiLCA3MDA0XSwKICAgICAgWyIxMjcuMC4w
LjEiLCA3MDA1XQogICAgXQogIH0sCiAgIm15LWxvY2FsIjogewogICAgIm5hbWUiOiAibXktbG9j
YWwiLAogICAgImhvc3QiOiAiMTI3LjAuMC4xIiwKICAgICJwb3J0IjogNjM3OSwKICAgICJjbHVz
dGVyX21vZGUiOiBmYWxzZQogIH0KfQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
