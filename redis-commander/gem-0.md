Разработка функциональных требований для TUI (Terminal User Interface) утилиты для Redis требует баланса между удобством GUI и скоростью/доступностью CLI. Учитывая целевую аудиторию (разработчики, сопровождение, DevOps), упор должен быть сделан на скорость, безопасность работы с продакшном и поддержку сложных типов данных.

Ниже представлен подробный список функциональных требований, разбитый по категориям.

---

### 1. Управление подключениями (Connectivity)
Утилита должна уметь подключаться к различным окружениям, часто изолированным.

*   **Менеджер профилей:** Сохранение, редактирование и быстрый выбор параметров подключения (Alias, Host, Port, Auth).
*   **Поддержка методов аутентификации:**
    *   Классический `AUTH` (пароль).
    *   Redis ACL (пользователь + пароль).
    *   Поддержка TLS/SSL подключений (с возможностью указания CA сертификатов или игнорирования проверки).
*   **Туннелирование (SSH Tunneling):** Встроенная поддержка SSH-туннелей (через Bastion/Jump host) с аутентификацией по ключу или паролю. Это критично для DevOps и сопровождения.
*   **Cluster & Sentinel Support:**
    *   Автоматическое обнаружение нод в режиме Cluster Mode.
    *   Поддержка работы через Redis Sentinel.
*   **Выбор базы данных:** Быстрое переключение между logical databases (0-15), если не используется кластерный режим.

### 2. Навигация и поиск (Navigation & Exploration)
Работа с ключами должна быть интуитивной, но безопасной для производительности сервера.

*   **Иерархическое представление (Tree View):** Группировка ключей по разделителям (по умолчанию `:`, настраиваемо) в виде дерева папок.
*   **Безопасный листинг:** Использование курсора `SCAN` вместо блокирующего `KEYS *` для загрузки списка ключей. Пагинация результатов.
*   **Фильтрация и поиск:**
    *   Фильтрация по паттерну (glob-style, как в SCAN).
    *   Fuzzy search по отображенным ключам.
    *   Фильтрация по типу ключа (показать только Hash или только Set).
*   **Отображение метаданных:** В списке ключей отображать их тип (string, hash, zset...) и TTL.

### 3. Работа с данными (Data Manipulation)
CRUD операции для всех нативных типов данных Redis.

*   **Просмотр значений:**
    *   Подсветка синтаксиса для популярных форматов (JSON, XML, YAML) внутри значений ключей.
    *   Pretty-print для JSON (автоформатирование).
    *   **HEX-view:** Просмотр бинарных данных (Protobuf, MsgPack, gzipped data) в шестнадцатеричном формате.
*   **Редактирование:**
    *   Создание, изменение, переименование и удаление ключей.
    *   Редактирование TTL (Expire): установка времени жизни или удаление ограничения.
    *   Специфичные редакторы для типов:
        *   **Hash:** Добавление/удаление полей, редактирование значений.
        *   **List/Set/ZSet:** Добавление/удаление элементов, изменение score (для ZSet).
        *   **Stream:** Просмотр записей (XREAD/XRANGE), добавление записей.
*   **Работа с большими данными:** Возможность открыть значение во внешнем редакторе (Vim, Nano) через временный файл (`$EDITOR`), что удобно для больших JSON-конфигов.
*   **Буфер обмена:** Копирование ключа или значения в системный буфер обмена.

### 4. Мониторинг и Диагностика (Monitoring & Insights)
Для DevOps и инженеров поддержки важна оценка состояния сервера.

*   **Дашборд состояния:** Отображение в реальном времени:
    *   Использование памяти (Memory Usage / Fragmentation).
    *   Количество клиентов.
    *   CPU Usage.
    *   Hits/Misses ratio.
    *   Версия сервера, Uptime.
*   **Slowlog Анализатор:** Просмотр журнала медленных запросов (`SLOWLOG GET`) с возможностью очистки.
*   **Клиенты:** Просмотр списка подключенных клиентов (`CLIENT LIST`) с возможностью «убить» соединение (полезно при зависших блокировках).
*   **Pub/Sub Sniffer:** Интерфейс для подписки на каналы и просмотра сообщений в реальном времени (полезно для отладки событийной архитектуры).

### 5. Консоль и скриптинг (Console & Scripting)
Для опытных пользователей, которым нужен прямой доступ.

*   **Встроенный REPL:** Строка ввода для выполнения "сырых" команд Redis.
    *   Автодополнение команд и ключей.
    *   История команд.
*   **Lua Scripts:** Возможность загрузить и выполнить Lua скрипт (`EVAL`).

### 6. Безопасность и защита от ошибок (Safety)
Защита от случайного уничтожения продакшна ("Fat finger" protection).

*   **Read-only режим:** Возможность пометить профиль подключения как "Read-only" (блокировка команд DEL, FLUSHDB, SET и т.д. на уровне интерфейса).
*   **Подтверждение деструктивных действий:** Всплывающие диалоги при попытке удалить ключ, очистить базу или изменить TTL.
*   **Визуальная индикация:** Цветовое кодирование окружений (например, красный фон хедера для Prod, зеленый для Dev).

### 7. Требования к UI/UX (TUI Specifics)
*   **Кроссплатформенность:** Работа на Linux, macOS, Windows (WSL/Powershell).
*   **Управление:** Полная поддержка клавиатуры (Vim-style навигация `h,j,k,l` будет плюсом) + поддержка мыши (скролл, клики для выбора).
*   **Отзывчивость:** Интерфейс не должен зависать при загрузке больших ключей (асинхронная загрузка).
*   **Темы:** Поддержка светлой/темной темы, адаптация под цвета терминала.

### 8. Дополнительные возможности (Nice to have)
*   **Redis Modules:** Базовая поддержка RedisJSON (просмотр как дерева) и RediSearch.
*   **Bulk Operations:** Массовое удаление ключей по паттерну.
*   **Export/Import:** Возможность сохранить значение ключа в файл или загрузить из файла.

### Пример сценария использования (User Story):
> **Разработчик** подключается к DEV-стенду, находит ключ сессии пользователя через поиск, видит, что данные внутри — это gzip. Переключает вид в Hex, понимает структуру. Меняет TTL, чтобы сессия не протухла во время отладки.
>
> **DevOps** подключается к PROD через SSH-туннель. Видит на дашборде всплеск памяти. Открывает Slowlog, находит "тяжелую" команду `KEYS *`, определяет IP клиента и принудительно разрывает соединение. Включает Read-only режим, чтобы случайно ничего не удалить.
