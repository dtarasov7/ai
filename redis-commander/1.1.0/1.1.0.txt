cmVkaXNfY29tbWFuZGVyX3R1aS12MS4xLjAucHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA3NzAAMDAwMDAw
MAAwMDAxNzM0ADAwMDAwNDY0MzQ3ADE1MTMxNzc1NzMyADAxNTM2MwAgMAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAdmJveHNmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAj
IS91c3IvYmluL2VudiBweXRob24zCiIiIgpSZWRpcyBDb21tYW5kZXIgVFVJIC0gVGVybWluYWwg
VXNlciBJbnRlcmZhY2Ug0LIg0YHRgtC40LvQtSBSZWRpcyBDb21tYW5kZXIK0J/QvtC70L3QsNGP
INGE0YPQvdC60YbQuNC+0L3QsNC70YzQvdC+0YHRgtGMOiDQv9GA0L7RgdC80L7RgtGAINC60LvR
jtGH0LXQuSwg0LLRi9C/0L7Qu9C90LXQvdC40LUg0LrQvtC80LDQvdC0LCDQtNC+0LHQsNCy0LvQ
tdC90LjQtSDQutC70Y7Rh9C10LkKIiIiCgppbXBvcnQgdXJ3aWQKIyBpbXBvcnQgcmVkaXMKZnJv
bSBzaW1wbGVfcmVkaXNfY2xpZW50IGltcG9ydCBSZWRpc0NsaWVudCwgUmVkaXNFcnJvciwgUmVk
aXNDb25uZWN0aW9uRXJyb3IsIFJlZGlzQ2x1c3RlckVycm9yCmltcG9ydCBhcmdwYXJzZQppbXBv
cnQganNvbgppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgdGltZQpmcm9tIGRhdGV0aW1lIGlt
cG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgRGljdCwgQW55LCBPcHRpb25h
bCwgVHVwbGUKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgT3JkZXJlZERpY3QsIGRlZmF1bHRkaWN0
CmltcG9ydCBsb2dnaW5nCmltcG9ydCBiYXNlNjQKaW1wb3J0IGdldHBhc3MKZnJvbSB0eXBpbmcg
aW1wb3J0IERpY3QKIyDQlNC70Y8g0YjQuNGE0YDQvtCy0LDQvdC40Y8gKNC90YPQttC10L0gcGlw
IGluc3RhbGwgY3J5cHRvZ3JhcGh5KQp0cnk6CiAgICBmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQg
aW1wb3J0IEZlcm5ldAogICAgZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LnByaW1pdGl2ZXMgaW1w
b3J0IGhhc2hlcwogICAgZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LnByaW1pdGl2ZXMua2RmLnBi
a2RmMiBpbXBvcnQgUEJLREYySE1BQwogICAgZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LmJhY2tl
bmRzIGltcG9ydCBkZWZhdWx0X2JhY2tlbmQKICAgIEhBU19DUllQVE8gPSBUcnVlCmV4Y2VwdCBJ
bXBvcnRFcnJvcjoKICAgIEhBU19DUllQVE8gPSBGYWxzZQoKCl9fVkVSU0lPTl9fID0gIjEuMS4w
IgpfX0FVVEhPUl9fID0gItCi0LDRgNCw0YHQvtCyINCU0LzQuNGC0YDQuNC5IgoKIyDQndCw0YHR
gtGA0L7QudC60LAg0LvQvtCz0LjRgNC+0LLQsNC90LjRjwpsb2dnaW5nLmJhc2ljQ29uZmlnKAog
ICAgZmlsZW5hbWU9J3JlZGlzX3R1aV9hdWRpdC5sb2cnLAogICAgbGV2ZWw9bG9nZ2luZy5JTkZP
LAogICAgZm9ybWF0PSclKGFzY3RpbWUpcyAtICUobGV2ZWxuYW1lKXMgLSAlKG1lc3NhZ2UpcycK
KQpsb2dnZXIgPSBsb2dnaW5nLmdldExvZ2dlcigncmVkaXNfY29tbWFuZGVyX3R1aScpCgoKY2xh
c3MgQ29ubmVjdGlvblByb2ZpbGU6CiAgICAiIiLQn9GA0L7RhNC40LvRjCDQv9C+0LTQutC70Y7R
h9C10L3QuNGPINC6IFJlZGlzIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZTogc3RyLCBo
b3N0OiBzdHIgPSAnbG9jYWxob3N0JywgcG9ydDogaW50ID0gNjM3OSwKICAgICAgICAgICAgIHBh
c3N3b3JkOiBPcHRpb25hbFtzdHJdID0gTm9uZSwgdXNlcm5hbWU6IE9wdGlvbmFsW3N0cl0gPSBO
b25lLAogICAgICAgICAgICAgc3NsOiBib29sID0gRmFsc2UsIHNzbF9jYV9jZXJ0czogT3B0aW9u
YWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICBzc2xfY2VydGZpbGU6IE9wdGlvbmFsW3N0cl0g
PSBOb25lLCBzc2xfa2V5ZmlsZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICBz
b2NrZXRfcGF0aDogT3B0aW9uYWxbc3RyXSA9IE5vbmUsIHJlYWRvbmx5OiBib29sID0gRmFsc2Us
CiAgICAgICAgICAgICBjbHVzdGVyX21vZGU6IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgIGNs
dXN0ZXJfbm9kZXM6IE9wdGlvbmFsW0xpc3RbVHVwbGVbc3RyLCBpbnRdXV0gPSBOb25lKTogICMg
0J3QvtC00Ysg0LTQu9GPINC60LvQsNGB0YLQtdGA0LAKICAgICAgICBzZWxmLm5hbWUgPSBuYW1l
CiAgICAgICAgc2VsZi5ob3N0ID0gaG9zdAogICAgICAgIHNlbGYucG9ydCA9IHBvcnQKICAgICAg
ICBzZWxmLnBhc3N3b3JkID0gcGFzc3dvcmQKICAgICAgICBzZWxmLnVzZXJuYW1lID0gdXNlcm5h
bWUKICAgICAgICBzZWxmLnNzbCA9IHNzbAogICAgICAgIHNlbGYuc3NsX2NhX2NlcnRzID0gc3Ns
X2NhX2NlcnRzCiAgICAgICAgc2VsZi5zc2xfY2VydGZpbGUgPSBzc2xfY2VydGZpbGUKICAgICAg
ICBzZWxmLnNzbF9rZXlmaWxlID0gc3NsX2tleWZpbGUKICAgICAgICBzZWxmLnNvY2tldF9wYXRo
ID0gc29ja2V0X3BhdGgKICAgICAgICBzZWxmLnJlYWRvbmx5ID0gcmVhZG9ubHkKICAgICAgICBz
ZWxmLmNsdXN0ZXJfbW9kZSA9IGNsdXN0ZXJfbW9kZQogICAgICAgIHNlbGYuY2x1c3Rlcl9ub2Rl
cyA9IGNsdXN0ZXJfbm9kZXMgb3IgWyhob3N0LCBwb3J0KV0KCiAgICBkZWYgdG9fZGljdChzZWxm
KSAtPiBEaWN0OgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICduYW1lJzogc2VsZi5uYW1l
LAogICAgICAgICAgICAnaG9zdCc6IHNlbGYuaG9zdCwKICAgICAgICAgICAgJ3BvcnQnOiBzZWxm
LnBvcnQsCiAgICAgICAgICAgICdzc2wnOiBzZWxmLnNzbCwKICAgICAgICAgICAgJ3JlYWRvbmx5
Jzogc2VsZi5yZWFkb25seQogICAgICAgIH0KCgpjbGFzcyBSZWRpc0Nvbm5lY3Rpb246CiAgICAi
IiLQnNC10L3QtdC00LbQtdGAINC/0L7QtNC60LvRjtGH0LXQvdC40Lkg0LogUmVkaXMiIiIKCiAg
ICBkZWYgX19pbml0X18oc2VsZiwgcHJvZmlsZTogQ29ubmVjdGlvblByb2ZpbGUpOgogICAgICAg
IHNlbGYucHJvZmlsZSA9IHByb2ZpbGUKICAgICAgICBzZWxmLmNsaWVudDogT3B0aW9uYWxbcmVk
aXMuUmVkaXNdID0gTm9uZQogICAgICAgICMgc2VsZi5jbGllbnQ6IFJlZGlzQ2xpZW50CiAgICAg
ICAgc2VsZi5jbHVzdGVyX2NsaWVudDogT3B0aW9uYWxbcmVkaXMuUmVkaXNDbHVzdGVyXSA9IE5v
bmUgICMg0J3QvtCy0YvQuSDQutC70LjQtdC90YIKICAgICAgICBzZWxmLmNvbm5lY3RlZCA9IEZh
bHNlCiAgICAgICAgc2VsZi5jdXJyZW50X2RiID0gMAogICAgICAgIHNlbGYuaXNfY2x1c3RlciA9
IHByb2ZpbGUuY2x1c3Rlcl9tb2RlCgogICAgZGVmIGNvbm5lY3Qoc2VsZikgLT4gVHVwbGVbYm9v
bCwgc3RyXToKICAgICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IFJlZGlzINC40LvQ
uCBSZWRpcyBDbHVzdGVyIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBzZWxmLnByb2Zp
bGUuY2x1c3Rlcl9tb2RlOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2Nvbm5lY3RfY2x1
c3RlcigpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fY29u
bmVjdF9zdGFuZGFsb25lKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgIHNlbGYuY29ubmVjdGVkID0gRmFsc2UKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiQ29u
bmVjdGlvbiBmYWlsZWQ6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgc3RyKGUpCgog
ICAgZGVmIF9jb25uZWN0X3N0YW5kYWxvbmUoc2VsZikgLT4gVHVwbGVbYm9vbCwgc3RyXToKICAg
ICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IHN0YW5kYWxvbmUgUmVkaXMiIiIKICAg
ICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IFJlZGlzIiIiCiAgICAgICAgdHJ5Ogog
ICAgICAgICAgICBrd2FyZ3MgPSB7CiAgICAgICAgICAgICAgICAnZGInOiAwLCAgIyDQktGB0LXQ
s9C00LAg0L3QsNGH0LjQvdCw0LXQvCDRgSBEQjAKICAgICAgICAgICAgICAgICdzb2NrZXRfdGlt
ZW91dCc6IDUsCiAgICAgICAgICAgICAgICAnZGVjb2RlX3Jlc3BvbnNlcyc6IEZhbHNlCiAgICAg
ICAgICAgIH0KCiAgICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS5zb2NrZXRfcGF0aDoKICAgICAg
ICAgICAgICAgIGt3YXJnc1sndW5peF9zb2NrZXRfcGF0aCddID0gc2VsZi5wcm9maWxlLnNvY2tl
dF9wYXRoCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBrd2FyZ3NbJ2hvc3QnXSA9
IHNlbGYucHJvZmlsZS5ob3N0CiAgICAgICAgICAgICAgICBrd2FyZ3NbJ3BvcnQnXSA9IHNlbGYu
cHJvZmlsZS5wb3J0CgogICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUucGFzc3dvcmQ6CiAgICAg
ICAgICAgICAgICBrd2FyZ3NbJ3Bhc3N3b3JkJ10gPSBzZWxmLnByb2ZpbGUucGFzc3dvcmQKCiAg
ICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS51c2VybmFtZToKICAgICAgICAgICAgICAgIGt3YXJn
c1sndXNlcm5hbWUnXSA9IHNlbGYucHJvZmlsZS51c2VybmFtZQoKICAgICAgICAgICAgaWYgc2Vs
Zi5wcm9maWxlLnNzbDoKICAgICAgICAgICAgICAgIGt3YXJnc1snc3NsJ10gPSBUcnVlCiAgICAg
ICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NhX2NlcnRzOgogICAgICAgICAgICAgICAg
ICAgIGt3YXJnc1snc3NsX2NhX2NlcnRzJ10gPSBzZWxmLnByb2ZpbGUuc3NsX2NhX2NlcnRzCiAg
ICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NlcnRmaWxlOgogICAgICAgICAgICAg
ICAgICAgIGt3YXJnc1snc3NsX2NlcnRmaWxlJ10gPSBzZWxmLnByb2ZpbGUuc3NsX2NlcnRmaWxl
CiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2tleWZpbGU6CiAgICAgICAgICAg
ICAgICAgICAga3dhcmdzWydzc2xfa2V5ZmlsZSddID0gc2VsZi5wcm9maWxlLnNzbF9rZXlmaWxl
CgogICAgICAgICAgICBzZWxmLmNsaWVudCA9IFJlZGlzQ2xpZW50KCoqa3dhcmdzKQogICAgICAg
ICAgICBzZWxmLmNsaWVudC5waW5nKCkKICAgICAgICAgICAgc2VsZi5jb25uZWN0ZWQgPSBUcnVl
CiAgICAgICAgICAgIHNlbGYuY3VycmVudF9kYiA9IDAKICAgICAgICAgICAgbG9nZ2VyLmluZm8o
ZiJDb25uZWN0ZWQgdG8ge3NlbGYucHJvZmlsZS5ob3N0fTp7c2VsZi5wcm9maWxlLnBvcnR9IikK
ICAgICAgICAgICAgcmV0dXJuIFRydWUsICJDb25uZWN0ZWQiCgogICAgICAgIGV4Y2VwdCBSZWRp
c0Nvbm5lY3Rpb25FcnJvciBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJDb25uZWN0
aW9uIGZhaWxlZDoge2V9IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKICAgICAg
ICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuY29ubmVjdGVkID0gRmFs
c2UKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiQ29ubmVjdGlvbiBmYWlsZWQ6IHtlfSIpCiAg
ICAgICAgICAgIHJldHVybiBGYWxzZSwgc3RyKGUpCgogICAgZGVmIF9jb25uZWN0X2NsdXN0ZXIo
c2VsZikgLT4gVHVwbGVbYm9vbCwgc3RyXToKICAgICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3Q
uNC1INC6IFJlZGlzIENsdXN0ZXIgLSDQv9GA0L7RgdGC0LDRjyDQstC10YDRgdC40Y8iIiIKICAg
ICAgICB0cnk6CiAgICAgICAgICAgICMg0J/RgNC+0YHRgtC+INC/0LXRgNC10LTQsNC10Lwg0YHQ
v9C40YHQvtC6INGD0LfQu9C+0LIg0LrQsNC6INC10YHRgtGMCiAgICAgICAgICAgIGt3YXJncyA9
IHsKICAgICAgICAgICAgICAgICdob3N0Jzogc2VsZi5wcm9maWxlLmhvc3QsCiAgICAgICAgICAg
ICAgICAncG9ydCc6IHNlbGYucHJvZmlsZS5wb3J0LAogICAgICAgICAgICAgICAgJ2RlY29kZV9y
ZXNwb25zZXMnOiBGYWxzZSwKICAgICAgICAgICAgICAgICdzb2NrZXRfdGltZW91dCc6IDUsCiAg
ICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS5wYXNzd29yZDoKICAgICAg
ICAgICAgICAgIGt3YXJnc1sncGFzc3dvcmQnXSA9IHNlbGYucHJvZmlsZS5wYXNzd29yZAoKICAg
ICAgICAgICAgaWYgc2VsZi5wcm9maWxlLnNzbDoKICAgICAgICAgICAgICAgIGt3YXJnc1snc3Ns
J10gPSBUcnVlCiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NhX2NlcnRzOgog
ICAgICAgICAgICAgICAgICAgIGt3YXJnc1snc3NsX2NhX2NlcnRzJ10gPSBzZWxmLnByb2ZpbGUu
c3NsX2NhX2NlcnRzCiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NlcnRmaWxl
OgogICAgICAgICAgICAgICAgICAgIGt3YXJnc1snc3NsX2NlcnRmaWxlJ10gPSBzZWxmLnByb2Zp
bGUuc3NsX2NlcnRmaWxlCiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2tleWZp
bGU6CiAgICAgICAgICAgICAgICAgICAga3dhcmdzWydzc2xfa2V5ZmlsZSddID0gc2VsZi5wcm9m
aWxlLnNzbF9rZXlmaWxlCgogICAgICAgICAgICAjINCU0LvRjyDQvtGC0LvQsNC00LrQuAogICAg
ICAgICAgICBsb2dnZXIuaW5mbyhmIkNvbm5lY3RpbmcgdG8gUmVkaXMgQ2x1c3RlciBhdCB7c2Vs
Zi5wcm9maWxlLmhvc3R9OntzZWxmLnByb2ZpbGUucG9ydH0iKQoKICAgICAgICAgICAgIyBSZWRp
c0NsdXN0ZXIg0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60Lgg0L7QsdC90LDRgNGD0LbQuNGCINC0
0YDRg9Cz0LjQtSDRg9C30LvRiwogICAgICAgICAgICAjIHNlbGYuY2x1c3Rlcl9jbGllbnQgPSBy
ZWRpcy5SZWRpc0NsdXN0ZXIoKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYuY2x1c3Rlcl9jbGll
bnQgPSBSZWRpc0NsaWVudCgqKmt3YXJncywgaXNfY2x1c3Rlcj1UcnVlKQogICAgICAgICAgICBz
ZWxmLmNsdXN0ZXJfY2xpZW50LnBpbmcoKQogICAgICAgICAgICBzZWxmLmNvbm5lY3RlZCA9IFRy
dWUKICAgICAgICAgICAgc2VsZi5pc19jbHVzdGVyID0gVHJ1ZQoKICAgICAgICAgICAgIyDQn9GA
0L7QstC10YDRj9C10LwsINGH0YLQviDRjdGC0L4g0LTQtdC50YHRgtCy0LjRgtC10LvRjNC90L4g
0LrQu9Cw0YHRgtC10YAKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgY2x1c3Rlcl9p
bmZvID0gc2VsZi5jbHVzdGVyX2NsaWVudC5jbHVzdGVyX2luZm8oKQogICAgICAgICAgICAgICAg
bG9nZ2VyLmluZm8oZiJDbHVzdGVyIHN0YXRlOiB7Y2x1c3Rlcl9pbmZvLmdldCgnY2x1c3Rlcl9z
dGF0ZScsICd1bmtub3duJyl9IikKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAg
cGFzcwoKICAgICAgICAgICAgcmV0dXJuIFRydWUsICJDb25uZWN0ZWQgdG8gY2x1c3RlciIKCiAg
ICAgICAgZXhjZXB0IFJlZGlzQ2x1c3RlckVycm9yIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5l
cnJvcihmIlJlZGlzIENsdXN0ZXIgZXJyb3I6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiBGYWxz
ZSwgZiJDbHVzdGVyIGVycm9yOiB7c3RyKGUpfSIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFz
IGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkNvbm5lY3Rpb24gZmFpbGVkOiB7ZX0iKQog
ICAgICAgICAgICByZXR1cm4gRmFsc2UsIHN0cihlKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGFj
dGl2ZV9jbGllbnQoc2VsZik6CiAgICAgICAgIiIi0JLQvtC30LLRgNCw0YnQsNC10YIg0LDQutGC
0LjQstC90YvQuSDQutC70LjQtdC90YIiIiIKICAgICAgICBpZiBzZWxmLmlzX2NsdXN0ZXI6CiAg
ICAgICAgICAgIHJldHVybiBzZWxmLmNsdXN0ZXJfY2xpZW50CiAgICAgICAgcmV0dXJuIHNlbGYu
Y2xpZW50CgogICAgZGVmIHNlbGVjdF9kYihzZWxmLCBkYjogaW50KSAtPiBUdXBsZVtib29sLCBz
dHJdOgogICAgICAgICIiItCf0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQvdCwINC00YDRg9Cz0YPR
jiDQsdCw0LfRgyDQtNCw0L3QvdGL0YUgKNC90LUg0L/QvtC00LTQtdGA0LbQuNCy0LDQtdGC0YHR
jyDQsiDQutC70LDRgdGC0LXRgNC1KSIiIgogICAgICAgIGlmIHNlbGYuaXNfY2x1c3RlcjoKICAg
ICAgICAgICAgcmV0dXJuIEZhbHNlLCAiUmVkaXMgQ2x1c3RlciBzdXBwb3J0cyBvbmx5IERCMCIK
CiAgICAgICAgaWYgbm90IHNlbGYuY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4gRmFsc2Us
ICJOb3QgY29ubmVjdGVkIgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuY2xpZW50LnNl
bGVjdChkYikKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2RiID0gZGIKICAgICAgICAgICAgbG9n
Z2VyLmluZm8oZiJTd2l0Y2hlZCB0byBEQjp7ZGJ9IikKICAgICAgICAgICAgcmV0dXJuIFRydWUs
IGYiU3dpdGNoZWQgdG8gREI6e2RifSIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAg
ICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBzd2l0Y2ggREI6IHtlfSIpCiAgICAg
ICAgICAgIHJldHVybiBGYWxzZSwgc3RyKGUpCgogICAgZGVmIGRpc2Nvbm5lY3Qoc2VsZik6CiAg
ICAgICAgaWYgc2VsZi5jbGllbnQ6CiAgICAgICAgICAgIHNlbGYuY2xpZW50LmNsb3NlKCkKICAg
ICAgICAgICAgc2VsZi5jb25uZWN0ZWQgPSBGYWxzZQogICAgICAgICAgICBsb2dnZXIuaW5mbyhm
IkRpc2Nvbm5lY3RlZCBmcm9tIHtzZWxmLnByb2ZpbGUuaG9zdH06e3NlbGYucHJvZmlsZS5wb3J0
fSIpCgoKY2xhc3MgS2V5TGlzdEl0ZW0odXJ3aWQuV2lkZ2V0V3JhcCk6CiAgICAiIiLQrdC70LXQ
vNC10L3RgiDRgdC/0LjRgdC60LAg0LrQu9GO0YfQtdC5INGBINC/0L7QtNC00LXRgNC20LrQvtC5
INCy0YvQtNC10LvQtdC90LjRjyIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBrZXk6IGJ5dGVz
LCBrZXlfdHlwZTogc3RyLCBvbl9zZWxlY3RfY2FsbGJhY2ssIG1hcmtlZDogYm9vbCA9IEZhbHNl
KToKICAgICAgICAiIiIKICAgICAgICBBcmdzOgogICAgICAgICAgICBrZXk6INC60LvRjtGHIChi
eXRlcykKICAgICAgICAgICAga2V5X3R5cGU6INGC0LjQvyDQutC70Y7Rh9CwIChzdHJpbmcsIGhh
c2gsIGxpc3QsIGV0YykKICAgICAgICAgICAgb25fc2VsZWN0X2NhbGxiYWNrOiDRhNGD0L3QutGG
0LjRjyDQtNC70Y8g0LLRi9C30L7QstCwINC/0YDQuCDQstGL0LHQvtGA0LUg0LrQu9GO0YfQsAog
ICAgICAgICAgICBtYXJrZWQ6INC+0YLQvNC10YfQtdC9INC70Lgg0Y3Qu9C10LzQtdC90YIKICAg
ICAgICAiIiIKICAgICAgICBzZWxmLmtleSA9IGtleQogICAgICAgIHNlbGYua2V5X3R5cGUgPSBr
ZXlfdHlwZQogICAgICAgIHNlbGYubWFya2VkID0gbWFya2VkCiAgICAgICAgc2VsZi5vbl9zZWxl
Y3RfY2FsbGJhY2sgPSBvbl9zZWxlY3RfY2FsbGJhY2sKCiAgICAgICAgIyDQlNC10LrQvtC00LjR
gNGD0LXQvCDQutC70Y7RhyDQtNC70Y8g0L7RgtC+0LHRgNCw0LbQtdC90LjRjwogICAgICAgIHRy
eToKICAgICAgICAgICAgc2VsZi5rZXlfc3RyID0ga2V5LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9
J3JlcGxhY2UnKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgc2VsZi5rZXlfc3RyID0gc3Ry
KGtleSkKCiAgICAgICAgIyDQmNC60L7QvdC60LAg0YLQuNC/0LAKICAgICAgICB0eXBlX2ljb25z
ID0gewogICAgICAgICAgICAnc3RyaW5nJzogJ1tTdF0nLAogICAgICAgICAgICAnaGFzaCc6ICdb
SHNdJywKICAgICAgICAgICAgJ2xpc3QnOiAnW0xpXScsCiAgICAgICAgICAgICdzZXQnOiAnW1Nl
XScsCiAgICAgICAgICAgICd6c2V0JzogJ1tac10nLAogICAgICAgICAgICAnc3RyZWFtJzogJ1tU
cl0nLAogICAgICAgICAgICAnbm9uZSc6ICdbTm9dJywKICAgICAgICAgICAgJ3Vua25vd24nOiAn
Wz9dJywKICAgICAgICB9CiAgICAgICAgaWNvbiA9IHR5cGVfaWNvbnMuZ2V0KGtleV90eXBlLCAn
Wz9dJykKCiAgICAgICAgIyDQntGC0LzQtdGC0LrQsCAo0LTQu9GPINC80LDRgdGB0L7QstGL0YUg
0L7Qv9C10YDQsNGG0LjQuSkKICAgICAgICBtYXJrID0gJ+KckycgaWYgbWFya2VkIGVsc2UgJyAn
CgogICAgICAgICMg0KLQtdC60YHRgiDRjdC70LXQvNC10L3RgtCwCiAgICAgICAgdGV4dCA9IGYi
e21hcmt9e2ljb259IHtzZWxmLmtleV9zdHJ9IgoKICAgICAgICBzZWxmLnRleHRfd2lkZ2V0ID0g
dXJ3aWQuU2VsZWN0YWJsZUljb24odGV4dCwgY3Vyc29yX3Bvc2l0aW9uPTApCgogICAgICAgIHN1
cGVyKCkuX19pbml0X18oc2VsZi50ZXh0X3dpZGdldCkKCiAgICBkZWYgdG9nZ2xlX21hcmsoc2Vs
Zik6CiAgICAgICAgIiIi0J/QtdGA0LXQutC70Y7Rh9C40YLRjCDQvtGC0LzQtdGC0LrRgyIiIgog
ICAgICAgIHNlbGYubWFya2VkID0gbm90IHNlbGYubWFya2VkCiAgICAgICAgc2VsZi51cGRhdGVf
ZGlzcGxheSgpCgogICAgZGVmIHVwZGF0ZV9kaXNwbGF5KHNlbGYpOgogICAgICAgICIiItCe0LHQ
vdC+0LLQuNGC0Ywg0L7RgtC+0LHRgNCw0LbQtdC90LjQtSIiIgogICAgICAgIHR5cGVfaWNvbnMg
PSB7CiAgICAgICAgICAgICdzdHJpbmcnOiAnW1N0XScsCiAgICAgICAgICAgICdoYXNoJzogJ1tI
c10nLAogICAgICAgICAgICAnbGlzdCc6ICdbTGldJywKICAgICAgICAgICAgJ3NldCc6ICdbU2Vd
JywKICAgICAgICAgICAgJ3pzZXQnOiAnW1pzXScsCiAgICAgICAgICAgICdzdHJlYW0nOiAnW1Ry
XScsCiAgICAgICAgICAgICdub25lJzogJ1tOb10nLAogICAgICAgICAgICAndW5rbm93bic6ICdb
P10nLAogICAgICAgIH0KICAgICAgICBpY29uID0gdHlwZV9pY29ucy5nZXQoc2VsZi5rZXlfdHlw
ZSwgJ1s/XScpCiAgICAgICAgbWFyayA9ICfinJMnIGlmIHNlbGYubWFya2VkIGVsc2UgJyAnCiAg
ICAgICAgdGV4dCA9IGYie21hcmt9e2ljb259IHtzZWxmLmtleV9zdHJ9IgogICAgICAgIHNlbGYu
dGV4dF93aWRnZXQuc2V0X3RleHQodGV4dCkKCiAgICBkZWYgc2VsZWN0YWJsZShzZWxmKToKICAg
ICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBrZXlwcmVzcyhzZWxmLCBzaXplLCBrZXkpOgogICAg
ICAgIGlmIGtleSA9PSAnfic6ICAjINCf0YDQvtCx0LXQuyAtINC/0LXRgNC10LrQu9GO0YfQuNGC
0Ywg0L7RgtC80LXRgtC60YMKICAgICAgICAgICAgc2VsZi50b2dnbGVfbWFyaygpCiAgICAgICAg
ICAgIHJldHVybiBOb25lCiAgICAgICAgZWxpZiBrZXkgPT0gJ2VudGVyJzoKICAgICAgICAgICAg
IyDQktGL0LfRi9Cy0LDQtdC8IGNhbGxiYWNrINC90LDQv9GA0Y/QvNGD0Y4KICAgICAgICAgICAg
aWYgc2VsZi5vbl9zZWxlY3RfY2FsbGJhY2s6CiAgICAgICAgICAgICAgICBzZWxmLm9uX3NlbGVj
dF9jYWxsYmFjayhzZWxmLmtleSkKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICByZXR1
cm4ga2V5CgoKY2xhc3MgS2V5TGlzdFZpZXcodXJ3aWQuV2lkZ2V0V3JhcCk6CiAgICAiIiLQktC4
0YDRgtGD0LDQu9C40LfQuNGA0L7QstCw0L3QvdGL0Lkg0YHQv9C40YHQvtC6INC60LvRjtGH0LXQ
uSDRgSDRhNC40LvRjNGC0YDQsNGG0LjQtdC5INC4INC60LXRiNC40YDQvtCy0LDQvdC40LXQvCIi
IgoKICAgIHNpZ25hbHMgPSBbJ2tleV9zZWxlY3RlZCddCgogICAgZGVmIF9faW5pdF9fKHNlbGYp
OgogICAgICAgIHNlbGYuYWxsX2tleXMgPSBbXSAgIyDQktGB0LUg0LrQu9GO0YfQuDogWyhrZXlf
Ynl0ZXMsIHR5cGVfc3RyKSwgLi4uXQogICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cyA9IFtdICAj
INCe0YLRhNC40LvRjNGC0YDQvtCy0LDQvdC90YvQtSDQutC70Y7Rh9C4CiAgICAgICAgc2VsZi5m
aWx0ZXJfcGF0dGVybiA9IE5vbmUgICMg0KLQtdC60YPRidC40Lkg0YTQuNC70YzRgtGACiAgICAg
ICAgc2VsZi5tYXJrZWRfa2V5cyA9IHNldCgpICAjINCe0YLQvNC10YfQtdC90L3Ri9C1INC60LvR
jtGH0LgKICAgICAgICBzZWxmLmtleV9jYWNoZSA9IHt9ICAjINCa0LXRiCDQstC40LTQttC10YLQ
vtCyOiB7a2V5OiBLZXlMaXN0SXRlbX0KCiAgICAgICAgIyBXYWxrZXIg0LTQu9GPIExpc3RCb3gK
ICAgICAgICBzZWxmLndhbGtlciA9IHVyd2lkLlNpbXBsZUZvY3VzTGlzdFdhbGtlcihbXSkKICAg
ICAgICBzZWxmLmxpc3Rib3ggPSB1cndpZC5MaXN0Qm94KHNlbGYud2Fsa2VyKQoKICAgICAgICAj
INCX0LDQs9C+0LvQvtCy0L7QuiDRgSDQuNC90YTQvtGA0LzQsNGG0LjQtdC5CiAgICAgICAgc2Vs
Zi5oZWFkZXIgPSB1cndpZC5UZXh0KCcnKQogICAgICAgIHNlbGYudXBkYXRlX2hlYWRlcigpCgog
ICAgICAgICMg0JrQvtC80L/QvtC90L7QstC60LAKICAgICAgICBwaWxlID0gdXJ3aWQuUGlsZShb
CiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5oZWFkZXIsICdpbmZvX2xh
YmVsJykpLAogICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5EaXZpZGVyKCfilIAnKSksCiAgICAg
ICAgICAgICgnd2VpZ2h0JywgMSwgc2VsZi5saXN0Ym94KSwKICAgICAgICBdKQoKICAgICAgICBz
dXBlcigpLl9faW5pdF9fKHBpbGUpCgogICAgZGVmIHNldF9rZXlzKHNlbGYsIGtleXNfd2l0aF90
eXBlczogTGlzdFtUdXBsZVtieXRlcywgc3RyXV0pOgogICAgICAgICIiItCj0YHRgtCw0L3QvtCy
0LjRgtGMINGB0L/QuNGB0L7QuiDQutC70Y7Rh9C10LkgKNGBINGC0LjQv9Cw0LzQuCkiIiIKICAg
ICAgICBsb2dnZXIuaW5mbyhmIktleUxpc3RWaWV3LnNldF9rZXlzIGNhbGxlZCB3aXRoIHtsZW4o
a2V5c193aXRoX3R5cGVzKX0ga2V5cyIpCiAgICAgICAgc2VsZi5hbGxfa2V5cyA9IGtleXNfd2l0
aF90eXBlcwogICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cyA9IGtleXNfd2l0aF90eXBlcy5jb3B5
KCkKICAgICAgICBzZWxmLmtleV9jYWNoZS5jbGVhcigpICAjINCe0YfQuNGJ0LDQtdC8INC60LXR
iCDQv9GA0Lgg0L/QvtC70L3QvtC8INC+0LHQvdC+0LLQu9C10L3QuNC4CiAgICAgICAgbG9nZ2Vy
LmluZm8oZiJhbGxfa2V5czoge2xlbihzZWxmLmFsbF9rZXlzKX0sIGZpbHRlcmVkX2tleXM6IHts
ZW4oc2VsZi5maWx0ZXJlZF9rZXlzKX0iKQogICAgICAgIHNlbGYucmVmcmVzaF9kaXNwbGF5KCkK
ICAgICAgICBsb2dnZXIuaW5mbygiS2V5TGlzdFZpZXcuc2V0X2tleXMgY29tcGxldGVkIikKCiAg
ICBkZWYgYXBwbHlfZmlsdGVyKHNlbGYsIHBhdHRlcm46IE9wdGlvbmFsW3N0cl0pOgogICAgICAg
ICIiItCf0YDQuNC80LXQvdC40YLRjCDRhNC40LvRjNGC0YAg0L/QviDQv9Cw0YLRgtC10YDQvdGD
IiIiCiAgICAgICAgc2VsZi5maWx0ZXJfcGF0dGVybiA9IHBhdHRlcm4KCiAgICAgICAgaWYgbm90
IHBhdHRlcm46CiAgICAgICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cyA9IHNlbGYuYWxsX2tleXMu
Y29weSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaW1wb3J0IGZubWF0Y2gKICAgICAgICAg
ICAgc2VsZi5maWx0ZXJlZF9rZXlzID0gW10KICAgICAgICAgICAgcGF0dGVybl9sb3dlciA9IHBh
dHRlcm4ubG93ZXIoKQoKICAgICAgICAgICAgZm9yIGtleSwga2V5X3R5cGUgaW4gc2VsZi5hbGxf
a2V5czoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBrZXlfc3RyID0g
a2V5LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKS5sb3dlcigpCiAgICAgICAgICAg
ICAgICAgICAgIyDQn9C+0LTQtNC10YDQttC60LAgd2lsZGNhcmQg0LjQu9C4INC/0YDQvtGB0YLQ
vtCz0L4g0L/QvtC40YHQutCwCiAgICAgICAgICAgICAgICAgICAgaWYgJyonIGluIHBhdHRlcm4g
b3IgJz8nIGluIHBhdHRlcm46CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZubWF0Y2guZm5t
YXRjaChrZXlfc3RyLCBwYXR0ZXJuX2xvd2VyKToKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNlbGYuZmlsdGVyZWRfa2V5cy5hcHBlbmQoKGtleSwga2V5X3R5cGUpKQogICAgICAgICAgICAg
ICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBhdHRlcm5fbG93ZXIgaW4g
a2V5X3N0cjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cy5h
cHBlbmQoKGtleSwga2V5X3R5cGUpKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAg
ICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5yZWZyZXNoX2Rpc3BsYXkoKQoKICAgIGRlZiBh
X3JlZnJlc2hfZGlzcGxheShzZWxmKToKICAgICAgICAiIiLQntCx0L3QvtCy0LjRgtGMINC+0YLQ
vtCx0YDQsNC20LXQvdC40LUg0YHQv9C40YHQutCwIiIiCiAgICAgICAgbG9nZ2VyLmluZm8oZiJL
ZXlMaXN0Vmlldy5yZWZyZXNoX2Rpc3BsYXkgY2FsbGVkLCBmaWx0ZXJlZF9rZXlzOiB7bGVuKHNl
bGYuZmlsdGVyZWRfa2V5cyl9IikKCiAgICAgICAgc2VsZi53YWxrZXIuY2xlYXIoKQogICAgICAg
IGxvZ2dlci5pbmZvKCJXYWxrZXIgY2xlYXJlZCIpCgogICAgICAgICMg0KHQvtC30LTQsNC10Lwg
0LLQuNC00LbQtdGC0YsKICAgICAgICBhZGRlZF9jb3VudCA9IDAKICAgICAgICBmb3IgaWR4LCAo
a2V5LCBrZXlfdHlwZSkgaW4gZW51bWVyYXRlKHNlbGYuZmlsdGVyZWRfa2V5cyk6CiAgICAgICAg
ICAgIHRyeToKICAgICAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8INC60LXRiAogICAg
ICAgICAgICAgICAgaWYga2V5IGluIHNlbGYua2V5X2NhY2hlOgogICAgICAgICAgICAgICAgICAg
IGl0ZW0gPSBzZWxmLmtleV9jYWNoZVtrZXldCiAgICAgICAgICAgICAgICAgICAgaXRlbS5tYXJr
ZWQgPSBrZXkgaW4gc2VsZi5tYXJrZWRfa2V5cwogICAgICAgICAgICAgICAgICAgIGl0ZW0udXBk
YXRlX2Rpc3BsYXkoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAj
INCh0L7Qt9C00LDQtdC8INC90L7QstGL0Lkg0LLQuNC00LbQtdGCCiAgICAgICAgICAgICAgICAg
ICAgaXRlbSA9IEtleUxpc3RJdGVtKGtleSwga2V5X3R5cGUsIG1hcmtlZD1rZXkgaW4gc2VsZi5t
YXJrZWRfa2V5cykKICAgICAgICAgICAgICAgICAgICAjIOKchSDQmNCh0J/QoNCQ0JLQm9CV0J3Q
mNCVOiDQuNGB0L/QvtC70YzQt9GD0LXQvCDQvNC10YLQvtC0INC90LDQv9GA0Y/QvNGD0Y4KICAg
ICAgICAgICAgICAgICAgICB1cndpZC5jb25uZWN0X3NpZ25hbChpdGVtLCAnc2VsZWN0Jywgc2Vs
Zi5vbl9rZXlfc2VsZWN0ZWQpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5rZXlfY2FjaGVba2V5
XSA9IGl0ZW0KCiAgICAgICAgICAgICAgICAjINCe0LHQvtGA0LDRh9C40LLQsNC10Lwg0Lgg0LTQ
vtCx0LDQstC70Y/QtdC8CiAgICAgICAgICAgICAgICB3cmFwcGVkID0gdXJ3aWQuQXR0ck1hcChp
dGVtLCAna2V5X2l0ZW0nLCAna2V5X2l0ZW1fZm9jdXMnKQogICAgICAgICAgICAgICAgc2VsZi53
YWxrZXIuYXBwZW5kKHdyYXBwZWQpCiAgICAgICAgICAgICAgICBhZGRlZF9jb3VudCArPSAxCgog
ICAgICAgICAgICAgICAgaWYgYWRkZWRfY291bnQgPD0gMzoKICAgICAgICAgICAgICAgICAgICBs
b2dnZXIuaW5mbyhmIkFkZGVkIGtleSAje2FkZGVkX2NvdW50fToge2tleVs6NTBdIGlmIGxlbihr
ZXkpID4gNTAgZWxzZSBrZXl9IikKCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToK
ICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGNyZWF0aW5nIHdpZGdldCBmb3Ig
a2V5IHtrZXl9OiB7ZX0iLCBleGNfaW5mbz1UcnVlKQoKICAgICAgICBsb2dnZXIuaW5mbyhmIldh
bGtlciBub3cgaGFzIHtsZW4oc2VsZi53YWxrZXIpfSBpdGVtcyAoYWRkZWQge2FkZGVkX2NvdW50
fSkiKQoKICAgICAgICBzZWxmLnVwZGF0ZV9oZWFkZXIoKQogICAgICAgIGxvZ2dlci5pbmZvKCJL
ZXlMaXN0Vmlldy5yZWZyZXNoX2Rpc3BsYXkgY29tcGxldGVkIikKCiAgICBkZWYgcmVmcmVzaF9k
aXNwbGF5KHNlbGYpOgogICAgICAgICIiItCe0LHQvdC+0LLQuNGC0Ywg0L7RgtC+0LHRgNCw0LbQ
tdC90LjQtSDRgdC/0LjRgdC60LAiIiIKICAgICAgICBsb2dnZXIuaW5mbyhmIktleUxpc3RWaWV3
LnJlZnJlc2hfZGlzcGxheSBjYWxsZWQsIGZpbHRlcmVkX2tleXM6IHtsZW4oc2VsZi5maWx0ZXJl
ZF9rZXlzKX0iKQoKICAgICAgICBzZWxmLndhbGtlci5jbGVhcigpCiAgICAgICAgbG9nZ2VyLmlu
Zm8oIldhbGtlciBjbGVhcmVkIikKCiAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDQstC40LTQttC1
0YLRiwogICAgICAgIGFkZGVkX2NvdW50ID0gMAogICAgICAgIGZvciBpZHgsIChrZXksIGtleV90
eXBlKSBpbiBlbnVtZXJhdGUoc2VsZi5maWx0ZXJlZF9rZXlzKToKICAgICAgICAgICAgdHJ5Ogog
ICAgICAgICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwg0LrQtdGICiAgICAgICAgICAgICAg
ICBpZiBrZXkgaW4gc2VsZi5rZXlfY2FjaGU6CiAgICAgICAgICAgICAgICAgICAgaXRlbSA9IHNl
bGYua2V5X2NhY2hlW2tleV0KICAgICAgICAgICAgICAgICAgICBpdGVtLm1hcmtlZCA9IGtleSBp
biBzZWxmLm1hcmtlZF9rZXlzCiAgICAgICAgICAgICAgICAgICAgaXRlbS51cGRhdGVfZGlzcGxh
eSgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMg4pyFINCh0L7Q
t9C00LDQtdC8INCy0LjQtNC20LXRgiDRgSBjYWxsYmFjayDQvdCw0L/RgNGP0LzRg9GOCiAgICAg
ICAgICAgICAgICAgICAgaXRlbSA9IEtleUxpc3RJdGVtKAogICAgICAgICAgICAgICAgICAgICAg
ICBrZXksCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlLAogICAgICAgICAgICAgICAg
ICAgICAgICBvbl9zZWxlY3RfY2FsbGJhY2s9c2VsZi5vbl9rZXlfc2VsZWN0ZWQsICAjINC/0LXR
gNC10LTQsNC10Lwg0LzQtdGC0L7QtAogICAgICAgICAgICAgICAgICAgICAgICBtYXJrZWQ9a2V5
IGluIHNlbGYubWFya2VkX2tleXMKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAg
ICAgICAgc2VsZi5rZXlfY2FjaGVba2V5XSA9IGl0ZW0KCiAgICAgICAgICAgICAgICAjINCe0LHQ
vtGA0LDRh9C40LLQsNC10Lwg0Lgg0LTQvtCx0LDQstC70Y/QtdC8CiAgICAgICAgICAgICAgICB3
cmFwcGVkID0gdXJ3aWQuQXR0ck1hcChpdGVtLCAna2V5X2l0ZW0nLCAna2V5X2l0ZW1fZm9jdXMn
KQogICAgICAgICAgICAgICAgc2VsZi53YWxrZXIuYXBwZW5kKHdyYXBwZWQpCiAgICAgICAgICAg
ICAgICBhZGRlZF9jb3VudCArPSAxCgogICAgICAgICAgICAgICAgaWYgYWRkZWRfY291bnQgPD0g
MzoKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkFkZGVkIGtleSAje2FkZGVkX2Nv
dW50fToge2tleVs6NTBdIGlmIGxlbihrZXkpID4gNTAgZWxzZSBrZXl9IikKCiAgICAgICAgICAg
IGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVy
cm9yIGNyZWF0aW5nIHdpZGdldCBmb3Iga2V5IHtrZXl9OiB7ZX0iLCBleGNfaW5mbz1UcnVlKQoK
ICAgICAgICBsb2dnZXIuaW5mbyhmIldhbGtlciBub3cgaGFzIHtsZW4oc2VsZi53YWxrZXIpfSBp
dGVtcyAoYWRkZWQge2FkZGVkX2NvdW50fSkiKQoKICAgICAgICBzZWxmLnVwZGF0ZV9oZWFkZXIo
KQogICAgICAgIGxvZ2dlci5pbmZvKCJLZXlMaXN0Vmlldy5yZWZyZXNoX2Rpc3BsYXkgY29tcGxl
dGVkIikKCiAgICBkZWYgdXBkYXRlX2hlYWRlcihzZWxmKToKICAgICAgICAiIiLQntCx0L3QvtCy
0LjRgtGMINC30LDQs9C+0LvQvtCy0L7QuiDRgSDQuNC90YTQvtGA0LzQsNGG0LjQtdC5IiIiCiAg
ICAgICAgdG90YWwgPSBsZW4oc2VsZi5hbGxfa2V5cykKICAgICAgICBmaWx0ZXJlZCA9IGxlbihz
ZWxmLmZpbHRlcmVkX2tleXMpCiAgICAgICAgbWFya2VkID0gbGVuKHNlbGYubWFya2VkX2tleXMp
CgogICAgICAgIGlmIHNlbGYuZmlsdGVyX3BhdHRlcm46CiAgICAgICAgICAgIHRleHQgPSBmIiBL
ZXlzOiB7ZmlsdGVyZWR9L3t0b3RhbH0gKGZpbHRlcjoge3NlbGYuZmlsdGVyX3BhdHRlcm59KSIK
ICAgICAgICBlbHNlOgogICAgICAgICAgICB0ZXh0ID0gZiIgS2V5czoge3RvdGFsfSIKCiAgICAg
ICAgaWYgbWFya2VkID4gMDoKICAgICAgICAgICAgdGV4dCArPSBmIiB8IE1hcmtlZDoge21hcmtl
ZH0iCgogICAgICAgIHNlbGYuaGVhZGVyLnNldF90ZXh0KHRleHQpCgogICAgZGVmIG9uX2tleV9z
ZWxlY3RlZChzZWxmLCBrZXkpOgogICAgICAgICIiItCe0LHRgNCw0LHQvtGC0YfQuNC6INCy0YvQ
sdC+0YDQsCDQutC70Y7Rh9CwIiIiCiAgICAgICAgbG9nZ2VyLmluZm8oZiJLZXlMaXN0Vmlldy5v
bl9rZXlfc2VsZWN0ZWQgY2FsbGVkIikKICAgICAgICBsb2dnZXIuaW5mbyhmIlR5cGUgb2YgJ2tl
eSc6IHt0eXBlKGtleSl9IikKICAgICAgICBsb2dnZXIuaW5mbyhmIlZhbHVlIG9mICdrZXknOiB7
a2V5fSIpCiAgICAgICAgbG9nZ2VyLmluZm8oZiJOdW1iZXIgb2YgYXJncyByZWNlaXZlZDogMSIp
CgogICAgICAgICMg0J/QtdGA0LXQtNCw0LXQvCDQtNCw0LvRjNGI0LUg0YfQtdGA0LXQtyDRgdC4
0LPQvdCw0LsKICAgICAgICBsb2dnZXIuaW5mbygiQ2FsbGluZyB1cndpZC5lbWl0X3NpZ25hbC4u
LiIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cndpZC5lbWl0X3NpZ25hbChzZWxmLCAna2V5
X3NlbGVjdGVkJywga2V5KQogICAgICAgICAgICBsb2dnZXIuaW5mbygiZW1pdF9zaWduYWwgY29t
cGxldGVkIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dl
ci5lcnJvcihmImVtaXRfc2lnbmFsIGZhaWxlZDoge2V9IiwgZXhjX2luZm89VHJ1ZSkKCiAgICBk
ZWYgZ2V0X2ZvY3VzZWRfa2V5KHNlbGYpIC0+IE9wdGlvbmFsW2J5dGVzXToKICAgICAgICAiIiLQ
n9C+0LvRg9GH0LjRgtGMINC60LvRjtGHINCyINGE0L7QutGD0YHQtSIiIgogICAgICAgIGZvY3Vz
X3dpZGdldCwgZm9jdXNfcG9zID0gc2VsZi53YWxrZXIuZ2V0X2ZvY3VzKCkKICAgICAgICBpZiBm
b2N1c193aWRnZXQgYW5kIGlzaW5zdGFuY2UoZm9jdXNfd2lkZ2V0LmJhc2Vfd2lkZ2V0LCBLZXlM
aXN0SXRlbSk6CiAgICAgICAgICAgIHJldHVybiBmb2N1c193aWRnZXQuYmFzZV93aWRnZXQua2V5
CiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgZ2V0X21hcmtlZF9rZXlzKHNlbGYpIC0+IExp
c3RbYnl0ZXNdOgogICAgICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg0YHQv9C40YHQvtC6INC+0YLQ
vNC10YfQtdC90L3Ri9GFINC60LvRjtGH0LXQuSIiIgogICAgICAgIHJldHVybiBsaXN0KHNlbGYu
bWFya2VkX2tleXMpCgogICAgZGVmIG1hcmtfYnlfcGF0dGVybihzZWxmLCBwYXR0ZXJuOiBzdHIp
OgogICAgICAgICIiItCe0YLQvNC10YLQuNGC0Ywg0LrQu9GO0YfQuCDQv9C+INC/0LDRgtGC0LXR
gNC90YMiIiIKICAgICAgICBpbXBvcnQgZm5tYXRjaAogICAgICAgIHBhdHRlcm5fbG93ZXIgPSBw
YXR0ZXJuLmxvd2VyKCkKCiAgICAgICAgZm9yIGtleSwgXyBpbiBzZWxmLmFsbF9rZXlzOgogICAg
ICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBrZXlfc3RyID0ga2V5LmRlY29kZSgndXRmLTgn
LCBlcnJvcnM9J3JlcGxhY2UnKS5sb3dlcigpCiAgICAgICAgICAgICAgICBpZiBmbm1hdGNoLmZu
bWF0Y2goa2V5X3N0ciwgcGF0dGVybl9sb3dlcik6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5t
YXJrZWRfa2V5cy5hZGQoa2V5KQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBw
YXNzCgogICAgICAgIHNlbGYucmVmcmVzaF9kaXNwbGF5KCkKCiAgICBkZWYgdW5tYXJrX2FsbChz
ZWxmKToKICAgICAgICAiIiLQodC90Y/RgtGMINCy0YHQtSDQvtGC0LzQtdGC0LrQuCIiIgogICAg
ICAgIHNlbGYubWFya2VkX2tleXMuY2xlYXIoKQogICAgICAgIHNlbGYucmVmcmVzaF9kaXNwbGF5
KCkKCiAgICBkZWYgdG9nZ2xlX21hcmtfZm9jdXNlZChzZWxmKToKICAgICAgICAiIiLQn9C10YDQ
tdC60LvRjtGH0LjRgtGMINC+0YLQvNC10YLQutGDINC90LAg0YLQtdC60YPRidC10Lwg0Y3Qu9C1
0LzQtdC90YLQtSIiIgogICAgICAgIGZvY3VzX3dpZGdldCwgZm9jdXNfcG9zID0gc2VsZi53YWxr
ZXIuZ2V0X2ZvY3VzKCkKICAgICAgICBpZiBmb2N1c193aWRnZXQgYW5kIGlzaW5zdGFuY2UoZm9j
dXNfd2lkZ2V0LmJhc2Vfd2lkZ2V0LCBLZXlMaXN0SXRlbSk6CiAgICAgICAgICAgIGl0ZW0gPSBm
b2N1c193aWRnZXQuYmFzZV93aWRnZXQKICAgICAgICAgICAgaWYgaXRlbS5rZXkgaW4gc2VsZi5t
YXJrZWRfa2V5czoKICAgICAgICAgICAgICAgIHNlbGYubWFya2VkX2tleXMucmVtb3ZlKGl0ZW0u
a2V5KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5tYXJrZWRfa2V5cy5h
ZGQoaXRlbS5rZXkpCiAgICAgICAgICAgIGl0ZW0ubWFya2VkID0gaXRlbS5rZXkgaW4gc2VsZi5t
YXJrZWRfa2V5cwogICAgICAgICAgICBpdGVtLnVwZGF0ZV9kaXNwbGF5KCkKICAgICAgICAgICAg
c2VsZi51cGRhdGVfaGVhZGVyKCkKCiAgICAgICAgICAgICMg0J/QtdGA0LXRhdC+0LQg0Log0YHQ
u9C10LTRg9GO0YnQtdC80YMg0Y3Qu9C10LzQtdC90YLRgwogICAgICAgICAgICBpZiBmb2N1c19w
b3MgPCBsZW4oc2VsZi53YWxrZXIpIC0gMToKICAgICAgICAgICAgICAgIHNlbGYud2Fsa2VyLnNl
dF9mb2N1cyhmb2N1c19wb3MgKyAxKQoKCmNsYXNzIENvbW1hbmRQcm9tcHRXcmFwcGVyKHVyd2lk
LldpZGdldFdyYXApOgogICAgIiIi0J7QsdC10YDRgtC60LAg0LTQu9GPIEVkaXQg0YEg0L/QtdGA
0LXRhdCy0LDRgtC+0Lwg0YHRgtGA0LXQu9C+0Log0LLQstC10YDRhS/QstC90LjQtyIiIgoKICAg
IGRlZiBfX2luaXRfXyhzZWxmLCBlZGl0X3dpZGdldCwgb25fdXAsIG9uX2Rvd24sIG9uX2VudGVy
KToKICAgICAgICBzZWxmLmVkaXRfd2lkZ2V0ID0gZWRpdF93aWRnZXQKICAgICAgICBzZWxmLm9u
X3VwID0gb25fdXAKICAgICAgICBzZWxmLm9uX2Rvd24gPSBvbl9kb3duCiAgICAgICAgc2VsZi5v
bl9lbnRlciA9IG9uX2VudGVyCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhlZGl0X3dpZGdldCkK
CiAgICBkZWYgc2VsZWN0YWJsZShzZWxmKToKICAgICAgICAiIiLQktC40LTQttC10YIg0LzQvtC2
0LXRgiDQv9C+0LvRg9GH0LDRgtGMINGE0L7QutGD0YEiIiIKICAgICAgICByZXR1cm4gVHJ1ZQoK
ICAgIGRlZiBrZXlwcmVzcyhzZWxmLCBzaXplLCBrZXkpOgogICAgICAgICIiItCf0LXRgNC10YXQ
stCw0YLRi9Cy0LDQtdC8INC60LvQsNCy0LjRiNC4IiIiCiAgICAgICAgaWYga2V5ID09ICdjdHJs
IHAnIG9yIGtleSA9PSAncGFnZSB1cCc6CiAgICAgICAgICAgICMg4pyFINCS0YvQt9GL0LLQsNC1
0LwgY2FsbGJhY2sg0Lgg0LLQvtC30LLRgNCw0YnQsNC10LwgTm9uZSAo0L7QsdGA0LDQsdC+0YLQ
sNC90L4pCiAgICAgICAgICAgIHNlbGYub25fdXAoKQogICAgICAgICAgICByZXR1cm4gTm9uZQog
ICAgICAgIGVsaWYga2V5ID09ICdjdHJsIG4nIG9yIGtleSA9PSAncGFnZSBkb3duJzoKICAgICAg
ICAgICAgIyDinIUg0JLRi9C30YvQstCw0LXQvCBjYWxsYmFjayDQuCDQstC+0LfQstGA0LDRidCw
0LXQvCBOb25lICjQvtCx0YDQsNCx0L7RgtCw0L3QvikKICAgICAgICAgICAgc2VsZi5vbl9kb3du
KCkKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBlbGlmIGtleSA9PSAnZW50ZXInOgog
ICAgICAgICAgICAjIOKchSDQktGL0LfRi9Cy0LDQtdC8IGNhbGxiYWNrINC4INCy0L7Qt9Cy0YDQ
sNGJ0LDQtdC8IE5vbmUgKNC+0LHRgNCw0LHQvtGC0LDQvdC+KQogICAgICAgICAgICBzZWxmLm9u
X2VudGVyKCkKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAg
ICAjINCe0YHRgtCw0LvRjNC90YvQtSDQutC70LDQstC40YjQuCDQv9C10YDQtdC00LDQtdC8INCy
IEVkaXQKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZWRpdF93aWRnZXQua2V5cHJlc3Moc2l6ZSwg
a2V5KQoKCmNsYXNzIEFkZEtleURpYWxvZyh1cndpZC5XaWRnZXRXcmFwKToKICAgICIiItCU0LjQ
sNC70L7QsyDQtNC+0LHQsNCy0LvQtdC90LjRjy/RgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGP
INC60LvRjtGH0LAiIiIKICAgIHNpZ25hbHMgPSBbJ2Nsb3NlJ10KCiAgICBkZWYgX19pbml0X18o
c2VsZiwgY29ubmVjdGlvbjogUmVkaXNDb25uZWN0aW9uLCBvbl9zdWNjZXNzX2NhbGxiYWNrLCBl
ZGl0X2tleT1Ob25lKToKICAgICAgICBzZWxmLmNvbm5lY3Rpb24gPSBjb25uZWN0aW9uCiAgICAg
ICAgc2VsZi5vbl9zdWNjZXNzID0gb25fc3VjY2Vzc19jYWxsYmFjawogICAgICAgIHNlbGYuZWRp
dF9rZXkgPSBlZGl0X2tleQogICAgICAgIHNlbGYuY3VycmVudF90eXBlID0gJ3N0cmluZycKICAg
ICAgICBzZWxmLnZhbHVlX2NoYW5nZWQgPSBGYWxzZQoKICAgICAgICAjINCf0L7Qu9GPINCy0LLQ
vtC00LAg0YEg0YLQtdC80L3Ri9C8INGB0YLQuNC70LXQvAogICAgICAgIHNlbGYua2V5X2VkaXQg
PSB1cndpZC5BdHRyTWFwKAogICAgICAgICAgICB1cndpZC5FZGl0KCcnKSwgICMg4pyFINCj0LHQ
uNGA0LDQtdC8ICJLZXk6ICIg0L7RgtGB0Y7QtNCwCiAgICAgICAgICAgICdpbnB1dCcsCiAgICAg
ICAgICAgICdpbnB1dF9mb2N1cycKICAgICAgICApCgogICAgICAgIHNlbGYudHlwZV9ncm91cCA9
IFtdCgogICAgICAgICMg0KHQvtC30LTQsNC10Lwg0LrQvdC+0L/QutC4INGBINC+0LHRgNCw0LHQ
vtGC0YfQuNC60L7QvAogICAgICAgIHNlbGYudHlwZV9idXR0b25zID0gWwogICAgICAgICAgICB1
cndpZC5SYWRpb0J1dHRvbihzZWxmLnR5cGVfZ3JvdXAsICdTdHJpbmcnLCBzdGF0ZT1UcnVlLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbl9zdGF0ZV9jaGFuZ2U9bGFtYmRhIGJ0biwg
c3RhdGU6IHNlbGYub25fdHlwZV9jaGFuZ2VkKGJ0biwgc3RhdGUsICdzdHJpbmcnKSksCiAgICAg
ICAgICAgIHVyd2lkLlJhZGlvQnV0dG9uKHNlbGYudHlwZV9ncm91cCwgJ0hhc2gnLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBvbl9zdGF0ZV9jaGFuZ2U9bGFtYmRhIGJ0biwgc3RhdGU6
IHNlbGYub25fdHlwZV9jaGFuZ2VkKGJ0biwgc3RhdGUsICdoYXNoJykpLAogICAgICAgICAgICB1
cndpZC5SYWRpb0J1dHRvbihzZWxmLnR5cGVfZ3JvdXAsICdMaXN0JywKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgb25fc3RhdGVfY2hhbmdlPWxhbWJkYSBidG4sIHN0YXRlOiBzZWxmLm9u
X3R5cGVfY2hhbmdlZChidG4sIHN0YXRlLCAnbGlzdCcpKSwKICAgICAgICAgICAgdXJ3aWQuUmFk
aW9CdXR0b24oc2VsZi50eXBlX2dyb3VwLCAnU2V0JywKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgb25fc3RhdGVfY2hhbmdlPWxhbWJkYSBidG4sIHN0YXRlOiBzZWxmLm9uX3R5cGVfY2hh
bmdlZChidG4sIHN0YXRlLCAnc2V0JykpLAogICAgICAgICAgICB1cndpZC5SYWRpb0J1dHRvbihz
ZWxmLnR5cGVfZ3JvdXAsICdaU2V0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25f
c3RhdGVfY2hhbmdlPWxhbWJkYSBidG4sIHN0YXRlOiBzZWxmLm9uX3R5cGVfY2hhbmdlZChidG4s
IHN0YXRlLCAnenNldCcpKSwKICAgICAgICAgICAgdXJ3aWQuUmFkaW9CdXR0b24oc2VsZi50eXBl
X2dyb3VwLCAnQml0bWFwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25fc3RhdGVf
Y2hhbmdlPWxhbWJkYSBidG4sIHN0YXRlOiBzZWxmLm9uX3R5cGVfY2hhbmdlZChidG4sIHN0YXRl
LCAnYml0bWFwJykpLAogICAgICAgICAgICB1cndpZC5SYWRpb0J1dHRvbihzZWxmLnR5cGVfZ3Jv
dXAsICdTdHJlYW0nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbl9zdGF0ZV9jaGFu
Z2U9bGFtYmRhIGJ0biwgc3RhdGU6IHNlbGYub25fdHlwZV9jaGFuZ2VkKGJ0biwgc3RhdGUsICdz
dHJlYW0nKSksCiAgICAgICAgXQoKICAgICAgICAjINCj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C1
INCy0LjQtNC20LXRgtGLCiAgICAgICAgc2VsZi52YWx1ZV9lZGl0ID0gTm9uZQogICAgICAgIHNl
bGYudmFsdWVfY29udGFpbmVyID0gdXJ3aWQuUGlsZShbXSkKICAgICAgICBzZWxmLnR0bF9lZGl0
ID0gdXJ3aWQuQXR0ck1hcCgKICAgICAgICAgICAgdXJ3aWQuRWRpdCgnJyksICAjIOKchSDQo9Cx
0LjRgNCw0LXQvCAiVFRMOiAiINC+0YLRgdGO0LTQsAogICAgICAgICAgICAnaW5wdXQnLAogICAg
ICAgICAgICAnaW5wdXRfZm9jdXMnCiAgICAgICAgKQogICAgICAgIHNlbGYuZXJyb3JfdGV4dCA9
IHVyd2lkLlRleHQoJycpCiAgICAgICAgc2VsZi5jb25maXJtX2RpYWxvZyA9IE5vbmUKCiAgICAg
ICAgIyDQmtC90L7Qv9C60LgKICAgICAgICBzYXZlX2J0biA9IHVyd2lkLkJ1dHRvbignU2F2ZSAo
RjcpJywgb25fcHJlc3M9c2VsZi5vbl9zYXZlKQogICAgICAgIGNhbmNlbF9idG4gPSB1cndpZC5C
dXR0b24oJ0NhbmNlbCAoRXNjKScsIG9uX3ByZXNzPXNlbGYub25fY2FuY2VsKQoKICAgICAgICAj
IOKchSDQn9C+0LTQv9C40YHQuCDRgSDQsdC10LvRi9C8INC90LAg0YHQuNC90LXQvAogICAgICAg
IGtleV9sYWJlbCA9IHVyd2lkLkF0dHJNYXAodXJ3aWQuVGV4dCgnS2V5OicpLCAnaW5mb19sYWJl
bCcpCiAgICAgICAgdHlwZV9sYWJlbCA9IHVyd2lkLkF0dHJNYXAodXJ3aWQuVGV4dCgnVHlwZTon
KSwgJ2luZm9fbGFiZWwnKQogICAgICAgIHR0bF9sYWJlbCA9IHVyd2lkLkF0dHJNYXAodXJ3aWQu
VGV4dCgnVFRMIChzZWNvbmRzLCBvcHRpb25hbCk6JyksICdpbmZvX2xhYmVsJykKCiAgICAgICAg
IyDQmtC+0LzQv9C+0L3QvtCy0LrQsAogICAgICAgIHRpdGxlID0gJ0VkaXQgS2V5JyBpZiBlZGl0
X2tleSBlbHNlICdBZGQgTmV3IEtleScKICAgICAgICBib2R5ID0gWwogICAgICAgICAgICBzZWxm
LmVycm9yX3RleHQsCiAgICAgICAgICAgIHVyd2lkLkRpdmlkZXIoKSwKICAgICAgICAgICAga2V5
X2xhYmVsLCAgIyDinIUg0J/QvtC00L/QuNGB0Ywg0L7RgtC00LXQu9GM0L3QvgogICAgICAgICAg
ICBzZWxmLmtleV9lZGl0LAogICAgICAgICAgICB1cndpZC5EaXZpZGVyKCksCiAgICAgICAgICAg
IHR5cGVfbGFiZWwsICAjIOKchSDQn9C+0LTQv9C40YHRjCDQvtGC0LTQtdC70YzQvdC+CiAgICAg
ICAgXQogICAgICAgIGJvZHkuZXh0ZW5kKHNlbGYudHlwZV9idXR0b25zKQogICAgICAgIGJvZHku
ZXh0ZW5kKFsKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAogICAgICAgICAgICBzZWxmLnZh
bHVlX2NvbnRhaW5lciwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAogICAgICAgICAgICB0
dGxfbGFiZWwsICAjIOKchSDQn9C+0LTQv9C40YHRjCDQvtGC0LTQtdC70YzQvdC+CiAgICAgICAg
ICAgIHNlbGYudHRsX2VkaXQsCiAgICAgICAgICAgIHVyd2lkLkRpdmlkZXIoKSwKICAgICAgICAg
ICAgdXJ3aWQuQ29sdW1ucyhbCiAgICAgICAgICAgICAgICB1cndpZC5BdHRyTWFwKHNhdmVfYnRu
LCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1h
cChjYW5jZWxfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICBdKSwK
ICAgICAgICBdKQoKICAgICAgICBzZWxmLnBpbGUgPSB1cndpZC5QaWxlKGJvZHkpCiAgICAgICAg
ZmlsbCA9IHVyd2lkLkZpbGxlcihzZWxmLnBpbGUsIHZhbGlnbj0ndG9wJykKICAgICAgICBwYWRk
aW5nID0gdXJ3aWQuUGFkZGluZyhmaWxsLCBsZWZ0PTIsIHJpZ2h0PTIpCiAgICAgICAgbGluZWJv
eCA9IHVyd2lkLkxpbmVCb3gocGFkZGluZywgdGl0bGU9dGl0bGUpCgogICAgICAgIHN1cGVyKCku
X19pbml0X18odXJ3aWQuQXR0ck1hcChsaW5lYm94LCAnZGlhbG9nJykpCgogICAgICAgICMg0JXR
gdC70Lgg0YDQtdC20LjQvCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPLCDQt9Cw0LPRgNGD
0LbQsNC10Lwg0LTQsNC90L3Ri9C1CiAgICAgICAgaWYgZWRpdF9rZXk6CiAgICAgICAgICAgIHNl
bGYubG9hZF9rZXlfZGF0YShlZGl0X2tleSkKICAgICAgICBlbHNlOgogICAgICAgICAgICAjINCY
0L3QuNGG0LjQsNC70LjQt9C40YDRg9C10Lwg0LLQuNC00LbQtdGC0Ysg0LTQu9GPIFN0cmluZyAo
0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4pCiAgICAgICAgICAgIHNlbGYudXBkYXRlX3ZhbHVlX3dp
ZGdldCgnc3RyaW5nJykKCiAgICBkZWYgbG9hZF9rZXlfZGF0YShzZWxmLCBrZXkpOgogICAgICAg
ICIiItCX0LDQs9GA0YPQt9C40YLRjCDQtNCw0L3QvdGL0LUg0YHRg9GJ0LXRgdGC0LLRg9GO0YnQ
tdCz0L4g0LrQu9GO0YfQsCDQtNC70Y8g0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjyIiIgog
ICAgICAgIHRyeToKICAgICAgICAgICAgY2xpZW50ID0gc2VsZi5jb25uZWN0aW9uLmFjdGl2ZV9j
bGllbnQKCiAgICAgICAgICAgICMg0KPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0LjQvNGPINC6
0LvRjtGH0LAgKNCyINGA0LXQttC40LzQtSDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPINC9
0LXQu9GM0LfRjyDQvNC10L3Rj9GC0YwpCiAgICAgICAgICAgIHNlbGYua2V5X2VkaXQuYmFzZV93
aWRnZXQuc2V0X2VkaXRfdGV4dChrZXkpCiAgICAgICAgICAgIHNlbGYua2V5X2VkaXQuYmFzZV93
aWRnZXQuc2V0X2VkaXRfcG9zKGxlbihrZXkpKQoKICAgICAgICAgICAgIyDQn9C+0LvRg9GH0LDQ
tdC8INGC0LjQvyDQutC70Y7Rh9CwCiAgICAgICAgICAgIGtleV90eXBlID0gY2xpZW50LnR5cGUo
a2V5KQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGtleV90eXBlLCBieXRlcyk6CiAgICAgICAg
ICAgICAgICBrZXlfdHlwZSA9IGtleV90eXBlLmRlY29kZSgndXRmLTgnKQoKICAgICAgICAgICAg
IyDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDRgtC40L8KICAgICAgICAgICAgdHlwZV9pbmRl
eCA9IFsnc3RyaW5nJywgJ2hhc2gnLCAnbGlzdCcsICdzZXQnLCAnenNldCcsICdiaXRtYXAnLCAn
c3RyZWFtJ10uaW5kZXgoa2V5X3R5cGUpCiAgICAgICAgICAgIHNlbGYudHlwZV9idXR0b25zW3R5
cGVfaW5kZXhdLnNldF9zdGF0ZShUcnVlKQogICAgICAgICAgICBzZWxmLmN1cnJlbnRfdHlwZSA9
IGtleV90eXBlCiAgICAgICAgICAgIHNlbGYudXBkYXRlX3ZhbHVlX3dpZGdldChrZXlfdHlwZSkK
CiAgICAgICAgICAgICMg0JfQsNCz0YDRg9C20LDQtdC8INC30L3QsNGH0LXQvdC40LUg0LIg0LfQ
sNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCINGC0LjQv9CwCiAgICAgICAgICAgIGlmIGtleV90eXBl
ID09ICdzdHJpbmcnOgogICAgICAgICAgICAgICAgdmFsdWUgPSBjbGllbnQuZ2V0KGtleSkKICAg
ICAgICAgICAgICAgIGlmIHZhbHVlOgogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uo
dmFsdWUsIGJ5dGVzKToKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5kZWNv
ZGUoJ3V0Zi04JywgZXJyb3JzPSdyZXBsYWNlJykKICAgICAgICAgICAgICAgICAgICAjINCg0LDQ
t9Cx0LjQstCw0LXQvCDQv9C+IFxuINC90LAg0YHRgtGA0L7QutC4INC00LvRjyDQvNC90L7Qs9C+
0YHRgtGA0L7Rh9C90L7Qs9C+INGA0LXQtNCw0LrRgtC+0YDQsAogICAgICAgICAgICAgICAgICAg
IGxpbmVzID0gdmFsdWUuc3BsaXQoJ1xcbicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi52YWx1
ZV9lZGl0LmJhc2Vfd2lkZ2V0LnNldF9lZGl0X3RleHQoJ1xuJy5qb2luKGxpbmVzKSkKCiAgICAg
ICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ2hhc2gnOgogICAgICAgICAgICAgICAgaGFzaF9kYXRh
ID0gY2xpZW50LmhnZXRhbGwoa2V5KQogICAgICAgICAgICAgICAgbGluZXMgPSBbXQogICAgICAg
ICAgICAgICAgZm9yIGZpZWxkLCB2YWwgaW4gaGFzaF9kYXRhLml0ZW1zKCk6CiAgICAgICAgICAg
ICAgICAgICAgaWYgaXNpbnN0YW5jZShmaWVsZCwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAg
ICAgICBmaWVsZCA9IGZpZWxkLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAg
ICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsLCBieXRlcyk6CiAgICAgICAgICAgICAg
ICAgICAgICAgIHZhbCA9IHZhbC5kZWNvZGUoJ3V0Zi04JywgZXJyb3JzPSdyZXBsYWNlJykKICAg
ICAgICAgICAgICAgICAgICBsaW5lcy5hcHBlbmQoZiJ7ZmllbGR9Ont2YWx9IikKICAgICAgICAg
ICAgICAgIHNlbGYudmFsdWVfZWRpdC5iYXNlX3dpZGdldC5zZXRfZWRpdF90ZXh0KCdcbicuam9p
bihsaW5lcykpCgogICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdsaXN0JzoKICAgICAgICAg
ICAgICAgIGl0ZW1zID0gY2xpZW50LmxyYW5nZShrZXksIDAsIC0xKQogICAgICAgICAgICAgICAg
bGluZXMgPSBbXQogICAgICAgICAgICAgICAgZm9yIGl0ZW0gaW4gaXRlbXM6CiAgICAgICAgICAg
ICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBieXRlcyk6CiAgICAgICAgICAgICAgICAgICAg
ICAgIGl0ZW0gPSBpdGVtLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAg
ICAgICAgICAgICAgIGxpbmVzLmFwcGVuZChpdGVtKQogICAgICAgICAgICAgICAgc2VsZi52YWx1
ZV9lZGl0LmJhc2Vfd2lkZ2V0LnNldF9lZGl0X3RleHQoJ1xuJy5qb2luKGxpbmVzKSkKCiAgICAg
ICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3NldCc6CiAgICAgICAgICAgICAgICBtZW1iZXJzID0g
Y2xpZW50LnNtZW1iZXJzKGtleSkKICAgICAgICAgICAgICAgIGxpbmVzID0gW10KICAgICAgICAg
ICAgICAgIGZvciBtZW1iZXIgaW4gbWVtYmVyczoKICAgICAgICAgICAgICAgICAgICBpZiBpc2lu
c3RhbmNlKG1lbWJlciwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIgPSBt
ZW1iZXIuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScpCiAgICAgICAgICAgICAgICAg
ICAgbGluZXMuYXBwZW5kKG1lbWJlcikKICAgICAgICAgICAgICAgIHNlbGYudmFsdWVfZWRpdC5i
YXNlX3dpZGdldC5zZXRfZWRpdF90ZXh0KCdcbicuam9pbihsaW5lcykpCgogICAgICAgICAgICBl
bGlmIGtleV90eXBlID09ICd6c2V0JzoKICAgICAgICAgICAgICAgIGl0ZW1zID0gY2xpZW50Lnpy
YW5nZShrZXksIDAsIC0xLCB3aXRoc2NvcmVzPVRydWUpCiAgICAgICAgICAgICAgICBsaW5lcyA9
IFtdCiAgICAgICAgICAgICAgICBmb3IgbWVtYmVyLCBzY29yZSBpbiBpdGVtczoKICAgICAgICAg
ICAgICAgICAgICBpZiBpc2luc3RhbmNlKG1lbWJlciwgYnl0ZXMpOgogICAgICAgICAgICAgICAg
ICAgICAgICBtZW1iZXIgPSBtZW1iZXIuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScp
CiAgICAgICAgICAgICAgICAgICAgbGluZXMuYXBwZW5kKGYie21lbWJlcn06e3Njb3JlfSIpCiAg
ICAgICAgICAgICAgICBzZWxmLnZhbHVlX2VkaXQuYmFzZV93aWRnZXQuc2V0X2VkaXRfdGV4dCgn
XG4nLmpvaW4obGluZXMpKQoKICAgICAgICAgICAgIyDQn9C+0LvRg9GH0LDQtdC8IFRUTAogICAg
ICAgICAgICB0dGwgPSBjbGllbnQudHRsKGtleSkKICAgICAgICAgICAgaWYgdHRsID4gMDoKICAg
ICAgICAgICAgICAgIHNlbGYudHRsX2VkaXQuYmFzZV93aWRnZXQuc2V0X2VkaXRfdGV4dChzdHIo
dHRsKSkKCiAgICAgICAgICAgICMg0KHQsdGA0LDRgdGL0LLQsNC10Lwg0YTQu9Cw0LMg0LjQt9C8
0LXQvdC10L3QuNGPINC/0L7RgdC70LUg0LfQsNCz0YDRg9C30LrQuAogICAgICAgICAgICBzZWxm
LnZhbHVlX2NoYW5nZWQgPSBGYWxzZQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAg
ICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBsb2FkIGtleSBkYXRhOiB7ZX0iKQog
ICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoZiJGYWlsZWQgdG8gbG9hZCBrZXk6IHtlfSIpCgog
ICAgZGVmIGtleXByZXNzKHNlbGYsIHNpemUsIGtleSk6CiAgICAgICAgIiIi0J7QsdGA0LDQsdC+
0YLQutCwINC90LDQttCw0YLQuNC5INC60LvQsNCy0LjRiCIiIgogICAgICAgICMg0JXRgdC70Lgg
0L7RgtC60YDRi9GCINC00LjQsNC70L7QsyDQv9C+0LTRgtCy0LXRgNC20LTQtdC90LjRjywg0L/Q
tdGA0LXQtNCw0LXQvCDQtdC80YMg0YPQv9GA0LDQstC70LXQvdC40LUKICAgICAgICBpZiBzZWxm
LmNvbmZpcm1fZGlhbG9nOgogICAgICAgICAgICByZXR1cm4gc3VwZXIoKS5rZXlwcmVzcyhzaXpl
LCBrZXkpCgogICAgICAgIGlmIGtleSA9PSAnZXNjJzoKICAgICAgICAgICAgc2VsZi5yZXF1ZXN0
X2Nsb3NlKCkKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBlbGlmIGtleSA9PSAnZjcn
OgogICAgICAgICAgICBzZWxmLm9uX3NhdmUoTm9uZSkKICAgICAgICAgICAgcmV0dXJuIE5vbmUK
CiAgICAgICAgIyDQntGC0YHQu9C10LbQuNCy0LDQtdC8INC40LfQvNC10L3QtdC90LjRjyDQsiB2
YWx1ZV9lZGl0CiAgICAgICAgcmVzdWx0ID0gc3VwZXIoKS5rZXlwcmVzcyhzaXplLCBrZXkpCgog
ICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8LCDQsdGL0Lsg0LvQuCDQuNC30LzQtdC90LXQvSDR
gtC10LrRgdGCCiAgICAgICAgaWYgc2VsZi52YWx1ZV9lZGl0IGFuZCBoYXNhdHRyKHNlbGYudmFs
dWVfZWRpdCwgJ2Jhc2Vfd2lkZ2V0Jyk6CiAgICAgICAgICAgIGN1cnJlbnRfdGV4dCA9IHNlbGYu
dmFsdWVfZWRpdC5iYXNlX3dpZGdldC5nZXRfZWRpdF90ZXh0KCkKICAgICAgICAgICAgaWYgY3Vy
cmVudF90ZXh0LnN0cmlwKCk6CiAgICAgICAgICAgICAgICBzZWxmLnZhbHVlX2NoYW5nZWQgPSBU
cnVlCgogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgcmVxdWVzdF9jbG9zZShzZWxmKToK
ICAgICAgICAiIiLQl9Cw0L/RgNC+0YEg0L3QsCDQt9Cw0LrRgNGL0YLQuNC1INGBINC/0YDQvtCy
0LXRgNC60L7QuSDQuNC30LzQtdC90LXQvdC40LkiIiIKICAgICAgICBpZiBzZWxmLnZhbHVlX2No
YW5nZWQ6CiAgICAgICAgICAgIHNlbGYuc2hvd19jb25maXJtX2RpYWxvZygKICAgICAgICAgICAg
ICAgICJEaXNjYXJkIGNoYW5nZXM/IiwKICAgICAgICAgICAgICAgICJZb3UgaGF2ZSB1bnNhdmVk
IGNoYW5nZXMuIENsb3NlIGFueXdheT8iLAogICAgICAgICAgICAgICAgb25feWVzPWxhbWJkYTog
c2VsZi5fZW1pdCgnY2xvc2UnKSwKICAgICAgICAgICAgICAgIG9uX25vPWxhbWJkYTogTm9uZQog
ICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fZW1pdCgnY2xvc2Un
KQoKICAgIGRlZiBvbl90eXBlX2NoYW5nZWQoc2VsZiwgYnV0dG9uLCBuZXdfc3RhdGUsIHR5cGVf
bmFtZSk6CiAgICAgICAgIiIi0J7QsdGA0LDQsdC+0YLRh9C40Log0LjQt9C80LXQvdC10L3QuNGP
INGC0LjQv9CwINGBINC/0L7QtNGC0LLQtdGA0LbQtNC10L3QuNC10LwiIiIKICAgICAgICBpZiBu
b3QgbmV3X3N0YXRlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgdHlwZV9uYW1lID09
IHNlbGYuY3VycmVudF90eXBlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyDQldGB0LvQ
uCDQtdGB0YLRjCDQvdC10YHQvtGF0YDQsNC90LXQvdC90YvQtSDQuNC30LzQtdC90LXQvdC40Y8s
INGB0L/RgNCw0YjQuNCy0LDQtdC8CiAgICAgICAgaWYgc2VsZi52YWx1ZV9jaGFuZ2VkOgogICAg
ICAgICAgICAjINCX0LDQv9C+0LzQuNC90LDQtdC8INC90L7QstGL0Lkg0YLQuNC/CiAgICAgICAg
ICAgIHNlbGYucGVuZGluZ190eXBlID0gdHlwZV9uYW1lCgogICAgICAgICAgICBzZWxmLnNob3df
Y29uZmlybV9kaWFsb2coCiAgICAgICAgICAgICAgICAiQ2hhbmdlIHR5cGU/IiwKICAgICAgICAg
ICAgICAgICJLZWVwIGN1cnJlbnQgdmFsdWUgb3IgY2xlYXI/IiwKICAgICAgICAgICAgICAgIHll
c190ZXh0PSJLZWVwIiwKICAgICAgICAgICAgICAgIG5vX3RleHQ9IkNsZWFyIiwKICAgICAgICAg
ICAgICAgIG9uX3llcz1sYW1iZGE6IHNlbGYuY2hhbmdlX3R5cGVfa2VlcF92YWx1ZSh0eXBlX25h
bWUpLAogICAgICAgICAgICAgICAgb25fbm89bGFtYmRhOiBzZWxmLmNoYW5nZV90eXBlX2NsZWFy
X3ZhbHVlKHR5cGVfbmFtZSkKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAg
IGxvZ2dlci5kZWJ1ZyhmIlR5cGUgY2hhbmdlZCBmcm9tIHtzZWxmLmN1cnJlbnRfdHlwZX0gdG8g
e3R5cGVfbmFtZX0iKQogICAgICAgICAgICBzZWxmLmN1cnJlbnRfdHlwZSA9IHR5cGVfbmFtZQog
ICAgICAgICAgICBzZWxmLnVwZGF0ZV92YWx1ZV93aWRnZXQodHlwZV9uYW1lKQoKICAgIGRlZiBj
aGFuZ2VfdHlwZV9rZWVwX3ZhbHVlKHNlbGYsIHR5cGVfbmFtZSk6CiAgICAgICAgIiIi0KHQvNC1
0L3QuNGC0Ywg0YLQuNC/LCDRgdC+0YXRgNCw0L3QuNCyINC30L3QsNGH0LXQvdC40LUiIiIKICAg
ICAgICBvbGRfdmFsdWUgPSBzZWxmLmdldF92YWx1ZV90ZXh0KCkKICAgICAgICBzZWxmLmN1cnJl
bnRfdHlwZSA9IHR5cGVfbmFtZQogICAgICAgIHNlbGYudXBkYXRlX3ZhbHVlX3dpZGdldCh0eXBl
X25hbWUpCiAgICAgICAgIyDQn9GL0YLQsNC10LzRgdGPINGB0L7RhdGA0LDQvdC40YLRjCDRgdGC
0LDRgNC+0LUg0LfQvdCw0YfQtdC90LjQtQogICAgICAgIGlmIHNlbGYudmFsdWVfZWRpdCBhbmQg
b2xkX3ZhbHVlOgogICAgICAgICAgICBzZWxmLnZhbHVlX2VkaXQuYmFzZV93aWRnZXQuc2V0X2Vk
aXRfdGV4dChvbGRfdmFsdWUpCgogICAgZGVmIGNoYW5nZV90eXBlX2NsZWFyX3ZhbHVlKHNlbGYs
IHR5cGVfbmFtZSk6CiAgICAgICAgIiIi0KHQvNC10L3QuNGC0Ywg0YLQuNC/LCDQvtGH0LjRgdGC
0LjQsiDQt9C90LDRh9C10L3QuNC1IiIiCiAgICAgICAgc2VsZi5jdXJyZW50X3R5cGUgPSB0eXBl
X25hbWUKICAgICAgICBzZWxmLnVwZGF0ZV92YWx1ZV93aWRnZXQodHlwZV9uYW1lKQogICAgICAg
IHNlbGYudmFsdWVfY2hhbmdlZCA9IEZhbHNlCgogICAgZGVmIHNob3dfY29uZmlybV9kaWFsb2co
c2VsZiwgdGl0bGUsIG1lc3NhZ2UsIHllc190ZXh0PSJZZXMiLCBub190ZXh0PSJObyIsIG9uX3ll
cz1Ob25lLCBvbl9ubz1Ob25lKToKICAgICAgICAiIiLQn9C+0LrQsNC30LDRgtGMINC00LjQsNC7
0L7QsyDQv9C+0LTRgtCy0LXRgNC20LTQtdC90LjRjyIiIgogICAgICAgIHllc19idG4gPSB1cndp
ZC5CdXR0b24oeWVzX3RleHQsIG9uX3ByZXNzPWxhbWJkYSBidG46IHNlbGYuY2xvc2VfY29uZmly
bV9kaWFsb2cob25feWVzKSkKICAgICAgICBub19idG4gPSB1cndpZC5CdXR0b24obm9fdGV4dCwg
b25fcHJlc3M9bGFtYmRhIGJ0bjogc2VsZi5jbG9zZV9jb25maXJtX2RpYWxvZyhvbl9ubykpCgog
ICAgICAgIHBpbGUgPSB1cndpZC5QaWxlKFsKICAgICAgICAgICAgdXJ3aWQuVGV4dChtZXNzYWdl
KSwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAogICAgICAgICAgICB1cndpZC5Db2x1bW5z
KFsKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoeWVzX2J0biwgJ2J1dHRvbicsICdidXR0
b25fZm9jdXMnKSwKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAobm9fYnRuLCAnYnV0dG9u
JywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICBdKSwKICAgICAgICBdKQoKICAgICAgICBs
aW5lYm94ID0gdXJ3aWQuTGluZUJveCh1cndpZC5GaWxsZXIocGlsZSksIHRpdGxlPXRpdGxlKQog
ICAgICAgIG92ZXJsYXkgPSB1cndpZC5PdmVybGF5KAogICAgICAgICAgICB1cndpZC5BdHRyTWFw
KGxpbmVib3gsICdkaWFsb2cnKSwKICAgICAgICAgICAgc2VsZi5fdywKICAgICAgICAgICAgYWxp
Z249J2NlbnRlcicsCiAgICAgICAgICAgIHdpZHRoPSgncmVsYXRpdmUnLCA2MCksCiAgICAgICAg
ICAgIHZhbGlnbj0nbWlkZGxlJywKICAgICAgICAgICAgaGVpZ2h0PSgncmVsYXRpdmUnLCAzMCkK
ICAgICAgICApCgogICAgICAgIHNlbGYuY29uZmlybV9kaWFsb2cgPSBvdmVybGF5CiAgICAgICAg
c2VsZi5fdyA9IG92ZXJsYXkKCiAgICBkZWYgY2xvc2VfY29uZmlybV9kaWFsb2coc2VsZiwgY2Fs
bGJhY2spOgogICAgICAgICIiItCX0LDQutGA0YvRgtGMINC00LjQsNC70L7QsyDQv9C+0LTRgtCy
0LXRgNC20LTQtdC90LjRjyIiIgogICAgICAgICMg0JLQvtGB0YHRgtCw0L3QsNCy0LvQuNCy0LDQ
tdC8INC40YHRhdC+0LTQvdGL0Lkg0LLQuNC00LbQtdGCCiAgICAgICAgc2VsZi5fdyA9IHVyd2lk
LkF0dHJNYXAoCiAgICAgICAgICAgIHVyd2lkLkxpbmVCb3goCiAgICAgICAgICAgICAgICB1cndp
ZC5QYWRkaW5nKAogICAgICAgICAgICAgICAgICAgIHVyd2lkLkZpbGxlcihzZWxmLnBpbGUsIHZh
bGlnbj0ndG9wJyksCiAgICAgICAgICAgICAgICAgICAgbGVmdD0yLCByaWdodD0yCiAgICAgICAg
ICAgICAgICApLAogICAgICAgICAgICAgICAgdGl0bGU9J0VkaXQgS2V5JyBpZiBzZWxmLmVkaXRf
a2V5IGVsc2UgJ0FkZCBOZXcgS2V5JwogICAgICAgICAgICApLAogICAgICAgICAgICAnZGlhbG9n
JwogICAgICAgICkKICAgICAgICBzZWxmLmNvbmZpcm1fZGlhbG9nID0gTm9uZQoKICAgICAgICAj
INCS0YvQv9C+0LvQvdGP0LXQvCBjYWxsYmFjawogICAgICAgIGlmIGNhbGxiYWNrOgogICAgICAg
ICAgICBjYWxsYmFjaygpCgogICAgZGVmIHVwZGF0ZV92YWx1ZV93aWRnZXQoc2VsZiwga2V5X3R5
cGUpOgogICAgICAgICIiItCe0LHQvdC+0LLQuNGC0Ywg0LLQuNC00LbQtdGCINC00LvRjyDQstCy
0L7QtNCwINC30L3QsNGH0LXQvdC40Y8g0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCINGC
0LjQv9CwIiIiCiAgICAgICAgc2VsZi5jdXJyZW50X3R5cGUgPSBrZXlfdHlwZQoKICAgICAgICAj
INCe0YfQuNGJ0LDQtdC8INC60L7QvdGC0LXQudC90LXRgAogICAgICAgIHNlbGYudmFsdWVfY29u
dGFpbmVyLmNvbnRlbnRzLmNsZWFyKCkKCiAgICAgICAgIyDinIUg0J/QvtC00L/QuNGB0Ywg0LTQ
u9GPINC30L3QsNGH0LXQvdC40Y8KICAgICAgICB2YWx1ZV9sYWJlbCA9IHVyd2lkLkF0dHJNYXAo
dXJ3aWQuVGV4dCgnVmFsdWU6JyksICdpbmZvX2xhYmVsJykKICAgICAgICBzZWxmLnZhbHVlX2Nv
bnRhaW5lci5jb250ZW50cy5hcHBlbmQoKHZhbHVlX2xhYmVsLCAoJ3BhY2snLCBOb25lKSkpCgog
ICAgICAgIGlmIGtleV90eXBlID09ICdzdHJpbmcnOgogICAgICAgICAgICAjINCc0L3QvtCz0L7R
gdGC0YDQvtGH0L3QvtC1INC/0L7Qu9C1INC00LvRjyBzdHJpbmcKICAgICAgICAgICAgc2VsZi52
YWx1ZV9lZGl0ID0gdXJ3aWQuQXR0ck1hcCgKICAgICAgICAgICAgICAgIHVyd2lkLkVkaXQoJycs
IG11bHRpbGluZT1UcnVlKSwKICAgICAgICAgICAgICAgICdpbnB1dCcsCiAgICAgICAgICAgICAg
ICAnaW5wdXRfZm9jdXMnCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi52YWx1ZV9jb250
YWluZXIuY29udGVudHMuYXBwZW5kKAogICAgICAgICAgICAgICAgKHVyd2lkLkxpbmVCb3goc2Vs
Zi52YWx1ZV9lZGl0KSwgKCd3ZWlnaHQnLCAxKSkKICAgICAgICAgICAgKQoKICAgICAgICBlbGlm
IGtleV90eXBlID09ICdoYXNoJzoKICAgICAgICAgICAgIyDQlNC70Y8gaGFzaCAtINGC0LDQsdC7
0LjRhtCwIGtleS12YWx1ZSDQv9Cw0YAKICAgICAgICAgICAgaGVscF90ZXh0ID0gdXJ3aWQuVGV4
dCgnRW50ZXIga2V5LXZhbHVlIHBhaXJzIChvbmUgcGVyIGxpbmUsIGZvcm1hdDoga2V5PXZhbHVl
KScpCiAgICAgICAgICAgIHNlbGYudmFsdWVfZWRpdCA9IHVyd2lkLkF0dHJNYXAoCiAgICAgICAg
ICAgICAgICB1cndpZC5FZGl0KCcnLCBtdWx0aWxpbmU9VHJ1ZSksCiAgICAgICAgICAgICAgICAn
aW5wdXQnLAogICAgICAgICAgICAgICAgJ2lucHV0X2ZvY3VzJwogICAgICAgICAgICApCiAgICAg
ICAgICAgIHNlbGYudmFsdWVfY29udGFpbmVyLmNvbnRlbnRzLmV4dGVuZChbCiAgICAgICAgICAg
ICAgICAoaGVscF90ZXh0LCAoJ3BhY2snLCBOb25lKSksCiAgICAgICAgICAgICAgICAodXJ3aWQu
TGluZUJveChzZWxmLnZhbHVlX2VkaXQpLCAoJ3dlaWdodCcsIDEpKQogICAgICAgICAgICBdKQoK
ICAgICAgICBlbGlmIGtleV90eXBlID09ICdsaXN0JzoKICAgICAgICAgICAgIyDQlNC70Y8gbGlz
dCAtINC+0LTQvdC+INC30L3QsNGH0LXQvdC40LUg0L3QsCDRgdGC0YDQvtC60YMKICAgICAgICAg
ICAgaGVscF90ZXh0ID0gdXJ3aWQuVGV4dCgnRW50ZXIgbGlzdCBpdGVtcyAob25lIHBlciBsaW5l
KScpCiAgICAgICAgICAgIHNlbGYudmFsdWVfZWRpdCA9IHVyd2lkLkF0dHJNYXAoCiAgICAgICAg
ICAgICAgICB1cndpZC5FZGl0KCcnLCBtdWx0aWxpbmU9VHJ1ZSksCiAgICAgICAgICAgICAgICAn
aW5wdXQnLAogICAgICAgICAgICAgICAgJ2lucHV0X2ZvY3VzJwogICAgICAgICAgICApCiAgICAg
ICAgICAgIHNlbGYudmFsdWVfY29udGFpbmVyLmNvbnRlbnRzLmV4dGVuZChbCiAgICAgICAgICAg
ICAgICAoaGVscF90ZXh0LCAoJ3BhY2snLCBOb25lKSksCiAgICAgICAgICAgICAgICAodXJ3aWQu
TGluZUJveChzZWxmLnZhbHVlX2VkaXQpLCAoJ3dlaWdodCcsIDEpKQogICAgICAgICAgICBdKQoK
ICAgICAgICBlbGlmIGtleV90eXBlID09ICdzZXQnOgogICAgICAgICAgICAjINCU0LvRjyBzZXQg
LSDQvtC00L3QviDQt9C90LDRh9C10L3QuNC1INC90LAg0YHRgtGA0L7QutGDCiAgICAgICAgICAg
IGhlbHBfdGV4dCA9IHVyd2lkLlRleHQoJ0VudGVyIHNldCBtZW1iZXJzIChvbmUgcGVyIGxpbmUp
JykKICAgICAgICAgICAgc2VsZi52YWx1ZV9lZGl0ID0gdXJ3aWQuQXR0ck1hcCgKICAgICAgICAg
ICAgICAgIHVyd2lkLkVkaXQoJycsIG11bHRpbGluZT1UcnVlKSwKICAgICAgICAgICAgICAgICdp
bnB1dCcsCiAgICAgICAgICAgICAgICAnaW5wdXRfZm9jdXMnCiAgICAgICAgICAgICkKICAgICAg
ICAgICAgc2VsZi52YWx1ZV9jb250YWluZXIuY29udGVudHMuZXh0ZW5kKFsKICAgICAgICAgICAg
ICAgIChoZWxwX3RleHQsICgncGFjaycsIE5vbmUpKSwKICAgICAgICAgICAgICAgICh1cndpZC5M
aW5lQm94KHNlbGYudmFsdWVfZWRpdCksICgnd2VpZ2h0JywgMSkpCiAgICAgICAgICAgIF0pCgog
ICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3pzZXQnOgogICAgICAgICAgICAjINCU0LvRjyB6c2V0
IC0gc2NvcmU6bWVtYmVyINC/0LDRgNGLCiAgICAgICAgICAgIGhlbHBfdGV4dCA9IHVyd2lkLlRl
eHQoJ0VudGVyIHNjb3JlZCBpdGVtcyAoZm9ybWF0OiBzY29yZTptZW1iZXIsIG9uZSBwZXIgbGlu
ZSknKQogICAgICAgICAgICBzZWxmLnZhbHVlX2VkaXQgPSB1cndpZC5BdHRyTWFwKAogICAgICAg
ICAgICAgICAgdXJ3aWQuRWRpdCgnJywgbXVsdGlsaW5lPVRydWUpLAogICAgICAgICAgICAgICAg
J2lucHV0JywKICAgICAgICAgICAgICAgICdpbnB1dF9mb2N1cycKICAgICAgICAgICAgKQogICAg
ICAgICAgICBzZWxmLnZhbHVlX2NvbnRhaW5lci5jb250ZW50cy5leHRlbmQoWwogICAgICAgICAg
ICAgICAgKGhlbHBfdGV4dCwgKCdwYWNrJywgTm9uZSkpLAogICAgICAgICAgICAgICAgKHVyd2lk
LkxpbmVCb3goc2VsZi52YWx1ZV9lZGl0KSwgKCd3ZWlnaHQnLCAxKSkKICAgICAgICAgICAgXSkK
CiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyDQlNC70Y8g0L7RgdGC0LDQu9GM0L3Ri9GFINGC
0LjQv9C+0LIKICAgICAgICAgICAgaGVscF90ZXh0ID0gdXJ3aWQuVGV4dChmJ3trZXlfdHlwZX0g
dHlwZSAtIHVzZSBhcHByb3ByaWF0ZSBmb3JtYXQnKQogICAgICAgICAgICBzZWxmLnZhbHVlX2Vk
aXQgPSB1cndpZC5BdHRyTWFwKAogICAgICAgICAgICAgICAgdXJ3aWQuRWRpdCgnJywgbXVsdGls
aW5lPVRydWUpLAogICAgICAgICAgICAgICAgJ2lucHV0JywKICAgICAgICAgICAgICAgICdpbnB1
dF9mb2N1cycKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLnZhbHVlX2NvbnRhaW5lci5j
b250ZW50cy5leHRlbmQoWwogICAgICAgICAgICAgICAgKGhlbHBfdGV4dCwgKCdwYWNrJywgTm9u
ZSkpLAogICAgICAgICAgICAgICAgKHVyd2lkLkxpbmVCb3goc2VsZi52YWx1ZV9lZGl0KSwgKCd3
ZWlnaHQnLCAxKSkKICAgICAgICAgICAgXSkKCiAgICBkZWYgZ2V0X3ZhbHVlX3RleHQoc2VsZikg
LT4gc3RyOgogICAgICAgICIiItCj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INC80LXRgtC+0LQg
0L/QvtC70YPRh9C10L3QuNGPINGC0LXQutGB0YLQsCDQuNC3IHZhbHVlX2VkaXQiIiIKICAgICAg
ICBpZiBzZWxmLnZhbHVlX2VkaXQ6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnZhbHVlX2VkaXQu
YmFzZV93aWRnZXQuZ2V0X2VkaXRfdGV4dCgpLnN0cmlwKCkKICAgICAgICByZXR1cm4gJycKCiAg
ICBkZWYgb25fc2F2ZShzZWxmLCBidXR0b24pOgogICAgICAgICIiItCh0L7RhdGA0LDQvdC10L3Q
uNC1INC60LvRjtGH0LAiIiIKICAgICAgICBrZXkgPSBzZWxmLmtleV9lZGl0LmJhc2Vfd2lkZ2V0
LmdldF9lZGl0X3RleHQoKS5zdHJpcCgpCiAgICAgICAga2V5X3R5cGUgPSBzZWxmLmN1cnJlbnRf
dHlwZQogICAgICAgIHR0bF90ZXh0ID0gc2VsZi50dGxfZWRpdC5iYXNlX3dpZGdldC5nZXRfZWRp
dF90ZXh0KCkuc3RyaXAoKQoKICAgICAgICBpZiBub3Qga2V5OgogICAgICAgICAgICBzZWxmLnNo
b3dfZXJyb3IoIktleSBjYW5ub3QgYmUgZW1wdHkiKQogICAgICAgICAgICByZXR1cm4KCiAgICAg
ICAgIyDQn9GA0L7QstC10YDQutCwINC00LvRjyDQutC70LDRgdGC0LXRgNCwCiAgICAgICAgaWYg
c2VsZi5jb25uZWN0aW9uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgIGlmICd7JyBpbiBrZXkgYW5k
ICd9JyBpbiBrZXk6CiAgICAgICAgICAgICAgICBpbXBvcnQgcmUKICAgICAgICAgICAgICAgIGlm
IG5vdCByZS5zZWFyY2gocidcey4qP1x9Jywga2V5KToKICAgICAgICAgICAgICAgICAgICBzZWxm
LnNob3dfZXJyb3IoIkludmFsaWQgaGFzaCB0YWcgZm9ybWF0LiBVc2Uge3RhZ30gZm9ybWF0LiIp
CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgdHRs
ID0gaW50KHR0bF90ZXh0KSBpZiB0dGxfdGV4dCBlbHNlIE5vbmUKICAgICAgICAgICAgY2xpZW50
ID0gc2VsZi5jb25uZWN0aW9uLmFjdGl2ZV9jbGllbnQKICAgICAgICAgICAgdmFsdWUgPSBzZWxm
LmdldF92YWx1ZV90ZXh0KCkKCiAgICAgICAgICAgICMg0J/RgNC4INGA0LXQtNCw0LrRgtC40YDQ
vtCy0LDQvdC40Lgg0YPQtNCw0LvRj9C10Lwg0YHRgtCw0YDRi9C5INC60LvRjtGHINC10YHQu9C4
INGC0LjQvyDQuNC30LzQtdC90LjQu9GB0Y8KICAgICAgICAgICAgaWYgc2VsZi5lZGl0X2tleToK
ICAgICAgICAgICAgICAgIG9sZF90eXBlID0gY2xpZW50LnR5cGUoc2VsZi5lZGl0X2tleSkKICAg
ICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uob2xkX3R5cGUsIGJ5dGVzKToKICAgICAgICAgICAg
ICAgICAgICBvbGRfdHlwZSA9IG9sZF90eXBlLmRlY29kZSgndXRmLTgnKQogICAgICAgICAgICAg
ICAgaWYgb2xkX3R5cGUgIT0ga2V5X3R5cGU6CiAgICAgICAgICAgICAgICAgICAgY2xpZW50LmRl
bGV0ZShzZWxmLmVkaXRfa2V5KQoKICAgICAgICAgICAgaWYga2V5X3R5cGUgPT0gJ3N0cmluZyc6
CiAgICAgICAgICAgICAgICBpZiBub3QgdmFsdWU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5z
aG93X2Vycm9yKCJWYWx1ZSBjYW5ub3QgYmUgZW1wdHkiKQogICAgICAgICAgICAgICAgICAgIHJl
dHVybgogICAgICAgICAgICAgICAgIyDQn9GA0LXQvtCx0YDQsNC30YPQtdC8INC80L3QvtCz0L7R
gdGC0YDQvtGH0L3Ri9C5INCy0LLQvtC0INCyINC+0LTQvdGDINGB0YLRgNC+0LrRgyDRgSBcbgog
ICAgICAgICAgICAgICAgZmluYWxfdmFsdWUgPSAnXFxuJy5qb2luKHZhbHVlLnNwbGl0KCdcbicp
KQogICAgICAgICAgICAgICAgY2xpZW50LnNldChrZXksIGZpbmFsX3ZhbHVlKQoKICAgICAgICAg
ICAgZWxpZiBrZXlfdHlwZSA9PSAnaGFzaCc6CiAgICAgICAgICAgICAgICBwYWlycyA9IHt9CiAg
ICAgICAgICAgICAgICBmb3IgbGluZSBpbiB2YWx1ZS5zcGxpdCgnXG4nKToKICAgICAgICAgICAg
ICAgICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgaWYgJzonIGlu
IGxpbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGssIHYgPSBsaW5lLnNwbGl0KCc6JywgMSkK
ICAgICAgICAgICAgICAgICAgICAgICAgcGFpcnNbay5zdHJpcCgpXSA9IHYuc3RyaXAoKQogICAg
ICAgICAgICAgICAgaWYgbm90IHBhaXJzOgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd19l
cnJvcigiQXQgbGVhc3Qgb25lIGZpZWxkOnZhbHVlIHBhaXIgcmVxdWlyZWQiKQogICAgICAgICAg
ICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgIyDQn9GA0Lgg0YDQtdC00LDQutGC0LjR
gNC+0LLQsNC90LjQuCDRgdC90LDRh9Cw0LvQsCDQvtGH0LjRidCw0LXQvAogICAgICAgICAgICAg
ICAgaWYgc2VsZi5lZGl0X2tleToKICAgICAgICAgICAgICAgICAgICBjbGllbnQuZGVsZXRlKGtl
eSkKICAgICAgICAgICAgICAgIGNsaWVudC5oc2V0KGtleSwgbWFwcGluZz1wYWlycykKCiAgICAg
ICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ2xpc3QnOgogICAgICAgICAgICAgICAgaXRlbXMgPSBb
aXRlbS5zdHJpcCgpIGZvciBpdGVtIGluIHZhbHVlLnNwbGl0KCdcbicpIGlmIGl0ZW0uc3RyaXAo
KV0KICAgICAgICAgICAgICAgIGlmIG5vdCBpdGVtczoKICAgICAgICAgICAgICAgICAgICBzZWxm
LnNob3dfZXJyb3IoIkF0IGxlYXN0IG9uZSBlbGVtZW50IHJlcXVpcmVkIikKICAgICAgICAgICAg
ICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICMg0J/RgNC4INGA0LXQtNCw0LrRgtC40YDQ
vtCy0LDQvdC40Lgg0YHQvdCw0YfQsNC70LAg0L7Rh9C40YnQsNC10LwKICAgICAgICAgICAgICAg
IGlmIHNlbGYuZWRpdF9rZXk6CiAgICAgICAgICAgICAgICAgICAgY2xpZW50LmRlbGV0ZShrZXkp
CiAgICAgICAgICAgICAgICBjbGllbnQucnB1c2goa2V5LCAqaXRlbXMpCgogICAgICAgICAgICBl
bGlmIGtleV90eXBlID09ICdzZXQnOgogICAgICAgICAgICAgICAgaXRlbXMgPSBbaXRlbS5zdHJp
cCgpIGZvciBpdGVtIGluIHZhbHVlLnNwbGl0KCdcbicpIGlmIGl0ZW0uc3RyaXAoKV0KICAgICAg
ICAgICAgICAgIGlmIG5vdCBpdGVtczoKICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dfZXJy
b3IoIkF0IGxlYXN0IG9uZSBtZW1iZXIgcmVxdWlyZWQiKQogICAgICAgICAgICAgICAgICAgIHJl
dHVybgogICAgICAgICAgICAgICAgIyDQn9GA0Lgg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQ
uCDRgdC90LDRh9Cw0LvQsCDQvtGH0LjRidCw0LXQvAogICAgICAgICAgICAgICAgaWYgc2VsZi5l
ZGl0X2tleToKICAgICAgICAgICAgICAgICAgICBjbGllbnQuZGVsZXRlKGtleSkKICAgICAgICAg
ICAgICAgIGNsaWVudC5zYWRkKGtleSwgKml0ZW1zKQoKICAgICAgICAgICAgZWxpZiBrZXlfdHlw
ZSA9PSAnenNldCc6CiAgICAgICAgICAgICAgICBwYWlycyA9IHt9CiAgICAgICAgICAgICAgICBm
b3IgbGluZSBpbiB2YWx1ZS5zcGxpdCgnXG4nKToKICAgICAgICAgICAgICAgICAgICBsaW5lID0g
bGluZS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgaWYgJzonIGluIGxpbmU6CiAgICAgICAg
ICAgICAgICAgICAgICAgIG1lbWJlciwgc2NvcmUgPSBsaW5lLnJzcGxpdCgnOicsIDEpCiAgICAg
ICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhaXJz
W21lbWJlci5zdHJpcCgpXSA9IGZsb2F0KHNjb3JlLnN0cmlwKCkpCiAgICAgICAgICAgICAgICAg
ICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5zaG93X2Vycm9yKGYiSW52YWxpZCBzY29yZSBpbiBsaW5lOiB7bGluZX0iKQogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBpZiBub3QgcGFpcnM6CiAg
ICAgICAgICAgICAgICAgICAgc2VsZi5zaG93X2Vycm9yKCJBdCBsZWFzdCBvbmUgbWVtYmVyOnNj
b3JlIHBhaXIgcmVxdWlyZWQiKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAg
ICAgICAgIyDQn9GA0Lgg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQuCDRgdC90LDRh9Cw0LvQ
sCDQvtGH0LjRidCw0LXQvAogICAgICAgICAgICAgICAgaWYgc2VsZi5lZGl0X2tleToKICAgICAg
ICAgICAgICAgICAgICBjbGllbnQuZGVsZXRlKGtleSkKICAgICAgICAgICAgICAgIGNsaWVudC56
YWRkKGtleSwgcGFpcnMpCgogICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdiaXRtYXAnOgog
ICAgICAgICAgICAgICAgY2xpZW50LnNldChrZXksICcnKQoKICAgICAgICAgICAgICAgIGJpdF9z
ZXQgPSBGYWxzZQogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gdmFsdWUuc3BsaXQoJ1xuJyk6
CiAgICAgICAgICAgICAgICAgICAgbGluZSA9IGxpbmUuc3RyaXAoKQogICAgICAgICAgICAgICAg
ICAgIGlmICc6JyBpbiBsaW5lOgogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRfc3RyLCBi
aXRfc3RyID0gbGluZS5zcGxpdCgnOicsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IGludChvZmZzZXRfc3RyLnN0cmlw
KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXQgPSBpbnQoYml0X3N0ci5zdHJpcCgp
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYml0IG5vdCBpbiAoMCwgMSk6CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93X2Vycm9yKGYiQml0IHZhbHVlIG11
c3QgYmUgMCBvciAxLCBnb3Q6IHtiaXR9IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjbGllbnQuZGVsZXRlKGtleSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1
cm4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudC5leGVjdXRlX2NvbW1hbmQoJ1NF
VEJJVCcsIGtleSwgb2Zmc2V0LCBiaXQsIGtleT1rZXkpCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBiaXRfc2V0ID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVF
cnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd19lcnJvcihmIkludmFs
aWQgb2Zmc2V0OmJpdCBmb3JtYXQgaW4gbGluZToge2xpbmV9IikKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNsaWVudC5kZWxldGUoa2V5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuCgogICAgICAgICAgICAgICAgaWYgbm90IGJpdF9zZXQ6CiAgICAgICAgICAgICAgICAg
ICAgc2VsZi5zaG93X2Vycm9yKCJBdCBsZWFzdCBvbmUgb2Zmc2V0OmJpdCBwYWlyIHJlcXVpcmVk
IikKICAgICAgICAgICAgICAgICAgICBjbGllbnQuZGVsZXRlKGtleSkKICAgICAgICAgICAgICAg
ICAgICByZXR1cm4KCiAgICAgICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3N0cmVhbSc6CiAgICAg
ICAgICAgICAgICBmaWVsZHMgPSB7fQogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gdmFsdWUu
c3BsaXQoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgbGluZSA9IGxpbmUuc3RyaXAoKQogICAg
ICAgICAgICAgICAgICAgIGlmICc6JyBpbiBsaW5lOgogICAgICAgICAgICAgICAgICAgICAgICBr
LCB2ID0gbGluZS5zcGxpdCgnOicsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkc1tr
LnN0cmlwKCldID0gdi5zdHJpcCgpCgogICAgICAgICAgICAgICAgaWYgbm90IGZpZWxkczoKICAg
ICAgICAgICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoIkF0IGxlYXN0IG9uZSBmaWVsZDp2YWx1
ZSBwYWlyIHJlcXVpcmVkIGZvciBzdHJlYW0gZW50cnkiKQogICAgICAgICAgICAgICAgICAgIHJl
dHVybgoKICAgICAgICAgICAgICAgIGFyZ3MgPSBba2V5LCAnKiddCiAgICAgICAgICAgICAgICBm
b3IgaywgdiBpbiBmaWVsZHMuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICBhcmdzLmV4dGVu
ZChbaywgdl0pCgogICAgICAgICAgICAgICAgY2xpZW50LmV4ZWN1dGVfY29tbWFuZCgnWEFERCcs
ICphcmdzLCBrZXk9a2V5KQoKICAgICAgICAgICAgIyDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQ
vCBUVEwg0LXRgdC70Lgg0YPQutCw0LfQsNC9CiAgICAgICAgICAgIGlmIHR0bDoKICAgICAgICAg
ICAgICAgIGNsaWVudC5leHBpcmUoa2V5LCB0dGwpCgogICAgICAgICAgICBhY3Rpb24gPSAiVXBk
YXRlZCIgaWYgc2VsZi5lZGl0X2tleSBlbHNlICJDcmVhdGVkIgogICAgICAgICAgICBsb2dnZXIu
aW5mbyhmInthY3Rpb259IGtleToge2tleX0gKHR5cGU6IHtrZXlfdHlwZX0pIikKICAgICAgICAg
ICAgc2VsZi5vbl9zdWNjZXNzKCkKICAgICAgICAgICAgc2VsZi5fZW1pdCgnY2xvc2UnKQoKICAg
ICAgICBleGNlcHQgUmVkaXNDbHVzdGVyRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5zaG93
X2Vycm9yKGYiQ2x1c3RlciBlcnJvcjoge2V9IikKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYi
Q2x1c3RlciBlcnJvciB3aXRoIGtleToge2V9IikKICAgICAgICBleGNlcHQgUmVkaXNFcnJvciBh
cyBlOgogICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoZiJSZWRpcyBlcnJvcjoge2V9IikKICAg
ICAgICAgICAgbG9nZ2VyLmVycm9yKGYiUmVkaXMgZXJyb3Igd2l0aCBrZXk6IHtlfSIpCiAgICAg
ICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoZiJG
YWlsZWQgdG8gc2F2ZSBrZXk6IHtlfSIpCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxl
ZCB0byBzYXZlIGtleToge2V9IiwgZXhjX2luZm89VHJ1ZSkKCiAgICBkZWYgc2hvd19lcnJvcihz
ZWxmLCBtZXNzYWdlKToKICAgICAgICAiIiLQn9C+0LrQsNC30LDRgtGMINGB0L7QvtCx0YnQtdC9
0LjQtSDQvtCxINC+0YjQuNCx0LrQtSIiIgogICAgICAgIHNlbGYuZXJyb3JfdGV4dC5zZXRfdGV4
dCgoJ2Vycm9yJywgZiLinYwgRXJyb3I6IHttZXNzYWdlfSIpKQoKICAgIGRlZiBvbl9jYW5jZWwo
c2VsZiwgYnV0dG9uKToKICAgICAgICAiIiLQntGC0LzQtdC90LAiIiIKICAgICAgICBzZWxmLnJl
cXVlc3RfY2xvc2UoKQoKCmNsYXNzIFNjcm9sbEJhcih1cndpZC5XaWRnZXRXcmFwKToKICAgICIi
ItCf0YDQvtGB0YLQvtC5INC40L3QtNC40LrQsNGC0L7RgCDQv9GA0L7QutGA0YPRgtC60Lgg0LTQ
u9GPIExpc3RCb3giIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgd2lkZ2V0KToKICAgICAgICAi
IiIKICAgICAgICB3aWRnZXQgLSBMaXN0Qm94INC40LvQuCBQaWxlINGBIExpc3RCb3gg0LLQvdGD
0YLRgNC4CiAgICAgICAgIiIiCiAgICAgICAgc2VsZi53aWRnZXQgPSB3aWRnZXQKICAgICAgICBz
ZWxmLnNjcm9sbGJhcl93aWR0aCA9IDEKCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBMaXN0Qm94
INCy0L3Rg9GC0YDQuCDQstC40LTQttC10YLQsAogICAgICAgIHNlbGYubGlzdGJveCA9IHNlbGYu
X2ZpbmRfbGlzdGJveCh3aWRnZXQpCgogICAgICAgICMg0KHQvtC30LTQsNC10Lwg0YLQtdC60YHR
gtC+0LLRi9C5INC40L3QtNC40LrQsNGC0L7RgAogICAgICAgIHNlbGYuc2Nyb2xsYmFyX3RleHQg
PSB1cndpZC5UZXh0KCfilIInLCBhbGlnbj0nbGVmdCcpCgogICAgICAgICMg0JrQvtC80LHQuNC9
0LjRgNGD0LXQvCDQvtGB0L3QvtCy0L3QvtC5INCy0LjQtNC20LXRgiDQuCDRgdC60YDQvtC70LvQ
sdCw0YAKICAgICAgICBzZWxmLmNvbHVtbnMgPSB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAg
KCd3ZWlnaHQnLCAxLCB3aWRnZXQpLAogICAgICAgICAgICAoJ2dpdmVuJywgc2VsZi5zY3JvbGxi
YXJfd2lkdGgsIHVyd2lkLkF0dHJNYXAoCiAgICAgICAgICAgICAgICB1cndpZC5GaWxsZXIoc2Vs
Zi5zY3JvbGxiYXJfdGV4dCwgdmFsaWduPSd0b3AnKSwKICAgICAgICAgICAgICAgICdzY3JvbGxi
YXInCiAgICAgICAgICAgICkpLAogICAgICAgIF0sIGRpdmlkZWNoYXJzPTApCgogICAgICAgIHN1
cGVyKCkuX19pbml0X18oc2VsZi5jb2x1bW5zKQoKICAgIGRlZiBfZmluZF9saXN0Ym94KHNlbGYs
IHdpZGdldCk6CiAgICAgICAgIiIi0KDQtdC60YPRgNGB0LjQstC90L4g0LjRidC10LwgTGlzdEJv
eCDQstC90YPRgtGA0Lgg0LLQuNC00LbQtdGC0LAiIiIKICAgICAgICBpZiBpc2luc3RhbmNlKHdp
ZGdldCwgdXJ3aWQuTGlzdEJveCk6CiAgICAgICAgICAgIHJldHVybiB3aWRnZXQKICAgICAgICBl
bGlmIGhhc2F0dHIod2lkZ2V0LCAnb3JpZ2luYWxfd2lkZ2V0Jyk6CiAgICAgICAgICAgIHJldHVy
biBzZWxmLl9maW5kX2xpc3Rib3god2lkZ2V0Lm9yaWdpbmFsX3dpZGdldCkKICAgICAgICBlbGlm
IGlzaW5zdGFuY2Uod2lkZ2V0LCB1cndpZC5QaWxlKToKICAgICAgICAgICAgZm9yIGl0ZW0sIF8g
aW4gd2lkZ2V0LmNvbnRlbnRzOgogICAgICAgICAgICAgICAgbGIgPSBzZWxmLl9maW5kX2xpc3Ri
b3goaXRlbSkKICAgICAgICAgICAgICAgIGlmIGxiOgogICAgICAgICAgICAgICAgICAgIHJldHVy
biBsYgogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIHJlbmRlcihzZWxmLCBzaXplLCBmb2N1
cz1GYWxzZSk6CiAgICAgICAgIiIi0J7QsdC90L7QstC70Y/QtdC8INC40L3QtNC40LrQsNGC0L7R
gCDQv9GA0Lgg0LrQsNC20LTQvtC5INC+0YLRgNC40YHQvtCy0LrQtSIiIgogICAgICAgIG1heGNv
bCwgbWF4cm93ID0gc2l6ZQoKICAgICAgICBpZiBzZWxmLmxpc3Rib3ggaXMgTm9uZToKICAgICAg
ICAgICAgcmV0dXJuIHNlbGYuY29sdW1ucy5yZW5kZXIoc2l6ZSwgZm9jdXMpCgogICAgICAgIHRy
eToKICAgICAgICAgICAgd2Fsa2VyID0gc2VsZi5saXN0Ym94LmJvZHkKCiAgICAgICAgICAgIGlm
IG5vdCBoYXNhdHRyKHdhbGtlciwgJ19fbGVuX18nKSBvciBsZW4od2Fsa2VyKSA9PSAwOgogICAg
ICAgICAgICAgICAgIyDQn9GD0YHRgtC+0Lkg0YHQv9C40YHQvtC6CiAgICAgICAgICAgICAgICBz
ZWxmLnNjcm9sbGJhcl90ZXh0LnNldF90ZXh0KCcgJyAqIG1heHJvdykKICAgICAgICAgICAgZWxz
ZToKICAgICAgICAgICAgICAgIHRvdGFsX2l0ZW1zID0gbGVuKHdhbGtlcikKCiAgICAgICAgICAg
ICAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0YLQtdC60YPRidGD0Y4g0L/QvtC30LjRhtC40Y4g0YTQ
vtC60YPRgdCwCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZm9jdXNf
cG9zID0gd2Fsa2VyLmZvY3VzCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uo
Zm9jdXNfcG9zLCBpbnQpOgogICAgICAgICAgICAgICAgICAgICAgICBmb2N1c19wb3MgPSAwCiAg
ICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgZm9jdXNfcG9zID0gMAoK
ICAgICAgICAgICAgICAgICMg0KHQvtC30LTQsNC10Lwg0LLQuNC30YPQsNC70YzQvdGL0Lkg0LjQ
vdC00LjQutCw0YLQvtGACiAgICAgICAgICAgICAgICBpZiB0b3RhbF9pdGVtcyA8PSBtYXhyb3c6
CiAgICAgICAgICAgICAgICAgICAgIyDQktGB0ZEg0L/QvtC80LXRidCw0LXRgtGB0Y8g0L3QsCDR
jdC60YDQsNC9CiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yID0gJ+KWiCcgKiBtYXhyb3cK
ICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgIyDQldGB0YLRjCDQv9GA
0L7QutGA0YPRgtC60LAKICAgICAgICAgICAgICAgICAgICBsaW5lcyA9IFtdCgogICAgICAgICAg
ICAgICAgICAgICMg0JLRi9GH0LjRgdC70Y/QtdC8INGA0LDQt9C80LXRgCDQuCDQv9C+0LfQuNGG
0LjRjiAi0L/QvtC70LfRg9C90LrQsCIKICAgICAgICAgICAgICAgICAgICB0aHVtYl9zaXplID0g
bWF4KDEsIGludChtYXhyb3cgKiBtYXhyb3cgLyB0b3RhbF9pdGVtcykpCiAgICAgICAgICAgICAg
ICAgICAgc2Nyb2xsX3Byb2dyZXNzID0gZm9jdXNfcG9zIC8gbWF4KDEsIHRvdGFsX2l0ZW1zIC0g
MSkKICAgICAgICAgICAgICAgICAgICB0aHVtYl9wb3MgPSBpbnQoc2Nyb2xsX3Byb2dyZXNzICog
KG1heHJvdyAtIHRodW1iX3NpemUpKQoKICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5n
ZShtYXhyb3cpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBpID09IDAgYW5kIGZvY3VzX3Bv
cyA+IDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lcy5hcHBlbmQoJ+KWsicpICAj
INCh0YLRgNC10LvQutCwINCy0LLQtdGA0YUgLSDQtdGB0YLRjCDQtNCw0L3QvdGL0LUg0LLRi9GI
0LUKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBpID09IG1heHJvdyAtIDEgYW5kIGZvY3Vz
X3BvcyA8IHRvdGFsX2l0ZW1zIC0gMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVz
LmFwcGVuZCgn4pa8JykgICMg0KHRgtGA0LXQu9C60LAg0LLQvdC40LcgLSDQtdGB0YLRjCDQtNCw
0L3QvdGL0LUg0L3QuNC20LUKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiB0aHVtYl9wb3Mg
PD0gaSA8IHRodW1iX3BvcyArIHRodW1iX3NpemU6CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBsaW5lcy5hcHBlbmQoJ+KWiCcpICAjINCf0L7Qu9C30YPQvdC+0LoKICAgICAgICAgICAgICAg
ICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzLmFwcGVuZCgn
4pSCJykgICMg0JTQvtGA0L7QttC60LAKCiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yID0g
J1xuJy5qb2luKGxpbmVzKQoKICAgICAgICAgICAgICAgIHNlbGYuc2Nyb2xsYmFyX3RleHQuc2V0
X3RleHQoaW5kaWNhdG9yKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgIGxvZ2dlci5kZWJ1ZyhmIlNjcm9sbEJhciB1cGRhdGUgZXJyb3I6IHtlfSIpCiAgICAgICAg
ICAgICMgRmFsbGJhY2sKICAgICAgICAgICAgc2VsZi5zY3JvbGxiYXJfdGV4dC5zZXRfdGV4dCgn
4pSCJyAqIG1heHJvdykKCiAgICAgICAgcmV0dXJuIHNlbGYuY29sdW1ucy5yZW5kZXIoc2l6ZSwg
Zm9jdXMpCgoKY2xhc3MgUmVkaXNDb21tYW5kZXJVSToKICAgICIiItCT0LvQsNCy0L3QvtC1INC+
0LrQvdC+INCyINGB0YLQuNC70LUgUmVkaXMgQ29tbWFuZGVyIiIiCgogICAgcGFsZXR0ZSA9IFsK
ICAgICAgICAoJ2hlYWRlcicsICd3aGl0ZScsICdkYXJrIGJsdWUnLCAnYm9sZCcpLAogICAgICAg
ICgnaGVhZGVyX3RleHQnLCAnd2hpdGUnLCAnZGFyayBibHVlJyksCiAgICAgICAgKCdmb290ZXIn
LCAnd2hpdGUnLCAnZGFyayBibHVlJyksCiAgICAgICAgKCdzaWRlYmFyJywgJ2xpZ2h0IGdyYXkn
LCAnZGFyayBibHVlJyksCiAgICAgICAgKCdzaWRlYmFyX2ZvY3VzJywgJ3doaXRlJywgJ2Rhcmsg
Ymx1ZScsICdib2xkJyksCiAgICAgICAgKCdjb25uZWN0aW9uJywgJ2xpZ2h0IGN5YW4nLCAnZGFy
ayBibHVlJyksCiAgICAgICAgKCdjb25uZWN0aW9uX3NlbGVjdGVkJywgJ2JsYWNrJywgJ2xpZ2h0
IGN5YW4nLCAnYm9sZCcpLAogICAgICAgICgna2V5X2ZvbGRlcicsICd3aGl0ZScsICdkYXJrIGJs
dWUnKSwKICAgICAgICAoJ2tleV9mb2xkZXJfZm9jdXMnLCAnYmxhY2snLCAnbGlnaHQgY3lhbics
ICdib2xkJyksCiAgICAgICAgKCdrZXlfaXRlbScsICd5ZWxsb3cnLCAnZGFyayBibHVlJyksCiAg
ICAgICAgKCdrZXlfaXRlbV9mb2N1cycsICdibGFjaycsICdsaWdodCBjeWFuJywgJ2JvbGQnKSwK
ICAgICAgICAoJ2J1dHRvbicsICd3aGl0ZScsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ2J1dHRv
bl9mb2N1cycsICd3aGl0ZScsICdsaWdodCBibHVlJywgJ2JvbGQnKSwKICAgICAgICAoJ2J1dHRv
bl9kYW5nZXInLCAnd2hpdGUnLCAnZGFyayByZWQnKSwKICAgICAgICAoJ2luZm9fbGFiZWwnLCAn
bGlnaHQgY3lhbicsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ2luZm9fdmFsdWUnLCAnd2hpdGUn
LCAnZGFyayBibHVlJyksCiAgICAgICAgKCd0YWJfYWN0aXZlJywgJ3doaXRlJywgJ2xpZ2h0IGJs
dWUnLCAnYm9sZCcpLAogICAgICAgICgndGFiX2luYWN0aXZlJywgJ2xpZ2h0IGdyYXknLCAnZGFy
ayBibHVlJyksCiAgICAgICAgKCdlcnJvcicsICdsaWdodCByZWQnLCAnZGFyayBibHVlJyksCiAg
ICAgICAgKCdzdWNjZXNzJywgJ2xpZ2h0IGdyZWVuJywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgn
ZGlhbG9nJywgJ3doaXRlJywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgnYmFja2dyb3VuZCcsICd3
aGl0ZScsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ2lucHV0JywgJ2JsYWNrJywgJ2RhcmsgY3lh
bicpLAogICAgICAgICgnaW5wdXRfZm9jdXMnLCAnYmxhY2snLCAnbGlnaHQgY3lhbicpLAogICAg
ICAgICgnc2Nyb2xsYmFyJywgJ2RhcmsgZ3JheScsICdkYXJrIGJsdWUnKSwKICAgIF0KCiAgICBk
ZWYgX19pbml0X18oc2VsZiwgYXJncyk6CiAgICAgICAgc2VsZi5jb25uZWN0aW9uczogRGljdFtz
dHIsIFJlZGlzQ29ubmVjdGlvbl0gPSB7fQogICAgICAgIHNlbGYuY3VycmVudF9jb25uZWN0aW9u
OiBPcHRpb25hbFtSZWRpc0Nvbm5lY3Rpb25dID0gTm9uZQogICAgICAgIHNlbGYuYXJncyA9IGFy
Z3MKCiAgICAgICAgIyDQl9Cw0LPRgNGD0LbQsNC10Lwg0L/RgNC+0YTQuNC70LgKICAgICAgICBz
ZWxmLnByb2ZpbGVzID0gc2VsZi5sb2FkX3Byb2ZpbGVzKCkKCiAgICAgICAgc2VsZi5rZXlfbGlz
dF92aWV3ID0gS2V5TGlzdFZpZXcoKQogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKHNlbGYu
a2V5X2xpc3RfdmlldywgJ2tleV9zZWxlY3RlZCcsIHNlbGYub25fa2V5X3NlbGVjdCkKCiAgICAg
ICAgIyBkZWYgZGVidWdfd3JhcHBlcigqYXJncywgKiprd2FyZ3MpOgogICAgICAgICMgICAgIGxv
Z2dlci5pbmZvKGYiZGVidWdfd3JhcHBlciBjYWxsZWQgd2l0aCBhcmdzPXthcmdzfSwga3dhcmdz
PXtrd2FyZ3N9IikKICAgICAgICAjICAgICBsb2dnZXIuaW5mbyhmIk51bWJlciBvZiBhcmdzOiB7
bGVuKGFyZ3MpfSIpCiAgICAgICAgIyAgICAgZm9yIGksIGFyZyBpbiBlbnVtZXJhdGUoYXJncyk6
CiAgICAgICAgIyAgICAgICAgIGxvZ2dlci5pbmZvKGYiICBhcmdbe2l9XTogdHlwZT17dHlwZShh
cmcpfSwgdmFsdWU9e2FyZ30iKQogICAgICAgICMKICAgICAgICAjICAgICAjINCY0LfQstC70LXQ
utCw0LXQvCDQutC70Y7RhyAo0L/QvtGB0LvQtdC00L3QuNC5INCw0YDQs9GD0LzQtdC90YIpCiAg
ICAgICAgIyAgICAgaWYgYXJnczoKICAgICAgICAjICAgICAgICAga2V5ID0gYXJnc1stMV0gICMg
0JHQtdGA0LXQvCDQv9C+0YHQu9C10LTQvdC40Lkg0LDRgNCz0YPQvNC10L3RggogICAgICAgICMg
ICAgICAgICBsb2dnZXIuaW5mbyhmIkNhbGxpbmcgb25fa2V5X3NlbGVjdCB3aXRoIGtleT17a2V5
fSIpCiAgICAgICAgIyAgICAgICAgIHNlbGYub25fa2V5X3NlbGVjdChrZXkpCiAgICAgICAgIyAg
ICAgZWxzZToKICAgICAgICAjICAgICAgICAgbG9nZ2VyLmVycm9yKCJObyBhcmdzIHJlY2VpdmVk
ISIpCiAgICAgICAgIwogICAgICAgICMgdXJ3aWQuY29ubmVjdF9zaWduYWwoc2VsZi5rZXlfbGlz
dF92aWV3LCAna2V5X3NlbGVjdGVkJywgZGVidWdfd3JhcHBlcikKCiAgICAgICAgIyBzZWxmLmtl
eXNfbGlzdDogTGlzdFtieXRlc10gPSBbXSAgIyDQn9GA0L7RgdGC0L7QuSDRgdC/0LjRgdC+0Log
0LrQu9GO0YfQtdC5CiAgICAgICAgc2VsZi5jdXJyZW50X2tleTogT3B0aW9uYWxbYnl0ZXNdID0g
Tm9uZQogICAgICAgIHNlbGYuc2VwYXJhdG9yID0gJ+KElicKICAgICAgICBzZWxmLmNvbnNvbGVf
bW9kZSA9IEZhbHNlCiAgICAgICAgc2VsZi5tYXhfZGIgPSAxNSAgIyBSZWRpcyDQv9C+0LTQtNC1
0YDQttC40LLQsNC10YIgMC0xNSDQsdCw0Lcg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4KICAgICAg
ICBzZWxmLmtleV9jb3VudCA9IDAKCiAgICAgICAgIyDQmNGB0YLQvtGA0LjRjyDQutC+0LzQsNC9
0LQKICAgICAgICBzZWxmLmNvbW1hbmRfaGlzdG9yeSA9IFtdICAjINCh0L/QuNGB0L7QuiDQstGB
0LXRhSDQutC+0LzQsNC90LQKICAgICAgICBzZWxmLmhpc3RvcnlfaW5kZXggPSAtMSAgIyDQotC1
0LrRg9GJ0LDRjyDQv9C+0LfQuNGG0LjRjyDQsiDQuNGB0YLQvtGA0LjQuCAoLTEgPSDQvdC+0LLQ
sNGPINC60L7QvNCw0L3QtNCwKQogICAgICAgIHNlbGYuY3VycmVudF9pbnB1dCA9ICcnICAjINCS
0YDQtdC80LXQvdC90L7QtSDRhdGA0LDQvdC40LvQuNGJ0LUg0LTQu9GPINGC0LXQutGD0YnQtdCz
0L4g0LLQstC+0LTQsAoKICAgICAgICAjINCh0L7Qt9C00LDQtdC8INC40L3RgtC10YDRhNC10LnR
gQogICAgICAgIHNlbGYuY3JlYXRlX3VpKCkKCiAgICAgICAgIyDQl9Cw0LPRgNGD0LbQsNC10Lwg
0LjRgdGC0L7RgNC40Y4g0LjQtyDRhNCw0LnQu9CwCiAgICAgICAgc2VsZi5sb2FkX2NvbW1hbmRf
aGlzdG9yeSgpCgogICAgICAgICMg0JDQstGC0L7QvNCw0YLQuNGH0LXRgdC60Lgg0L/QvtC00LrQ
u9GO0YfQsNC10LzRgdGPINC6INC/0LXRgNCy0L7QvNGDINC/0YDQvtGE0LjQu9GOCiAgICAgICAg
aWYgc2VsZi5wcm9maWxlczoKICAgICAgICAgICAgZmlyc3RfcHJvZmlsZSA9IGxpc3Qoc2VsZi5w
cm9maWxlcy52YWx1ZXMoKSlbMF0KICAgICAgICAgICAgc2VsZi5jb25uZWN0X3RvX3Byb2ZpbGUo
Zmlyc3RfcHJvZmlsZSkKCiAgICAgICAgc2VsZi5sb29wID0gdXJ3aWQuTWFpbkxvb3AoCiAgICAg
ICAgICAgIHNlbGYubWFpbl9mcmFtZSwKICAgICAgICAgICAgcGFsZXR0ZT1zZWxmLnBhbGV0dGUs
CiAgICAgICAgICAgIHVuaGFuZGxlZF9pbnB1dD1zZWxmLmhhbmRsZV9pbnB1dCwKICAgICAgICAg
ICAgcG9wX3Vwcz1UcnVlCiAgICAgICAgKQoKICAgIGRlZiBsb2FkX2NvbW1hbmRfaGlzdG9yeShz
ZWxmKToKICAgICAgICAiIiLQl9Cw0LPRgNGD0LfQuNGC0Ywg0LjRgdGC0L7RgNC40Y4g0LrQvtC8
0LDQvdC0INC40Lcg0YTQsNC50LvQsCIiIgogICAgICAgIGhpc3RvcnlfZmlsZSA9IG9zLnBhdGgu
ZXhwYW5kdXNlcignfi8ucmVkaXNfY29tbWFuZGVyX2hpc3RvcnknKQogICAgICAgIHRyeToKICAg
ICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoaGlzdG9yeV9maWxlKToKICAgICAgICAgICAgICAg
IHdpdGggb3BlbihoaXN0b3J5X2ZpbGUsICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoKICAg
ICAgICAgICAgICAgICAgICBzZWxmLmNvbW1hbmRfaGlzdG9yeSA9IFtsaW5lLnN0cmlwKCkgZm9y
IGxpbmUgaW4gZiBpZiBsaW5lLnN0cmlwKCldCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhm
IkxvYWRlZCB7bGVuKHNlbGYuY29tbWFuZF9oaXN0b3J5KX0gY29tbWFuZHMgZnJvbSBoaXN0b3J5
IikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJv
cihmIkZhaWxlZCB0byBsb2FkIGNvbW1hbmQgaGlzdG9yeToge2V9IikKCiAgICBkZWYgc2F2ZV9j
b21tYW5kX2hpc3Rvcnkoc2VsZik6CiAgICAgICAgIiIi0KHQvtGF0YDQsNC90LjRgtGMINC40YHR
gtC+0YDQuNGOINC60L7QvNCw0L3QtCDQsiDRhNCw0LnQuyIiIgogICAgICAgIGhpc3RvcnlfZmls
ZSA9IG9zLnBhdGguZXhwYW5kdXNlcignfi8ucmVkaXNfY29tbWFuZGVyX2hpc3RvcnknKQogICAg
ICAgIHRyeToKICAgICAgICAgICAgIyDQodC+0YXRgNCw0L3Rj9C10Lwg0L/QvtGB0LvQtdC00L3Q
uNC1IDEwMDAg0LrQvtC80LDQvdC0CiAgICAgICAgICAgIHdpdGggb3BlbihoaXN0b3J5X2ZpbGUs
ICd3JywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoKICAgICAgICAgICAgICAgIGZvciBjbWQgaW4g
c2VsZi5jb21tYW5kX2hpc3RvcnlbLTEwMDpdOgogICAgICAgICAgICAgICAgICAgIGYud3JpdGUo
Y21kICsgJ1xuJykKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJTYXZlZCB7bGVuKHNlbGYuY29t
bWFuZF9oaXN0b3J5KX0gY29tbWFuZHMgdG8gaGlzdG9yeSIpCiAgICAgICAgZXhjZXB0IEV4Y2Vw
dGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gc2F2ZSBjb21t
YW5kIGhpc3Rvcnk6IHtlfSIpCgogICAgZGVmIGFkZF90b19oaXN0b3J5KHNlbGYsIGNvbW1hbmQ6
IHN0cik6CiAgICAgICAgIiIi0JTQvtCx0LDQstC40YLRjCDQutC+0LzQsNC90LTRgyDQsiDQuNGB
0YLQvtGA0LjRjiIiIgogICAgICAgIGNvbW1hbmQgPSBjb21tYW5kLnN0cmlwKCkKICAgICAgICBp
ZiBub3QgY29tbWFuZDoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMg0J3QtSDQtNC+0LHQ
sNCy0LvRj9C10Lwg0LTRg9Cx0LvQuNC60LDRgtGLINC/0L7QtNGA0Y/QtAogICAgICAgIGlmIHNl
bGYuY29tbWFuZF9oaXN0b3J5IGFuZCBzZWxmLmNvbW1hbmRfaGlzdG9yeVstMV0gPT0gY29tbWFu
ZDoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuY29tbWFuZF9oaXN0b3J5LmFwcGVu
ZChjb21tYW5kKQogICAgICAgIHNlbGYuaGlzdG9yeV9pbmRleCA9IC0xICAjINCh0LHRgNCw0YHR
i9Cy0LDQtdC8INC40L3QtNC10LrRgQogICAgICAgIHNlbGYuY3VycmVudF9pbnB1dCA9ICcnCgog
ICAgICAgICMg0KHQvtGF0YDQsNC90Y/QtdC8INC40YHRgtC+0YDQuNGOCiAgICAgICAgc2VsZi5z
YXZlX2NvbW1hbmRfaGlzdG9yeSgpCgogICAgZGVmIG5hdmlnYXRlX2hpc3Rvcnkoc2VsZiwgZGly
ZWN0aW9uOiBzdHIpOgogICAgICAgICIiItCd0LDQstC40LPQsNGG0LjRjyDQv9C+INC40YHRgtC+
0YDQuNC4INC60L7QvNCw0L3QtAoKICAgICAgICBBcmdzOgogICAgICAgICAgICBkaXJlY3Rpb246
ICd1cCcg0LjQu9C4ICdkb3duJwogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLmNvbW1h
bmRfaGlzdG9yeToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMg0KHQvtGF0YDQsNC90Y/Q
tdC8INGC0LXQutGD0YnQuNC5INCy0LLQvtC0INC10YHQu9C4INC80Ysg0LIg0YDQtdC20LjQvNC1
INC90L7QstC+0Lkg0LrQvtC80LDQvdC00YsKICAgICAgICBpZiBzZWxmLmhpc3RvcnlfaW5kZXgg
PT0gLTE6CiAgICAgICAgICAgIHNlbGYuY3VycmVudF9pbnB1dCA9IHNlbGYuY29tbWFuZF9wcm9t
cHQuZ2V0X2VkaXRfdGV4dCgpCgogICAgICAgIGlmIGRpcmVjdGlvbiA9PSAndXAnOgogICAgICAg
ICAgICAjINCY0LTQtdC8INC90LDQt9Cw0LQg0LIg0LjRgdGC0L7RgNC40LgKICAgICAgICAgICAg
aWYgc2VsZi5oaXN0b3J5X2luZGV4ID09IC0xOgogICAgICAgICAgICAgICAgIyDQn9C10YDQstC+
0LUg0L3QsNC20LDRgtC40LUgLSDQv9C10YDQtdGF0L7QtNC40Lwg0Log0L/QvtGB0LvQtdC00L3Q
tdC5INC60L7QvNCw0L3QtNC1CiAgICAgICAgICAgICAgICBzZWxmLmhpc3RvcnlfaW5kZXggPSBs
ZW4oc2VsZi5jb21tYW5kX2hpc3RvcnkpIC0gMQogICAgICAgICAgICBlbGlmIHNlbGYuaGlzdG9y
eV9pbmRleCA+IDA6CiAgICAgICAgICAgICAgICBzZWxmLmhpc3RvcnlfaW5kZXggLT0gMQoKICAg
ICAgICBlbGlmIGRpcmVjdGlvbiA9PSAnZG93bic6CiAgICAgICAgICAgICMg0JjQtNC10Lwg0LLQ
v9C10YDQtdC0INCyINC40YHRgtC+0YDQuNC4CiAgICAgICAgICAgIGlmIHNlbGYuaGlzdG9yeV9p
bmRleCA9PSAtMToKICAgICAgICAgICAgICAgICMg0KPQttC1INCyINGA0LXQttC40LzQtSDQvdC+
0LLQvtC5INC60L7QvNCw0L3QtNGLCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAg
ZWxpZiBzZWxmLmhpc3RvcnlfaW5kZXggPCBsZW4oc2VsZi5jb21tYW5kX2hpc3RvcnkpIC0gMToK
ICAgICAgICAgICAgICAgIHNlbGYuaGlzdG9yeV9pbmRleCArPSAxCiAgICAgICAgICAgIGVsc2U6
CiAgICAgICAgICAgICAgICAjINCU0L7RiNC70Lgg0LTQviDQutC+0L3RhtCwIC0g0LLQvtC30LLR
gNCw0YnQsNC10LzRgdGPINC6INGC0LXQutGD0YnQtdC80YMg0LLQstC+0LTRgwogICAgICAgICAg
ICAgICAgc2VsZi5oaXN0b3J5X2luZGV4ID0gLTEKICAgICAgICAgICAgICAgIHNlbGYuY29tbWFu
ZF9wcm9tcHQuc2V0X2VkaXRfdGV4dChzZWxmLmN1cnJlbnRfaW5wdXQpCiAgICAgICAgICAgICAg
ICBzZWxmLmNvbW1hbmRfcHJvbXB0LnNldF9lZGl0X3BvcyhsZW4oc2VsZi5jdXJyZW50X2lucHV0
KSkKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjINCj0YHRgtCw0L3QsNCy0LvQuNCy
0LDQtdC8INGC0LXQutGB0YIg0LjQtyDQuNGB0YLQvtGA0LjQuAogICAgICAgIGlmIHNlbGYuaGlz
dG9yeV9pbmRleCA+PSAwOgogICAgICAgICAgICBjb21tYW5kID0gc2VsZi5jb21tYW5kX2hpc3Rv
cnlbc2VsZi5oaXN0b3J5X2luZGV4XQogICAgICAgICAgICBzZWxmLmNvbW1hbmRfcHJvbXB0LnNl
dF9lZGl0X3RleHQoY29tbWFuZCkKICAgICAgICAgICAgc2VsZi5jb21tYW5kX3Byb21wdC5zZXRf
ZWRpdF9wb3MobGVuKGNvbW1hbmQpKQoKICAgIGRlZiBnZXRfa2V5X3R5cGVfaWNvbihzZWxmLCBr
ZXk6IHN0cikgLT4gc3RyOgogICAgICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg0LjQutC+0L3QutGD
INC00LvRjyDRgtC40L/QsCDQutC70Y7Rh9CwICjQv9GA0L7RgdGC0YvQtSDRgdC40LzQstC+0LvR
iykiIiIKCiAgICAgICAgIyDQkNC70YzRgtC10YDQvdCw0YLQuNCy0LA6IEFTQ0lJINGB0LjQvNCy
0L7Qu9GLCiAgICAgICAgYXNjaWlfaWNvbnMgPSB7CiAgICAgICAgICAgICdzdHJpbmcnOiAnW1N0
XSAnLAogICAgICAgICAgICAnaGFzaCc6ICdbSHNdICcsCiAgICAgICAgICAgICdsaXN0JzogJ1tM
aV0gJywKICAgICAgICAgICAgJ3NldCc6ICdbU2VdICcsCiAgICAgICAgICAgICd6c2V0JzogJ1ta
c10gJywKICAgICAgICAgICAgJ3N0cmVhbSc6ICdbVHJdICcsCiAgICAgICAgICAgICdub25lJzog
J1tOb10gJywKICAgICAgICAgICAgJ3Vua25vd24nOiAnWz9dICcsCiAgICAgICAgfQoKICAgICAg
ICAjINCY0YHQv9C+0LvRjNC30YPQtdC8IGFzY2lpX2ljb25zINC00LvRjyDQvNCw0LrRgdC40LzQ
sNC70YzQvdC+0Lkg0YHQvtCy0LzQtdGB0YLQuNC80L7RgdGC0LgKICAgICAgICBpY29uX3NldCA9
IGFzY2lpX2ljb25zCgogICAgICAgIGlmIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBu
b3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4g
aWNvbl9zZXRbJ3Vua25vd24nXQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNsaWVudCA9IHNl
bGYuY3VycmVudF9jb25uZWN0aW9uLmFjdGl2ZV9jbGllbnQKICAgICAgICAgICAga2V5X3R5cGUg
PSBjbGllbnQudHlwZShrZXkuZW5jb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScpKQoKICAg
ICAgICAgICAgaWYgaXNpbnN0YW5jZShrZXlfdHlwZSwgYnl0ZXMpOgogICAgICAgICAgICAgICAg
a2V5X3R5cGUgPSBrZXlfdHlwZS5kZWNvZGUoJ3V0Zi04JykubG93ZXIoKQogICAgICAgICAgICBl
bHNlOgogICAgICAgICAgICAgICAga2V5X3R5cGUgPSBzdHIoa2V5X3R5cGUpLmxvd2VyKCkKCiAg
ICAgICAgICAgIHJldHVybiBpY29uX3NldC5nZXQoa2V5X3R5cGUsIGljb25fc2V0Wyd1bmtub3du
J10pCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJy
b3IoZiJFcnJvciBnZXR0aW5nIGtleSB0eXBlIGZvciB7a2V5fToge2V9IikKICAgICAgICAgICAg
cmV0dXJuIGljb25fc2V0Wyd1bmtub3duJ10KCiAgICAjIGRlZiBvbGRfbG9hZF9wcm9maWxlcyhz
ZWxmKSAtPiBEaWN0W3N0ciwgQ29ubmVjdGlvblByb2ZpbGVdOgogICAgIyAgICAgIiIi0JfQsNCz
0YDRg9C30LrQsCDQv9GA0L7RhNC40LvQtdC5INGBINC/0L7QtNC00LXRgNC20LrQvtC5INC60LvQ
sNGB0YLQtdGA0LAiIiIKICAgICMgICAgIHByb2ZpbGVzID0ge30KICAgICMgICAgIHByb2ZpbGVz
X2ZpbGUgPSAncmVkaXNfcHJvZmlsZXMuanNvbicKICAgICMKICAgICMgICAgIGlmIG9zLnBhdGgu
ZXhpc3RzKHByb2ZpbGVzX2ZpbGUpOgogICAgIyAgICAgICAgIHRyeToKICAgICMgICAgICAgICAg
ICAgd2l0aCBvcGVuKHByb2ZpbGVzX2ZpbGUsICdyJykgYXMgZjoKICAgICMgICAgICAgICAgICAg
ICAgIGRhdGEgPSBqc29uLmxvYWQoZikKICAgICMgICAgICAgICAgICAgICAgIGZvciBuYW1lLCBj
b25maWcgaW4gZGF0YS5pdGVtcygpOgogICAgIyAgICAgICAgICAgICAgICAgICAgICMg0J/QvtC0
0LPQvtGC0LDQstC70LjQstCw0LXQvCDQutC+0L3RhNC40LMg0LTQu9GPIENvbm5lY3Rpb25Qcm9m
aWxlCiAgICAjICAgICAgICAgICAgICAgICAgICAgY2xlYW5fY29uZmlnID0ge30KICAgICMKICAg
ICMgICAgICAgICAgICAgICAgICAgICAjINCR0LDQt9C+0LLRi9C1INC/0LDRgNCw0LzQtdGC0YDR
iwogICAgIyAgICAgICAgICAgICAgICAgICAgIGJhc2VfcGFyYW1zID0gWyduYW1lJywgJ2hvc3Qn
LCAncG9ydCcsICdwYXNzd29yZCcsICd1c2VybmFtZScsCiAgICAjICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgJ3NzbCcsICdzb2NrZXRfcGF0aCcsICdyZWFkb25seScsICdzc2xf
Y2FfY2VydHMnLAogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzc2xf
Y2VydGZpbGUnLCAnc3NsX2tleWZpbGUnXQogICAgIwogICAgIyAgICAgICAgICAgICAgICAgICAg
IGZvciBwYXJhbSBpbiBiYXNlX3BhcmFtczoKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAg
aWYgcGFyYW0gaW4gY29uZmlnOgogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xl
YW5fY29uZmlnW3BhcmFtXSA9IGNvbmZpZ1twYXJhbV0KICAgICMKICAgICMgICAgICAgICAgICAg
ICAgICAgICAjINCf0LDRgNCw0LzQtdGC0YDRiyDQutC70LDRgdGC0LXRgNCwCiAgICAjICAgICAg
ICAgICAgICAgICAgICAgaWYgJ2NsdXN0ZXJfbW9kZScgaW4gY29uZmlnOgogICAgIyAgICAgICAg
ICAgICAgICAgICAgICAgICBjbGVhbl9jb25maWdbJ2NsdXN0ZXJfbW9kZSddID0gYm9vbChjb25m
aWdbJ2NsdXN0ZXJfbW9kZSddKQogICAgIwogICAgIyAgICAgICAgICAgICAgICAgICAgICMg0J7Q
sdGA0LDQsdC+0YLQutCwIGNsdXN0ZXJfbm9kZXMgLSDQstCw0LbQvdC+OiDRgdC+0YXRgNCw0L3R
j9C10Lwg0LrQsNC6INGB0L/QuNGB0L7QuiDQutC+0YDRgtC10LbQtdC5CiAgICAjICAgICAgICAg
ICAgICAgICAgICAgaWYgJ2NsdXN0ZXJfbm9kZXMnIGluIGNvbmZpZzoKICAgICMgICAgICAgICAg
ICAgICAgICAgICAgICAgbm9kZXMgPSBjb25maWdbJ2NsdXN0ZXJfbm9kZXMnXQogICAgIyAgICAg
ICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKG5vZGVzLCBsaXN0KToKICAgICMgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZF9ub2RlcyA9IFtdCiAgICAjICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBub2RlczoKICAgICMgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKG5vZGUsIHN0cik6CiAgICAjICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0KTQvtGA0LzQsNGCICJob3N0OnBv
cnQiCiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICc6JyBpbiBu
b2RlOgogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCwg
cG9ydF9zdHIgPSBub2RlLnNwbGl0KCc6JywgMSkKICAgICMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHRyeToKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwb3J0ID0gaW50KHBvcnRfc3RyKQogICAgIyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZF9ub2Rlcy5hcHBlbmQoKGhv
c3QsIHBvcnQpKQogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJJbnZhbGlkIHBvcnQgaW4gbm9kZSB7bm9kZX0i
KQogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShu
b2RlLCBkaWN0KToKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQ
pNC+0YDQvNCw0YIgeyJob3N0IjogIi4uLiIsICJwb3J0IjogLi4ufQogICAgIyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0ID0gbm9kZS5nZXQoJ2hvc3QnLCAnbG9jYWxo
b3N0JykKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydCA9IG5v
ZGUuZ2V0KCdwb3J0JywgNjM3OSkKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdHJ5OgogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cG9ydCA9IGludChwb3J0KQogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZm9ybWF0dGVkX25vZGVzLmFwcGVuZCgoaG9zdCwgcG9ydCkpCiAgICAjICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgIyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJJbnZh
bGlkIHBvcnQgaW4gbm9kZSB7bm9kZX0iKQogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGVsaWYgaXNpbnN0YW5jZShub2RlLCBsaXN0KSBhbmQgbGVuKG5vZGUpID09IDI6CiAg
ICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0KTQvtGA0LzQsNGCIFsi
aG9zdCIsIHBvcnRdCiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhv
c3QsIHBvcnQgPSBub2RlWzBdLCBub2RlWzFdCiAgICAjICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRyeToKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHBvcnQgPSBpbnQocG9ydCkKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGZvcm1hdHRlZF9ub2Rlcy5hcHBlbmQoKHN0cihob3N0KSwgcG9ydCkpCiAg
ICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9y
OgogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndh
cm5pbmcoZiJJbnZhbGlkIHBvcnQgaW4gbm9kZSB7bm9kZX0iKQogICAgIwogICAgIyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgZm9ybWF0dGVkX25vZGVzOgogICAgIyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNsZWFuX2NvbmZpZ1snY2x1c3Rlcl9ub2RlcyddID0gZm9y
bWF0dGVkX25vZGVzCiAgICAjCiAgICAjICAgICAgICAgICAgICAgICAgICAgIyDQodC+0LfQtNCw
0LXQvCDQv9GA0L7RhNC40LvRjAogICAgIyAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICMg
ICAgICAgICAgICAgICAgICAgICAgICAgIyDQo9Cx0LXQtNC40LzRgdGPLCDRh9GC0L4g0LXRgdGC
0YwgaG9zdCDQuCBwb3J0CiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgIGlmICdob3N0JyBu
b3QgaW4gY2xlYW5fY29uZmlnOgogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg
J2NsdXN0ZXJfbm9kZXMnIGluIGNsZWFuX2NvbmZpZyBhbmQgY2xlYW5fY29uZmlnWydjbHVzdGVy
X25vZGVzJ106CiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW5fY29u
ZmlnWydob3N0J10gPSBjbGVhbl9jb25maWdbJ2NsdXN0ZXJfbm9kZXMnXVswXVswXQogICAgIyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuX2NvbmZpZ1sncG9ydCddID0gY2xl
YW5fY29uZmlnWydjbHVzdGVyX25vZGVzJ11bMF1bMV0KICAgICMgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGVsc2U6CiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xl
YW5fY29uZmlnWydob3N0J10gPSAnbG9jYWxob3N0JwogICAgIyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNsZWFuX2NvbmZpZ1sncG9ydCddID0gNjM3OQogICAgIwogICAgIyAgICAg
ICAgICAgICAgICAgICAgICAgICBwcm9maWxlc1tuYW1lXSA9IENvbm5lY3Rpb25Qcm9maWxlKCoq
Y2xlYW5fY29uZmlnKQogICAgIwogICAgIyAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBUeXBl
RXJyb3IgYXMgZToKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYi
SW52YWxpZCBjb25maWcgZm9yIHByb2ZpbGUgJ3tuYW1lfSc6IHtlfSIpCiAgICAjICAgICAgICAg
ICAgICAgICAgICAgICAgICMg0J/RgNC+0LHRg9C10Lwg0YHQvtC30LTQsNGC0Ywg0L/RgNC+0YTQ
uNC70Ywg0YEg0LzQuNC90LjQvNCw0LvRjNC90YvQvNC4INC/0LDRgNCw0LzQtdGC0YDQsNC80LgK
ICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgbWluaW1hbF9jb25maWcgPSB7CiAgICAjICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAnbmFtZSc6IG5hbWUsCiAgICAjICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAnaG9zdCc6IGNvbmZpZy5nZXQoJ2hvc3QnLCAnbG9jYWxob3N0Jyks
CiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncG9ydCc6IGNvbmZpZy5nZXQoJ3Bv
cnQnLCA2Mzc5KSwKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjbHVzdGVyX21v
ZGUnOiBjb25maWcuZ2V0KCdjbHVzdGVyX21vZGUnLCBGYWxzZSkKICAgICMgICAgICAgICAgICAg
ICAgICAgICAgICAgfQogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICBpZiAncGFzc3dvcmQn
IGluIGNvbmZpZzoKICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbmltYWxfY29u
ZmlnWydwYXNzd29yZCddID0gY29uZmlnWydwYXNzd29yZCddCiAgICAjICAgICAgICAgICAgICAg
ICAgICAgICAgIHByb2ZpbGVzW25hbWVdID0gQ29ubmVjdGlvblByb2ZpbGUoKiptaW5pbWFsX2Nv
bmZpZykKICAgICMKICAgICMgICAgICAgICBleGNlcHQganNvbi5KU09ORGVjb2RlRXJyb3IgYXMg
ZToKICAgICMgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiSW52YWxpZCBKU09OIGluIHByb2Zp
bGVzIGZpbGU6IHtlfSIpCiAgICAjICAgICAgICAgICAgIHByb2ZpbGVzWydsb2NhbGhvc3QnXSA9
IENvbm5lY3Rpb25Qcm9maWxlKCdsb2NhbGhvc3QnLCAnbG9jYWxob3N0JywgNjM3OSkKICAgICMg
ICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAjICAgICAgICAgICAgIGxvZ2dlci5l
cnJvcihmIkZhaWxlZCB0byBsb2FkIHByb2ZpbGVzOiB7ZX0iKQogICAgIyAgICAgICAgICAgICBw
cm9maWxlc1snbG9jYWxob3N0J10gPSBDb25uZWN0aW9uUHJvZmlsZSgnbG9jYWxob3N0JywgJ2xv
Y2FsaG9zdCcsIDYzNzkpCiAgICAjCiAgICAjICAgICAjINCf0YDQvtGE0LjQu9C4INC/0L4g0YPQ
vNC+0LvRh9Cw0L3QuNGOLCDQtdGB0LvQuCDRhNCw0LnQu9CwINC90LXRgiDQuNC70Lgg0L7QvSDQ
v9GD0YHRgtC+0LkKICAgICMgICAgIGlmIG5vdCBwcm9maWxlczoKICAgICMgICAgICAgICBwcm9m
aWxlc1snbG9jYWxob3N0J10gPSBDb25uZWN0aW9uUHJvZmlsZSgnbG9jYWxob3N0JywgJ2xvY2Fs
aG9zdCcsIDYzNzkpCiAgICAjCiAgICAjICAgICByZXR1cm4gcHJvZmlsZXMKCiAgICBkZWYgbG9h
ZF9wcm9maWxlcyhzZWxmKSAtPiBEaWN0W3N0ciwgQ29ubmVjdGlvblByb2ZpbGVdOgogICAgICAg
ICIiItCX0LDQs9GA0YPQt9C60LAg0L/RgNC+0YTQuNC70LXQuSDRgSDQv9C+0LTQtNC10YDQttC6
0L7QuSDRgtGA0LXRhSDRgNC10LbQuNC80L7QsiIiIgoKICAgICAgICAjINCe0L/RgNC10LTQtdC7
0Y/QtdC8INGA0LXQttC40Lwg0YDQsNCx0L7RgtGLCiAgICAgICAgaWYgc2VsZi5hcmdzLnZhdWx0
X3VybDoKICAgICAgICAgICAgIyDQoNC10LbQuNC8IDM6IFZhdWx0CiAgICAgICAgICAgIHByb2Zp
bGVzX2RhdGEgPSBzZWxmLl9sb2FkX2Zyb21fdmF1bHQoKQogICAgICAgIGVsaWYgc2VsZi5hcmdz
LmVuY3J5cHRlZF9jb25maWc6CiAgICAgICAgICAgICMg0KDQtdC20LjQvCAyOiDQl9Cw0YjQuNGE
0YDQvtCy0LDQvdC90YvQuSDRhNCw0LnQuwogICAgICAgICAgICBwcm9maWxlc19kYXRhID0gc2Vs
Zi5fbG9hZF9lbmNyeXB0ZWRfY29uZmlnKHNlbGYuYXJncy5lbmNyeXB0ZWRfY29uZmlnKQogICAg
ICAgIGVsc2U6CiAgICAgICAgICAgICMg0KDQtdC20LjQvCAxOiDQntCx0YvRh9C90YvQuSDRhNCw
0LnQuwogICAgICAgICAgICBwcm9maWxlc19kYXRhID0gc2VsZi5fbG9hZF9wbGFpbnRleHRfY29u
ZmlnKHNlbGYuYXJncy5jb25maWcpCgogICAgICAgICMg0J/QsNGA0YHQuNC8INC30LDQs9GA0YPQ
ttC10L3QvdGL0LUg0LTQsNC90L3Ri9C1INCyINC/0YDQvtGE0LjQu9C4CiAgICAgICAgcmV0dXJu
IHNlbGYuX3BhcnNlX3Byb2ZpbGVzKHByb2ZpbGVzX2RhdGEpCgogICAgZGVmIF9sb2FkX3BsYWlu
dGV4dF9jb25maWcoc2VsZiwgY29uZmlnX3BhdGg6IHN0cikgLT4gZGljdDoKICAgICAgICAiIiLQ
oNC10LbQuNC8IDE6INCX0LDQs9GA0YPQt9C60LAg0LjQtyDQvtCx0YvRh9C90L7Qs9C+IEpTT04g
0YTQsNC50LvQsCIiIgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhjb25maWdfcGF0aCk6
CiAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiQ29uZmlnIGZpbGUgbm90IGZvdW5kOiB7Y29u
ZmlnX3BhdGh9IikKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgICAgIHRyeToKICAgICAgICAg
ICAgd2l0aCBvcGVuKGNvbmZpZ19wYXRoLCAncicpIGFzIGY6CiAgICAgICAgICAgICAgICByZXR1
cm4ganNvbi5sb2FkKGYpCiAgICAgICAgZXhjZXB0IGpzb24uSlNPTkRlY29kZUVycm9yIGFzIGU6
CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkludmFsaWQgSlNPTiBpbiBjb25maWcgZmlsZTog
e2V9IikKICAgICAgICAgICAgcmV0dXJuIHt9CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBl
OgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gbG9hZCBjb25maWc6IHtlfSIp
CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiBfbG9hZF9lbmNyeXB0ZWRfY29uZmlnKHNl
bGYsIGNvbmZpZ19wYXRoOiBzdHIpIC0+IGRpY3Q6CiAgICAgICAgIiIi0KDQtdC20LjQvCAyOiDQ
l9Cw0LPRgNGD0LfQutCwINC40Lcg0LfQsNGI0LjRhNGA0L7QstCw0L3QvdC+0LPQviDRhNCw0LnQ
u9CwIiIiCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGNvbmZpZ19wYXRoKToKICAgICAg
ICAgICAgc2VsZi5fZXhpdF9lcnJvcihmIkVuY3J5cHRlZCBjb25maWcgZmlsZSBub3QgZm91bmQ6
IHtjb25maWdfcGF0aH0iKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggb3Blbihjb25m
aWdfcGF0aCwgJ3JiJykgYXMgZjoKICAgICAgICAgICAgICAgIGZpbGVfZGF0YSA9IGYucmVhZCgp
CgogICAgICAgICAgICAjINCf0LXRgNCy0YvQtSAxNiDQsdCw0LnRgiAtINGN0YLQviBzYWx0CiAg
ICAgICAgICAgIGlmIGxlbihmaWxlX2RhdGEpIDwgMTY6CiAgICAgICAgICAgICAgICBzZWxmLl9l
eGl0X2Vycm9yKCJFbmNyeXB0ZWQgZmlsZSBpcyBjb3JydXB0ZWQgKHRvbyBzaG9ydCkiKQoKICAg
ICAgICAgICAgc2FsdCA9IGZpbGVfZGF0YVs6MTZdCiAgICAgICAgICAgIGVuY3J5cHRlZF9kYXRh
ID0gZmlsZV9kYXRhWzE2Ol0KCiAgICAgICAgICAgICMg0JfQsNC/0YDQsNGI0LjQstCw0LXQvCDQ
v9Cw0YDQvtC70YwKICAgICAgICAgICAgcGFzc3dvcmQgPSBnZXRwYXNzLmdldHBhc3MoIkVudGVy
IGRlY3J5cHRpb24gcGFzc3dvcmQ6ICIpCgogICAgICAgICAgICAjINCT0LXQvdC10YDQuNGA0YPQ
tdC8INC60LvRjtGHICjQv9Cw0YDQsNC80LXRgtGA0Ysg0JTQntCb0JbQndCrINGB0L7QstC/0LDQ
tNCw0YLRjCDRgSBlbmNyeXB0b3IucHkpCiAgICAgICAgICAgIGtkZiA9IFBCS0RGMkhNQUMoCiAg
ICAgICAgICAgICAgICBhbGdvcml0aG09aGFzaGVzLlNIQTI1NigpLAogICAgICAgICAgICAgICAg
bGVuZ3RoPTMyLAogICAgICAgICAgICAgICAgc2FsdD1zYWx0LAogICAgICAgICAgICAgICAgaXRl
cmF0aW9ucz0xMDAwMDAsCiAgICAgICAgICAgICAgICBiYWNrZW5kPWRlZmF1bHRfYmFja2VuZCgp
CiAgICAgICAgICAgICkKICAgICAgICAgICAga2V5ID0gYmFzZTY0LnVybHNhZmVfYjY0ZW5jb2Rl
KGtkZi5kZXJpdmUocGFzc3dvcmQuZW5jb2RlKCd1dGYtOCcpKSkKCiAgICAgICAgICAgIGYgPSBG
ZXJuZXQoa2V5KQoKICAgICAgICAgICAgIyDQoNCw0YHRiNC40YTRgNC+0LLRi9Cy0LDQtdC8CiAg
ICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGRlY3J5cHRlZF9kYXRhID0gZi5kZWNyeXB0
KGVuY3J5cHRlZF9kYXRhKQogICAgICAgICAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoZGVjcnlw
dGVkX2RhdGEuZGVjb2RlKCd1dGYtOCcpKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgog
ICAgICAgICAgICAgICAgc2VsZi5fZXhpdF9lcnJvcigiRGVjcnlwdGlvbiBmYWlsZWQhIEludmFs
aWQgcGFzc3dvcmQgb3IgY29ycnVwdGVkIGZpbGUuIikKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgICAgICBzZWxmLl9leGl0X2Vycm9yKGYiRXJyb3IgcmVhZGluZyBlbmNy
eXB0ZWQgY29uZmlnOiB7ZX0iKQoKICAgIGRlZiBfbG9hZF9mcm9tX3ZhdWx0KHNlbGYpIC0+IGRp
Y3Q6CiAgICAgICAgIiIi0KDQtdC20LjQvCAzOiDQl9Cw0LPRgNGD0LfQutCwINC40LcgSGFzaGlD
b3JwIFZhdWx0IiIiCiAgICAgICAgdmF1bHRfdXJsID0gc2VsZi5hcmdzLnZhdWx0X3VybAogICAg
ICAgIHZhdWx0X3BhdGggPSBzZWxmLmFyZ3MudmF1bHRfcGF0aAoKICAgICAgICBpZiBub3QgdmF1
bHRfcGF0aDoKICAgICAgICAgICAgc2VsZi5fZXhpdF9lcnJvcigiLS12YXVsdC1wYXRoIGlzIHJl
cXVpcmVkIHdoZW4gdXNpbmcgVmF1bHQgbW9kZSIpCgogICAgICAgICMg0J/QvtC70YPRh9Cw0LXQ
vCDRg9GH0LXRgtC90YvQtSDQtNCw0L3QvdGL0LUKICAgICAgICB1c2VybmFtZSA9IHNlbGYuYXJn
cy52YXVsdF91c2VyCiAgICAgICAgaWYgbm90IHVzZXJuYW1lOgogICAgICAgICAgICB1c2VybmFt
ZSA9IGlucHV0KCJWYXVsdCB1c2VybmFtZTogIikKCiAgICAgICAgcGFzc3dvcmQgPSBzZWxmLmFy
Z3MudmF1bHRfcGFzcwogICAgICAgIGlmIG5vdCBwYXNzd29yZDoKICAgICAgICAgICAgcGFzc3dv
cmQgPSBnZXRwYXNzLmdldHBhc3MoIlZhdWx0IHBhc3N3b3JkOiAiKQoKICAgICAgICB0cnk6CiAg
ICAgICAgICAgICMg0J/QvtC00LrQu9GO0YfQsNC10LzRgdGPINC6IFZhdWx0CiAgICAgICAgICAg
IGNsaWVudCA9IGh2YWMuQ2xpZW50KHVybD12YXVsdF91cmwpCgogICAgICAgICAgICAjINCQ0YPR
gtC10L3RgtC40YTQuNC60LDRhtC40Y8gKHVzZXJwYXNzINC80LXRgtC+0LQpCiAgICAgICAgICAg
IGNsaWVudC5hdXRoLnVzZXJwYXNzLmxvZ2luKAogICAgICAgICAgICAgICAgdXNlcm5hbWU9dXNl
cm5hbWUsCiAgICAgICAgICAgICAgICBwYXNzd29yZD1wYXNzd29yZAogICAgICAgICAgICApCgog
ICAgICAgICAgICBpZiBub3QgY2xpZW50LmlzX2F1dGhlbnRpY2F0ZWQoKToKICAgICAgICAgICAg
ICAgIHNlbGYuX2V4aXRfZXJyb3IoIlZhdWx0IGF1dGhlbnRpY2F0aW9uIGZhaWxlZCIpCgogICAg
ICAgICAgICAjINCn0LjRgtCw0LXQvCDRgdC10LrRgNC10YIg0LjQtyBLViB2MgogICAgICAgICAg
ICAjINCU0LvRjyBLViB2MiDQv9GD0YLRjCDQtNC+0LvQttC10L0g0YHQvtC00LXRgNC20LDRgtGM
IC9kYXRhLwogICAgICAgICAgICBzZWNyZXRfcmVzcG9uc2UgPSBjbGllbnQuc2VjcmV0cy5rdi52
Mi5yZWFkX3NlY3JldF92ZXJzaW9uKAogICAgICAgICAgICAgICAgcGF0aD12YXVsdF9wYXRoLnJl
cGxhY2UoJ3NlY3JldC9kYXRhLycsICcnKS5yZXBsYWNlKCdzZWNyZXQvJywgJycpCiAgICAgICAg
ICAgICkKCiAgICAgICAgICAgICMg0JjQt9Cy0LvQtdC60LDQtdC8INC00LDQvdC90YvQtQogICAg
ICAgICAgICBwcm9maWxlc19kYXRhID0gc2VjcmV0X3Jlc3BvbnNlWydkYXRhJ11bJ2RhdGEnXQog
ICAgICAgICAgICByZXR1cm4gcHJvZmlsZXNfZGF0YQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9u
IGFzIGU6CiAgICAgICAgICAgIHNlbGYuX2V4aXRfZXJyb3IoZiJGYWlsZWQgdG8gbG9hZCBmcm9t
IFZhdWx0OiB7ZX0iKQoKICAgIGRlZiBfcGFyc2VfcHJvZmlsZXMoc2VsZiwgZGF0YTogZGljdCkg
LT4gRGljdFtzdHIsIENvbm5lY3Rpb25Qcm9maWxlXToKICAgICAgICAiIiLQn9Cw0YDRgdC40L3Q
syDQt9Cw0LPRgNGD0LbQtdC90L3Ri9GFINC00LDQvdC90YvRhSDQsiDQvtCx0YrQtdC60YLRiyBD
b25uZWN0aW9uUHJvZmlsZSIiIgogICAgICAgIHByb2ZpbGVzID0ge30KCiAgICAgICAgZm9yIG5h
bWUsIGNvbmZpZyBpbiBkYXRhLml0ZW1zKCk6CiAgICAgICAgICAgICMg0J/QvtC00LPQvtGC0LDQ
stC70LjQstCw0LXQvCDQutC+0L3RhNC40LMg0LTQu9GPIENvbm5lY3Rpb25Qcm9maWxlCiAgICAg
ICAgICAgIGNsZWFuX2NvbmZpZyA9IHt9CgogICAgICAgICAgICAjINCR0LDQt9C+0LLRi9C1INC/
0LDRgNCw0LzQtdGC0YDRiwogICAgICAgICAgICBiYXNlX3BhcmFtcyA9IFsnbmFtZScsICdob3N0
JywgJ3BvcnQnLCAncGFzc3dvcmQnLCAndXNlcm5hbWUnLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAnc3NsJywgJ3NvY2tldF9wYXRoJywgJ3JlYWRvbmx5JywgJ3NzbF9jYV9jZXJ0cycsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICdzc2xfY2VydGZpbGUnLCAnc3NsX2tleWZpbGUnXQog
ICAgICAgICAgICBmb3IgcGFyYW0gaW4gYmFzZV9wYXJhbXM6CiAgICAgICAgICAgICAgICBpZiBw
YXJhbSBpbiBjb25maWc6CiAgICAgICAgICAgICAgICAgICAgY2xlYW5fY29uZmlnW3BhcmFtXSA9
IGNvbmZpZ1twYXJhbV0KCiAgICAgICAgICAgICMg0J/QsNGA0LDQvNC10YLRgNGLINC60LvQsNGB
0YLQtdGA0LAKICAgICAgICAgICAgaWYgJ2NsdXN0ZXJfbW9kZScgaW4gY29uZmlnOgogICAgICAg
ICAgICAgICAgY2xlYW5fY29uZmlnWydjbHVzdGVyX21vZGUnXSA9IGJvb2woY29uZmlnWydjbHVz
dGVyX21vZGUnXSkKCiAgICAgICAgICAgICMg0J7QsdGA0LDQsdC+0YLQutCwIGNsdXN0ZXJfbm9k
ZXMKICAgICAgICAgICAgaWYgJ2NsdXN0ZXJfbm9kZXMnIGluIGNvbmZpZzoKICAgICAgICAgICAg
ICAgIG5vZGVzID0gY29uZmlnWydjbHVzdGVyX25vZGVzJ10KICAgICAgICAgICAgICAgIGlmIGlz
aW5zdGFuY2Uobm9kZXMsIGxpc3QpOgogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZF9ub2Rl
cyA9IFtdCiAgICAgICAgICAgICAgICAgICAgZm9yIG5vZGUgaW4gbm9kZXM6CiAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uobm9kZSwgc3RyKToKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICMg0KTQvtGA0LzQsNGCICJob3N0OnBvcnQiCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpZiAnOicgaW4gbm9kZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBo
b3N0LCBwb3J0X3N0ciA9IG5vZGUuc3BsaXQoJzonLCAxKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydCA9
IGludChwb3J0X3N0cikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0
dGVkX25vZGVzLmFwcGVuZCgoaG9zdCwgcG9ydCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGxvZ2dlci53YXJuaW5nKGYiSW52YWxpZCBwb3J0IGluIG5vZGUge25vZGV9IikKICAgICAg
ICAgICAgICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKG5vZGUsIGRpY3QpOgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIyDQpNC+0YDQvNCw0YIgeyJob3N0IjogIi4uLiIsICJwb3J0Ijog
Li4ufQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCA9IG5vZGUuZ2V0KCdob3N0Jywg
J2xvY2FsaG9zdCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0ID0gbm9kZS5nZXQo
J3BvcnQnLCA2Mzc5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBvcnQgPSBpbnQocG9ydCkKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBmb3JtYXR0ZWRfbm9kZXMuYXBwZW5kKChob3N0LCBwb3J0KSkKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiSW52YWxpZCBwb3J0IGluIG5vZGUge25v
ZGV9IikKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKG5vZGUsIGxpc3Qp
IGFuZCBsZW4obm9kZSkgPT0gMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0KTQvtGA
0LzQsNGCIFsiaG9zdCIsIHBvcnRdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0LCBw
b3J0ID0gbm9kZVswXSwgbm9kZVsxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5Ogog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcnQgPSBpbnQocG9ydCkKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRfbm9kZXMuYXBwZW5kKChzdHIoaG9zdCks
IHBvcnQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJJbnZhbGlkIHBv
cnQgaW4gbm9kZSB7bm9kZX0iKQogICAgICAgICAgICAgICAgICAgIGlmIGZvcm1hdHRlZF9ub2Rl
czoKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW5fY29uZmlnWydjbHVzdGVyX25vZGVzJ10g
PSBmb3JtYXR0ZWRfbm9kZXMKCiAgICAgICAgICAgICMg0KHQvtC30LTQsNC10Lwg0L/RgNC+0YTQ
uNC70YwKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgIyDQo9Cx0LXQtNC40LzRgdGP
LCDRh9GC0L4g0LXRgdGC0YwgaG9zdCDQuCBwb3J0CiAgICAgICAgICAgICAgICBpZiAnaG9zdCcg
bm90IGluIGNsZWFuX2NvbmZpZzoKICAgICAgICAgICAgICAgICAgICBpZiAnY2x1c3Rlcl9ub2Rl
cycgaW4gY2xlYW5fY29uZmlnIGFuZCBjbGVhbl9jb25maWdbJ2NsdXN0ZXJfbm9kZXMnXToKICAg
ICAgICAgICAgICAgICAgICAgICAgY2xlYW5fY29uZmlnWydob3N0J10gPSBjbGVhbl9jb25maWdb
J2NsdXN0ZXJfbm9kZXMnXVswXVswXQogICAgICAgICAgICAgICAgICAgICAgICBjbGVhbl9jb25m
aWdbJ3BvcnQnXSA9IGNsZWFuX2NvbmZpZ1snY2x1c3Rlcl9ub2RlcyddWzBdWzFdCiAgICAgICAg
ICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW5fY29uZmlnWydo
b3N0J10gPSAnbG9jYWxob3N0JwogICAgICAgICAgICAgICAgICAgICAgICBjbGVhbl9jb25maWdb
J3BvcnQnXSA9IDYzNzkKCiAgICAgICAgICAgICAgICBwcm9maWxlc1tuYW1lXSA9IENvbm5lY3Rp
b25Qcm9maWxlKCoqY2xlYW5fY29uZmlnKQogICAgICAgICAgICBleGNlcHQgVHlwZUVycm9yIGFz
IGU6CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJJbnZhbGlkIGNvbmZpZyBmb3IgcHJv
ZmlsZSAne25hbWV9Jzoge2V9IikKICAgICAgICAgICAgICAgICMg0J/RgNC+0LHRg9C10Lwg0YHQ
vtC30LTQsNGC0Ywg0L/RgNC+0YTQuNC70Ywg0YEg0LzQuNC90LjQvNCw0LvRjNC90YvQvNC4INC/
0LDRgNCw0LzQtdGC0YDQsNC80LgKICAgICAgICAgICAgICAgIG1pbmltYWxfY29uZmlnID0gewog
ICAgICAgICAgICAgICAgICAgICduYW1lJzogbmFtZSwKICAgICAgICAgICAgICAgICAgICAnaG9z
dCc6IGNvbmZpZy5nZXQoJ2hvc3QnLCAnbG9jYWxob3N0JyksCiAgICAgICAgICAgICAgICAgICAg
J3BvcnQnOiBjb25maWcuZ2V0KCdwb3J0JywgNjM3OSksCiAgICAgICAgICAgICAgICAgICAgJ2Ns
dXN0ZXJfbW9kZSc6IGNvbmZpZy5nZXQoJ2NsdXN0ZXJfbW9kZScsIEZhbHNlKQogICAgICAgICAg
ICAgICAgfQogICAgICAgICAgICAgICAgaWYgJ3Bhc3N3b3JkJyBpbiBjb25maWc6CiAgICAgICAg
ICAgICAgICAgICAgbWluaW1hbF9jb25maWdbJ3Bhc3N3b3JkJ10gPSBjb25maWdbJ3Bhc3N3b3Jk
J10KICAgICAgICAgICAgICAgIHByb2ZpbGVzW25hbWVdID0gQ29ubmVjdGlvblByb2ZpbGUoKipt
aW5pbWFsX2NvbmZpZykKCiAgICAgICAgIyDQn9GA0L7RhNC40LvRjCDQv9C+INGD0LzQvtC70YfQ
sNC90LjRjiwg0LXRgdC70Lgg0LTQsNC90L3Ri9GFINC90LXRggogICAgICAgIGlmIG5vdCBwcm9m
aWxlczoKICAgICAgICAgICAgcHJvZmlsZXNbJ2xvY2FsaG9zdCddID0gQ29ubmVjdGlvblByb2Zp
bGUoJ2xvY2FsaG9zdCcsICdsb2NhbGhvc3QnLCA2Mzc5KQoKICAgICAgICByZXR1cm4gcHJvZmls
ZXMKCiAgICBkZWYgX2V4aXRfZXJyb3Ioc2VsZiwgbWVzc2FnZTogc3RyKToKICAgICAgICAiIiLQ
ktGL0LLQvtC0INC+0YjQuNCx0LrQuCDQuCDQstGL0YXQvtC0INC40Lcg0L/RgNC+0LPRgNCw0LzQ
vNGLIiIiCiAgICAgICAgcHJpbnQoZiJFUlJPUjoge21lc3NhZ2V9IiwgZmlsZT1zeXMuc3RkZXJy
KQogICAgICAgIGxvZ2dlci5lcnJvcihtZXNzYWdlKQogICAgICAgIHN5cy5leGl0KDEpCgogICAg
ZGVmIHZhbGlkYXRlX3Byb2ZpbGVzKHNlbGYpOgogICAgICAgICIiItCS0LDQu9C40LTQsNGG0LjR
jyDQt9Cw0LPRgNGD0LbQtdC90L3Ri9GFINC/0YDQvtGE0LjQu9C10LkiIiIKICAgICAgICBmb3Ig
bmFtZSwgcHJvZmlsZSBpbiBzZWxmLnByb2ZpbGVzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHBy
b2ZpbGUuY2x1c3Rlcl9tb2RlOgogICAgICAgICAgICAgICAgIyDQn9GA0L7QstC10YDQutCwINGD
0LfQu9C+0LIg0LrQu9Cw0YHRgtC10YDQsAogICAgICAgICAgICAgICAgaWYgbm90IGhhc2F0dHIo
cHJvZmlsZSwgJ2NsdXN0ZXJfbm9kZXMnKSBvciBub3QgcHJvZmlsZS5jbHVzdGVyX25vZGVzOgog
ICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiUHJvZmlsZSAne25hbWV9JyBoYXMg
Y2x1c3Rlcl9tb2RlPVRydWUgYnV0IG5vIGNsdXN0ZXJfbm9kZXMgZGVmaW5lZCIpCiAgICAgICAg
ICAgICAgICAgICAgcHJvZmlsZS5jbHVzdGVyX21vZGUgPSBGYWxzZSAgIyDQntGC0LrQu9GO0YfQ
sNC10Lwg0YDQtdC20LjQvCDQutC70LDRgdGC0LXRgNCwCgogICAgICAgICAgICAgICAgIyDQn9GA
0L7QstC10YDQutCwINGE0L7RgNC80LDRgtCwINGD0LfQu9C+0LIKICAgICAgICAgICAgICAgIGZv
ciBpLCBub2RlIGluIGVudW1lcmF0ZShwcm9maWxlLmNsdXN0ZXJfbm9kZXMpOgogICAgICAgICAg
ICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG5vZGUsIChsaXN0LCB0dXBsZSkpIG9yIGxlbihu
b2RlKSAhPSAyOgogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJQcm9maWxl
ICd7bmFtZX0nOiBJbnZhbGlkIG5vZGUgZm9ybWF0IGF0IGluZGV4IHtpfToge25vZGV9IikKICAg
ICAgICAgICAgICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKG5vZGVbMF0sIHN0cikgb3Igbm90
IGlzaW5zdGFuY2Uobm9kZVsxXSwgaW50KToKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2Vy
LmVycm9yKGYiUHJvZmlsZSAne25hbWV9JzogTm9kZSB7aX0gc2hvdWxkIGJlIChob3N0OnN0ciwg
cG9ydDppbnQpIikKCiAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA0LrQsCDQvtCx0Y/Qt9Cw0YLQ
tdC70YzQvdGL0YUg0L/QvtC70LXQuSDQtNC70Y8gc3RhbmRhbG9uZQogICAgICAgICAgICBlbGlm
IG5vdCBwcm9maWxlLnNvY2tldF9wYXRoIGFuZCAobm90IHByb2ZpbGUuaG9zdCBvciBub3QgcHJv
ZmlsZS5wb3J0KToKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIlByb2ZpbGUgJ3tuYW1l
fScgbWlzc2luZyBob3N0L3BvcnQgZm9yIHN0YW5kYWxvbmUgY29ubmVjdGlvbiIpCgogICAgICAg
IGxvZ2dlci5pbmZvKGYiVmFsaWRhdGVkIHtsZW4oc2VsZi5wcm9maWxlcyl9IHByb2ZpbGVzIikK
CiAgICBkZWYgY3JlYXRlX3Rvb2xiYXIoc2VsZik6CiAgICAgICAgIiIi0KHQvtC30LTQsNC90LjQ
tSB0b29sYmFyINGBINC60L3QvtC/0LrQsNC80LgiIiIKICAgICAgICByZXR1cm4gdXJ3aWQuQ29s
dW1ucyhbCiAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5oZWxw
X2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAgICgncGFjaycsIHVy
d2lkLlRleHQoJyAnKSksCiAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0dHJNYXAo
c2VsZi5jb21tYW5kc19idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAg
ICAoJ3BhY2snLCB1cndpZC5UZXh0KCcgJykpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDIwLCB1
cndpZC5BdHRyTWFwKHNlbGYuYWRkX2tleV9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykp
LAogICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5UZXh0KCcgJykpLAogICAgICAgICAgICAoJ3dl
aWdodCcsIDIwLCB1cndpZC5BdHRyTWFwKHNlbGYuZWRpdF9idG4sICdidXR0b24nLCAnYnV0dG9u
X2ZvY3VzJykpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLlRleHQoJycpKSwKICAg
ICAgICAgICAgKCd3ZWlnaHQnLCAyMCwgdXJ3aWQuQXR0ck1hcChzZWxmLmRlbGV0ZV9idG4sICdi
dXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lk
LlRleHQoJycpKSwKICAgICAgICAgICAgKCd3ZWlnaHQnLCAyMCwgdXJ3aWQuQXR0ck1hcChzZWxm
LmRpc2Nvbm5lY3RfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpKSwKICAgICAgICAgICAg
KCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgKCd3ZWlnaHQnLCAyMCwgdXJ3
aWQuQXR0ck1hcChzZWxmLmV4aXRfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpKSwKICAg
ICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgKCd3ZWlnaHQn
LCAyMCwgdXJ3aWQuQXR0ck1hcChzZWxmLnJlZnJlc2hfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9m
b2N1cycpKSwKICAgICAgICBdLCBkaXZpZGVjaGFycz0wKQoKICAgIGRlZiBjcmVhdGVfdWkoc2Vs
Zik6CiAgICAgICAgIiIi0KHQvtC30LTQsNC90LjQtSDQuNC90YLQtdGA0YTQtdC50YHQsCIiIgog
ICAgICAgICMgSGVhZGVyCiAgICAgICAgaGVhZGVyX3RleHQgPSB1cndpZC5UZXh0KFsKICAgICAg
ICAgICAgKCdoZWFkZXJfdGV4dCcsICcg4pePICcpLAogICAgICAgICAgICAoJ2hlYWRlcl90ZXh0
JywgJ1JlZGlzIENvbW1hbmRlciBUVUknKQogICAgICAgIF0sIGFsaWduPSdsZWZ0JykKCiAgICAg
ICAgc2VsZi5oZWFkZXIgPSB1cndpZC5BdHRyTWFwKAogICAgICAgICAgICB1cndpZC5QYWRkaW5n
KGhlYWRlcl90ZXh0LCBsZWZ0PTEsIHJpZ2h0PTEpLAogICAgICAgICAgICAnaGVhZGVyJwogICAg
ICAgICkKCiAgICAgICAgIyBUb29sYmFyCiAgICAgICAgc2VsZi5jb3B5X2J0biA9IHVyd2lkLkJ1
dHRvbignRjU6IENvcHknKQogICAgICAgIHNlbGYubW92ZV9idG4gPSB1cndpZC5CdXR0b24oJ0Y2
OiBNb3ZlJykKICAgICAgICBzZWxmLnJlZnJlc2hfYnRuID0gdXJ3aWQuQnV0dG9uKCdGMTE6IFJl
ZnJlc2gnKQogICAgICAgIHNlbGYuZGVsZXRlX2J0biA9IHVyd2lkLkJ1dHRvbignRjg6IERlbGV0
ZScpCiAgICAgICAgc2VsZi5jb21tYW5kc19idG4gPSB1cndpZC5CdXR0b24oJ0YyOiBDb21tYW5k
cycpCiAgICAgICAgc2VsZi5hZGRfa2V5X2J0biA9IHVyd2lkLkJ1dHRvbignRjM6IEFkZCBOZXcg
S2V5JykKICAgICAgICBzZWxmLmVkaXRfYnRuID0gdXJ3aWQuQnV0dG9uKCdGNDogRWRpdCcpCiAg
ICAgICAgc2VsZi5kaXNjb25uZWN0X2J0biA9IHVyd2lkLkJ1dHRvbignRjk6IERpc2Nvbm5lY3Qn
KQogICAgICAgIHNlbGYuaGVscF9idG4gPSB1cndpZC5CdXR0b24oJ0YxOiBIZWxwJykKICAgICAg
ICBzZWxmLmV4aXRfYnRuID0gdXJ3aWQuQnV0dG9uKCdGMTA6IEV4aXQnKQoKICAgICAgICB1cndp
ZC5jb25uZWN0X3NpZ25hbChzZWxmLnJlZnJlc2hfYnRuLCAnY2xpY2snLCBsYW1iZGEgYjogc2Vs
Zi5yZWZyZXNoX2tleXMoKSkKICAgICAgICB1cndpZC5jb25uZWN0X3NpZ25hbChzZWxmLmRlbGV0
ZV9idG4sICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLmRlbGV0ZV9tYXJrZWRfa2V5cygpKQogICAg
ICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKHNlbGYuY29tbWFuZHNfYnRuLCAnY2xpY2snLCBsYW1i
ZGEgYjogc2VsZi50b2dnbGVfY29uc29sZSgpKQogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFs
KHNlbGYuZWRpdF9idG4sICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLmVkaXRfa2V5X3dyYXBwZXIo
KSkKICAgICAgICB1cndpZC5jb25uZWN0X3NpZ25hbChzZWxmLmFkZF9rZXlfYnRuLCAnY2xpY2sn
LCBsYW1iZGEgYjogc2VsZi5zaG93X2FkZF9rZXlfZGlhbG9nKCkpCiAgICAgICAgdXJ3aWQuY29u
bmVjdF9zaWduYWwoc2VsZi5kaXNjb25uZWN0X2J0biwgJ2NsaWNrJywgbGFtYmRhIGI6IHNlbGYu
ZGlzY29ubmVjdCgpKQogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKHNlbGYuZXhpdF9idG4s
ICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLmV4aXRfbWFpbigpKQogICAgICAgIHVyd2lkLmNvbm5l
Y3Rfc2lnbmFsKHNlbGYuaGVscF9idG4sICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLnNob3dfaGVs
cCgpKQoKICAgICAgICAjINCY0YHQv9C+0LvRjNC30YPQtdC8INC80LXRgtC+0LQg0LTQu9GPINGB
0L7Qt9C00LDQvdC40Y8gdG9vbGJhcgogICAgICAgIHRvb2xiYXIgPSBzZWxmLmNyZWF0ZV90b29s
YmFyKCkKCiAgICAgICAgIyDQm9C10LLQsNGPINC/0LDQvdC10LvRjDog0JrQntCc0JHQmNCd0JjQ
oNCe0JLQkNCd0J3QkNCvICjRgdC10YDQstC10YDRiy9EQiDQstCy0LXRgNGF0YMgKyDQutC70Y7R
h9C4INCy0L3QuNC30YMpCiAgICAgICAgIyDQlNC10YDQtdCy0L4g0L/QvtC00LrQu9GO0YfQtdC9
0LjQuSDQuCDQsdCw0Lcg0LTQsNC90L3Ri9GFCiAgICAgICAgc2VsZi5jb25uZWN0aW9uX3RyZWUg
PSB1cndpZC5TaW1wbGVMaXN0V2Fsa2VyKFtdKQogICAgICAgIHNlbGYuY29ubmVjdGlvbl9saXN0
Ym94ID0gdXJ3aWQuTGlzdEJveChzZWxmLmNvbm5lY3Rpb25fdHJlZSkKCiAgICAgICAgIyDQntCx
0YrQtdC00LjQvdGP0LXQvDog0LTQtdGA0LXQstC+INC/0L7QtNC60LvRjtGH0LXQvdC40LkgKyDR
gdC/0LjRgdC+0Log0LrQu9GO0YfQtdC5LCDQmtCQ0JbQlNCr0Jkg0YHQviDRgdCy0L7QuNC8IHNj
cm9sbGJhcgogICAgICAgIHNlbGYubGVmdF9wYW5lbF9waWxlID0gdXJ3aWQuUGlsZShbCiAgICAg
ICAgICAgICgnd2VpZ2h0JywgMSwgU2Nyb2xsQmFyKHVyd2lkLkF0dHJNYXAoc2VsZi5jb25uZWN0
aW9uX2xpc3Rib3gsICdzaWRlYmFyJykpKSwgICMg4pyFIFNjcm9sbGJhciDQtNC70Y8g0LTQtdGA
0LXQstCwCiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkRpdmlkZXIoJ+KUgCcpKSwKICAgICAg
ICAgICAgKCd3ZWlnaHQnLCA0LCBTY3JvbGxCYXIoc2VsZi5rZXlfbGlzdF92aWV3Lmxpc3Rib3gp
KSwgICMg4pyFIFNjcm9sbGJhciDQtNC70Y8g0LrQu9GO0YfQtdC5CiAgICAgICAgXSkKCiAgICAg
ICAgIyDQndCVINC+0LHQvtGA0LDRh9C40LLQsNC10LwgUGlsZSDQsiBTY3JvbGxCYXIsINGCLtC6
LiBzY3JvbGxiYXIn0Ysg0YPQttC1INCy0L3Rg9GC0YDQuAogICAgICAgIHNlbGYubGVmdF9wYW5l
bCA9IHVyd2lkLkxpbmVCb3goCiAgICAgICAgICAgIHNlbGYubGVmdF9wYW5lbF9waWxlLAogICAg
ICAgICAgICB0aXRsZT0nQ29ubmVjdGlvbnMgJiBLZXlzJwogICAgICAgICkKCiAgICAgICAgIyDQ
n9GA0LDQstCw0Y8g0L/QsNC90LXQu9GMCiAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyID0gdXJ3
aWQuU2ltcGxlTGlzdFdhbGtlcihbXSkKICAgICAgICBzZWxmLmRldGFpbF9saXN0Ym94ID0gdXJ3
aWQuTGlzdEJveChzZWxmLmRldGFpbF93YWxrZXIpCgogICAgICAgIHNlbGYucmlnaHRfcGFuZWwg
PSB1cndpZC5MaW5lQm94KAogICAgICAgICAgICBTY3JvbGxCYXIodXJ3aWQuQXR0ck1hcChzZWxm
LmRldGFpbF9saXN0Ym94LCAnYmFja2dyb3VuZCcpKSwgICMg4pyFINCe0LHQvtGA0LDRh9C40LLQ
sNC10LwKICAgICAgICAgICAgdGl0bGU9J0RldGFpbHMnCiAgICAgICAgKQoKICAgICAgICAjINCe
0YHQvdC+0LLQvdCw0Y8g0L7QsdC70LDRgdGC0YwKICAgICAgICBjb250ZW50ID0gdXJ3aWQuQ29s
dW1ucyhbCiAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgc2VsZi5sZWZ0X3BhbmVsKSwKICAgICAg
ICAgICAgKCd3ZWlnaHQnLCAxLCBzZWxmLnJpZ2h0X3BhbmVsKSwKICAgICAgICBdLCBkaXZpZGVj
aGFycz0xKQoKICAgICAgICAjIFRhYnMKICAgICAgICBzZWxmLnRhYl90ZXh0ID0gdXJ3aWQuVGV4
dCgnJykKCiAgICAgICAgIyDQodGC0LDRgtGD0YEKICAgICAgICBzZWxmLnN0YXR1c190ZXh0ID0g
dXJ3aWQuVGV4dCgnUmVhZHknKQoKICAgICAgICAjINCa0L7QvdGB0L7Qu9GMIC0g0LjRgdGC0L7R
gNC40Y8g0LrQvtC80LDQvdC0INC4INGA0LXQt9GD0LvRjNGC0LDRgtC+0LIKICAgICAgICBzZWxm
LmNvbnNvbGVfaGlzdG9yeSA9IHVyd2lkLlNpbXBsZUxpc3RXYWxrZXIoW10pCiAgICAgICAgc2Vs
Zi5jb25zb2xlX2xpc3Rib3ggPSB1cndpZC5MaXN0Qm94KHNlbGYuY29uc29sZV9oaXN0b3J5KQoK
ICAgICAgICAjINCf0YDQvtC80L/RgiDQtNC70Y8g0LLQstC+0LTQsCDQutC+0LzQsNC90LTRiwog
ICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHQgPSB1cndpZC5FZGl0KCdyZWRpcz4gJykKCiAgICAg
ICAgIyDQntCx0L7RgNCw0YfQuNCy0LDQtdC8INC/0YDQvtC80L/RgiDQtNC70Y8g0L/QtdGA0LXR
hdCy0LDRgtCwINC60LvQsNCy0LjRiAogICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHRfd3JhcHBl
ciA9IENvbW1hbmRQcm9tcHRXcmFwcGVyKAogICAgICAgICAgICBzZWxmLmNvbW1hbmRfcHJvbXB0
LAogICAgICAgICAgICBvbl91cD1sYW1iZGE6IHNlbGYubmF2aWdhdGVfaGlzdG9yeSgndXAnKSwK
ICAgICAgICAgICAgb25fZG93bj1sYW1iZGE6IHNlbGYubmF2aWdhdGVfaGlzdG9yeSgnZG93bicp
LAogICAgICAgICAgICBvbl9lbnRlcj1zZWxmLmV4ZWN1dGVfY29uc29sZV9jb21tYW5kCiAgICAg
ICAgKQogICAgICAgICMg0J/QsNC90LXQu9GMINC60L7QvdGB0L7Qu9C4CiAgICAgICAgY29uc29s
ZV9waWxlID0gdXJ3aWQuUGlsZShbCiAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgU2Nyb2xsQmFy
KHVyd2lkLkF0dHJNYXAoc2VsZi5jb25zb2xlX2xpc3Rib3gsICdiYWNrZ3JvdW5kJykpKSwgICMg
4pyFINCe0LHQvtGA0LDRh9C40LLQsNC10LwKICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuRGl2
aWRlcign4pSAJykpLAogICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5BdHRyTWFwKHNlbGYuY29t
bWFuZF9wcm9tcHRfd3JhcHBlciwgJ2Zvb3RlcicpKSwKICAgICAgICBdKQoKICAgICAgICBjb25z
b2xlX3BpbGUuZm9jdXNfcG9zaXRpb24gPSAyICAjINCk0L7QutGD0YEg0L3QsCDQv9GA0L7QvNC/
0YIg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4KCiAgICAgICAgc2VsZi5jb25zb2xlX3BhbmVsID0g
dXJ3aWQuTGluZUJveCgKICAgICAgICAgICAgY29uc29sZV9waWxlLAogICAgICAgICAgICB0aXRs
ZT0nUmVkaXMgQ29uc29sZScKICAgICAgICApCgogICAgICAgICMg0J7RgdC90L7QstC90L7QtSDR
gtC10LvQviDRgSDQstC+0LfQvNC+0LbQvdC+0YHRgtGM0Y4g0L/QtdGA0LXQutC70Y7Rh9C10L3Q
uNGPCiAgICAgICAgc2VsZi5tYWluX2NvbnRlbnQgPSB1cndpZC5QaWxlKFsKICAgICAgICAgICAg
KCdwYWNrJywgdXJ3aWQuQXR0ck1hcCh1cndpZC5QYWRkaW5nKHRvb2xiYXIsIGxlZnQ9MSwgcmln
aHQ9MSksICdiYWNrZ3JvdW5kJykpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLkF0
dHJNYXAoY29udGVudCwgJ2JhY2tncm91bmQnKSksCiAgICAgICAgXSkKCiAgICAgICAgIyBGb290
ZXIgcGlsZQogICAgICAgIHNlbGYuZm9vdGVyX3BpbGUgPSB1cndpZC5QaWxlKFsKICAgICAgICAg
ICAgdXJ3aWQuQXR0ck1hcChzZWxmLnRhYl90ZXh0LCAnZm9vdGVyJyksCiAgICAgICAgICAgIHVy
d2lkLkF0dHJNYXAoc2VsZi5zdGF0dXNfdGV4dCwgJ2Zvb3RlcicpLAogICAgICAgIF0pCgogICAg
ICAgIHNlbGYubWFpbl9mcmFtZSA9IHVyd2lkLkZyYW1lKAogICAgICAgICAgICBoZWFkZXI9c2Vs
Zi5oZWFkZXIsCiAgICAgICAgICAgIGJvZHk9c2VsZi5tYWluX2NvbnRlbnQsCiAgICAgICAgICAg
IGZvb3Rlcj1zZWxmLmZvb3Rlcl9waWxlCiAgICAgICAgKQoKICAgICAgICAjINCj0YHRgtCw0L3Q
sNCy0LvQuNCy0LDQtdC8INC90LDRh9Cw0LvRjNC90YvQuSDRhNC+0LrRg9GBINC90LAgYm9keSAo
0L3QtSDQvdCwIGhlYWRlciDRgSDQutC90L7Qv9C60LDQvNC4KQogICAgICAgIHNlbGYubWFpbl9m
cmFtZS5mb2N1c19wb3NpdGlvbiA9ICdib2R5JwoKICAgICAgICAjINCj0YHRgtCw0L3QsNCy0LvQ
uNCy0LDQtdC8INGE0L7QutGD0YEg0L3QsCBjb250ZW50X2FyZWEgKNC/0YDQvtC/0YPRgdC60LDQ
tdC8IHRvb2xiYXIpCiAgICAgICAgc2VsZi5tYWluX2NvbnRlbnQuZm9jdXNfcG9zaXRpb24gPSAx
ICAjIDA9dG9vbGJhciwgMT1jb250ZW50X2FyZWEKCiAgICAgICAgc2VsZi51cGRhdGVfY29ubmVj
dGlvbl90cmVlKCkKCiAgICBkZWYgdG9nZ2xlX2NvbnNvbGUoc2VsZik6CiAgICAgICAgIiIi0J/Q
tdGA0LXQutC70Y7Rh9C10L3QuNC1INC60L7QvdGB0L7Qu9C4IiIiCiAgICAgICAgaWYgc2VsZi5j
b25zb2xlX21vZGU6CiAgICAgICAgICAgICMg0JLRi9C60LvRjtGH0LDQtdC8INC60L7QvdGB0L7Q
u9GMIC0g0L/QvtC60LDQt9GL0LLQsNC10Lwg0L7RgdC90L7QstC90L7QuSDQutC+0L3RgtC10L3R
ggogICAgICAgICAgICBzZWxmLm1haW5fY29udGVudC5jb250ZW50cyA9IFsKICAgICAgICAgICAg
ICAgICh1cndpZC5BdHRyTWFwKHVyd2lkLlBhZGRpbmcoCiAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5jcmVhdGVfdG9vbGJhcigpLCAgIyDinIUg0JjRgdC/0L7Qu9GM0LfRg9C10Lwg0LzQtdGC0L7Q
tAogICAgICAgICAgICAgICAgICAgIGxlZnQ9MSwgcmlnaHQ9MSksICdiYWNrZ3JvdW5kJyksICgn
cGFjaycsIE5vbmUpKSwKICAgICAgICAgICAgICAgICh1cndpZC5BdHRyTWFwKHVyd2lkLkNvbHVt
bnMoWwogICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgc2VsZi5sZWZ0X3BhbmVsKSwg
ICMg4pyFINCY0YHQv9C+0LvRjNC30YPQtdC8IGxlZnRfcGFuZWwg0YEg0LTQtdGA0LXQstC+0Lwr
0LrQu9GO0YfQsNC80LgKICAgICAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHNlbGYucmln
aHRfcGFuZWwpLCAgIyDinIUg0JjRgdC/0L7Qu9GM0LfRg9C10LwgcmlnaHRfcGFuZWwKICAgICAg
ICAgICAgICAgIF0sIGRpdmlkZWNoYXJzPTEpLCAnYmFja2dyb3VuZCcpLCAoJ3dlaWdodCcsIDEp
KSwKICAgICAgICAgICAgXQogICAgICAgICAgICBzZWxmLmNvbnNvbGVfbW9kZSA9IEZhbHNlCiAg
ICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cygiQ29uc29sZSBjbG9zZWQiKQogICAgICAgIGVsc2U6
CiAgICAgICAgICAgICMg0JLQutC70Y7Rh9Cw0LXQvCDQutC+0L3RgdC+0LvRjCAtINGA0LDQt9C0
0LXQu9GP0LXQvCDRjdC60YDQsNC9CiAgICAgICAgICAgIGNvbnRlbnRfYXJlYSA9IHVyd2lkLkNv
bHVtbnMoWwogICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAxLCBzZWxmLmxlZnRfcGFuZWwpLCAg
IyDinIUg0JjRgdC/0L7Qu9GM0LfRg9C10LwgbGVmdF9wYW5lbCDRgSDQtNC10YDQtdCy0L7QvCvQ
utC70Y7Rh9Cw0LzQuAogICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAxLCBzZWxmLnJpZ2h0X3Bh
bmVsKSwgICMg4pyFINCY0YHQv9C+0LvRjNC30YPQtdC8IHJpZ2h0X3BhbmVsCiAgICAgICAgICAg
IF0sIGRpdmlkZWNoYXJzPTEpCgogICAgICAgICAgICBzZWxmLm1haW5fY29udGVudC5jb250ZW50
cyA9IFsKICAgICAgICAgICAgICAgICh1cndpZC5BdHRyTWFwKHVyd2lkLlBhZGRpbmcoCiAgICAg
ICAgICAgICAgICAgICAgc2VsZi5jcmVhdGVfdG9vbGJhcigpLCAgIyDinIUg0JjRgdC/0L7Qu9GM
0LfRg9C10Lwg0LzQtdGC0L7QtAogICAgICAgICAgICAgICAgICAgIGxlZnQ9MSwgcmlnaHQ9MSks
ICdiYWNrZ3JvdW5kJyksICgncGFjaycsIE5vbmUpKSwKICAgICAgICAgICAgICAgICh1cndpZC5B
dHRyTWFwKGNvbnRlbnRfYXJlYSwgJ2JhY2tncm91bmQnKSwgKCd3ZWlnaHQnLCAyKSksCiAgICAg
ICAgICAgICAgICAodXJ3aWQuQXR0ck1hcChzZWxmLmNvbnNvbGVfcGFuZWwsICdiYWNrZ3JvdW5k
JyksICgnd2VpZ2h0JywgMSkpLAogICAgICAgICAgICBdCiAgICAgICAgICAgIHNlbGYuY29uc29s
ZV9tb2RlID0gVHJ1ZQoKICAgICAgICAgICAgIyDQlNC+0LHQsNCy0LvRj9C10Lwg0L/RgNC40LLQ
tdGC0YHRgtCy0LXQvdC90L7QtSDRgdC+0L7QsdGJ0LXQvdC40LUg0LXRgdC70Lgg0LrQvtC90YHQ
vtC70Ywg0L/Rg9GB0YLQsNGPCiAgICAgICAgICAgIGlmIGxlbihzZWxmLmNvbnNvbGVfaGlzdG9y
eSkgPT0gMDoKICAgICAgICAgICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5LmFwcGVuZCgKICAg
ICAgICAgICAgICAgICAgICB1cndpZC5UZXh0KCgnc3VjY2VzcycsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJ1JlZGlzIENvbnNvbGUgLSBUeXBlIGNvbW1hbmRzIGFuZCBwcmVzcyBF
bnRlci4gVHlwZSAiZXhpdCIgb3IgcHJlc3MgRXNjIHRvIGNsb3NlLicpKQogICAgICAgICAgICAg
ICAgKQogICAgICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLkRp
dmlkZXIoKSkKCiAgICAgICAgICAgICMg0KPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0YTQvtC6
0YPRgSDQvdCwINC60L7QvdGB0L7Qu9GM0L3Rg9GOINC/0LDQvdC10LvRjAogICAgICAgICAgICBz
ZWxmLm1haW5fY29udGVudC5mb2N1c19wb3NpdGlvbiA9IDIKICAgICAgICAgICAgIyDQpNC+0LrR
g9GBINC90LAg0L/RgNC+0LzQv9GCINCy0L3Rg9GC0YDQuCDQutC+0L3RgdC+0LvRjNC90L7QuSDQ
v9Cw0L3QtdC70LgKICAgICAgICAgICAgc2VsZi5jb25zb2xlX3BhbmVsLm9yaWdpbmFsX3dpZGdl
dC5mb2N1c19wb3NpdGlvbiA9IDIKICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKCJDb25zb2xl
IG9wZW5lZCAocHJlc3MgRjIgdG8gY2xvc2UpIikKCiAgICBkZWYgbnRvZ2dsZV9jb25zb2xlKHNl
bGYpOgogICAgICAgICIiItCf0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQutC+0L3RgdC+0LvQuCIi
IgogICAgICAgIGlmIHNlbGYuY29uc29sZV9tb2RlOgogICAgICAgICAgICAjINCS0YvQutC70Y7R
h9Cw0LXQvCDQutC+0L3RgdC+0LvRjCAtIDIg0LrQvtC70L7QvdC60LggKGNvbm5lY3Rpb25zK2tl
eXMgfCBkZXRhaWxzKQogICAgICAgICAgICB0b29sYmFyID0gdXJ3aWQuQ29sdW1ucyhbCiAgICAg
ICAgICAgICAgICAoJ3dlaWdodCcsIDIwLCB1cndpZC5BdHRyTWFwKHNlbGYucmVmcmVzaF9idG4s
ICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAgICAgICAgKCdwYWNrJywgdXJ3
aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0dHJN
YXAoc2VsZi5jb21tYW5kc19idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAg
ICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgnd2Vp
Z2h0JywgMjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5hZGRfa2V5X2J0biwgJ2J1dHRvbicsICdidXR0
b25fZm9jdXMnKSksCiAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLlRleHQoJycp
KSwKICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5kaXNj
b25uZWN0X2J0biwgJ2J1dHRvbl9kYW5nZXInLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAg
ICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgnd2VpZ2h0
JywgMjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5oZWxwX2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9j
dXMnKSksCiAgICAgICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5UZXh0KCcgJykpLAogICAgICAg
ICAgICAgICAgKCd3ZWlnaHQnLCAyMCwgdXJ3aWQuQXR0ck1hcChzZWxmLmV4aXRfYnRuLCAnYnV0
dG9uJywgJ2J1dHRvbl9mb2N1cycpKSwKICAgICAgICAgICAgXSwgZGl2aWRlY2hhcnM9MCkKCiAg
ICAgICAgICAgICMgMiDQutC+0LvQvtC90LrQuDog0LvQtdCy0LDRjyAoY29ubmVjdGlvbnMra2V5
cykgfCDQv9GA0LDQstCw0Y8gKGRldGFpbHMpCiAgICAgICAgICAgIGNvbnRlbnRfYXJlYSA9IHVy
d2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAxLCBzZWxmLmxlZnRfcGFu
ZWwpLAogICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAyLCBzZWxmLnJpZ2h0X3BhbmVsKSwKICAg
ICAgICAgICAgXSwgZGl2aWRlY2hhcnM9MSkKCiAgICAgICAgICAgIHNlbGYubWFpbl9jb250ZW50
LmNvbnRlbnRzID0gWwogICAgICAgICAgICAgICAgKHVyd2lkLkF0dHJNYXAodXJ3aWQuUGFkZGlu
Zyh0b29sYmFyLCBsZWZ0PTEsIHJpZ2h0PTEpLCAnYmFja2dyb3VuZCcpLCAoJ3BhY2snLCBOb25l
KSksCiAgICAgICAgICAgICAgICAodXJ3aWQuQXR0ck1hcChjb250ZW50X2FyZWEsICdiYWNrZ3Jv
dW5kJyksICgnd2VpZ2h0JywgMSkpLAogICAgICAgICAgICBdCiAgICAgICAgICAgIHNlbGYuY29u
c29sZV9tb2RlID0gRmFsc2UKICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKCJDb25zb2xlIGNs
b3NlZCIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyDQktC60LvRjtGH0LDQtdC8INC60L7Q
vdGB0L7Qu9GMIC0gMyDQutC+0LvQvtC90LrQuCAoY29ubmVjdGlvbnMra2V5cyB8IGRldGFpbHMg
fCBjb25zb2xlKQogICAgICAgICAgICB0b29sYmFyID0gdXJ3aWQuQ29sdW1ucyhbCiAgICAgICAg
ICAgICAgICAoJ3dlaWdodCcsIDIwLCB1cndpZC5BdHRyTWFwKHNlbGYucmVmcmVzaF9idG4sICdi
dXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQu
VGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0dHJNYXAo
c2VsZi5jb21tYW5kc19idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAg
ICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgnd2VpZ2h0
JywgMjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5hZGRfa2V5X2J0biwgJ2J1dHRvbicsICdidXR0b25f
Zm9jdXMnKSksCiAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLlRleHQoJycpKSwK
ICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5kaXNjb25u
ZWN0X2J0biwgJ2J1dHRvbl9kYW5nZXInLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAgICAg
ICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAgICAgICAgICAgICAgICgnd2VpZ2h0Jywg
MjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5oZWxwX2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMn
KSksCiAgICAgICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5UZXh0KCcgJykpLAogICAgICAgICAg
ICAgICAgKCd3ZWlnaHQnLCAyMCwgdXJ3aWQuQXR0ck1hcChzZWxmLmV4aXRfYnRuLCAnYnV0dG9u
JywgJ2J1dHRvbl9mb2N1cycpKSwKICAgICAgICAgICAgXSwgZGl2aWRlY2hhcnM9MCkKCiAgICAg
ICAgICAgICMg4pyFIDMg0LrQvtC70L7QvdC60Lg6INC70LXQstCw0Y8gKGNvbm5lY3Rpb25zK2tl
eXMpIHwg0YHRgNC10LTQvdGP0Y8gKGRldGFpbHMpIHwg0L/RgNCw0LLQsNGPIChjb25zb2xlKQog
ICAgICAgICAgICBjb250ZW50X2FyZWEgPSB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAgICAg
ICgnd2VpZ2h0JywgMSwgc2VsZi5sZWZ0X3BhbmVsKSwKICAgICAgICAgICAgICAgICgnd2VpZ2h0
JywgMiwgc2VsZi5yaWdodF9wYW5lbCksCiAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHNl
bGYuY29uc29sZV9wYW5lbCksICAjIOKchSDQmtC+0L3RgdC+0LvRjCDQutCw0Log0YLRgNC10YLR
jNGPINC60L7Qu9C+0L3QutCwCiAgICAgICAgICAgIF0sIGRpdmlkZWNoYXJzPTEsIGZvY3VzX2Nv
bHVtbj0yKSAgIyDinIUg0KTQvtC60YPRgSDQvdCwINC60L7QvdGB0L7Qu9GMCgogICAgICAgICAg
ICBzZWxmLm1haW5fY29udGVudC5jb250ZW50cyA9IFsKICAgICAgICAgICAgICAgICh1cndpZC5B
dHRyTWFwKHVyd2lkLlBhZGRpbmcodG9vbGJhciwgbGVmdD0xLCByaWdodD0xKSwgJ2JhY2tncm91
bmQnKSwgKCdwYWNrJywgTm9uZSkpLAogICAgICAgICAgICAgICAgKHVyd2lkLkF0dHJNYXAoY29u
dGVudF9hcmVhLCAnYmFja2dyb3VuZCcpLCAoJ3dlaWdodCcsIDEpKSwKICAgICAgICAgICAgXQog
ICAgICAgICAgICBzZWxmLmNvbnNvbGVfbW9kZSA9IFRydWUKCiAgICAgICAgICAgICMg0J/RgNC4
0LLQtdGC0YHRgtCy0LXQvdC90L7QtSDRgdC+0L7QsdGJ0LXQvdC40LUKICAgICAgICAgICAgaWYg
bGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSA9PSAwOgogICAgICAgICAgICAgICAgc2VsZi5jb25z
b2xlX2hpc3RvcnkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHVyd2lkLlRleHQoKCdzdWNj
ZXNzJywgJ1JlZGlzIENvbnNvbGUnKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAg
IHNlbGYuY29uc29sZV9oaXN0b3J5LmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICB1cndpZC5U
ZXh0KCgnc3VjY2VzcycsICfihpEv4oaTIC0gaGlzdG9yeSB8IFRhYiAtIHN3aXRjaCBwYW5lbCcp
KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3Rvcnku
YXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHVyd2lkLlRleHQoKCdzdWNjZXNzJywgJ2NsZWFy
IC0gY2xlYXIgfCBleGl0IC0gY2xvc2UnKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAg
ICAgIHNlbGYuY29uc29sZV9oaXN0b3J5LmFwcGVuZCh1cndpZC5EaXZpZGVyKCkpCgogICAgICAg
ICAgICAjIOKchSDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDRhNC+0LrRg9GBCiAgICAgICAg
ICAgIHNlbGYubWFpbl9jb250ZW50LmZvY3VzX3Bvc2l0aW9uID0gMSAgIyDQndCwIGNvbnRlbnRf
YXJlYQoKICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKCJDb25zb2xlIG9wZW5lZCAoRjUgdG8g
Y2xvc2UsIFRhYiB0byBzd2l0Y2ggcGFuZWxzKSIpCgogICAgZGVmIGV4ZWN1dGVfY29uc29sZV9j
b21tYW5kKHNlbGYpOgogICAgICAgICIiItCS0YvQv9C+0LvQvdC10L3QuNC1INC60L7QvNCw0L3Q
tNGLINC40Lcg0LrQvtC90YHQvtC70Lgg0YEg0L/QvtC00LTQtdGA0LbQutC+0Lkg0LrQu9Cw0YHR
gtC10YDQsCIiIgogICAgICAgIGlmIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBub3Qg
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICBzZWxmLmNvbnNv
bGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuVGV4dCgoJ2Vycm9yJywgJ+KclyBOb3QgY29ubmVjdGVk
IHRvIFJlZGlzJykpKQogICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3
aWQuRGl2aWRlcigpKQogICAgICAgICAgICBpZiBsZW4oc2VsZi5jb25zb2xlX2hpc3RvcnkpID4g
MDoKICAgICAgICAgICAgICAgIHNlbGYuY29uc29sZV9saXN0Ym94LnNldF9mb2N1cyhsZW4oc2Vs
Zi5jb25zb2xlX2hpc3RvcnkpIC0gMSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGNvbW1h
bmQgPSBzZWxmLmNvbW1hbmRfcHJvbXB0LmdldF9lZGl0X3RleHQoKS5zdHJpcCgpCiAgICAgICAg
aWYgbm90IGNvbW1hbmQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIOKchSDQlNC+0LHQ
sNCy0LvRj9C10Lwg0LrQvtC80LDQvdC00YMg0LIg0LjRgdGC0L7RgNC40Y4g0KHQoNCQ0JfQowog
ICAgICAgIHNlbGYuYWRkX3RvX2hpc3RvcnkoY29tbWFuZCkKCiAgICAgICAgIyDQn9GA0L7QstC1
0YDRj9C10Lwg0L3QsCDQutC+0LzQsNC90LTRgyDQstGL0YXQvtC00LAKICAgICAgICBpZiBjb21t
YW5kLmxvd2VyKCkgaW4gWydleGl0JywgJ3F1aXQnXToKICAgICAgICAgICAgc2VsZi50b2dnbGVf
Y29uc29sZSgpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIOKchSDQmtC+0LzQsNC90LTQ
sCDQvtGH0LjRgdGC0LrQuCDQutC+0L3RgdC+0LvQuAogICAgICAgIGlmIGNvbW1hbmQubG93ZXIo
KSA9PSAnY2xlYXInOgogICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5jbGVhcigpCiAg
ICAgICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHQuc2V0X2VkaXRfdGV4dCgnJykKICAgICAgICAg
ICAgcmV0dXJuCgogICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INC60L7QvNCw0L3QtNGDINCy
INCy0LjQt9GD0LDQu9GM0L3Rg9GOINC40YHRgtC+0YDQuNGOINC60L7QvdGB0L7Qu9C4CiAgICAg
ICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLlRleHQoKCdpbmZvX2xhYmVsJywg
ZidyZWRpcz4ge2NvbW1hbmR9JykpKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNsaWVudCA9
IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmFjdGl2ZV9jbGllbnQKICAgICAgICAgICAgaXNfY2x1
c3RlciA9IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmlzX2NsdXN0ZXIKCiAgICAgICAgICAgICMg
0KDQsNC30LHQuNGA0LDQtdC8INC60L7QvNCw0L3QtNGDCiAgICAgICAgICAgIHBhcnRzID0gY29t
bWFuZC5zcGxpdCgpCiAgICAgICAgICAgIGNtZCA9IHBhcnRzWzBdLnVwcGVyKCkKICAgICAgICAg
ICAgYXJncyA9IHBhcnRzWzE6XQoKICAgICAgICAgICAgIyDQodC/0LXRhtC40LDQu9GM0L3QsNGP
INC+0LHRgNCw0LHQvtGC0LrQsCDQtNC70Y8g0LrQu9Cw0YHRgtC10YDQsAogICAgICAgICAgICBp
ZiBpc19jbHVzdGVyOgogICAgICAgICAgICAgICAgIyDQmtC+0LzQsNC90LTRiywg0LrQvtGC0L7R
gNGL0LUg0L3QtSDQv9C+0LTQtNC10YDQttC40LLQsNGO0YLRgdGPINCyINC60LvQsNGB0YLQtdGA
0LUKICAgICAgICAgICAgICAgIHVuc3VwcG9ydGVkX2NvbW1hbmRzID0gWydTRUxFQ1QnLCAnTU9W
RScsICdTV0FQREInLCAnTUlHUkFURScsICdSQU5ET01LRVknXQogICAgICAgICAgICAgICAgaWYg
Y21kIGluIHVuc3VwcG9ydGVkX2NvbW1hbmRzOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY29u
c29sZV9oaXN0b3J5LmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgdXJ3aWQuVGV4dCgo
J2Vycm9yJywgZiIoZXJyb3IpIENvbW1hbmQgJ3tjbWR9JyBub3Qgc3VwcG9ydGVkIGluIFJlZGlz
IENsdXN0ZXIiKSkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKICAgICAgICAgICAgICAg
ICAgICBzZWxmLmNvbW1hbmRfcHJvbXB0LnNldF9lZGl0X3RleHQoJycpCiAgICAgICAgICAgICAg
ICAgICAgIyDQn9GA0L7QutGA0YPRh9C40LLQsNC10Lwg0LLQvdC40LcKICAgICAgICAgICAgICAg
ICAgICBpZiBsZW4oc2VsZi5jb25zb2xlX2hpc3RvcnkpID4gMDoKICAgICAgICAgICAgICAgICAg
ICAgICAgc2VsZi5jb25zb2xlX2xpc3Rib3guc2V0X2ZvY3VzKGxlbihzZWxmLmNvbnNvbGVfaGlz
dG9yeSkgLSAxKQogICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgICAgICMg
0JrQvtC80LDQvdC00Ysg0LrQu9Cw0YHRgtC10YDQsCAo0L3QsNGH0LjQvdCw0Y7RidC40LXRgdGP
INGBIENMVVNURVIpCiAgICAgICAgICAgICAgICBpZiBjbWQuc3RhcnRzd2l0aCgnQ0xVU1RFUicp
OgogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNsaWVudC5leGVjdXRlX2NvbW1hbmQoY21k
LCAqYXJncykKCiAgICAgICAgICAgICAgICAjIEtFWVMgLSDRgtGA0LXQsdGD0LXRgiDRgdC60LDQ
vdC40YDQvtCy0LDQvdC40Y8g0LLRgdC10YUg0YPQt9C70L7QsgogICAgICAgICAgICAgICAgZWxp
ZiBjbWQgPT0gJ0tFWVMnOgogICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBhcmdzWzBdIGlm
IGFyZ3MgZWxzZSAnKicKICAgICAgICAgICAgICAgICAgICBrZXlzID0gW10KCiAgICAgICAgICAg
ICAgICAgICAgIyDinIUg0JjRgdC/0YDQsNCy0LvQtdC90L46INC/0YDQvtCy0LXRgNGP0LXQvCDQ
vdCw0LvQuNGH0LjQtSDQvNC10YLQvtC00LAgZ2V0X25vZGVzCiAgICAgICAgICAgICAgICAgICAg
aWYgaGFzYXR0cihjbGllbnQsICdnZXRfbm9kZXMnKToKICAgICAgICAgICAgICAgICAgICAgICAg
Zm9yIG5vZGUgaW4gY2xpZW50LmdldF9ub2RlcygpOgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIyDinIUg0J/RgNC+0LLQtdGA0Y/QtdC8INCw0YLRgNC40LHRg9GCIHNlcnZlcl90eXBlINCx
0LXQt9C+0L/QsNGB0L3QvgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaGFzYXR0cihu
b2RlLCAnc2VydmVyX3R5cGUnKSBhbmQgbm9kZS5zZXJ2ZXJfdHlwZSA9PSAnbWFzdGVyJzoKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG5vZGVfa2V5cyA9IG5vZGUua2V5cyhwYXR0ZXJuKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBrZXlzLmV4dGVuZChub2RlX2tleXMpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIkVycm9yIGdldHRpbmcga2V5
cyBmcm9tIG5vZGU6IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAg
ICAgICAgICAgICAgIyBGYWxsYmFjayDQtNC70Y8g0LTRgNGD0LPQuNGFINGA0LXQsNC70LjQt9Cw
0YbQuNC5INC60LvQsNGB0YLQtdGA0LAKICAgICAgICAgICAgICAgICAgICAgICAga2V5cyA9IGxp
c3QoY2xpZW50LnNjYW5faXRlcihtYXRjaD1wYXR0ZXJuLCBjb3VudD0xMDApKQoKICAgICAgICAg
ICAgICAgICAgICByZXN1bHQgPSBrZXlzCgogICAgICAgICAgICAgICAgIyBTQ0FOIC0g0YLRgNC1
0LHRg9C10YIg0L7QsdGA0LDQsdC+0YLQutC4INCy0YHQtdGFINGD0LfQu9C+0LIKICAgICAgICAg
ICAgICAgIGVsaWYgY21kID09ICdTQ0FOJzoKICAgICAgICAgICAgICAgICAgICBjdXJzb3IgPSBp
bnQoYXJnc1swXSkgaWYgYXJncyBhbmQgYXJnc1swXS5pc2RpZ2l0KCkgZWxzZSAwCiAgICAgICAg
ICAgICAgICAgICAgcGF0dGVybiA9IGFyZ3NbMl0gaWYgbGVuKGFyZ3MpID4gMiBhbmQgYXJnc1sx
XS51cHBlcigpID09ICdNQVRDSCcgZWxzZSAnKicKICAgICAgICAgICAgICAgICAgICBjb3VudCA9
IGludChhcmdzWzRdKSBpZiBsZW4oYXJncykgPiA0IGFuZCBhcmdzWzNdLnVwcGVyKCkgPT0gJ0NP
VU5UJyBlbHNlIDEwCgogICAgICAgICAgICAgICAgICAgIGFsbF9rZXlzID0gW10KCiAgICAgICAg
ICAgICAgICAgICAgaWYgaGFzYXR0cihjbGllbnQsICdnZXRfbm9kZXMnKToKICAgICAgICAgICAg
ICAgICAgICAgICAgZm9yIG5vZGUgaW4gY2xpZW50LmdldF9ub2RlcygpOgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaWYgaGFzYXR0cihub2RlLCAnc2VydmVyX3R5cGUnKSBhbmQgbm9kZS5z
ZXJ2ZXJfdHlwZSA9PSAnbWFzdGVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0
cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfY3Vyc29yID0gMAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9jdXJzb3IsIGJhdGNoID0gbm9kZS5z
Y2FuKG5vZGVfY3Vyc29yLCBtYXRjaD1wYXR0ZXJuLCBjb3VudD1jb3VudCkKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbF9rZXlzLmV4dGVuZChiYXRjaCkKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vZGVfY3Vyc29yID09IDA6CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiRXJyb3Igc2Nhbm5pbmcg
bm9kZToge2V9IikKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAg
ICAgICAjIEZhbGxiYWNrCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBrZXkgaW4gY2xpZW50
LnNjYW5faXRlcihtYXRjaD1wYXR0ZXJuLCBjb3VudD1jb3VudCk6CiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBhbGxfa2V5cy5hcHBlbmQoa2V5KQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaWYgbGVuKGFsbF9rZXlzKSA+PSBjb3VudDoKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBicmVhawoKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBbMCwgYWxsX2tleXNbOmNv
dW50XV0gaWYgYWxsX2tleXMgZWxzZSBbMCwgW11dCgogICAgICAgICAgICAgICAgIyBJTkZPIC0g
0YHQvtCx0LjRgNCw0LXQvCDQuNC90YTQvtGA0LzQsNGG0LjRjiDRgdC+INCy0YHQtdGFINGD0LfQ
u9C+0LIKICAgICAgICAgICAgICAgIGVsaWYgY21kID09ICdJTkZPJzoKICAgICAgICAgICAgICAg
ICAgICBpZiBhcmdzIGFuZCBhcmdzWzBdLmxvd2VyKCkgaW4gWydjbHVzdGVyJywgJ2tleXNwYWNl
JywgJ21lbW9yeScsICdjcHUnLCAnc3RhdHMnLCAncmVwbGljYXRpb24nXToKICAgICAgICAgICAg
ICAgICAgICAgICAgc2VjdGlvbiA9IGFyZ3NbMF0ubG93ZXIoKQogICAgICAgICAgICAgICAgICAg
ICAgICBpbmZvX3Jlc3VsdHMgPSBbXQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaGFzYXR0
cihjbGllbnQsICdnZXRfbm9kZXMnKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBu
b2RlIGluIGNsaWVudC5nZXRfbm9kZXMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiBoYXNhdHRyKG5vZGUsICdzZXJ2ZXJfdHlwZScpIGFuZCBub2RlLnNlcnZlcl90eXBlID09
ICdtYXN0ZXInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2luZm8gPSBub2RlLmluZm8o
c2VjdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfaG9z
dCA9IGdldGF0dHIobm9kZSwgJ2hvc3QnLCAndW5rbm93bicpCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBub2RlX3BvcnQgPSBnZXRhdHRyKG5vZGUsICdwb3J0JywgJ3Vu
a25vd24nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mb19yZXN1
bHRzLmFwcGVuZChmIi0tLSB7bm9kZV9ob3N0fTp7bm9kZV9wb3J0fSAtLS0iKQoKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0KTQvtGA0LzQsNGC0LjRgNGD0LXQvCDR
gdC70L7QstCw0YDRjAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg
aXNpbnN0YW5jZShub2RlX2luZm8sIGRpY3QpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGZvciBrLCB2IGluIG5vZGVfaW5mby5pdGVtcygpOgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvX3Jlc3VsdHMuYXBwZW5k
KGYie2t9OiB7dn0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxz
ZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvX3Jlc3Vs
dHMuYXBwZW5kKHN0cihub2RlX2luZm8pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbmZvX3Jlc3VsdHMuYXBwZW5kKGYiLS0tIEVSUk9SOiB7ZX0gLS0tIikKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9ICJcbiIuam9pbihpbmZvX3Jlc3VsdHMp
CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICByZXN1bHQgPSBjbGllbnQuaW5mbyhzZWN0aW9uKQogICAgICAgICAgICAgICAgICAgIGVsc2U6
CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNsaWVudC5pbmZvKCkKCiAgICAgICAg
ICAgICAgICAjIERCU0laRSAtINGB0YPQvNC80LjRgNGD0LXQvCDQv9C+INCy0YHQtdC8INGD0LfQ
u9Cw0LwKICAgICAgICAgICAgICAgIGVsaWYgY21kID09ICdEQlNJWkUnOgogICAgICAgICAgICAg
ICAgICAgIHRvdGFsID0gMAoKICAgICAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKGNsaWVudCwg
J2dldF9ub2RlcycpOgogICAgICAgICAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBjbGllbnQu
Z2V0X25vZGVzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKG5vZGUs
ICdzZXJ2ZXJfdHlwZScpIGFuZCBub2RlLnNlcnZlcl90eXBlID09ICdtYXN0ZXInOgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdG90YWwgKz0gbm9kZS5kYnNpemUoKQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJFcnJvciBnZXR0aW5nIGRic2l6ZSBmcm9tIG5vZGU6
IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAg
dG90YWwgPSBjbGllbnQuZGJzaXplKCkKCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdG90
YWwKCiAgICAgICAgICAgICAgICAjIEZMVVNIQUxML0ZMVVNIREIgLSDQstGL0L/QvtC70L3Rj9C1
0Lwg0L3QsCDQstGB0LXRhSDRg9C30LvQsNGFCiAgICAgICAgICAgICAgICBlbGlmIGNtZCBpbiBb
J0ZMVVNIQUxMJywgJ0ZMVVNIREInXToKICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gW10K
CiAgICAgICAgICAgICAgICAgICAgaWYgaGFzYXR0cihjbGllbnQsICdnZXRfbm9kZXMnKToKICAg
ICAgICAgICAgICAgICAgICAgICAgZm9yIG5vZGUgaW4gY2xpZW50LmdldF9ub2RlcygpOgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgaGFzYXR0cihub2RlLCAnc2VydmVyX3R5cGUnKSBh
bmQgbm9kZS5zZXJ2ZXJfdHlwZSA9PSAnbWFzdGVyJzoKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfcmVz
dWx0ID0gbm9kZS5leGVjdXRlX2NvbW1hbmQoY21kLCAqYXJncykKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbm9kZV9ob3N0ID0gZ2V0YXR0cihub2RlLCAnaG9zdCcsICd1bmtu
b3duJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9wb3J0ID0gZ2V0
YXR0cihub2RlLCAncG9ydCcsICd1bmtub3duJykKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcmVzdWx0cy5hcHBlbmQoZiJ7bm9kZV9ob3N0fTp7bm9kZV9wb3J0fToge25vZGVf
cmVzdWx0fSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVu
ZChmIkVSUk9SOiB7ZX0iKQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSAiXG4iLmpv
aW4ocmVzdWx0cykgaWYgcmVzdWx0cyBlbHNlICJPSyIKICAgICAgICAgICAgICAgICAgICBlbHNl
OgogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBjbGllbnQuZXhlY3V0ZV9jb21tYW5k
KGNtZCwgKmFyZ3MpCgogICAgICAgICAgICAgICAgIyDQntCx0YvRh9C90YvQtSDQutC+0LzQsNC9
0LTRiyAtINCy0YvQv9C+0LvQvdGP0LXQvCDRh9C10YDQtdC3INC60LvQuNC10L3RgiDQutC70LDR
gdGC0LXRgNCwCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJlc3Vs
dCA9IGNsaWVudC5leGVjdXRlX2NvbW1hbmQoY21kLCAqYXJncykKCiAgICAgICAgICAgIGVsc2U6
CiAgICAgICAgICAgICAgICAjIFN0YW5kYWxvbmUg0YDQtdC20LjQvAogICAgICAgICAgICAgICAg
cmVzdWx0ID0gY2xpZW50LmV4ZWN1dGVfY29tbWFuZChjbWQsICphcmdzKQoKICAgICAgICAgICAg
IyDQpNC+0YDQvNCw0YLQuNGA0YPQtdC8INGA0LXQt9GD0LvRjNGC0LDRggogICAgICAgICAgICBy
ZXN1bHRfc3RyID0gc2VsZi5mb3JtYXRfcmVkaXNfcmVzdWx0KGNtZCwgcmVzdWx0KQoKICAgICAg
ICAgICAgIyDQlNC+0LHQsNCy0LvRj9C10Lwg0YDQtdC30YPQu9GM0YLQsNGCINCyINC40YHRgtC+
0YDQuNGOCiAgICAgICAgICAgIGlmICdcbicgaW4gcmVzdWx0X3N0cjoKICAgICAgICAgICAgICAg
IGZvciBsaW5lIGluIHJlc3VsdF9zdHIuc3BsaXQoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAg
c2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLlRleHQoKCdzdWNjZXNzJywgbGluZSkp
KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3Rvcnku
YXBwZW5kKHVyd2lkLlRleHQoKCdzdWNjZXNzJywgcmVzdWx0X3N0cikpKQoKICAgICAgICAgICAg
bG9nZ2VyLmluZm8oZiJFeGVjdXRlZDoge2NvbW1hbmR9ID0+IHtyZXN1bHRfc3RyWzoxMDBdfSIp
CgogICAgICAgICAgICAjIOKchSDQntGH0LjRidCw0LXQvCDQv9GA0L7QvNC/0YIKICAgICAgICAg
ICAgc2VsZi5jb21tYW5kX3Byb21wdC5zZXRfZWRpdF90ZXh0KCcnKQoKICAgICAgICAgICAgIyDQ
ntCx0L3QvtCy0LvRj9C10Lwg0LXRgdC70Lgg0LrQvtC80LDQvdC00LAg0LzQvtCz0LvQsCDQuNC3
0LzQtdC90LjRgtGMINC00LDQvdC90YvQtQogICAgICAgICAgICBtb2RpZnlpbmdfY29tbWFuZHMg
PSBbCiAgICAgICAgICAgICAgICAnU0VUJywgJ0RFTCcsICdIU0VUJywgJ0hERUwnLCAnTFBVU0gn
LCAnUlBVU0gnLCAnTFBPUCcsICdSUE9QJywKICAgICAgICAgICAgICAgICdTQUREJywgJ1NSRU0n
LCAnWkFERCcsICdaUkVNJywgJ0ZMVVNIREInLCAnRkxVU0hBTEwnLCAnUkVOQU1FJywKICAgICAg
ICAgICAgICAgICdSRU5BTUVOWCcsICdFWFBJUkUnLCAnRVhQSVJFQVQnLCAnUEVSU0lTVCcsICdB
UFBFTkQnLCAnREVDUicsCiAgICAgICAgICAgICAgICAnSU5DUicsICdMU0VUJywgJ0xUUklNJywg
J01TRVQnLCAnUEVYUElSRScsICdQRVhQSVJFQVQnLCAnUFNFVEVYJywKICAgICAgICAgICAgICAg
ICdTRVRFWCcsICdTRVROWCcsICdIU0VUTlgnLCAnSE1TRVQnLCAnTFBVU0hYJywgJ1JQVVNIWCcs
ICdTSU5URVJTVE9SRScsCiAgICAgICAgICAgICAgICAnU1VOSU9OU1RPUkUnLCAnU0RJRkZTVE9S
RScsICdaSU5URVJTVE9SRScsICdaVU5JT05TVE9SRScsICdaUkVNUkFOR0VCWUxFWCcsCiAgICAg
ICAgICAgICAgICAnWlJFTVJBTkdFQllSQU5LJywgJ1pSRU1SQU5HRUJZU0NPUkUnLCAnR0VUU0VU
JywgJ1VOTElOSycKICAgICAgICAgICAgXQoKICAgICAgICAgICAgaWYgY21kIGluIG1vZGlmeWlu
Z19jb21tYW5kczoKICAgICAgICAgICAgICAgICMg4pyFINCe0LHQvdC+0LLQu9GP0LXQvCDQsNGB
0LjQvdGF0YDQvtC90L3QviDRh9GC0L7QsdGLINC90LUg0LHQu9C+0LrQuNGA0L7QstCw0YLRjCDQ
utC+0L3RgdC+0LvRjAogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNl
bGYucmVmcmVzaF9rZXlzKCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToK
ICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gcmVmcmVzaCBrZXlz
OiB7ZX0iKQoKICAgICAgICBleGNlcHQgUmVkaXNDbHVzdGVyRXJyb3IgYXMgZToKICAgICAgICAg
ICAgIyBDbHVzdGVyLdGB0L/QtdGG0LjRhNC40YfQvdGL0LUg0L7RiNC40LHQutC4CiAgICAgICAg
ICAgIGVycm9yX21zZyA9IHN0cihlKQogICAgICAgICAgICBpZiAnQ1JPU1NTTE9UJyBpbiBlcnJv
cl9tc2c6CiAgICAgICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQu
VGV4dCgoJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBmJyhlcnJvcikgQ1JPU1NTTE9UOiBLZXlzIG11c3QgYmUgaW4gc2FtZSBo
YXNoIHNsb3QgZm9yIG11bHRpLWtleSBvcGVyYXRpb25zJykpKQogICAgICAgICAgICBlbGlmICdN
T1ZFRCcgaW4gZXJyb3JfbXNnOgogICAgICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3Rvcnku
YXBwZW5kKHVyd2lkLlRleHQoKCdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZicoZXJyb3IpIE1PVkVEOiBLZXkgbW92ZWQgdG8g
YW5vdGhlciBub2RlJykpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5j
b25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLlRleHQoKCdlcnJvcicsIGYnKGNsdXN0ZXIgZXJy
b3IpIHtlcnJvcl9tc2d9JykpKQogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJSZWRpcyBjbHVz
dGVyIGVycm9yOiB7ZX0iKQoKICAgICAgICBleGNlcHQgUmVkaXNDb25uZWN0aW9uRXJyb3IgYXMg
ZToKICAgICAgICAgICAgIyDQntGI0LjQsdC60Lgg0L/QvtC00LrQu9GO0YfQtdC90LjRjwogICAg
ICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuVGV4dCgoJ2Vycm9yJywg
ZicoY29ubmVjdGlvbiBlcnJvcikge3N0cihlKX0nKSkpCiAgICAgICAgICAgIGxvZ2dlci5lcnJv
cihmIlJlZGlzIGNvbm5lY3Rpb24gZXJyb3I6IHtlfSIpCgogICAgICAgIGV4Y2VwdCBSZWRpc0Vy
cm9yIGFzIGU6CiAgICAgICAgICAgICMg0J7QsdGJ0LjQtSBSZWRpcyDQvtGI0LjQsdC60LggKNCy
0LrQu9GO0YfQsNGPIFJlc3BvbnNlRXJyb3IpCiAgICAgICAgICAgIHNlbGYuY29uc29sZV9oaXN0
b3J5LmFwcGVuZCh1cndpZC5UZXh0KCgnZXJyb3InLCBmJyhlcnJvcikge3N0cihlKX0nKSkpCiAg
ICAgICAgICAgIGxvZ2dlci5lcnJvcihmIlJlZGlzIGVycm9yOiB7ZX0iKQoKICAgICAgICBleGNl
cHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICMg0JLRgdC1INC+0YHRgtCw0LvRjNC90YvQ
tSDQvtGI0LjQsdC60LgKICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVy
d2lkLlRleHQoKCdlcnJvcicsIGYnKGVycm9yKSB7c3RyKGUpfScpKSkKICAgICAgICAgICAgbG9n
Z2VyLmVycm9yKGYiQ29tbWFuZCBmYWlsZWQ6IHtlfSIsIGV4Y19pbmZvPVRydWUpCgogICAgICAg
ICMg0KDQsNC30LTQtdC70LjRgtC10LvRjAogICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5LmFw
cGVuZCh1cndpZC5EaXZpZGVyKCkpCgogICAgICAgICMg0J/RgNC+0LrRgNGD0YfQuNCy0LDQtdC8
INCy0L3QuNC3INC6INC/0L7RgdC70LXQtNC90LXQuSDQutC+0LzQsNC90LTQtQogICAgICAgIGlm
IGxlbihzZWxmLmNvbnNvbGVfaGlzdG9yeSkgPiAwOgogICAgICAgICAgICB0cnk6CiAgICAgICAg
ICAgICAgICBzZWxmLmNvbnNvbGVfbGlzdGJveC5zZXRfZm9jdXMobGVuKHNlbGYuY29uc29sZV9o
aXN0b3J5KSAtIDEpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAg
ICAgICAgIyDQntCz0YDQsNC90LjRh9C40LLQsNC10Lwg0LjRgdGC0L7RgNC40Y4gKNCy0LjQt9GD
0LDQu9GM0L3Rg9GOINCyINC60L7QvdGB0L7Qu9C4KQogICAgICAgIGlmIGxlbihzZWxmLmNvbnNv
bGVfaGlzdG9yeSkgPiAyMDA6CiAgICAgICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5WzpdID0g
c2VsZi5jb25zb2xlX2hpc3RvcnlbLTE1MDpdCgogICAgZGVmIGZvcm1hdF9yZWRpc19yZXN1bHQo
c2VsZiwgY21kOiBzdHIsIHJlc3VsdCkgLT4gc3RyOgogICAgICAgICIiItCk0L7RgNC80LDRgtC4
0YDQvtCy0LDQvdC40LUg0YDQtdC30YPQu9GM0YLQsNGC0LAgUmVkaXMg0LrQvtC80LDQvdC00Ysi
IiIKCiAgICAgICAgaWYgY21kID09ICdQSU5HJzoKICAgICAgICAgICAgaWYgcmVzdWx0IGlzIFRy
dWUgb3IgcmVzdWx0ID09IGInUE9ORycgb3IgcmVzdWx0ID09ICdQT05HJzoKICAgICAgICAgICAg
ICAgIHJldHVybiAnUE9ORycKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3VsdCwgYnl0
ZXMpOgogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5kZWNvZGUoJ3V0Zi04JywgZXJyb3Jz
PSdyZXBsYWNlJykKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3VsdCwgc3RyKToKICAg
ICAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAg
ICAgIHJldHVybiAnUE9ORycKCiAgICAgICAgZWxpZiByZXN1bHQgaXMgTm9uZToKICAgICAgICAg
ICAgcmV0dXJuICcobmlsKScKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3VsdCwgYm9vbCk6
CiAgICAgICAgICAgIHJldHVybiAnT0snIGlmIHJlc3VsdCBlbHNlICcoZXJyb3IpJwoKICAgICAg
ICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBpbnQpOgogICAgICAgICAgICByZXR1cm4gZicoaW50
ZWdlcikge3Jlc3VsdH0nCgogICAgICAgIGVsaWYgaXNpbnN0YW5jZShyZXN1bHQsIGJ5dGVzKToK
ICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZGVjb2RlZCA9IHJlc3VsdC5kZWNvZGUo
J3V0Zi04JywgZXJyb3JzPSdyZXBsYWNlJykKICAgICAgICAgICAgICAgIHJldHVybiBmJyJ7ZGVj
b2RlZH0iJwogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gZic8Ynl0
ZXM6IHtsZW4ocmVzdWx0KX0+JwoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBzdHIp
OgogICAgICAgICAgICByZXR1cm4gZicie3Jlc3VsdH0iJwoKICAgICAgICBlbGlmIGlzaW5zdGFu
Y2UocmVzdWx0LCBsaXN0KToKICAgICAgICAgICAgaWYgbGVuKHJlc3VsdCkgPT0gMDoKICAgICAg
ICAgICAgICAgIHJldHVybiAnKGVtcHR5IGxpc3Qgb3Igc2V0KScKICAgICAgICAgICAgZWxzZToK
ICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgaSwg
aXRlbSBpbiBlbnVtZXJhdGUocmVzdWx0Wzo1MF0pOiAgIyDQntCz0YDQsNC90LjRh9C40LLQsNC1
0LwgNTAg0Y3Qu9C10LzQtdC90YLQsNC80LgKICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3Rh
bmNlKGl0ZW0sIGJ5dGVzKToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZGVjb2RlZCA9IGl0ZW0uZGVjb2RlKCJ1dGYtOCIsIGVycm9ycz0i
cmVwbGFjZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRfbGluZXMuYXBwZW5k
KGYne2kgKyAxfSkgIntkZWNvZGVkfSInKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRfbGluZXMuYXBwZW5kKGYne2kgKyAx
fSkgPGJ5dGVzOiB7bGVuKGl0ZW0pfT4nKQogICAgICAgICAgICAgICAgICAgIGVsaWYgaXNpbnN0
YW5jZShpdGVtLCBzdHIpOgogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRfbGluZXMuYXBw
ZW5kKGYne2kgKyAxfSkgIntpdGVtfSInKQogICAgICAgICAgICAgICAgICAgIGVsaWYgaXNpbnN0
YW5jZShpdGVtLCBsaXN0KToKICAgICAgICAgICAgICAgICAgICAgICAgIyDQktC70L7QttC10L3Q
vdGL0LUg0YHQv9C40YHQutC4ICjQvdCw0L/RgNC40LzQtdGALCBTQ0FOKQogICAgICAgICAgICAg
ICAgICAgICAgICBpZiBpID09IDAgYW5kIGxlbihpdGVtKSA9PSAyIGFuZCBpc2luc3RhbmNlKGl0
ZW1bMF0sIGludCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjINCt0YLQviDRgNC10LfR
g9C70YzRgtCw0YIgU0NBTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0X2xpbmVz
LmFwcGVuZChmJ3tpICsgMX0pIDEpICJ7aXRlbVswXX0iJykKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJlc3VsdF9saW5lcy5hcHBlbmQoZicgICAyKSB7c2VsZi5mb3JtYXRfcmVkaXNfcmVz
dWx0KCJTQ0FOIiwgaXRlbVsxXSl9JykKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcy5hcHBlbmQoZid7aSArIDF9KSB7
aXRlbX0nKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAg
IHJlc3VsdF9saW5lcy5hcHBlbmQoZid7aSArIDF9KSB7c3RyKGl0ZW0pfScpCgogICAgICAgICAg
ICAgICAgaWYgbGVuKHJlc3VsdCkgPiA1MDoKICAgICAgICAgICAgICAgICAgICByZXN1bHRfbGlu
ZXMuYXBwZW5kKGYnLi4uIGFuZCB7bGVuKHJlc3VsdCkgLSA1MH0gbW9yZSBpdGVtcycpCgogICAg
ICAgICAgICAgICAgcmV0dXJuICdcbicuam9pbihyZXN1bHRfbGluZXMpCgogICAgICAgIGVsaWYg
aXNpbnN0YW5jZShyZXN1bHQsIGRpY3QpOgogICAgICAgICAgICBpZiBsZW4ocmVzdWx0KSA9PSAw
OgogICAgICAgICAgICAgICAgcmV0dXJuICcoZW1wdHkgaGFzaCknCiAgICAgICAgICAgIGVsc2U6
CiAgICAgICAgICAgICAgICByZXN1bHRfbGluZXMgPSBbXQogICAgICAgICAgICAgICAgZm9yIGks
IChrZXksIHZhbHVlKSBpbiBlbnVtZXJhdGUobGlzdChyZXN1bHQuaXRlbXMoKSlbOjUwXSk6CiAg
ICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShrZXksIGJ5dGVzKToKICAgICAgICAgICAg
ICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0ga2V5LmRl
Y29kZSgidXRmLTgiLCBlcnJvcnM9InJlcGxhY2UiKQogICAgICAgICAgICAgICAgICAgICAgICBl
eGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBmJzxieXRlczoge2xlbihr
ZXkpfT4nCgogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIGJ5dGVzKToK
ICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
dmFsdWUgPSB2YWx1ZS5kZWNvZGUoInV0Zi04IiwgZXJyb3JzPSJyZXBsYWNlIikKICAgICAgICAg
ICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUg
PSBmJzxieXRlczoge2xlbih2YWx1ZSl9PicKCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0X2xp
bmVzLmFwcGVuZChmJ3tpICsgMX0pICJ7a2V5fSIgPT4gInt2YWx1ZX0iJykKCiAgICAgICAgICAg
ICAgICBpZiBsZW4ocmVzdWx0KSA+IDUwOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5l
cy5hcHBlbmQoZicuLi4gYW5kIHtsZW4ocmVzdWx0KSAtIDUwfSBtb3JlIGZpZWxkcycpCgogICAg
ICAgICAgICAgICAgcmV0dXJuICdcbicuam9pbihyZXN1bHRfbGluZXMpCgogICAgICAgIGVsc2U6
CiAgICAgICAgICAgIHJldHVybiBzdHIocmVzdWx0KQoKICAgIGRlZiB1cGRhdGVfY29ubmVjdGlv
bl90cmVlKHNlbGYpOgogICAgICAgICIiItCe0LHQvdC+0LLQu9C10L3QuNC1INC00LXRgNC10LLQ
sCDQv9C+0LTQutC70Y7Rh9C10L3QuNC5ICjQkdCV0Jcg0LrQu9GO0YfQtdC5IC0g0L7QvdC4INCy
IGtleV9saXN0X3ZpZXcpIiIiCiAgICAgICAgc2VsZi5jb25uZWN0aW9uX3RyZWVbOl0gPSBbXQoK
ICAgICAgICBmb3IgbmFtZSwgcHJvZmlsZSBpbiBzZWxmLnByb2ZpbGVzLml0ZW1zKCk6CiAgICAg
ICAgICAgIGNvbm4gPSBzZWxmLmNvbm5lY3Rpb25zLmdldChuYW1lKQoKICAgICAgICAgICAgaWYg
Y29ubiBhbmQgY29ubi5jb25uZWN0ZWQ6CiAgICAgICAgICAgICAgICBpY29uID0gJ+KXjyAnCiAg
ICAgICAgICAgICAgICBpZiBjb25uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgICAgICAgICAgc2Vy
dmVyX2xhYmVsID0gZiJ7aWNvbn17cHJvZmlsZS5uYW1lfSBbQ0xVU1RFUl0iCiAgICAgICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlcnZlcl9sYWJlbCA9IGYie2ljb259e3By
b2ZpbGUubmFtZX0gKHtwcm9maWxlLmhvc3R9Ontwcm9maWxlLnBvcnR9KSIKICAgICAgICAgICAg
ICAgIHN0eWxlID0gJ2Nvbm5lY3Rpb24nCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAg
ICBpY29uID0gJ+KXiyAnCiAgICAgICAgICAgICAgICBzZXJ2ZXJfbGFiZWwgPSBmIntpY29ufXtw
cm9maWxlLm5hbWV9ICh7cHJvZmlsZS5ob3N0fTp7cHJvZmlsZS5wb3J0fSkiCiAgICAgICAgICAg
ICAgICBzdHlsZSA9ICdjb25uZWN0aW9uJwoKICAgICAgICAgICAgIyDQl9Cw0LPQvtC70L7QstC+
0Log0YHQtdGA0LLQtdGA0LAKICAgICAgICAgICAgc2VydmVyX2J0biA9IHVyd2lkLkJ1dHRvbihz
ZXJ2ZXJfbGFiZWwsIG9uX3ByZXNzPXNlbGYub25fc2VydmVyX3NlbGVjdCwgdXNlcl9kYXRhPW5h
bWUpCgogICAgICAgICAgICBpZiBjb25uIGFuZCBjb25uLmNvbm5lY3RlZDoKICAgICAgICAgICAg
ICAgIHNlbGYuY29ubmVjdGlvbl90cmVlLmFwcGVuZCh1cndpZC5BdHRyTWFwKHNlcnZlcl9idG4s
IHN0eWxlLCAnY29ubmVjdGlvbl9zZWxlY3RlZCcpKQogICAgICAgICAgICBlbHNlOgogICAgICAg
ICAgICAgICAgc2VsZi5jb25uZWN0aW9uX3RyZWUuYXBwZW5kKHVyd2lkLkF0dHJNYXAoc2VydmVy
X2J0biwgc3R5bGUsICdzaWRlYmFyX2ZvY3VzJykpCgogICAgICAgICAgICAjINCf0L7QutCw0LfR
i9Cy0LDQtdC8INCx0LDQt9GLINC00LDQvdC90YvRhSDQtNC70Y8g0L/QvtC00LrQu9GO0YfQtdC9
0L3QvtCz0L4g0YHQtdGA0LLQtdGA0LAKICAgICAgICAgICAgaWYgY29ubiBhbmQgY29ubi5jb25u
ZWN0ZWQ6CiAgICAgICAgICAgICAgICBpZiBjb25uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgICAg
ICAgICAgIyDQmtC70LDRgdGC0LXRgCAtINGC0L7Qu9GM0LrQviBEQjAKICAgICAgICAgICAgICAg
ICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2N1cnJlbnQgPSAoc2VsZi5jdXJy
ZW50X2Nvbm5lY3Rpb24gPT0gY29ubikKICAgICAgICAgICAgICAgICAgICAgICAgZGJfaWNvbiA9
ICcgIOKWqiAnIGlmIGlzX2N1cnJlbnQgZWxzZSAnICDilqsgJwogICAgICAgICAgICAgICAgICAg
ICAgICBkYl9sYWJlbCA9IGYie2RiX2ljb259REIwICh7c2VsZi5rZXlfY291bnR9IGtleXMpIgoK
ICAgICAgICAgICAgICAgICAgICAgICAgZGJfYnRuID0gdXJ3aWQuQnV0dG9uKGRiX2xhYmVsLCBv
bl9wcmVzcz1zZWxmLm9uX2RiX3NlbGVjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVzZXJfZGF0YT0obmFtZSwgMCkpCgogICAgICAgICAgICAgICAgICAg
ICAgICBpZiBpc19jdXJyZW50OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IHVy
d2lkLkF0dHJNYXAoZGJfYnRuLCAnY29ubmVjdGlvbl9zZWxlY3RlZCcsICdjb25uZWN0aW9uX3Nl
bGVjdGVkJykKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGl0ZW0gPSB1cndpZC5BdHRyTWFwKGRiX2J0biwgJ2tleV9mb2xkZXInLCAna2V5
X2ZvbGRlcl9mb2N1cycpCgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbm5lY3Rpb25f
dHJlZS5hcHBlbmQoaXRlbSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFz
IGU6CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGRpc3BsYXlp
bmcgY2x1c3RlciBEQjoge2V9IikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAg
ICAgICAgIyBTdGFuZGFsb25lCiAgICAgICAgICAgICAgICAgICAgZGJfa2V5X2NvdW50cyA9IHNl
bGYuZ2V0X2FsbF9kYl9rZXlfY291bnRzKGNvbm4pCgogICAgICAgICAgICAgICAgICAgIGZvciBk
Yl9udW0gaW4gcmFuZ2Uoc2VsZi5tYXhfZGIgKyAxKToKICAgICAgICAgICAgICAgICAgICAgICAg
aXNfY3VycmVudCA9IChzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9PSBjb25uIGFuZAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm4uY3VycmVudF9kYiA9PSBkYl9udW0p
CgogICAgICAgICAgICAgICAgICAgICAgICBkYl9pY29uID0gJyAg4paqICcgaWYgaXNfY3VycmVu
dCBlbHNlICcgIOKWqyAnCiAgICAgICAgICAgICAgICAgICAgICAgIGtleV9jb3VudCA9IGRiX2tl
eV9jb3VudHMuZ2V0KGRiX251bSwgMCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGtleV9j
b3VudCA+IDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYl9sYWJlbCA9IGYie2RiX2lj
b259REJ7ZGJfbnVtfSAoe2tleV9jb3VudH0ga2V5cykiCiAgICAgICAgICAgICAgICAgICAgICAg
IGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYl9sYWJlbCA9IGYie2RiX2ljb259
REJ7ZGJfbnVtfSIKCiAgICAgICAgICAgICAgICAgICAgICAgIGRiX2J0biA9IHVyd2lkLkJ1dHRv
bihkYl9sYWJlbCwgb25fcHJlc3M9c2VsZi5vbl9kYl9zZWxlY3QsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyX2RhdGE9KG5hbWUsIGRiX251bSkpCgog
ICAgICAgICAgICAgICAgICAgICAgICBpZiBpc19jdXJyZW50OgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaXRlbSA9IHVyd2lkLkF0dHJNYXAoZGJfYnRuLCAnY29ubmVjdGlvbl9zZWxlY3Rl
ZCcsICdjb25uZWN0aW9uX3NlbGVjdGVkJykKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSB1cndpZC5BdHRyTWFwKGRiX2J0biwg
J2tleV9mb2xkZXInLCAna2V5X2ZvbGRlcl9mb2N1cycpCgogICAgICAgICAgICAgICAgICAgICAg
ICBzZWxmLmNvbm5lY3Rpb25fdHJlZS5hcHBlbmQoaXRlbSkKCiAgICAgICAgc2VsZi51cGRhdGVf
dGFicygpCgogICAgZGVmIGdldF9hbGxfZGJfa2V5X2NvdW50cyhzZWxmLCBjb25uOiBSZWRpc0Nv
bm5lY3Rpb24pIC0+IERpY3RbaW50LCBpbnRdOgogICAgICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg
0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQu9GO0YfQtdC5INCy0L4g0LLRgdC10YUg0LHQsNC30LDR
hSDQtNCw0L3QvdGL0YUiIiIKICAgICAgICBkYl9jb3VudHMgPSB7fQoKICAgICAgICBpZiBub3Qg
Y29ubiBvciBub3QgY29ubi5jb25uZWN0ZWQ6CiAgICAgICAgICAgIHJldHVybiBkYl9jb3VudHMK
CiAgICAgICAgIyDQlNC70Y8g0LrQu9Cw0YHRgtC10YDQsCDQstC+0LfQstGA0LDRidCw0LXQvCDR
gtC+0LvRjNC60L4gREIwCiAgICAgICAgaWYgY29ubi5pc19jbHVzdGVyOgogICAgICAgICAgICB0
cnk6CiAgICAgICAgICAgICAgICAjINCSINC60LvQsNGB0YLQtdGA0LUg0LzQvtC20L3QviDQv9C+
0LvRg9GH0LjRgtGMINC+0LHRidC10LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQu9GO0YfQtdC5
INGH0LXRgNC10LcgREJTSVpFCiAgICAgICAgICAgICAgICB0b3RhbF9rZXlzID0gY29ubi5hY3Rp
dmVfY2xpZW50LmRic2l6ZSgpCgogICAgICAgICAgICAgICAgaWYgdG90YWxfa2V5cyA+IDA6CiAg
ICAgICAgICAgICAgICAgICAgZGJfY291bnRzWzBdID0gdG90YWxfa2V5cwogICAgICAgICAgICBl
eGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWls
ZWQgdG8gZ2V0IGNsdXN0ZXIga2V5IGNvdW50OiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gZGJf
Y291bnRzCgogICAgICAgICMg0KHQvtGF0YDQsNC90Y/QtdC8INGC0LXQutGD0YnRg9GOINCR0JQK
ICAgICAgICBjdXJyZW50X2RiID0gY29ubi5jdXJyZW50X2RiCgogICAgICAgIHRyeToKICAgICAg
ICAgICAgIyDQn9GA0L7RhdC+0LTQuNC8INC/0L4g0LLRgdC10Lwg0JHQlCDQuCDRgdGH0LjRgtCw
0LXQvCDQutC70Y7Rh9C4CiAgICAgICAgICAgIGZvciBkYl9udW0gaW4gcmFuZ2Uoc2VsZi5tYXhf
ZGIgKyAxKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBjb25uLmNs
aWVudC5zZWxlY3QoZGJfbnVtKQogICAgICAgICAgICAgICAgICAgIGNvdW50ID0gY29ubi5jbGll
bnQuZGJzaXplKCkKICAgICAgICAgICAgICAgICAgICBpZiBjb3VudCA+IDA6CiAgICAgICAgICAg
ICAgICAgICAgICAgIGRiX2NvdW50c1tkYl9udW1dID0gY291bnQKICAgICAgICAgICAgICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJG
YWlsZWQgdG8gZ2V0IGtleSBjb3VudCBmb3IgREJ7ZGJfbnVtfToge2V9IikKICAgICAgICAgICAg
ICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgIyDQktC+0LfQstGA0LDRidCw0LXQvNGB0Y8g
0Log0YLQtdC60YPRidC10Lkg0JHQlAogICAgICAgICAgICBjb25uLmNsaWVudC5zZWxlY3QoY3Vy
cmVudF9kYikKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dn
ZXIuZXJyb3IoZiJGYWlsZWQgdG8gZ2V0IGFsbCBEQiBrZXkgY291bnRzOiB7ZX0iKQogICAgICAg
ICAgICAjINCV0YHQu9C4INGH0YLQvi3RgtC+INC/0L7RiNC70L4g0L3QtSDRgtCw0LosINCy0L7Q
t9Cy0YDQsNGJ0LDQtdC80YHRjyDQuiDRgtC10LrRg9GJ0LXQuSDQkdCUCiAgICAgICAgICAgIHRy
eToKICAgICAgICAgICAgICAgIGNvbm4uY2xpZW50LnNlbGVjdChjdXJyZW50X2RiKQogICAgICAg
ICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHJldHVybiBkYl9jb3Vu
dHMKCiAgICBkZWYgb25fc2VydmVyX3NlbGVjdChzZWxmLCBidXR0b24sIHByb2ZpbGVfbmFtZTog
c3RyKToKICAgICAgICAiIiLQktGL0LHQvtGAINGB0LXRgNCy0LXRgNCwICjQv9C+0LTQutC70Y7R
h9C10L3QuNC1L9C/0LXRgNC10L/QvtC00LrQu9GO0YfQtdC90LjQtSkiIiIKICAgICAgICBwcm9m
aWxlID0gc2VsZi5wcm9maWxlcy5nZXQocHJvZmlsZV9uYW1lKQogICAgICAgIGlmIG5vdCBwcm9m
aWxlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyDQldGB0LvQuCDRg9C20LUg0L/QvtC0
0LrQu9GO0YfQtdC90Ysg0Log0Y3RgtC+0LzRgyDRgdC10YDQstC10YDRgwogICAgICAgIGlmIHBy
b2ZpbGVfbmFtZSBpbiBzZWxmLmNvbm5lY3Rpb25zIGFuZCBzZWxmLmNvbm5lY3Rpb25zW3Byb2Zp
bGVfbmFtZV0uY29ubmVjdGVkOgogICAgICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9
IHNlbGYuY29ubmVjdGlvbnNbcHJvZmlsZV9uYW1lXQogICAgICAgICAgICBzZWxmLnNldF9zdGF0
dXMoZiJBbHJlYWR5IGNvbm5lY3RlZCB0byB7cHJvZmlsZS5uYW1lfSIsICdzdWNjZXNzJykKICAg
ICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmNvbm5lY3RfdG9fcHJvZmlsZShwcm9maWxlKQoK
ICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCiAgICAgICAgc2VsZi51cGRhdGVfY29ubmVjdGlv
bl90cmVlKCkKCiAgICBkZWYgcGFyc2VfY2x1c3Rlcl9pbmZvKHNlbGYsIGluZm9fc3RyaW5nOiBz
dHIpIC0+IGRpY3Q6CiAgICAgICAgIiIi0J/QsNGA0YHQuNC90LMg0YDQtdC30YPQu9GM0YLQsNGC
0LAgQ0xVU1RFUiBJTkZPINCyINGB0LvQvtCy0LDRgNGMIiIiCiAgICAgICAgcmVzdWx0ID0ge30K
CiAgICAgICAgaWYgaXNpbnN0YW5jZShpbmZvX3N0cmluZywgYnl0ZXMpOgogICAgICAgICAgICBp
bmZvX3N0cmluZyA9IGluZm9fc3RyaW5nLmRlY29kZSgndXRmLTgnKQoKICAgICAgICBmb3IgbGlu
ZSBpbiBpbmZvX3N0cmluZy5zdHJpcCgpLnNwbGl0KCdcbicpOgogICAgICAgICAgICBsaW5lID0g
bGluZS5zdHJpcCgpCiAgICAgICAgICAgIGlmICc6JyBpbiBsaW5lOgogICAgICAgICAgICAgICAg
a2V5LCB2YWx1ZSA9IGxpbmUuc3BsaXQoJzonLCAxKQogICAgICAgICAgICAgICAgcmVzdWx0W2tl
eV0gPSB2YWx1ZQoKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGNvbm5lY3RfdG9fcHJv
ZmlsZShzZWxmLCBwcm9maWxlOiBDb25uZWN0aW9uUHJvZmlsZSk6CiAgICAgICAgIiIi0J/QvtC0
0LrQu9GO0YfQtdC90LjQtSDQuiDQv9GA0L7RhNC40LvRjiDRgSDQv9C+0LTQtNC10YDQttC60L7Q
uSDQutC70LDRgdGC0LXRgNCwIiIiCiAgICAgICAgaWYgcHJvZmlsZS5jbHVzdGVyX21vZGU6CiAg
ICAgICAgICAgICMg0JTQu9GPINC60LvQsNGB0YLQtdGA0LAg0LjRgdC/0L7Qu9GM0LfRg9C10Lwg
0L/QtdGA0LLRi9C5INGD0LfQtdC7INC00LvRjyDQuNC00LXQvdGC0LjRhNC40LrQsNGG0LjQuAog
ICAgICAgICAgICBpZiBwcm9maWxlLmNsdXN0ZXJfbm9kZXM6CiAgICAgICAgICAgICAgICBmaXJz
dF9ub2RlID0gcHJvZmlsZS5jbHVzdGVyX25vZGVzWzBdCiAgICAgICAgICAgICAgICBzZXJ2ZXJf
a2V5ID0gZiJjbHVzdGVyOntmaXJzdF9ub2RlWzBdfTp7Zmlyc3Rfbm9kZVsxXX0iCiAgICAgICAg
ICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZXJ2ZXJfa2V5ID0gZiJjbHVzdGVyOntwcm9maWxl
Lmhvc3R9Ontwcm9maWxlLnBvcnR9IgogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMg0JTQu9GP
IHN0YW5kYWxvbmUKICAgICAgICAgICAgaWYgcHJvZmlsZS5zb2NrZXRfcGF0aDoKICAgICAgICAg
ICAgICAgIHNlcnZlcl9rZXkgPSBmInVuaXg6e3Byb2ZpbGUuc29ja2V0X3BhdGh9IgogICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VydmVyX2tleSA9IGYie3Byb2ZpbGUuaG9zdH06
e3Byb2ZpbGUucG9ydH0iCgogICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8INGB0YPRidC10YHR
gtCy0YPRjtGJ0LjQtSDQv9C+0LTQutC70Y7Rh9C10L3QuNGPCiAgICAgICAgZm9yIGV4aXN0aW5n
X25hbWUsIGNvbm4gaW4gc2VsZi5jb25uZWN0aW9ucy5pdGVtcygpOgogICAgICAgICAgICBpZiBj
b25uLmNvbm5lY3RlZDoKICAgICAgICAgICAgICAgICMg0KHRgNCw0LLQvdC40LLQsNC10Lwg0L/Q
sNGA0LDQvNC10YLRgNGLINC/0L7QtNC60LvRjtGH0LXQvdC40Y8KICAgICAgICAgICAgICAgIGlm
IChjb25uLmlzX2NsdXN0ZXIgPT0gcHJvZmlsZS5jbHVzdGVyX21vZGUgYW5kCiAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbm4ucHJvZmlsZS5ob3N0ID09IHByb2ZpbGUuaG9zdCBhbmQKICAgICAg
ICAgICAgICAgICAgICAgICAgY29ubi5wcm9maWxlLnBvcnQgPT0gcHJvZmlsZS5wb3J0KToKCiAg
ICAgICAgICAgICAgICAgICAgIyDQlNC70Y8g0LrQu9Cw0YHRgtC10YDQsCDQtNC+0L/QvtC70L3Q
uNGC0LXQu9GM0L3QviDQv9GA0L7QstC10YDRj9C10Lwg0YPQt9C70YsKICAgICAgICAgICAgICAg
ICAgICBpZiBwcm9maWxlLmNsdXN0ZXJfbW9kZToKICAgICAgICAgICAgICAgICAgICAgICAgaWYg
KGhhc2F0dHIoY29ubi5wcm9maWxlLCAnY2x1c3Rlcl9ub2RlcycpIGFuZAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbm4ucHJvZmlsZS5jbHVzdGVyX25vZGVzID09IHByb2ZpbGUu
Y2x1c3Rlcl9ub2Rlcyk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRf
Y29ubmVjdGlvbiA9IGNvbm4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0
YXR1cyhmIkFscmVhZHkgY29ubmVjdGVkIHRvIGNsdXN0ZXIge3NlcnZlcl9rZXl9IiwgJ3N1Y2Nl
c3MnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWZyZXNoX2tleXMoKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgZWxzZToK
ICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gPSBjb25uCiAg
ICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIkFscmVhZHkgY29ubmVjdGVk
IHRvIHtzZXJ2ZXJfa2V5fSIsICdzdWNjZXNzJykKICAgICAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5yZWZyZXNoX2tleXMoKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAg
IyDQodC+0LfQtNCw0LXQvCDQvdC+0LLQvtC1INC/0L7QtNC60LvRjtGH0LXQvdC40LUKICAgICAg
ICBjb25uID0gUmVkaXNDb25uZWN0aW9uKHByb2ZpbGUpCiAgICAgICAgc3VjY2VzcywgbWVzc2Fn
ZSA9IGNvbm4uY29ubmVjdCgpCgogICAgICAgIGlmIHN1Y2Nlc3M6CiAgICAgICAgICAgIHNlbGYu
Y29ubmVjdGlvbnNbcHJvZmlsZS5uYW1lXSA9IGNvbm4KICAgICAgICAgICAgc2VsZi5jdXJyZW50
X2Nvbm5lY3Rpb24gPSBjb25uCgogICAgICAgICAgICBpZiBwcm9maWxlLmNsdXN0ZXJfbW9kZToK
ICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAjINCf0L7Qu9GD0YfQsNC1
0Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L4g0LrQu9Cw0YHRgtC10YDQtQogICAgICAgICAgICAg
ICAgICAgIGNsdXN0ZXJfaW5mb19zdHIgPSBjb25uLmFjdGl2ZV9jbGllbnQuZXhlY3V0ZV9jb21t
YW5kKCdDTFVTVEVSJywgJ0lORk8nKQoKICAgICAgICAgICAgICAgICAgICAjIOKchSDQmNCh0J/Q
oNCQ0JLQm9CV0J3QmNCVOiDQv9Cw0YDRgdC40Lwg0YHRgtGA0L7QutGDINCyINGB0LvQvtCy0LDR
gNGMCiAgICAgICAgICAgICAgICAgICAgY2x1c3Rlcl9pbmZvID0gc2VsZi5wYXJzZV9jbHVzdGVy
X2luZm8oY2x1c3Rlcl9pbmZvX3N0cikKCiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBjbHVz
dGVyX2luZm8uZ2V0KCdjbHVzdGVyX3N0YXRlJywgJ3Vua25vd24nKQogICAgICAgICAgICAgICAg
ICAgIG5vZGVfY291bnQgPSBjbHVzdGVyX2luZm8uZ2V0KCdjbHVzdGVyX2tub3duX25vZGVzJywg
Jz8nKQoKICAgICAgICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoCiAgICAgICAgICAgICAg
ICAgICAgICAgIGYiQ29ubmVjdGVkIHRvIFJlZGlzIENsdXN0ZXIgKHN0YXRlOiB7c3RhdGV9LCBu
b2Rlczoge25vZGVfY291bnR9KSIsCiAgICAgICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJwog
ICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMg
ZToKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJDb3VsZCBub3QgZ2V0IGNsdXN0
ZXIgaW5mbzoge2V9IikKICAgICAgICAgICAgICAgICAgICAjIEZhbGxiYWNrIC0g0L/RgNC+0YHR
gtC+INC/0L7QutCw0LfRi9Cy0LDQtdC8INGH0YLQviDQv9C+0LTQutC70Y7Rh9C40LvQuNGB0Ywg
0Log0LrQu9Cw0YHRgtC10YDRgwogICAgICAgICAgICAgICAgICAgIG5vZGVfY291bnQgPSBsZW4o
cHJvZmlsZS5jbHVzdGVyX25vZGVzKSBpZiBoYXNhdHRyKHByb2ZpbGUsICdjbHVzdGVyX25vZGVz
JykgZWxzZSAxCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiQ29ubmVjdGVk
IHRvIFJlZGlzIENsdXN0ZXIgKHtub2RlX2NvdW50fSBub2RlcykiLCAnc3VjY2VzcycpCiAgICAg
ICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJDb25uZWN0ZWQg
dG8ge3Byb2ZpbGUuaG9zdH06e3Byb2ZpbGUucG9ydH0iLCAnc3VjY2VzcycpCgogICAgICAgICAg
ICBzZWxmLnJlZnJlc2hfa2V5cygpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zZXRf
c3RhdHVzKGYiQ29ubmVjdGlvbiBmYWlsZWQ6IHttZXNzYWdlfSIsICdlcnJvcicpCgogICAgZGVm
IG9uX2RiX3NlbGVjdChzZWxmLCBidXR0b24sIGRhdGE6IFR1cGxlW3N0ciwgaW50XSk6CiAgICAg
ICAgIiIi0JLRi9Cx0L7RgCDQsdCw0LfRiyDQtNCw0L3QvdGL0YUiIiIKICAgICAgICBwcm9maWxl
X25hbWUsIGRiX251bSA9IGRhdGEKCiAgICAgICAgY29ubiA9IHNlbGYuY29ubmVjdGlvbnMuZ2V0
KHByb2ZpbGVfbmFtZSkKICAgICAgICBpZiBub3QgY29ubiBvciBub3QgY29ubi5jb25uZWN0ZWQ6
CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjINCU0LvRjyDQutC70LDRgdGC0LXRgNCwINGA
0LDQt9GA0LXRiNCw0LXQvCDRgtC+0LvRjNC60L4gREIwCiAgICAgICAgaWYgY29ubi5pc19jbHVz
dGVyOgogICAgICAgICAgICBpZiBkYl9udW0gIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYuc2V0
X3N0YXR1cygiUmVkaXMgQ2x1c3RlciBzdXBwb3J0cyBvbmx5IERCMCIsICd3YXJuaW5nJykKICAg
ICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAjINCSINC60LvQsNGB0YLQtdGA0LUg0L3Q
tdGCINC60L7QvNCw0L3QtNGLIFNFTEVDVCwg0L/RgNC+0YHRgtC+INC+0LHQvdC+0LLQu9GP0LXQ
vCDQuNC90YLQtdGA0YTQtdC50YEKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24g
PSBjb25uCiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cygiUmVkaXMgQ2x1c3RlciAoREIwKSIs
ICdzdWNjZXNzJykKICAgICAgICAgICAgc2VsZi5yZWZyZXNoX2tleXMoKQogICAgICAgICAgICBz
ZWxmLnVwZGF0ZV9jb25uZWN0aW9uX3RyZWUoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMg
U3RhbmRhbG9uZSBSZWRpcwogICAgICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9IGNv
bm4KICAgICAgICAgICAgc3VjY2VzcywgbWVzc2FnZSA9IGNvbm4uc2VsZWN0X2RiKGRiX251bSkK
CiAgICAgICAgICAgIGlmIHN1Y2Nlc3M6CiAgICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMo
ZiJTd2l0Y2hlZCB0byBEQntkYl9udW19IiwgJ3N1Y2Nlc3MnKQogICAgICAgICAgICAgICAgc2Vs
Zi5yZWZyZXNoX2tleXMoKQogICAgICAgICAgICAgICAgc2VsZi51cGRhdGVfY29ubmVjdGlvbl90
cmVlKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhm
IkZhaWxlZCB0byBzd2l0Y2ggREI6IHttZXNzYWdlfSIsICdlcnJvcicpCgogICAgZGVmIGRpc2Nv
bm5lY3Qoc2VsZik6CiAgICAgICAgIiIi0J7RgtC60LvRjtGH0LXQvdC40LUg0L7RgiDRgtC10LrR
g9GJ0LXQs9C+INGB0LXRgNCy0LXRgNCwIiIiCiAgICAgICAgaWYgc2VsZi5jdXJyZW50X2Nvbm5l
Y3Rpb246CiAgICAgICAgICAgIG5hbWUgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5wcm9maWxl
Lm5hbWUKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uZGlzY29ubmVjdCgpCiAg
ICAgICAgICAgIGRlbCBzZWxmLmNvbm5lY3Rpb25zW25hbWVdCiAgICAgICAgICAgIHNlbGYuY3Vy
cmVudF9jb25uZWN0aW9uID0gTm9uZQogICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJEaXNj
b25uZWN0ZWQgZnJvbSB7bmFtZX0iLCAnc3VjY2VzcycpCiAgICAgICAgICAgIHNlbGYua2V5c19s
aXN0ID0gW10gICAjIHNlbGYua2V5X3RyZWVfcm9vdCA9IEtleVRyZWVOb2RlKCdyb290JykKICAg
ICAgICAgICAgc2VsZi51cGRhdGVfY29ubmVjdGlvbl90cmVlKCkKCiAgICBkZWYgZXhpdF9tYWlu
KHNlbGYpOgogICAgICAgIHJhaXNlIHVyd2lkLkV4aXRNYWluTG9vcCgpCgogICAgZGVmIGdldF9j
bHVzdGVyX21hc3Rlcl9ub2RlcyhzZWxmLCBjbGllbnQpOgogICAgICAgICIiItCR0LXQt9C+0L/Q
sNGB0L3QvtC1INC/0L7Qu9GD0YfQtdC90LjQtSDQvNCw0YHRgtC10YAt0L3QvtC0INC60LvQsNGB
0YLQtdGA0LAiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgICMg0KHQv9C+0YHQvtCxIDE6INGB
0L7QstC80LXRgdGC0LjQvNGL0Lkg0YEgcmVkaXMtcHktY2x1c3RlciA+PSAyLjEuMAogICAgICAg
ICAgICBpZiBoYXNhdHRyKGNsaWVudCwgJ2dldF9wcmltYXJpZXMnKToKICAgICAgICAgICAgICAg
IHJldHVybiBjbGllbnQuZ2V0X3ByaW1hcmllcygpCgogICAgICAgICAgICAjINCh0L/QvtGB0L7Q
sSAyOiDQtNC70Y8g0LHQvtC70LXQtSDRgdGC0LDRgNGL0YUg0LLQtdGA0YHQuNC5CiAgICAgICAg
ICAgIGVsaWYgaGFzYXR0cihjbGllbnQsICdnZXRfbm9kZXMnKToKICAgICAgICAgICAgICAgIG5v
ZGVzID0gY2xpZW50LmdldF9ub2RlcygpCiAgICAgICAgICAgICAgICBtYXN0ZXJfbm9kZXMgPSBb
XQogICAgICAgICAgICAgICAgZm9yIG5vZGUgaW4gbm9kZXM6CiAgICAgICAgICAgICAgICAgICAg
IyDQn9GA0L7QstC10YDRj9C10Lwg0YDQsNC30L3Ri9C80Lgg0YHQv9C+0YHQvtCx0LDQvNC4CiAg
ICAgICAgICAgICAgICAgICAgaWYgaGFzYXR0cihub2RlLCAnc2VydmVyX3R5cGUnKToKICAgICAg
ICAgICAgICAgICAgICAgICAgaWYgbm9kZS5zZXJ2ZXJfdHlwZSA9PSAnbWFzdGVyJzoKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG1hc3Rlcl9ub2Rlcy5hcHBlbmQobm9kZSkKICAgICAgICAg
ICAgICAgICAgICBlbGlmIGhhc2F0dHIobm9kZSwgJ3JlZGlzX2Nvbm5lY3Rpb24nKToKICAgICAg
ICAgICAgICAgICAgICAgICAgIyDQn9C+0L/RgNC+0LHRg9C10Lwg0L/QvtC70YPRh9C40YLRjCDQ
uNC90YTQvtGA0LzQsNGG0LjRjiDRh9C10YDQtdC3INC60L7QvNCw0L3QtNGDCiAgICAgICAgICAg
ICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBub2Rl
LmV4ZWN1dGVfY29tbWFuZCgnUk9MRScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBp
bmZvIGFuZCBpc2luc3RhbmNlKGluZm8sIGxpc3QpIGFuZCBpbmZvWzBdID09ICdtYXN0ZXInOgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hc3Rlcl9ub2Rlcy5hcHBlbmQobm9kZSkK
ICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29udGludWUKCiAgICAgICAgICAgICAgICByZXR1cm4gbWFzdGVyX25vZGVzCgogICAgICAg
ICAgICAjINCh0L/QvtGB0L7QsSAzOiDRh9C10YDQtdC3IENMVVNURVIgTk9ERVMKICAgICAgICAg
ICAgZWxzZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBub2Rlc19p
bmZvID0gY2xpZW50LmV4ZWN1dGVfY29tbWFuZCgnQ0xVU1RFUiBOT0RFUycpCiAgICAgICAgICAg
ICAgICAgICAgaWYgaXNpbnN0YW5jZShub2Rlc19pbmZvLCBieXRlcyk6CiAgICAgICAgICAgICAg
ICAgICAgICAgIG5vZGVzX2luZm8gPSBub2Rlc19pbmZvLmRlY29kZSgndXRmLTgnKQoKICAgICAg
ICAgICAgICAgICAgICBtYXN0ZXJfbm9kZXMgPSBbXQogICAgICAgICAgICAgICAgICAgIGZvciBs
aW5lIGluIG5vZGVzX2luZm8uc3BsaXQoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlm
IGxpbmUuc3RyaXAoKSBhbmQgJ21hc3RlcicgaW4gbGluZSBhbmQgJ215c2VsZicgbm90IGluIGxp
bmU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjINCf0LDRgNGB0LjQvCDQsNC00YDQtdGB
INC90L7QtNGLCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0cyA9IGxpbmUuc3BsaXQo
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHBhcnRzKSA+IDE6CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYWRkciA9IHBhcnRzWzFdCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaWYgJzonIGluIGFkZHI6CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGhvc3QsIHBvcnQgPSBhZGRyLnNwbGl0KCc6JykKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDQv9C+0LTQutC70Y7Rh9C10L3QuNC1
INC6INC90L7QtNC1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfY2xp
ZW50ID0gcmVkaXMuUmVkaXMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBob3N0PWhvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0
PWludChwb3J0KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY29k
ZV9yZXNwb25zZXM9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzb2NrZXRfdGltZW91dD0yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFzdGVyX25vZGVzLmFwcGVuZChu
b2RlX2NsaWVudCkKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hc3Rlcl9ub2RlcwogICAg
ICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHJldHVybiBbXQoKICAgICAg
ICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxl
ZCB0byBnZXQgbWFzdGVyIG5vZGVzOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gW10KCiAgICBk
ZWYgcmVmcmVzaF9rZXlzKHNlbGYpOgogICAgICAgICIiItCe0LHQvdC+0LLQu9C10L3QuNC1INGB
0L/QuNGB0LrQsCDQutC70Y7Rh9C10LkiIiIKICAgICAgICBpZiBub3Qgc2VsZi5jdXJyZW50X2Nv
bm5lY3Rpb24gb3Igbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmNvbm5lY3RlZDoKICAgICAg
ICAgICAgc2VsZi5rZXlfbGlzdF92aWV3LnNldF9rZXlzKFtdKQogICAgICAgICAgICByZXR1cm4K
CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlv
bi5hY3RpdmVfY2xpZW50CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQ2xpZW50IHR5cGU6IHt0
eXBlKGNsaWVudCl9IikKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJJcyBjbHVzdGVyOiB7c2Vs
Zi5jdXJyZW50X2Nvbm5lY3Rpb24uaXNfY2x1c3Rlcn0iKQoKICAgICAgICAgICAgc2VsZi5zZXRf
c3RhdHVzKCJTY2FubmluZyBrZXlzLi4uIikKCiAgICAgICAgICAgIGlmIHNlbGYuY3VycmVudF9j
b25uZWN0aW9uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiU3RhcnRp
bmcgY2x1c3RlciBzY2FuLi4uIikKICAgICAgICAgICAgICAgIGtleXNfd2l0aF90eXBlcyA9IHNl
bGYuX3NjYW5fY2x1c3Rlcl9rZXlzX3dpdGhfdHlwZXNfaXRlcihjbGllbnQpCiAgICAgICAgICAg
ICAgICBsb2dnZXIuaW5mbyhmIkNsdXN0ZXIgc2NhbiByZXR1cm5lZCB7bGVuKGtleXNfd2l0aF90
eXBlcyl9IGtleXMiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBTdGFuZGFs
b25lIC0g0YHQutCw0L3QuNGA0YPQtdC8INGBINGC0LjQv9Cw0LzQuAogICAgICAgICAgICAgICAg
bG9nZ2VyLmluZm8oIlN0YXJ0aW5nIHN0YW5kYWxvbmUgc2Nhbi4uLiIpCiAgICAgICAgICAgICAg
ICBrZXlzX3dpdGhfdHlwZXMgPSBbXQogICAgICAgICAgICAgICAgc2Nhbl9jb3VudCA9IDAKICAg
ICAgICAgICAgICAgIG1heF9rZXlzID0gNTAwMAoKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZv
KCJVc2luZyBzY2FuX2l0ZXIuLi4iKQogICAgICAgICAgICAgICAgZm9yIGtleSBpbiBjbGllbnQu
c2Nhbl9pdGVyKG1hdGNoPScqJywgY291bnQ9MTAwKToKICAgICAgICAgICAgICAgICAgICBpZiBz
Y2FuX2NvdW50ID49IG1heF9rZXlzOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAg
ICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlID0g
Y2xpZW50LnR5cGUoa2V5KQogICAgICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGtl
eV90eXBlLCBieXRlcyk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlfdHlwZSA9IGtl
eV90eXBlLmRlY29kZSgndXRmLTgnKQogICAgICAgICAgICAgICAgICAgICAgICBrZXlzX3dpdGhf
dHlwZXMuYXBwZW5kKChrZXksIGtleV90eXBlKSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6
CiAgICAgICAgICAgICAgICAgICAgICAgIGtleXNfd2l0aF90eXBlcy5hcHBlbmQoKGtleSwgJ3Vu
a25vd24nKSkKCiAgICAgICAgICAgICAgICAgICAgc2Nhbl9jb3VudCArPSAxCgogICAgICAgICAg
ICAgICAgICAgIGlmIHNjYW5fY291bnQgJSAxMDAgPT0gMDoKICAgICAgICAgICAgICAgICAgICAg
ICAgc2VsZi5zZXRfc3RhdHVzKGYiU2Nhbm5pbmcuLi4ge3NjYW5fY291bnR9IGtleXMiKQogICAg
ICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJTdGFuZGFsb25lIHNjYW4gY29tcGxldGU6IHtsZW4o
a2V5c193aXRoX3R5cGVzKX0ga2V5cyIpCgogICAgICAgICAgICAjINCf0L7QutCw0LfRi9Cy0LDQ
tdC8INC/0LXRgNCy0YvQtSDQvdC10YHQutC+0LvRjNC60L4g0LTQu9GPINC/0YDQvtCy0LXRgNC6
0LgKICAgICAgICAgICAgaWYga2V5c193aXRoX3R5cGVzOgogICAgICAgICAgICAgICAgbG9nZ2Vy
LmluZm8oZiJGaXJzdCAzIGtleXM6IHtrZXlzX3dpdGhfdHlwZXNbOjNdfSIpCiAgICAgICAgICAg
IGVsc2U6CiAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZygiTm8ga2V5cyBmb3VuZCEiKQoK
ICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlNldHRpbmcga2V5cyB0byBrZXlfbGlzdF92aWV3Li4u
IikKICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3LnNldF9rZXlzKGtleXNfd2l0aF90eXBl
cykKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIktleXMgc2V0IHN1Y2Nlc3NmdWxseSIpCgogICAg
ICAgICAgICBzZWxmLmtleV9jb3VudCA9IGxlbihrZXlzX3dpdGhfdHlwZXMpCiAgICAgICAgICAg
ICMg0J7QsdC90L7QstC70Y/QtdC8INC00LXRgNC10LLQviDQv9C+0LTQutC70Y7Rh9C10L3QuNC5
ICjRh9GC0L7QsdGLINC/0L7QutCw0LfQsNGC0Ywg0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQu9GO
0YfQtdC5KQogICAgICAgICAgICBzZWxmLnVwZGF0ZV9jb25uZWN0aW9uX3RyZWUoKQoKICAgICAg
ICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiTG9hZGVkIHtsZW4oa2V5c193aXRoX3R5cGVzKX0ga2V5
cyIsICdzdWNjZXNzJykKCiAgICAgICAgICAgIGlmIHNlbGYuY3VycmVudF9rZXk6CiAgICAgICAg
ICAgICAgICBzZWxmLmRpc3BsYXlfa2V5X2RldGFpbHMoc2VsZi5jdXJyZW50X2tleSkKICAgICAg
ICAgICAgbG9nZ2VyLmluZm8oIj09PSByZWZyZXNoX2tleXMgY29tcGxldGVkID09PSIpCgogICAg
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYi
RXJyb3IgbG9hZGluZyBrZXlzOiB7ZX0iLCAnZXJyb3InKQogICAgICAgICAgICBsb2dnZXIuZXJy
b3IoZiJFcnJvciBsb2FkaW5nIGtleXM6IHtlfSIpCgogICAgZGVmIG9uX2tleV9zZWxlY3Qoc2Vs
Ziwga2V5OiBieXRlcyk6CiAgICAgICAgIiIi0J7QsdGA0LDQsdC+0YLRh9C40Log0LLRi9Cx0L7R
gNCwINC60LvRjtGH0LAKCiAgICAgICAgQXJnczoKICAgICAgICAgICAgd2lkZ2V0OiBLZXlMaXN0
VmlldyAtINC40YHRgtC+0YfQvdC40Log0YHQuNCz0L3QsNC70LAgKNC00L7QsdCw0LLQu9GP0LXR
gtGB0Y8gdXJ3aWQpCiAgICAgICAgICAgIGtleTogYnl0ZXMgLSDQstGL0LHRgNCw0L3QvdGL0Lkg
0LrQu9GO0YcKICAgICAgICAiIiIKICAgICAgICBsb2dnZXIuaW5mbyhmIlVJOiBLZXkgc2VsZWN0
ZWQ6IHtrZXl9IikKCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uIG9yIG5v
dCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5jb25uZWN0ZWQ6CiAgICAgICAgICAgIHJldHVybgoK
ICAgICAgICBzZWxmLmN1cnJlbnRfa2V5ID0ga2V5CiAgICAgICAgc2VsZi5kaXNwbGF5X2tleV9k
ZXRhaWxzKHNlbGYuY3VycmVudF9rZXkpCgogICAgZGVmIGdldF9zZWxlY3RlZF9rZXkoc2VsZikg
LT4gT3B0aW9uYWxbYnl0ZXNdOgogICAgICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg0LLRi9Cx0YDQ
sNC90L3Ri9C5INC60LvRjtGHIiIiCiAgICAgICAgcmV0dXJuIHNlbGYua2V5X2xpc3Rfdmlldy5n
ZXRfZm9jdXNlZF9rZXkoKQoKICAgIGRlZiBfc2Nhbl9jbHVzdGVyX2tleXNfd2l0aF90eXBlc19p
dGVyKHNlbGYsIGNsaWVudCkgLT4gTGlzdFtUdXBsZVtieXRlcywgc3RyXV06CiAgICAgICAgIiIi
0KHQutCw0L3QuNGA0L7QstCw0L3QuNC1INC60LvRjtGH0LXQuSDQsiBSZWRpcyBDbHVzdGVyINGB
INC/0L7Qu9GD0YfQtdC90LjQtdC8INC40YUg0YLQuNC/0L7QsiIiIgogICAgICAgIGtleXNfd2l0
aF90eXBlcyA9IFtdCiAgICAgICAgc2VsZi5rZXlfY291bnQgPSAwCgogICAgICAgIHRyeToKICAg
ICAgICAgICAgbWF4X2tleXMgPSA1MDAwICAjINCe0LPRgNCw0L3QuNGH0LXQvdC40LUg0LTQu9GP
INC/0YDQvtC40LfQstC+0LTQuNGC0LXQu9GM0L3QvtGB0YLQuAogICAgICAgICAgICBzY2FuX2Nv
dW50ID0gMAoKICAgICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10LwsINGP0LLQu9GP0LXRgtGB
0Y8g0LvQuCDRjdGC0L4g0LrQu9Cw0YHRgtC10YDQvtC8CiAgICAgICAgICAgIGlmIGNsaWVudC5p
c19jbHVzdGVyIGFuZCBjbGllbnQuY2x1c3Rlcl9ub2RlczoKICAgICAgICAgICAgICAgICMg4pyF
INCh0LrQsNC90LjRgNGD0LXQvCDQmtCQ0JbQlNCr0Jkg0LzQsNGB0YLQtdGAINGD0LfQtdC7INCy
INC60LvQsNGB0YLQtdGA0LUKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiU2Nhbm5pbmcg
e2xlbihjbGllbnQuY2x1c3Rlcl9ub2Rlcyl9IGNsdXN0ZXIgbm9kZXMuLi4iKQoKICAgICAgICAg
ICAgICAgIGZvciBub2RlX2lkLCBub2RlX2Nvbm4gaW4gY2xpZW50LmNsdXN0ZXJfbm9kZXMuaXRl
bXMoKToKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIlNjYW5uaW5nIG5vZGU6IHtu
b2RlX2lkfSIpCgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAg
ICAgIyBTQ0FOINC90LAg0LrQvtC90LrRgNC10YLQvdC+0Lwg0YPQt9C70LUKICAgICAgICAgICAg
ICAgICAgICAgICAgY3Vyc29yID0gMAogICAgICAgICAgICAgICAgICAgICAgICBub2RlX2tleXNf
Y291bnQgPSAwCgogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIyDQktGL0L/QvtC70L3Rj9C10LwgU0NBTiDQvdCw0L/RgNGP0LzR
g9GOINC90LAg0YPQt9C70LUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvciwga2V5
cyA9IHNlbGYuX3NjYW5fbm9kZShub2RlX2Nvbm4sIGN1cnNvciwgbWF0Y2g9JyonLCBjb3VudD0x
MDApCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGtleSBpbiBrZXlzOgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNjYW5fY291bnQgPj0gbWF4X2tleXM6CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQ
n9C+0LvRg9GH0LDQtdC8INGC0LjQvyDQutC70Y7Rh9CwICjRh9C10YDQtdC3INC/0YDQsNCy0LjQ
u9GM0L3Ri9C5INGD0LfQtdC7ISkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
a2V5X3R5cGUgPSBjbGllbnQudHlwZShrZXkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGlmIGlzaW5zdGFuY2Uoa2V5X3R5cGUsIGJ5dGVzKToKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlID0ga2V5X3R5cGUuZGVjb2RlKCd1dGYtOCcp
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleXNfd2l0aF90eXBlcy5hcHBl
bmQoKGtleSwga2V5X3R5cGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2Vw
dCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9n
Z2VyLmRlYnVnKGYiRXJyb3IgZ2V0dGluZyB0eXBlIGZvciBrZXkge2tleX06IHtlfSIpCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleXNfd2l0aF90eXBlcy5hcHBlbmQoKGtl
eSwgJ3Vua25vd24nKSkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nhbl9jb3Vu
dCArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9rZXlzX2NvdW50ICs9
IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmtleV9jb3VudCArPSAxCgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0J7QsdC90L7QstC70Y/QtdC8INGB0YLQ
sNGC0YPRgSDQutCw0LbQtNGL0LUgMTAwINC60LvRjtGH0LXQuQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIHNjYW5fY291bnQgJSAxMDAgPT0gMDoKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiU2Nhbm5pbmcuLi4gRm91bmQge3Nj
YW5fY291bnR9IGtleXMiKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGN1cnNvciA9
PSAwIG9yIHNjYW5fY291bnQgPj0gbWF4X2tleXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWsKCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiTm9kZSB7
bm9kZV9pZH06IGZvdW5kIHtub2RlX2tleXNfY291bnR9IGtleXMiKQoKICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgc2Nhbl9jb3VudCA+PSBtYXhfa2V5czoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIlN0b3BwZWQgYXQge21heF9rZXlzfSBrZXlzIChsaW1p
dCByZWFjaGVkKSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAg
ICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAg
IGxvZ2dlci5lcnJvcihmIkVycm9yIHNjYW5uaW5nIG5vZGUge25vZGVfaWR9OiB7ZX0iKQogICAg
ICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAg
ICAgICAgICMg4pyFIFN0YW5kYWxvbmUg0YDQtdC20LjQvCAtINC+0LHRi9GH0L3Ri9C5IHNjYW5f
aXRlcgogICAgICAgICAgICAgICAgaWYgaGFzYXR0cihjbGllbnQsICdzY2FuX2l0ZXInKToKICAg
ICAgICAgICAgICAgICAgICBmb3Iga2V5IGluIGNsaWVudC5zY2FuX2l0ZXIobWF0Y2g9JyonLCBj
b3VudD0xMDApOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBzY2FuX2NvdW50ID49IG1heF9r
ZXlzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiU3RvcHBl
ZCBhdCB7bWF4X2tleXN9IGtleXMgKGxpbWl0IHJlYWNoZWQpIikKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBrZXlfdHlwZSA9IGNsaWVudC50eXBlKGtleSkKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoa2V5X3R5cGUsIGJ5dGVzKToKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBrZXlfdHlwZSA9IGtleV90eXBlLmRlY29kZSgndXRmLTgn
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5c193aXRoX3R5cGVzLmFwcGVuZCgoa2V5
LCBrZXlfdHlwZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGtleXNfd2l0aF90eXBlcy5hcHBlbmQoKGtleSwgJ3Vua25vd24nKSkK
CiAgICAgICAgICAgICAgICAgICAgICAgIHNjYW5fY291bnQgKz0gMQogICAgICAgICAgICAgICAg
ICAgICAgICBzZWxmLmtleV9jb3VudCArPSAxCgogICAgICAgICAgICAgICAgICAgICAgICBpZiBz
Y2FuX2NvdW50ICUgMTAwID09IDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNl
dF9zdGF0dXMoZiJTY2FubmluZy4uLiBGb3VuZCB7c2Nhbl9jb3VudH0ga2V5cyIpCiAgICAgICAg
ICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgRmFsbGJhY2sg0LTQu9GPINGB0YLQ
sNGA0YvRhSDQstC10YDRgdC40LkKICAgICAgICAgICAgICAgICAgICBjdXJzb3IgPSAwCiAgICAg
ICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29y
LCBrZXlzID0gY2xpZW50LnNjYW4oY3Vyc29yLCBtYXRjaD0nKicsIGNvdW50PTEwMCkKICAgICAg
ICAgICAgICAgICAgICAgICAgZm9yIGtleSBpbiBrZXlzOgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgc2Nhbl9jb3VudCA+PSBtYXhfa2V5czoKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlID0gY2xpZW50LnR5cGUoa2V5KQogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoa2V5X3R5cGUsIGJ5dGVzKToK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5X3R5cGUgPSBrZXlfdHlwZS5k
ZWNvZGUoJ3V0Zi04JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzX3dpdGhf
dHlwZXMuYXBwZW5kKChrZXksIGtleV90eXBlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzX3dpdGhfdHlwZXMu
YXBwZW5kKChrZXksICd1bmtub3duJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2Fu
X2NvdW50ICs9IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYua2V5X2NvdW50ICs9
IDEKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGN1cnNvciA9PSAwIG9yIHNjYW5fY291bnQg
Pj0gbWF4X2tleXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICBl
eGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHBy
b2Nlc3Npbmcga2V5czoge2V9IiwgZXhjX2luZm89VHJ1ZSkKCiAgICAgICAgIyDQo9Cx0LjRgNCw
0LXQvCDQtNGD0LHQu9C40LrQsNGC0YsKICAgICAgICBzZWVuID0gc2V0KCkKICAgICAgICB1bmlx
dWVfa2V5cyA9IFtdCiAgICAgICAgZm9yIGtleSwga2V5X3R5cGUgaW4ga2V5c193aXRoX3R5cGVz
OgogICAgICAgICAgICBpZiBrZXkgbm90IGluIHNlZW46CiAgICAgICAgICAgICAgICBzZWVuLmFk
ZChrZXkpCiAgICAgICAgICAgICAgICB1bmlxdWVfa2V5cy5hcHBlbmQoKGtleSwga2V5X3R5cGUp
KQoKICAgICAgICBsb2dnZXIuaW5mbyhmIlNjYW5uZWQge2xlbih1bmlxdWVfa2V5cyl9IHVuaXF1
ZSBrZXlzIHdpdGggdHlwZXMiKQogICAgICAgIHJldHVybiB1bmlxdWVfa2V5cwoKICAgIGRlZiBf
c2Nhbl9ub2RlKHNlbGYsIG5vZGVfY29ubiwgY3Vyc29yOiBpbnQsIG1hdGNoOiBzdHIsIGNvdW50
OiBpbnQpOgogICAgICAgICIiItCS0YvQv9C+0LvQvdC40YLRjCBTQ0FOINC90LAg0LrQvtC90LrR
gNC10YLQvdC+0Lwg0YPQt9C70LUg0LrQu9Cw0YHRgtC10YDQsCIiIgogICAgICAgIGFyZ3MgPSBb
J1NDQU4nLCBjdXJzb3JdCgogICAgICAgIGlmIG1hdGNoOgogICAgICAgICAgICBhcmdzLmV4dGVu
ZChbJ01BVENIJywgbWF0Y2hdKQogICAgICAgIGlmIGNvdW50OgogICAgICAgICAgICBhcmdzLmV4
dGVuZChbJ0NPVU5UJywgY291bnRdKQoKICAgICAgICByZXNwb25zZSA9IG5vZGVfY29ubi5leGVj
dXRlX2NvbW1hbmQoKmFyZ3MpCgogICAgICAgIG5ld19jdXJzb3IgPSBpbnQocmVzcG9uc2VbMF0p
CiAgICAgICAga2V5cyA9IHJlc3BvbnNlWzFdCgogICAgICAgIHJldHVybiBuZXdfY3Vyc29yLCBr
ZXlzCgogICAgZGVmIGRpc3BsYXlfa2V5X2RldGFpbHMoc2VsZiwga2V5OiBieXRlcyk6CiAgICAg
ICAgIiIi0J7RgtC+0LHRgNCw0LbQtdC90LjQtSDQtNC10YLQsNC70LXQuSDQutC70Y7Rh9CwINGB
INC/0L7QtNC00LXRgNC20LrQvtC5INC60LvQsNGB0YLQtdGA0LAiIiIKICAgICAgICBpZiBub3Qg
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gb3Igbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmNv
bm5lY3RlZDoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgY2xp
ZW50ID0gc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uYWN0aXZlX2NsaWVudAogICAgICAgICAgICBr
ZXlfc3RyID0ga2V5LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQoKICAgICAgICAg
ICAgIyDQn9C+0LvRg9GH0LDQtdC8INC+0YHQvdC+0LLQvdGD0Y4g0LjQvdGE0L7RgNC80LDRhtC4
0Y4g0L4g0LrQu9GO0YfQtQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBrZXlfdHlw
ZSA9IGNsaWVudC50eXBlKGtleSkKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoa2V5X3R5
cGUsIGJ5dGVzKToKICAgICAgICAgICAgICAgICAgICBrZXlfdHlwZSA9IGtleV90eXBlLmRlY29k
ZSgndXRmLTgnKQogICAgICAgICAgICAgICAgdHRsID0gY2xpZW50LnR0bChrZXkpCiAgICAgICAg
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1
cyhmIkVycm9yIGdldHRpbmcga2V5IGluZm86IHtlfSIsICdlcnJvcicpCiAgICAgICAgICAgICAg
ICByZXR1cm4KCiAgICAgICAgICAgICMg0J3QsNGH0LjQvdCw0LXQvCDRhNC+0YDQvNC40YDQvtCy
0LDRgtGMINCy0YvQstC+0LQKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyWzpdID0gW10K
CiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dChbCiAgICAg
ICAgICAgICAgICAoJ2luZm9fbGFiZWwnLCAnS2V5OiAnKSwKICAgICAgICAgICAgICAgICgnaW5m
b192YWx1ZScsIGtleV9zdHIpCiAgICAgICAgICAgIF0pKQogICAgICAgICAgICBzZWxmLmRldGFp
bF93YWxrZXIuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKCiAgICAgICAgICAgICMg0J7RgdC90L7Q
stC90LDRjyDQuNC90YTQvtGA0LzQsNGG0LjRjyAo0LTQu9GPINC60LvQsNGB0YLQtdGA0LAg0Lgg
c3RhbmRhbG9uZSkKICAgICAgICAgICAgaW5mb19pdGVtcyA9IFsKICAgICAgICAgICAgICAgICgn
VHlwZScsIGtleV90eXBlKSwKICAgICAgICAgICAgICAgICgnVFRMJywgZiJ7dHRsfXMiIGlmIHR0
bCA+IDAgZWxzZSAnTm8gZXhwaXJhdGlvbicgaWYgdHRsID09IC0xIGVsc2UgJ04vQScpLAogICAg
ICAgICAgICBdCgogICAgICAgICAgICAjINCU0L7Qv9C+0LvQvdC40YLQtdC70YzQvdCw0Y8g0LjQ
vdGE0L7RgNC80LDRhtC40Y8g0LTQu9GPINC60LvQsNGB0YLQtdGA0LAKICAgICAgICAgICAgaWYg
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uaXNfY2x1c3RlcjoKICAgICAgICAgICAgICAgIHRyeToK
ICAgICAgICAgICAgICAgICAgICBzbG90ID0gY2xpZW50LmtleXNsb3Qoa2V5X3N0cikKICAgICAg
ICAgICAgICAgICAgICBub2RlID0gY2xpZW50LmdldF9ub2RlX2Zyb21fa2V5KGtleV9zdHIpCiAg
ICAgICAgICAgICAgICAgICAgaW5mb19pdGVtcy5leHRlbmQoWwogICAgICAgICAgICAgICAgICAg
ICAgICAoJ0hhc2ggU2xvdCcsIHN0cihzbG90KSksCiAgICAgICAgICAgICAgICAgICAgICAgICgn
Tm9kZScsIGYie25vZGUuaG9zdH06e25vZGUucG9ydH0iKSwKICAgICAgICAgICAgICAgICAgICBd
KQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAg
ICAgIGxvZ2dlci53YXJuaW5nKGYiQ291bGQgbm90IGdldCBjbHVzdGVyIGluZm8gZm9yIGtleTog
e2V9IikKCiAgICAgICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INC40L3RhNC+0YDQvNCw0YbQ
uNGOINC+INGA0LDQt9C80LXRgNC1INCyINC30LDQstC40YHQuNC80L7RgdGC0Lgg0L7RgiDRgtC4
0L/QsAogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBrZXlfdHlwZSA9PSAnc3Ry
aW5nJzoKICAgICAgICAgICAgICAgICAgICBzaXplID0gY2xpZW50LnN0cmxlbihrZXkpCiAgICAg
ICAgICAgICAgICAgICAgaW5mb19pdGVtcy5hcHBlbmQoKCdTaXplJywgZiJ7c2l6ZX0gYnl0ZXMi
KSkKICAgICAgICAgICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ2xpc3QnOgogICAgICAgICAgICAg
ICAgICAgIHNpemUgPSBjbGllbnQubGxlbihrZXkpCiAgICAgICAgICAgICAgICAgICAgaW5mb19p
dGVtcy5hcHBlbmQoKCdMZW5ndGgnLCBzdHIoc2l6ZSkpKQogICAgICAgICAgICAgICAgZWxpZiBr
ZXlfdHlwZSA9PSAnc2V0JzoKICAgICAgICAgICAgICAgICAgICBzaXplID0gY2xpZW50LnNjYXJk
KGtleSkKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmFwcGVuZCgoJ01lbWJlcnMnLCBz
dHIoc2l6ZSkpKQogICAgICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnenNldCc6CiAgICAg
ICAgICAgICAgICAgICAgc2l6ZSA9IGNsaWVudC56Y2FyZChrZXkpCiAgICAgICAgICAgICAgICAg
ICAgaW5mb19pdGVtcy5hcHBlbmQoKCdNZW1iZXJzJywgc3RyKHNpemUpKSkKICAgICAgICAgICAg
ICAgIGVsaWYga2V5X3R5cGUgPT0gJ2hhc2gnOgogICAgICAgICAgICAgICAgICAgIHNpemUgPSBj
bGllbnQuaGxlbihrZXkpCiAgICAgICAgICAgICAgICAgICAgaW5mb19pdGVtcy5hcHBlbmQoKCdG
aWVsZHMnLCBzdHIoc2l6ZSkpKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAg
ICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIkNvdWxkIG5vdCBnZXQgc2l6ZSBpbmZvIGZv
ciBrZXk6IHtlfSIpCgogICAgICAgICAgICAjINCe0YLQvtCx0YDQsNC20LDQtdC8INCy0YHRjiDQ
uNC90YTQvtGA0LzQsNGG0LjRjgogICAgICAgICAgICBmb3IgbGFiZWwsIHZhbHVlIGluIGluZm9f
aXRlbXM6CiAgICAgICAgICAgICAgICByb3cgPSB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAg
ICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLkF0dHJNYXAodXJ3aWQuVGV4dChsYWJlbCksICdp
bmZvX2xhYmVsJykpLAogICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMiwgdXJ3aWQuQXR0
ck1hcCh1cndpZC5UZXh0KHN0cih2YWx1ZSkpLCAnaW5mb192YWx1ZScpKSwKICAgICAgICAgICAg
ICAgIF0pCiAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHJvdykKCiAg
ICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQogICAg
ICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoKCdpbmZvX2xhYmVs
JywgJ1ZhbHVlOicpKSkKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVuZCh1cndp
ZC5EaXZpZGVyKCkpCgogICAgICAgICAgICAjINCe0YLQvtCx0YDQsNC20LXQvdC40LUg0LfQvdCw
0YfQtdC90LjRjyDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YIg0YLQuNC/0LAg0LrQu9GO
0YfQsAogICAgICAgICAgICAjINCt0YLQvtGCINC60L7QtCDQvtCx0YnQuNC5INC00LvRjyBjbHVz
dGVyINC4IHN0YW5kYWxvbmUKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYga2V5
X3R5cGUgPT0gJ3N0cmluZyc6CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjbGllbnQuZ2V0
KGtleSkKICAgICAgICAgICAgICAgICAgICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgICAgICAg
ICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoKCdlcnJvcics
ICdLZXkgbm90IGZvdW5kJykpKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAg
ICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlX3N0ciA9
IHZhbHVlLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVuZCh1cndpZC5UZXh0KHZhbHVlX3N0
cikpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdXJ3aWQuVGV4dChmJzxiaW5hcnkgZGF0YToge2xlbih2YWx1ZSl9IGJ5dGVzPicp
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgZWxpZiBrZXlf
dHlwZSA9PSAnaGFzaCc6CiAgICAgICAgICAgICAgICAgICAgaGFzaF9kYXRhID0gY2xpZW50Lmhn
ZXRhbGwoa2V5KQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNoX2RhdGE6CiAgICAgICAg
ICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dCgnKGVt
cHR5IGhhc2gpJykpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAg
ICAgICAgZm9yIGZpZWxkLCB2YWwgaW4gaGFzaF9kYXRhLml0ZW1zKCk6CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRf
c3RyID0gZmllbGQuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdmFsX3N0ciA9IHZhbC5kZWNvZGUoJ3V0Zi04JywgZXJyb3Jz
PSdyZXBsYWNlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cgPSB1cndpZC5D
b2x1bW5zKFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAx
LCB1cndpZC5UZXh0KCgna2V5X2ZvbGRlcicsIGZpZWxkX3N0cikpKSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAyLCB1cndpZC5UZXh0KHZhbF9zdHIpKSwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQocm93KQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0JTQ
u9GPINCx0LjQvdCw0YDQvdGL0YUg0LTQsNC90L3Ri9GFCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcm93ID0gdXJ3aWQuQ29sdW1ucyhbCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuVGV4dCgoJ2tleV9mb2xkZXInLCAnPGJpbmFy
eSBmaWVsZD4nKSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ3dlaWdo
dCcsIDIsIHVyd2lkLlRleHQoZic8YmluYXJ5OiB7bGVuKHZhbCl9IGJ5dGVzPicpKSwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQocm93KQoKICAgICAgICAgICAgICAgIGVsaWYg
a2V5X3R5cGUgPT0gJ2xpc3QnOgogICAgICAgICAgICAgICAgICAgICMg0J/QvtC70YPRh9Cw0LXQ
vCDRgtC+0LvRjNC60L4g0L/QtdGA0LLRi9C1IDEwMCDRjdC70LXQvNC10L3RgtC+0LIKICAgICAg
ICAgICAgICAgICAgICBsaXN0X2RhdGEgPSBjbGllbnQubHJhbmdlKGtleSwgMCwgOTkpCiAgICAg
ICAgICAgICAgICAgICAgaWYgbm90IGxpc3RfZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAg
c2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVuZCh1cndpZC5UZXh0KCcoZW1wdHkgbGlzdCknKSkKICAg
ICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaWR4LCBp
dGVtIGluIGVudW1lcmF0ZShsaXN0X2RhdGEpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
dHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1fc3RyID0gaXRlbS5kZWNv
ZGUoJ3V0Zi04JywgZXJyb3JzPSdyZXBsYWNlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoZiJbe2lkeH1dIHtpdGVt
X3N0cn0iKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1cndpZC5UZXh0KGYiW3tpZHh9XSA8YmluYXJ5OiB7
bGVuKGl0ZW0pfSBieXRlcz4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKCiAg
ICAgICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdzZXQnOgogICAgICAgICAgICAgICAgICAg
ICMg0J/QvtC70YPRh9Cw0LXQvCDRgtC+0LvRjNC60L4g0L/QtdGA0LLRi9C1IDEwMCDRjdC70LXQ
vNC10L3RgtC+0LIKICAgICAgICAgICAgICAgICAgICBzZXRfZGF0YSA9IGxpc3QoY2xpZW50LnNt
ZW1iZXJzKGtleSkpWzoxMDBdCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHNldF9kYXRhOgog
ICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRl
eHQoJyhlbXB0eSBzZXQpJykpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAg
ICAgICAgICAgICAgZm9yIGl0ZW0gaW4gc2V0X2RhdGE6CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbV9zdHIgPSBpdGVt
LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dChmIuKAoiB7aXRl
bV9zdHJ9IikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVuZCgKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJ3aWQuVGV4dChmIuKAoiA8YmluYXJ5OiB7bGVu
KGl0ZW0pfSBieXRlcz4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKCiAgICAg
ICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICd6c2V0JzoKICAgICAgICAgICAgICAgICAgICAj
INCf0L7Qu9GD0YfQsNC10Lwg0YLQvtC70YzQutC+INC/0LXRgNCy0YvQtSAxMDAg0Y3Qu9C10LzQ
tdC90YLQvtCyCiAgICAgICAgICAgICAgICAgICAgenNldF9kYXRhID0gY2xpZW50LnpyYW5nZShr
ZXksIDAsIDk5LCB3aXRoc2NvcmVzPVRydWUpCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHpz
ZXRfZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVu
ZCh1cndpZC5UZXh0KCcoZW1wdHkgenNldCknKSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgICAgICAgICBmb3IgbWVtYmVyLCBzY29yZSBpbiB6c2V0X2RhdGE6CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbWVtYmVyX3N0ciA9IG1lbWJlci5kZWNvZGUoJ3V0Zi04JywgZXJyb3JzPSdyZXBsYWNl
JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cgPSB1cndpZC5Db2x1bW5zKFsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAyLCB1cndpZC5U
ZXh0KG1lbWJlcl9zdHIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd3
ZWlnaHQnLCAxLCB1cndpZC5UZXh0KCgnaW5mb192YWx1ZScsIHN0cihzY29yZSkpKSksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHJvdykKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cgPSB1cndp
ZC5Db2x1bW5zKFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd3ZWlnaHQn
LCAyLCB1cndpZC5UZXh0KGYnPGJpbmFyeToge2xlbihtZW1iZXIpfSBieXRlcz4nKSksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuVGV4dCgo
J2luZm9fdmFsdWUnLCBzdHIoc2NvcmUpKSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2Vy
LmFwcGVuZChyb3cpCgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBz
ZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoZidVbmtub3duIGtleSB0eXBlOiB7
a2V5X3R5cGV9JykpCgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHVy
d2lkLlRleHQoKCdlcnJvcicsIGYnRXJyb3IgcmV0cmlldmluZyB2YWx1ZToge3N0cihlKX0nKSkK
ICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHJl
dHJpZXZpbmcgdmFsdWUgZm9yIGtleSB7a2V5X3N0cn06IHtlfSIpCgogICAgICAgICAgICAjINCa
0L3QvtC/0LrQuCDQtNC10LnRgdGC0LLQuNC5ICjRg9C00LDQu9C10L3QuNC1INC4INGCLtC0LikK
ICAgICAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLnByb2ZpbGUucmVhZG9u
bHk6CiAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLkRpdmlk
ZXIoKSkKICAgICAgICAgICAgICAgIGRlbGV0ZV9idG4gPSB1cndpZC5CdXR0b24oJ0RlbGV0ZSBL
ZXknLCBvbl9wcmVzcz1sYW1iZGEgYjogc2VsZi5kZWxldGVfa2V5KGtleSkpCiAgICAgICAgICAg
ICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHVyd2lk
LkF0dHJNYXAoZGVsZXRlX2J0biwgJ2J1dHRvbl9kYW5nZXInLCAnYnV0dG9uX2ZvY3VzJykKICAg
ICAgICAgICAgICAgICkKCiAgICAgICAgICAgICMg0JXRgdC70Lgg0Y3RgtC+INC60LvQsNGB0YLQ
tdGALCDQtNC+0LHQsNCy0LvRj9C10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L4g0LzQuNCz0YDQ
sNGG0LjQuAogICAgICAgICAgICBpZiBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5pc19jbHVzdGVy
OgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA
0Y/QtdC8LCDQvdC1INC80LjQs9GA0LjRgNGD0LXRgtGB0Y8g0LvQuCDQutC70Y7RhwogICAgICAg
ICAgICAgICAgICAgIGNsdXN0ZXJfaW5mbyA9IGNsaWVudC5jbHVzdGVyKCdLRVlTTE9UJywga2V5
X3N0cikKICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGNsdXN0ZXJfaW5mbywgYnl0
ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICBjbHVzdGVyX2luZm8gPSBjbHVzdGVyX2luZm8u
ZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFw
cGVuZCh1cndpZC5EaXZpZGVyKCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fs
a2VyLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgdXJ3aWQuVGV4dCgoJ2luZm9fbGFi
ZWwnLCBmJ0NsdXN0ZXIgU2xvdDoge2NsdXN0ZXJfaW5mb30nKSkKICAgICAgICAgICAgICAgICAg
ICApCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAg
ICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhm
IkVycm9yIGRpc3BsYXlpbmcga2V5OiB7ZX0iLCAnZXJyb3InKQogICAgICAgICAgICBsb2dnZXIu
ZXJyb3IoZiJFcnJvciBkaXNwbGF5aW5nIGtleSB7a2V5fToge2V9IikKICAgICAgICAgICAgIyDQ
n9C+0LrQsNC30YvQstCw0LXQvCDQvtGI0LjQsdC60YMg0LIg0LTQtdGC0LDQu9GP0YUKICAgICAg
ICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyWzpdID0gWwogICAgICAgICAgICAgICAgdXJ3aWQuVGV4
dCgoJ2Vycm9yJywgZidFcnJvcjoge3N0cihlKX0nKSkKICAgICAgICAgICAgXQoKICAgIGRlZiBk
ZWJ1Z19jbHVzdGVyX2luZm8oc2VsZik6CiAgICAgICAgIiIi0J7RgtC70LDQtNC+0YfQvdCw0Y8g
0LjQvdGE0L7RgNC80LDRhtC40Y8g0L4g0LrQu9Cw0YHRgtC10YDQtSIiIgogICAgICAgIGlmIG5v
dCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBub3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24u
aXNfY2x1c3RlcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAg
Y2xpZW50ID0gc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uYWN0aXZlX2NsaWVudAoKICAgICAgICAg
ICAgIyDQktGL0LLQvtC00LjQvCDQstGB0Y4g0LTQvtGB0YLRg9C/0L3Rg9GOINC40L3RhNC+0YDQ
vNCw0YbQuNGOCiAgICAgICAgICAgIGluZm8gPSB7fQoKICAgICAgICAgICAgIyAxLiDQn9GA0L7Q
stC10YDRj9C10Lwg0LzQtdGC0L7QtNGLINC60LvQuNC10L3RgtCwCiAgICAgICAgICAgIGluZm9b
J2NsaWVudF9tZXRob2RzJ10gPSBbbSBmb3IgbSBpbiBkaXIoY2xpZW50KSBpZiBub3QgbS5zdGFy
dHN3aXRoKCdfJyldCgogICAgICAgICAgICAjIDIuINCf0YDQvtCx0YPQtdC8INC/0L7Qu9GD0YfQ
uNGC0Ywg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L4g0L3QvtC00LDRhQogICAgICAgICAgICB0cnk6
CiAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKGNsaWVudCwgJ2dldF9ub2RlcycpOgogICAgICAg
ICAgICAgICAgICAgIG5vZGVzID0gY2xpZW50LmdldF9ub2RlcygpCiAgICAgICAgICAgICAgICAg
ICAgaW5mb1snbm9kZXNfY291bnQnXSA9IGxlbihub2RlcykKICAgICAgICAgICAgICAgICAgICBp
bmZvWydub2Rlc19pbmZvJ10gPSBbXQogICAgICAgICAgICAgICAgICAgIGZvciBpLCBub2RlIGlu
IGVudW1lcmF0ZShub2Rlc1s6M10pOiAgIyDQn9C10YDQstGL0LUgMyDQvdC+0LTRiwogICAgICAg
ICAgICAgICAgICAgICAgICBub2RlX2luZm8gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAnaW5kZXgnOiBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiBzdHIodHlw
ZShub2RlKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYXR0cnMnOiBbYSBmb3IgYSBp
biBkaXIobm9kZSkgaWYgbm90IGEuc3RhcnRzd2l0aCgnXycpXQogICAgICAgICAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICMg0J/RgNC+0LHRg9C10Lwg0L/QvtC70YPR
h9C40YLRjCDQsNC00YDQtdGBCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIobm9k
ZSwgJ2hvc3QnKSBhbmQgaGFzYXR0cihub2RlLCAncG9ydCcpOgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbm9kZV9pbmZvWydhZGRyZXNzJ10gPSBmIntub2RlLmhvc3R9Ontub2RlLnBvcnR9
IgogICAgICAgICAgICAgICAgICAgICAgICBpbmZvWydub2Rlc19pbmZvJ10uYXBwZW5kKG5vZGVf
aW5mbykKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAg
aW5mb1snbm9kZXNfZXJyb3InXSA9IHN0cihlKQoKICAgICAgICAgICAgIyAzLiDQn9GA0L7QsdGD
0LXQvCBDTFVTVEVSIElORk8KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgY2x1c3Rl
cl9pbmZvID0gY2xpZW50LmNsdXN0ZXJfaW5mbygpCiAgICAgICAgICAgICAgICBpbmZvWydjbHVz
dGVyX2luZm8nXSA9IGNsdXN0ZXJfaW5mbwogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFz
IGU6CiAgICAgICAgICAgICAgICBpbmZvWydjbHVzdGVyX2luZm9fZXJyb3InXSA9IHN0cihlKQoK
ICAgICAgICAgICAgIyA0LiDQn9GA0L7QsdGD0LXQvCBST0xFCiAgICAgICAgICAgIHRyeToKICAg
ICAgICAgICAgICAgIHJvbGUgPSBjbGllbnQuZXhlY3V0ZV9jb21tYW5kKCdST0xFJykKICAgICAg
ICAgICAgICAgIGluZm9bJ3JvbGUnXSA9IHJvbGUKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgICAgICAgICAgaW5mb1sncm9sZV9lcnJvciddID0gc3RyKGUpCgogICAg
ICAgICAgICAjINCX0LDQv9C40YHRi9Cy0LDQtdC8INCyINC70L7QswogICAgICAgICAgICBsb2dn
ZXIuaW5mbyhmIkNsdXN0ZXIgZGVidWcgaW5mbzoge2pzb24uZHVtcHMoaW5mbywgZGVmYXVsdD1z
dHIsIGluZGVudD0yKX0iKQoKICAgICAgICAgICAgIyDQn9C+0LrQsNC30YvQstCw0LXQvCDQsiBV
SQogICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXJbOl0gPSBbXQogICAgICAgICAgICBzZWxm
LmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoKCdoZWFkZXJfdGV4dCcsICdDbHVzdGVy
IERlYnVnIEluZm86JykpKQogICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVy
d2lkLkRpdmlkZXIoKSkKCiAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGluIGluZm8uaXRlbXMo
KToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIChsaXN0LCBkaWN0KSk6CiAg
ICAgICAgICAgICAgICAgICAgdmFsdWVfc3RyID0ganNvbi5kdW1wcyh2YWx1ZSwgZGVmYXVsdD1z
dHIsIGluZGVudD0yKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB2
YWx1ZV9zdHIgPSBzdHIodmFsdWUpCgogICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2Vy
LmFwcGVuZCh1cndpZC5UZXh0KGYie2tleX06IHt2YWx1ZV9zdHJ9IikpCiAgICAgICAgICAgICAg
ICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKCiAgICAgICAgZXhj
ZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJEZWJ1ZyBmYWls
ZWQ6IHtlfSIpCgogICAgZGVmIGRlbGV0ZV9rZXkoc2VsZiwga2V5OiBieXRlcyk6CiAgICAgICAg
IiIi0KPQtNCw0LvQtdC90LjQtSDQutC70Y7Rh9CwINGBINC/0L7QtNC00LXRgNC20LrQvtC5INC6
0LvQsNGB0YLQtdGA0LAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb246
CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNsaWVudCA9IHNl
bGYuY3VycmVudF9jb25uZWN0aW9uLmFjdGl2ZV9jbGllbnQKICAgICAgICAgICAgZGVsZXRlZCA9
IGNsaWVudC5kZWxldGUoa2V5KQoKICAgICAgICAgICAgaWYgZGVsZXRlZDoKICAgICAgICAgICAg
ICAgIHNlbGYuc2V0X3N0YXR1cyhmIktleSBkZWxldGVkIiwgJ3N1Y2Nlc3MnKQogICAgICAgICAg
ICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiS2V5IG5vdCBmb3VuZCIs
ICd3YXJuaW5nJykKCiAgICAgICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkKICAgICAgICAgICAg
c2VsZi5kZXRhaWxfd2Fsa2VyWzpdID0gW10KCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBl
OgogICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJEZWxldGUgZmFpbGVkOiB7ZX0iLCAnZXJy
b3InKQogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJEZWxldGUgZmFpbGVkIGZvciBrZXkge2tl
eX06IHtlfSIpCgogICAgZGVmIHVwZGF0ZV90YWJzKHNlbGYpOgogICAgICAgICIiItCe0LHQvdC+
0LLQu9C10L3QuNC1INGC0LDQsdC+0LIiIiIKICAgICAgICB0YWJzID0gW10KCiAgICAgICAgaWYg
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gYW5kIHNlbGYuY3VycmVudF9jb25uZWN0aW9uLmNvbm5l
Y3RlZDoKICAgICAgICAgICAgbmFtZSA9IHNlbGYuY3VycmVudF9jb25uZWN0aW9uLnByb2ZpbGUu
bmFtZQoKICAgICAgICAgICAgaWYgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uaXNfY2x1c3RlcjoK
ICAgICAgICAgICAgICAgICMg0JTQu9GPINC60LvQsNGB0YLQtdGA0LAg0L/QvtC60LDQt9GL0LLQ
sNC10Lwg0YHQv9C10YbQuNCw0LvRjNC90YPRjiDQuNC60L7QvdC60YMKICAgICAgICAgICAgICAg
IHRyeToKICAgICAgICAgICAgICAgICAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0LjQvdGE0L7RgNC8
0LDRhtC40Y4g0L4g0LrQu9Cw0YHRgtC10YDQtQogICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJf
aW5mb19zdHIgPSBjb25uLmFjdGl2ZV9jbGllbnQuZXhlY3V0ZV9jb21tYW5kKCdDTFVTVEVSJywg
J0lORk8nKQogICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJfaW5mbyA9IHNlbGYucGFyc2VfY2x1
c3Rlcl9pbmZvKGNsdXN0ZXJfaW5mb19zdHIpCiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBj
bHVzdGVyX2luZm8uZ2V0KCdjbHVzdGVyX3N0YXRlJywgJ3Vua25vd24nKQogCiAgICAgICAgICAg
ICAgICAgICAgaWYgc3RhdGUgPT0gJ29rJzoKICAgICAgICAgICAgICAgICAgICAgICAgaWNvbiA9
ICfwn5+iJwogICAgICAgICAgICAgICAgICAgICAgICBzdHlsZSA9ICdzdWNjZXNzJwogICAgICAg
ICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGljb24gPSAn8J+UtCcK
ICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSAnZXJyb3InCgogICAgICAgICAgICAgICAg
ICAgIGxhYmVsID0gZiIge2ljb259IHtuYW1lfSBbQ2x1c3Rlcl0gIgogICAgICAgICAgICAgICAg
ICAgIHRhYnMuYXBwZW5kKChzdHlsZSwgbGFiZWwpKQoKICAgICAgICAgICAgICAgIGV4Y2VwdCBF
eGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGYiIOKaoCB7bmFtZX0g
W0NsdXN0ZXJdICIKICAgICAgICAgICAgICAgICAgICB0YWJzLmFwcGVuZCgoJ3dhcm5pbmcnLCBs
YWJlbCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkYiA9IHNlbGYuY3VycmVu
dF9jb25uZWN0aW9uLmN1cnJlbnRfZGIKICAgICAgICAgICAgICAgIGxhYmVsID0gZiIg4pePIHtu
YW1lfSBbREJ7ZGJ9XSAiCiAgICAgICAgICAgICAgICB0YWJzLmFwcGVuZCgoJ3RhYl9hY3RpdmUn
LCBsYWJlbCkpCgogICAgICAgIHNlbGYudGFiX3RleHQuc2V0X3RleHQodGFicyBpZiB0YWJzIGVs
c2UgJycpCgogICAgZGVmIF9maW5kX2xpc3Rib3hfaW5fdWkoc2VsZik6CiAgICAgICAgIiIi0J3Q
sNC50YLQuCBMaXN0Qm94INCyINGB0YLRgNGD0LrRgtGD0YDQtSBVSSIiIgogICAgICAgIHRyeToK
ICAgICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10LwgbWFpbl9mcmFtZQogICAgICAgICAgICBp
ZiBoYXNhdHRyKHNlbGYsICdtYWluX2ZyYW1lJyk6CiAgICAgICAgICAgICAgICBib2R5ID0gc2Vs
Zi5tYWluX2ZyYW1lLmdldF9ib2R5KCkKICAgICAgICAgICAgICAgIGxpc3Rib3ggPSBzZWxmLl9m
aW5kX2xpc3Rib3hfcmVjdXJzaXZlKGJvZHkpCiAgICAgICAgICAgICAgICBpZiBsaXN0Ym94Ogog
ICAgICAgICAgICAgICAgICAgIHJldHVybiBsaXN0Ym94CgogICAgICAgICAgICAjINCf0YDQvtCy
0LXRgNGP0LXQvCBjb2x1bW5zICjQtNCy0YPRhdC/0LDQvdC10LvRjNC90YvQuSDQuNC90YLQtdGA
0YTQtdC50YEpCiAgICAgICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgJ2NvbHVtbnMnKToKICAgICAg
ICAgICAgICAgIGZvciB3aWRnZXQsIG9wdGlvbnMgaW4gc2VsZi5jb2x1bW5zLmNvbnRlbnRzOgog
ICAgICAgICAgICAgICAgICAgIGxpc3Rib3ggPSBzZWxmLl9maW5kX2xpc3Rib3hfcmVjdXJzaXZl
KHdpZGdldCkKICAgICAgICAgICAgICAgICAgICBpZiBsaXN0Ym94OgogICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gbGlzdGJveAoKICAgICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwg
Y29udGVudF9mcmFtZSAo0LXRgdC70Lgg0LXRgdGC0YwpCiAgICAgICAgICAgIGlmIGhhc2F0dHIo
c2VsZiwgJ2NvbnRlbnRfZnJhbWUnKToKICAgICAgICAgICAgICAgIGJvZHkgPSBzZWxmLmNvbnRl
bnRfZnJhbWUuZ2V0X2JvZHkoKQogICAgICAgICAgICAgICAgbGlzdGJveCA9IHNlbGYuX2ZpbmRf
bGlzdGJveF9yZWN1cnNpdmUoYm9keSkKICAgICAgICAgICAgICAgIGlmIGxpc3Rib3g6CiAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIGxpc3Rib3gKCiAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA
0Y/QtdC8IGtleV92aWV3ICjQtdGB0LvQuCDQtdGB0YLRjCkKICAgICAgICAgICAgaWYgaGFzYXR0
cihzZWxmLCAna2V5X3ZpZXcnKToKICAgICAgICAgICAgICAgIGxpc3Rib3ggPSBzZWxmLl9maW5k
X2xpc3Rib3hfcmVjdXJzaXZlKHNlbGYua2V5X3ZpZXcpCiAgICAgICAgICAgICAgICBpZiBsaXN0
Ym94OgogICAgICAgICAgICAgICAgICAgIHJldHVybiBsaXN0Ym94CgogICAgICAgICAgICByZXR1
cm4gTm9uZQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dl
ci5lcnJvcihmIkVycm9yIGZpbmRpbmcgbGlzdGJveDoge2V9IikKICAgICAgICAgICAgcmV0dXJu
IE5vbmUKCiAgICBkZWYgX2ZpbmRfbGlzdGJveF9yZWN1cnNpdmUoc2VsZiwgd2lkZ2V0LCBkZXB0
aD0wKToKICAgICAgICAiIiLQoNC10LrRg9GA0YHQuNCy0L3Ri9C5INC/0L7QuNGB0LogTGlzdEJv
eCIiIgogICAgICAgIGlmIGRlcHRoID4gMTA6CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAg
ICAgIGlmIHdpZGdldCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgICAgICAj
INCd0LDRiNC70LggTGlzdEJveAogICAgICAgIGlmIGlzaW5zdGFuY2Uod2lkZ2V0LCB1cndpZC5M
aXN0Qm94KToKICAgICAgICAgICAgcmV0dXJuIHdpZGdldAoKICAgICAgICAjINCg0LDQt9Cy0L7R
gNCw0YfQuNCy0LDQtdC8INC+0LHQtdGA0YLQutC4CiAgICAgICAgaWYgaGFzYXR0cih3aWRnZXQs
ICdvcmlnaW5hbF93aWRnZXQnKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2ZpbmRfbGlzdGJv
eF9yZWN1cnNpdmUod2lkZ2V0Lm9yaWdpbmFsX3dpZGdldCwgZGVwdGggKyAxKQoKICAgICAgICBp
ZiBoYXNhdHRyKHdpZGdldCwgJ2Jhc2Vfd2lkZ2V0Jyk6CiAgICAgICAgICAgIHJldHVybiBzZWxm
Ll9maW5kX2xpc3Rib3hfcmVjdXJzaXZlKHdpZGdldC5iYXNlX3dpZGdldCwgZGVwdGggKyAxKQoK
ICAgICAgICAjIEZyYW1lIC0g0L/RgNC+0LLQtdGA0Y/QtdC8IGJvZHkKICAgICAgICBpZiBpc2lu
c3RhbmNlKHdpZGdldCwgdXJ3aWQuRnJhbWUpOgogICAgICAgICAgICBib2R5ID0gd2lkZ2V0Lmdl
dF9ib2R5KCkKICAgICAgICAgICAgaWYgYm9keToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNl
bGYuX2ZpbmRfbGlzdGJveF9yZWN1cnNpdmUoYm9keSwgZGVwdGggKyAxKQogICAgICAgICAgICAg
ICAgaWYgcmVzdWx0OgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAg
IyBDb2x1bW5zL1BpbGUgLSDQv9GA0L7QstC10YDRj9C10LwgY29udGVudHMKICAgICAgICBpZiBo
YXNhdHRyKHdpZGdldCwgJ2NvbnRlbnRzJyk6CiAgICAgICAgICAgIGZvciBpdGVtIGluIHdpZGdl
dC5jb250ZW50czoKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaXRlbSwgdHVwbGUpIGFu
ZCBsZW4oaXRlbSkgPiAwOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuX2ZpbmRf
bGlzdGJveF9yZWN1cnNpdmUoaXRlbVswXSwgZGVwdGggKyAxKQogICAgICAgICAgICAgICAgICAg
IGlmIHJlc3VsdDoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgICAg
ICByZXR1cm4gTm9uZQoKICAgIGRlZiBzaG93X2VkaXRfa2V5X2RpYWxvZyhzZWxmLCBrZXkpOgog
ICAgICAgICIiItCf0L7QutCw0LfQsNGC0Ywg0LTQuNCw0LvQvtCzINGA0LXQtNCw0LrRgtC40YDQ
vtCy0LDQvdC40Y8g0LrQu9GO0YfQsCIiIgoKICAgICAgICBkZWYgb25fc3VjY2VzcygpOgogICAg
ICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCgogICAgICAgIGRpYWxvZyA9IEFkZEtleURpYWxv
ZygKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24sCiAgICAgICAgICAgIG9uX3N1
Y2Nlc3MsCiAgICAgICAgICAgIGVkaXRfa2V5PWtleSAgIyDQn9C10YDQtdC00LDQtdC8INC60LvR
jtGHINC00LvRjyDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPCiAgICAgICAgKQoKICAgICAg
ICB1cndpZC5jb25uZWN0X3NpZ25hbChkaWFsb2csICdjbG9zZScsIGxhbWJkYSB3OiBzZWxmLmNs
b3NlX2RpYWxvZyhOb25lKSkKCiAgICAgICAgb3ZlcmxheSA9IHVyd2lkLk92ZXJsYXkoCiAgICAg
ICAgICAgIGRpYWxvZywKICAgICAgICAgICAgc2VsZi5tYWluX2ZyYW1lLAogICAgICAgICAgICBh
bGlnbj0nY2VudGVyJywKICAgICAgICAgICAgd2lkdGg9KCdyZWxhdGl2ZScsIDgwKSwKICAgICAg
ICAgICAgdmFsaWduPSdtaWRkbGUnLAogICAgICAgICAgICBoZWlnaHQ9KCdyZWxhdGl2ZScsIDgw
KQogICAgICAgICkKCiAgICAgICAgc2VsZi5kaWFsb2cgPSBvdmVybGF5CiAgICAgICAgc2VsZi5s
b29wLndpZGdldCA9IG92ZXJsYXkKCiAgICBkZWYgc2hvd19hZGRfa2V5X2RpYWxvZyhzZWxmKToK
ICAgICAgICAiIiLQlNC40LDQu9C+0LMg0LTQvtCx0LDQstC70LXQvdC40Y8g0LrQu9GO0YfQsCIi
IgogICAgICAgIGlmIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBub3Qgc2VsZi5jdXJy
ZW50X2Nvbm5lY3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoIk5v
dCBjb25uZWN0ZWQiLCAnZXJyb3InKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgZGlhbG9n
ID0gQWRkS2V5RGlhbG9nKHNlbGYuY3VycmVudF9jb25uZWN0aW9uLCBzZWxmLm9uX2tleV9hZGRl
ZCkKICAgICAgICB1cndpZC5jb25uZWN0X3NpZ25hbChkaWFsb2csICdjbG9zZScsIHNlbGYuY2xv
c2VfZGlhbG9nKQoKICAgICAgICBvdmVybGF5ID0gdXJ3aWQuT3ZlcmxheSgKICAgICAgICAgICAg
ZGlhbG9nLAogICAgICAgICAgICBzZWxmLm1haW5fZnJhbWUsCiAgICAgICAgICAgIGFsaWduPSdj
ZW50ZXInLAogICAgICAgICAgICB3aWR0aD0oJ3JlbGF0aXZlJywgNjApLAogICAgICAgICAgICB2
YWxpZ249J21pZGRsZScsCiAgICAgICAgICAgIGhlaWdodD0oJ3JlbGF0aXZlJywgNzApCiAgICAg
ICAgKQoKICAgICAgICBzZWxmLmxvb3Aud2lkZ2V0ID0gb3ZlcmxheQoKICAgIGRlZiBzaG93X21h
cmtfcGF0dGVybl9kaWFsb2coc2VsZik6CiAgICAgICAgIiIi0JTQuNCw0LvQvtCzINC+0YLQvNC1
0YLQutC4INC60LvRjtGH0LXQuSDQv9C+INGI0LDQsdC70L7QvdGDIiIiCiAgICAgICAgZWRpdCA9
IHVyd2lkLkVkaXQoJ1BhdHRlcm4gKCogYW5kID8gd2lsZGNhcmRzKTogJykKCiAgICAgICAgZGVm
IG9uX21hcmsoYnV0dG9uKToKICAgICAgICAgICAgcGF0dGVybiA9IGVkaXQuZ2V0X2VkaXRfdGV4
dCgpLnN0cmlwKCkKICAgICAgICAgICAgaWYgcGF0dGVybjoKICAgICAgICAgICAgICAgIHNlbGYu
a2V5X2xpc3Rfdmlldy5tYXJrX2J5X3BhdHRlcm4ocGF0dGVybikKICAgICAgICAgICAgICAgIG1h
cmtlZF9jb3VudCA9IGxlbihzZWxmLmtleV9saXN0X3ZpZXcuZ2V0X21hcmtlZF9rZXlzKCkpCiAg
ICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJNYXJrZWQge21hcmtlZF9jb3VudH0ga2V5
cyBieSBwYXR0ZXJuOiB7cGF0dGVybn0iLCAnc3VjY2VzcycpCiAgICAgICAgICAgIHNlbGYuY2xv
c2VfZGlhbG9nKE5vbmUpCgogICAgICAgIGRlZiBvbl9jYW5jZWwoYnV0dG9uKToKICAgICAgICAg
ICAgc2VsZi5jbG9zZV9kaWFsb2coTm9uZSkKCiAgICAgICAgbWFya19idG4gPSB1cndpZC5CdXR0
b24oJ01hcmsnLCBvbl9wcmVzcz1vbl9tYXJrKQogICAgICAgIGNhbmNlbF9idG4gPSB1cndpZC5C
dXR0b24oJ0NhbmNlbCcsIG9uX3ByZXNzPW9uX2NhbmNlbCkKCiAgICAgICAgcGlsZSA9IHVyd2lk
LlBpbGUoWwogICAgICAgICAgICB1cndpZC5UZXh0KCdFbnRlciBwYXR0ZXJuIHRvIG1hcmsga2V5
czonKSwKICAgICAgICAgICAgdXJ3aWQuVGV4dCgnRXhhbXBsZXM6IHVzZXI6Kiwgc2Vzc2lvbjo/
MTIzLCAqdGVtcConKSwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAogICAgICAgICAgICBl
ZGl0LAogICAgICAgICAgICB1cndpZC5EaXZpZGVyKCksCiAgICAgICAgICAgIHVyd2lkLkNvbHVt
bnMoWwogICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChtYXJrX2J0biwgJ2J1dHRvbicsICdi
dXR0b25fZm9jdXMnKSwKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoY2FuY2VsX2J0biwg
J2J1dHRvbicsICdidXR0b25fZm9jdXMnKSwKICAgICAgICAgICAgXSksCiAgICAgICAgXSkKCiAg
ICAgICAgZGlhbG9nID0gdXJ3aWQuTGluZUJveCh1cndpZC5GaWxsZXIocGlsZSksIHRpdGxlPSdN
YXJrIEtleXMgYnkgUGF0dGVybicpCgogICAgICAgIG92ZXJsYXkgPSB1cndpZC5PdmVybGF5KAog
ICAgICAgICAgICB1cndpZC5BdHRyTWFwKGRpYWxvZywgJ2RpYWxvZycpLAogICAgICAgICAgICBz
ZWxmLm1haW5fZnJhbWUsCiAgICAgICAgICAgIGFsaWduPSdjZW50ZXInLAogICAgICAgICAgICB3
aWR0aD0oJ3JlbGF0aXZlJywgNTApLAogICAgICAgICAgICB2YWxpZ249J21pZGRsZScsCiAgICAg
ICAgICAgIGhlaWdodD0oJ3JlbGF0aXZlJywgMzApCiAgICAgICAgKQoKICAgICAgICBzZWxmLmxv
b3Aud2lkZ2V0ID0gb3ZlcmxheQoKICAgIGRlZiBzaG93X2ZpbHRlcl9kaWFsb2coc2VsZik6CiAg
ICAgICAgIiIi0JTQuNCw0LvQvtCzINGE0LjQu9GM0YLRgNCw0YbQuNC4INC60LvRjtGH0LXQuSIi
IgogICAgICAgIGVkaXQgPSB1cndpZC5FZGl0KCdGaWx0ZXIgcGF0dGVybiAoKiBmb3Igd2lsZGNh
cmQpOiAnKQoKICAgICAgICBkZWYgb25fYXBwbHkoYnV0dG9uKToKICAgICAgICAgICAgcGF0dGVy
biA9IGVkaXQuZ2V0X2VkaXRfdGV4dCgpLnN0cmlwKCkKICAgICAgICAgICAgaWYgcGF0dGVybjoK
ICAgICAgICAgICAgICAgIHNlbGYua2V5X2xpc3Rfdmlldy5hcHBseV9maWx0ZXIocGF0dGVybikK
ICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIkZpbHRlciBhcHBsaWVkOiB7cGF0dGVy
bn0iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3
LmFwcGx5X2ZpbHRlcihOb25lKQogICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKCJGaWx0
ZXIgY2xlYXJlZCIpCiAgICAgICAgICAgIHNlbGYuY2xvc2VfZGlhbG9nKE5vbmUpCgogICAgICAg
IGRlZiBvbl9jbGVhcihidXR0b24pOgogICAgICAgICAgICBzZWxmLmtleV9saXN0X3ZpZXcuYXBw
bHlfZmlsdGVyKE5vbmUpCiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cygiRmlsdGVyIGNsZWFy
ZWQiKQogICAgICAgICAgICBzZWxmLmNsb3NlX2RpYWxvZyhOb25lKQoKICAgICAgICBhcHBseV9i
dG4gPSB1cndpZC5CdXR0b24oJ0FwcGx5Jywgb25fcHJlc3M9b25fYXBwbHkpCiAgICAgICAgY2xl
YXJfYnRuID0gdXJ3aWQuQnV0dG9uKCdDbGVhcicsIG9uX3ByZXNzPW9uX2NsZWFyKQogICAgICAg
IGNhbmNlbF9idG4gPSB1cndpZC5CdXR0b24oJ0NhbmNlbCcsIG9uX3ByZXNzPXNlbGYuY2xvc2Vf
ZGlhbG9nKE5vbmUpKQoKICAgICAgICBwaWxlID0gdXJ3aWQuUGlsZShbCiAgICAgICAgICAgIGVk
aXQsCiAgICAgICAgICAgIHVyd2lkLkRpdmlkZXIoKSwKICAgICAgICAgICAgdXJ3aWQuQ29sdW1u
cyhbCiAgICAgICAgICAgICAgICB1cndpZC5BdHRyTWFwKGFwcGx5X2J0biwgJ2J1dHRvbicsICdi
dXR0b25fZm9jdXMnKSwKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoY2xlYXJfYnRuLCAn
YnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChj
YW5jZWxfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICBdKSwKICAg
ICAgICBdKQoKICAgICAgICBkaWFsb2cgPSB1cndpZC5MaW5lQm94KHVyd2lkLkZpbGxlcihwaWxl
KSwgdGl0bGU9J0ZpbHRlciBLZXlzJykKCiAgICAgICAgb3ZlcmxheSA9IHVyd2lkLk92ZXJsYXko
CiAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoZGlhbG9nLCAnZGlhbG9nJyksCiAgICAgICAgICAg
IHNlbGYubWFpbl9mcmFtZSwKICAgICAgICAgICAgYWxpZ249J2NlbnRlcicsCiAgICAgICAgICAg
IHdpZHRoPSgncmVsYXRpdmUnLCA1MCksCiAgICAgICAgICAgIHZhbGlnbj0nbWlkZGxlJywKICAg
ICAgICAgICAgaGVpZ2h0PSgncmVsYXRpdmUnLCAyMCkKICAgICAgICApCgogICAgICAgIHNlbGYu
bG9vcC53aWRnZXQgPSBvdmVybGF5CgogICAgZGVmIGRlbGV0ZV9tYXJrZWRfa2V5cyhzZWxmKToK
ICAgICAgICAiIiLQo9C00LDQu9C40YLRjCDQvtGC0LzQtdGH0LXQvdC90YvQtSDQutC70Y7Rh9C4
IiIiCiAgICAgICAgbWFya2VkID0gc2VsZi5rZXlfbGlzdF92aWV3LmdldF9tYXJrZWRfa2V5cygp
CgogICAgICAgIGlmIG5vdCBtYXJrZWQ6CiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cygiTm8g
a2V5cyBtYXJrZWQiLCAnd2FybmluZycpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjINCf
0L7QtNGC0LLQtdGA0LbQtNC10L3QuNC1CiAgICAgICAgZGVmIG9uX2NvbmZpcm0oYnV0dG9uKToK
ICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgY2xpZW50ID0gc2VsZi5jdXJyZW50X2Nv
bm5lY3Rpb24uYWN0aXZlX2NsaWVudAogICAgICAgICAgICAgICAgZGVsZXRlZCA9IDAKICAgICAg
ICAgICAgICAgIGZvciBrZXkgaW4gbWFya2VkOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgY2xpZW50LmRlbGV0ZShrZXkpOgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZGVsZXRlZCArPSAxCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0Ogog
ICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgc2VsZi5zZXRfc3Rh
dHVzKGYiRGVsZXRlZCB7ZGVsZXRlZH0ve2xlbihtYXJrZWQpfSBrZXlzIiwgJ3N1Y2Nlc3MnKQog
ICAgICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3LnVubWFya19hbGwoKQogICAgICAgICAg
ICAgICAgc2VsZi5yZWZyZXNoX2tleXMoKQogICAgICAgICAgICAgICAgc2VsZi5jbG9zZV9kaWFs
b2coTm9uZSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAg
ICAgc2VsZi5zZXRfc3RhdHVzKGYiRGVsZXRlIGZhaWxlZDoge2V9IiwgJ2Vycm9yJykKCiAgICAg
ICAgdGV4dCA9IHVyd2lkLlRleHQoZiJEZWxldGUge2xlbihtYXJrZWQpfSBtYXJrZWQga2V5cz8i
KQogICAgICAgIHllc19idG4gPSB1cndpZC5CdXR0b24oJ1llcycsIG9uX3ByZXNzPW9uX2NvbmZp
cm0pCiAgICAgICAgbm9fYnRuID0gdXJ3aWQuQnV0dG9uKCdObycsIG9uX3ByZXNzPXNlbGYuY2xv
c2VfZGlhbG9nKE5vbmUpKQoKICAgICAgICBwaWxlID0gdXJ3aWQuUGlsZShbCiAgICAgICAgICAg
IHRleHQsCiAgICAgICAgICAgIHVyd2lkLkRpdmlkZXIoKSwKICAgICAgICAgICAgdXJ3aWQuQ29s
dW1ucyhbCiAgICAgICAgICAgICAgICB1cndpZC5BdHRyTWFwKHllc19idG4sICdidXR0b25fZGFu
Z2VyJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChub19i
dG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJyksCiAgICAgICAgICAgIF0pLAogICAgICAgIF0p
CgogICAgICAgIGRpYWxvZyA9IHVyd2lkLkxpbmVCb3godXJ3aWQuRmlsbGVyKHBpbGUpLCB0aXRs
ZT0nQ29uZmlybSBEZWxldGUnKQoKICAgICAgICBvdmVybGF5ID0gdXJ3aWQuT3ZlcmxheSgKICAg
ICAgICAgICAgdXJ3aWQuQXR0ck1hcChkaWFsb2csICdkaWFsb2cnKSwKICAgICAgICAgICAgc2Vs
Zi5tYWluX2ZyYW1lLAogICAgICAgICAgICBhbGlnbj0nY2VudGVyJywKICAgICAgICAgICAgd2lk
dGg9KCdyZWxhdGl2ZScsIDQwKSwKICAgICAgICAgICAgdmFsaWduPSdtaWRkbGUnLAogICAgICAg
ICAgICBoZWlnaHQ9KCdyZWxhdGl2ZScsIDIwKQogICAgICAgICkKCiAgICAgICAgc2VsZi5sb29w
LndpZGdldCA9IG92ZXJsYXkKCiAgICBkZWYgb25fa2V5X2FkZGVkKHNlbGYpOgogICAgICAgICIi
ItCa0LvRjtGHINC00L7QsdCw0LLQu9C10L0iIiIKICAgICAgICBzZWxmLnNldF9zdGF0dXMoIktl
eSBhZGRlZCBzdWNjZXNzZnVsbHkiLCAnc3VjY2VzcycpCiAgICAgICAgc2VsZi5yZWZyZXNoX2tl
eXMoKQoKICAgIGRlZiBjbG9zZV9kaWFsb2coc2VsZiwgYnV0dG9uKToKICAgICAgICAiIiLQl9Cw
0LrRgNGL0YLRjCDQtNC40LDQu9C+0LMg0Lgg0LLQtdGA0L3Rg9GC0YzRgdGPINC6INC+0YHQvdC+
0LLQvdC+0LzRgyDRjdC60YDQsNC90YMKCiAgICAgICAgQXJnczoKICAgICAgICAgICAgYnV0dG9u
OiDQutC90L7Qv9C60LAg0LjQu9C4IE5vbmUgKHVyd2lkINC/0LXRgNC10LTQsNC10YIgYnV0dG9u
INC/0YDQuCBjYWxsYmFjaykKICAgICAgICAiIiIKICAgICAgICBzZWxmLmxvb3Aud2lkZ2V0ID0g
c2VsZi5tYWluX2ZyYW1lCgogICAgZGVmIHNldF9zdGF0dXMoc2VsZiwgbWVzc2FnZTogc3RyLCBz
dHlsZTogc3RyID0gJ2Zvb3RlcicpOgogICAgICAgICIiItCj0YHRgtCw0L3QvtCy0LrQsCDRgdGC
0LDRgtGD0YHQsCIiIgogICAgICAgIHNlbGYuc3RhdHVzX3RleHQuc2V0X3RleHQoKHN0eWxlLCBm
IiB7bWVzc2FnZX0iKSkKCiAgICBkZWYgZWRpdF9rZXlfd3JhcHBlcihzZWxmKToKICAgICAgICBp
ZiBub3Qgc2VsZi5jb25zb2xlX21vZGU6CiAgICAgICAgICAgIHNlbGVjdGVkX2tleSA9IHNlbGYu
Z2V0X3NlbGVjdGVkX2tleSgpCiAgICAgICAgICAgIGlmIHNlbGVjdGVkX2tleToKICAgICAgICAg
ICAgICAgICMg0JTQtdC60L7QtNC40YDRg9C10Lwg0LXRgdC70LggYnl0ZXMKICAgICAgICAgICAg
ICAgIGlmIGlzaW5zdGFuY2Uoc2VsZWN0ZWRfa2V5LCBieXRlcyk6CiAgICAgICAgICAgICAgICAg
ICAgc2VsZWN0ZWRfa2V5ID0gc2VsZWN0ZWRfa2V5LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3Jl
cGxhY2UnKQogICAgICAgICAgICAgICAgc2VsZi5zaG93X2VkaXRfa2V5X2RpYWxvZyhzZWxlY3Rl
ZF9rZXkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMo
Ik5vIGtleSBzZWxlY3RlZCIpCgogICAgZGVmIGhhbmRsZV9pbnB1dChzZWxmLCBrZXkpOgogICAg
ICAgICIiItCe0LHRgNCw0LHQvtGC0LrQsCDQutC70LDQstC40YgiIiIKICAgICAgICAjIOKchSBU
YWIgLSDQv9C10YDQtdC60LvRjtGH0LXQvdC40LUg0LzQtdC20LTRgyDQv9Cw0L3QtdC70Y/QvNC4
CiAgICAgICAgaWYga2V5ID09ICd0YWInOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAg
ICAjINCf0L7Qu9GD0YfQsNC10Lwg0YLQtdC60YPRidGD0Y4gY29udGVudF9hcmVhICjRjdGC0L4g
Q29sdW1ucykKICAgICAgICAgICAgICAgIGNvbnRlbnRfd2lkZ2V0ID0gc2VsZi5tYWluX2NvbnRl
bnQuY29udGVudHNbMV1bMF0ub3JpZ2luYWxfd2lkZ2V0CgogICAgICAgICAgICAgICAgaWYgaXNp
bnN0YW5jZShjb250ZW50X3dpZGdldCwgdXJ3aWQuQ29sdW1ucyk6CiAgICAgICAgICAgICAgICAg
ICAgY3VycmVudF9mb2N1cyA9IGNvbnRlbnRfd2lkZ2V0LmZvY3VzX3Bvc2l0aW9uCiAgICAgICAg
ICAgICAgICAgICAgbnVtX2NvbHVtbnMgPSBsZW4oY29udGVudF93aWRnZXQuY29udGVudHMpCgog
ICAgICAgICAgICAgICAgICAgICMg0J/QtdGA0LXQutC70Y7Rh9Cw0LXQvCDQvdCwINGB0LvQtdC0
0YPRjtGJ0YPRjiDQutC+0LvQvtC90LrRgyDQv9C+INC60YDRg9Cz0YMKICAgICAgICAgICAgICAg
ICAgICBuZXh0X2ZvY3VzID0gKGN1cnJlbnRfZm9jdXMgKyAxKSAlIG51bV9jb2x1bW5zCiAgICAg
ICAgICAgICAgICAgICAgY29udGVudF93aWRnZXQuZm9jdXNfcG9zaXRpb24gPSBuZXh0X2ZvY3Vz
CgogICAgICAgICAgICAgICAgICAgICMg0J7QsdC90L7QstC70Y/QtdC8INGB0YLQsNGC0YPRgQog
ICAgICAgICAgICAgICAgICAgIHBhbmVsX25hbWVzID0gWydDb25uZWN0aW9ucyAmIEtleXMnLCAn
RGV0YWlscycsICdDb25zb2xlJ10KICAgICAgICAgICAgICAgICAgICBpZiBuZXh0X2ZvY3VzIDwg
bGVuKHBhbmVsX25hbWVzKToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVz
KGYiRm9jdXM6IHtwYW5lbF9uYW1lc1tuZXh0X2ZvY3VzXX0iKQoKICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gc3dpdGNoIHBhbmVsOiB7ZX0iKQoKICAg
ICAgICBpZiBrZXkgPT0gJ2YxMCc6CiAgICAgICAgICAgIHJhaXNlIHVyd2lkLkV4aXRNYWluTG9v
cCgpCiAgICAgICAgZWxpZiBrZXkgaW4gKCdxJywgJ1EnKToKICAgICAgICAgICAgaWYgbm90IHNl
bGYuY29uc29sZV9tb2RlOgogICAgICAgICAgICAgICAgcmFpc2UgdXJ3aWQuRXhpdE1haW5Mb29w
KCkKICAgICAgICBlbGlmIGtleSA9PSAnZjExJzoKICAgICAgICAgICAgaWYgbm90IHNlbGYuY29u
c29sZV9tb2RlOgogICAgICAgICAgICAgICAgc2VsZi5yZWZyZXNoX2tleXMoKQogICAgICAgIGVs
aWYga2V5ID09ICdmMScgb3Iga2V5ID09ICc/JzoKICAgICAgICAgICAgc2VsZi5zaG93X2hlbHAo
KQogICAgICAgIGVsaWYga2V5ID09ICdmMic6CiAgICAgICAgICAgIHNlbGYudG9nZ2xlX2NvbnNv
bGUoKQogICAgICAgIGVsaWYga2V5ID09ICdlc2MnOgogICAgICAgICAgICBpZiBzZWxmLmNvbnNv
bGVfbW9kZToKICAgICAgICAgICAgICAgIHNlbGYudG9nZ2xlX2NvbnNvbGUoKQogICAgICAgIGVs
aWYga2V5ID09ICdmMyc6CiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmNvbnNvbGVfbW9kZToKICAg
ICAgICAgICAgICAgIHNlbGYuc2hvd19hZGRfa2V5X2RpYWxvZygpCiAgICAgICAgZWxpZiBrZXkg
PT0gJ2Y5JzoKICAgICAgICAgICAgaWYgbm90IHNlbGYuY29uc29sZV9tb2RlOgogICAgICAgICAg
ICAgICAgc2VsZi5kaXNjb25uZWN0KCkKICAgICAgICBlbGlmIGtleSA9PSAnZjQnOgogICAgICAg
ICAgICBzZWxmLmVkaXRfa2V5X3dyYXBwZXIoKQogICAgICAgIGVsaWYga2V5ID09ICdmMTInOgog
ICAgICAgICAgICBpZiBub3Qgc2VsZi5jb25zb2xlX21vZGU6CiAgICAgICAgICAgICAgICBzZWxm
LmRlYnVnX2NsdXN0ZXJfaW5mbygpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2VudGVyJzoKICAgICAg
ICAgICAgaWYgc2VsZi5jb25zb2xlX21vZGU6CiAgICAgICAgICAgICAgICAjINCf0YDQvtCy0LXR
gNGP0LXQvCwg0L3QsNGF0L7QtNC40LzRgdGPINC70Lgg0LzRiyDQsiDQv9GA0L7QvNC/0YLQtQog
ICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYubWFpbl9jb250
ZW50LmZvY3VzX3Bvc2l0aW9uID09IDI6ICAjINCa0L7QvdGB0L7Qu9GM0L3QsNGPINC/0LDQvdC1
0LvRjAogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlX3BpbGUgPSBzZWxmLmNvbnNvbGVf
cGFuZWwub3JpZ2luYWxfd2lkZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNvbnNvbGVf
cGlsZS5mb2N1c19wb3NpdGlvbiA9PSAyOiAgIyDQn9GA0L7QvNC/0YIKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHNlbGYuZXhlY3V0ZV9jb25zb2xlX2NvbW1hbmQoKQogICAgICAgICAgICAg
ICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgaWYga2V5ID09ICcg
JzogICMg0J/RgNC+0LHQtdC7IC0g0L7RgtC80LXRgtC40YLRjC/RgdC90Y/RgtGMINC+0YLQvNC1
0YLQutGDCiAgICAgICAgICAgIHNlbGYua2V5X2xpc3Rfdmlldy50b2dnbGVfbWFya19mb2N1c2Vk
KCkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGVsaWYga2V5ID09ICdjdHJsIGEnOiAgIyBD
dHJsK0EgLSDQvtGC0LzQtdGC0LjRgtGMINCy0YHQtQogICAgICAgICAgICBwYXR0ZXJuID0gc2Vs
Zi5zaG93X21hcmtfcGF0dGVybl9kaWFsb2coKQogICAgICAgICAgICBpZiBwYXR0ZXJuOgogICAg
ICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3Lm1hcmtfYnlfcGF0dGVybihwYXR0ZXJuKQog
ICAgICAgICAgICByZXR1cm4KCiAgICAgICAgZWxpZiBrZXkgPT0gJ2N0cmwgdSc6ICAjIEN0cmwr
VSAtINGB0L3Rj9GC0Ywg0LLRgdC1INC+0YLQvNC10YLQutC4CiAgICAgICAgICAgIHNlbGYua2V5
X2xpc3Rfdmlldy51bm1hcmtfYWxsKCkKICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKCJBbGwg
bWFya3MgY2xlYXJlZCIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBlbGlmIGtleSA9PSAn
Lyc6ICAjINCk0LjQu9GM0YLRgAogICAgICAgICAgICBzZWxmLnNob3dfZmlsdGVyX2RpYWxvZygp
CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBlbGlmIGtleSA9PSAnZjgnOiAgIyDQnNCw0YHR
gdC+0LLQvtC1INGD0LTQsNC70LXQvdC40LUg0L7RgtC80LXRh9C10L3QvdGL0YUKICAgICAgICAg
ICAgc2VsZi5kZWxldGVfbWFya2VkX2tleXMoKQogICAgICAgICAgICByZXR1cm4KCiAgICBkZWYg
c2hvd19oZWxwKHNlbGYpOgogICAgICAgICIiItCh0L/RgNCw0LLQutCwIiIiCiAgICAgICAgaGVs
cF90ZXh0ID0gIiIiClJlZGlzIENvbW1hbmRlciBUVUkgLSBIZWxwCgpIb3RrZXlzOgogIHEsIFEg
ICAgICAgLSBRdWl0ICh3aGVuIG5vdCBpbiBjb25zb2xlIG1vZGUpCiAgPywgRjEgICAgICAtIFRo
aXMgaGVscAogIEYyICAgICAgICAgLSBUb2dnbGUgY29uc29sZSBtb2RlCiAgRjMgICAgICAgICAt
IE5ldyBrZXkKICBGNCAgICAgICAgIC0gRWRpdCBrZXkKICBGOCAgICAgICAgIC0gRGVsZXRlIE1h
cmtlZCBrZXkKICBGOSAgICAgICAgIC0gRGlzY29ubmVjdAogIEYxMCAgICAgICAgLSBRdWl0CiAg
RjExICAgICAgICAtIFJlZnJlc2gga2V5cwoKICAvICAgICAgICAgIC0gS2V5IEZpbHRlcgogIEN0
cmwrYSAgICAgLSBtYXJrIGtleXMKICBDdHJsK3UgICAgIC0gdW5tYXJrIGtleXMgCiAgRW50ZXIg
ICAgICAtIFZpZXcga2V5CiAgICAgICAgICAgICAKCkNvbnNvbGUgTW9kZToKICBUeXBlIFJlZGlz
IGNvbW1hbmRzIGFuZCBwcmVzcyBFbnRlcgogIEV4YW1wbGVzOiBHRVQga2V5LCBTRVQga2V5IHZh
bHVlLCBLRVlTICoKCiAgUGFnZSB1cCAgIC0gcHJldiBjb21tYW5kIGZyb20gaGlzdG9yeQogIFBh
Z2UgZG93biAtIG5leHQgY29tbWFuZCBmcm9tIGhpc3RvcnkKIiIiCiAgICAgICAgc2VsZi5kZXRh
aWxfd2Fsa2VyWzpdID0gW10KICAgICAgICBmb3IgbGluZSBpbiBoZWxwX3RleHQuc3BsaXQoJ1xu
Jyk6CiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dChsaW5l
KSkKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgICIiItCX0LDQv9GD0YHQuiIiIgogICAgICAg
IHNlbGYubG9vcC5ydW4oKQoKCmRlZiBtYWluKCk6CiAgICAiIiLQotC+0YfQutCwINCy0YXQvtC0
0LAiIiIKICAgIHBhcnNlciA9IGFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKGRlc2NyaXB0aW9uPWYn
UkVESVMgQ29tbWFuZGVyIC0gVFVJIE1hbmFnZXIgZm9yIFJFRElTIDsgVmVyc2lvbiB7X19WRVJT
SU9OX199JykKCiAgICAjINCg0LXQttC40LwgMTog0J7QsdGL0YfQvdGL0Lkg0YTQsNC50LsgKNC/
0L4g0YPQvNC+0LvRh9Cw0L3QuNGOKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgnLWMnLCAnLS1j
b25maWcnLCBkZWZhdWx0PSdyZWRpc19wcm9maWxlcy5qc29uJywgaGVscD0nUGF0aCB0byBwbGFp
bnRleHQgY29uZmlnIGZpbGUgKGRlZmF1bHQ6IHJlZGlzX3Byb2ZpbGVzLmpzb24pJykKICAgICMg
0KDQtdC20LjQvCAyOiDQl9Cw0YjQuNGE0YDQvtCy0LDQvdC90YvQuSDRhNCw0LnQuwogICAgcGFy
c2VyLmFkZF9hcmd1bWVudCgnLWUnLCAnLS1lbmNyeXB0ZWQtY29uZmlnJywgIGhlbHA9J1BhdGgg
dG8gZW5jcnlwdGVkIGNvbmZpZyBmaWxlIChNb2RlIDIpLiBSZXF1aXJlcyBwYXNzd29yZC4nKQog
ICAgIyDQoNC10LbQuNC8IDM6IFZhdWx0CiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctLXZhdWx0
LXVybCcsIGhlbHA9J1ZhdWx0IFVSTCAoZS5nLiBodHRwOi8vMTI3LjAuMC4xOjgyMDApLiBBY3Rp
dmF0ZXMgTW9kZSAzLicpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctLXZhdWx0LXBhdGgnLCBo
ZWxwPSdQYXRoIHRvIHNlY3JldCBpbiBWYXVsdCAoZS5nLiBzZWNyZXQvZGF0YS9yZWRpcy1jb21t
YW5kZXIpJykKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy0tdmF1bHQtdXNlcicsIGhlbHA9J1Zh
dWx0IHVzZXJuYW1lICh3aWxsIHByb21wdCBpZiBtaXNzaW5nKScpCiAgICBwYXJzZXIuYWRkX2Fy
Z3VtZW50KCctLXZhdWx0LXBhc3MnLCBoZWxwPSdWYXVsdCBwYXNzd29yZCAod2lsbCBwcm9tcHQg
aWYgbWlzc2luZyAtIElOU0VDVVJFIGluIGhpc3RvcnkpJykKCiAgICBhcmdzID0gcGFyc2VyLnBh
cnNlX2FyZ3MoKQogICAgcHJpbnQoZidSRURJUyBDb21tYW5kZXIgLSBUVUkgTWFuYWdlciBmb3Ig
UkVESVMgOyBWZXJzaW9uIHtfX1ZFUlNJT05fX30nKQoKICAgIHRyeToKICAgICAgICBhcHAgPSBS
ZWRpc0NvbW1hbmRlclVJKGFyZ3MpCiAgICAgICAgYXBwLnJ1bigpCiAgICBleGNlcHQgS2V5Ym9h
cmRJbnRlcnJ1cHQ6CiAgICAgICAgcGFzcwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAg
ICAgIHByaW50KGYiRmF0YWwgZXJyb3I6IHtlfSIsIGZpbGU9c3lzLnN0ZGVycikKICAgICAgICBs
b2dnZXIuZXhjZXB0aW9uKCJGYXRhbCBlcnJvciIpCiAgICAgICAgc3lzLmV4aXQoMSkKCgppZiBf
X25hbWVfXyA9PSAnX19tYWluX18nOgogICAgbWFpbigpCgoKAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAByZWRpc19wcm9maWxlcy5qc29uAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAMDAwMDc3MAAwMDAwMDAwADAwMDE3MzQAMDAwMDAwMDA2NTEAMTUx
MzE0MTAyMTUAMDE0MDE2ACAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAHVzdGFyICAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB2Ym94c2YAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHsKICAibXktY2x1c3RlciI6IHsKICAgICJu
YW1lIjogIm15LWNsdXN0ZXIiLAogICAgImhvc3QiOiAiMTI3LjAuMC4xIiwKICAgICJwb3J0Ijog
NzAwMCwKICAgICJjbHVzdGVyX21vZGUiOiB0cnVlLAogICAgImNsdXN0ZXJfbm9kZXMiOiBbCiAg
ICAgIFsiMTI3LjAuMC4xIiwgNzAwMF0sCiAgICAgIFsiMTI3LjAuMC4xIiwgNzAwMV0sCiAgICAg
IFsiMTI3LjAuMC4xIiwgNzAwMl0sCiAgICAgIFsiMTI3LjAuMC4xIiwgNzAwM10sCiAgICAgIFsi
MTI3LjAuMC4xIiwgNzAwNF0sCiAgICAgIFsiMTI3LjAuMC4xIiwgNzAwNV0KICAgIF0KICB9LAog
ICJteS1sb2NhbCI6IHsKICAgICJuYW1lIjogIm15LWxvY2FsIiwKICAgICJob3N0IjogIjEyNy4w
LjAuMSIsCiAgICAicG9ydCI6IDYzNzksCiAgICAiY2x1c3Rlcl9tb2RlIjogZmFsc2UKICB9Cn0K
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAc2ltcGxlX3JlZGlzX2NsaWVudC5weQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAADAwMDA3NzAAMDAwMDAwMAAwMDAxNzM0ADAwMDAwMDczNjAzADE1MTMx
NjUyNDM2ADAxNDUyNQAgMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdmJveHNmAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiIiIKU2ltcGxlIFJlZGlzIENsaWVudCAtINCf
0L7Qu9C90LDRjyDQstC10YDRgdC40Y8K0J/QvtC00LTQtdGA0LbQutCwOiBSRVNQLCBDbHVzdGVy
LCBTU0wsIHNjYW5faXRlciwga2V5c2xvdCwgZ2V0X25vZGVfZnJvbV9rZXkKIiIiCgppbXBvcnQg
c29ja2V0CmltcG9ydCBzc2wgYXMgc3NsX21vZHVsZQpmcm9tIHR5cGluZyBpbXBvcnQgT3B0aW9u
YWwsIExpc3QsIERpY3QsIEFueSwgVHVwbGUsIFVuaW9uLCBJdGVyYXRvcgppbXBvcnQgbG9nZ2lu
ZwoKbG9nZ2VyID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCgoKY2xhc3MgUmVkaXNFcnJv
cihFeGNlcHRpb24pOgogICAgIiIi0JHQsNC30L7QstCw0Y8g0L7RiNC40LHQutCwIFJlZGlzIiIi
CiAgICBwYXNzCgoKY2xhc3MgUmVkaXNDb25uZWN0aW9uRXJyb3IoUmVkaXNFcnJvcik6CiAgICAi
IiLQntGI0LjQsdC60LAg0L/QvtC00LrQu9GO0YfQtdC90LjRjyIiIgogICAgcGFzcwoKCmNsYXNz
IFJlZGlzQ2x1c3RlckVycm9yKFJlZGlzRXJyb3IpOgogICAgIiIi0J7RiNC40LHQutCwINC60LvQ
sNGB0YLQtdGA0LAiIiIKICAgIHBhc3MKCgpjbGFzcyBSRVNQUGFyc2VyOgogICAgIiIi0J/QsNGA
0YHQtdGAIFJFU1Ag0L/RgNC+0YLQvtC60L7Qu9CwIiIiCgogICAgQHN0YXRpY21ldGhvZAogICAg
ZGVmIGVuY29kZV9jb21tYW5kKCphcmdzKSAtPiBieXRlczoKICAgICAgICAiIiLQmtC+0LTQuNGA
0L7QstCw0L3QuNC1INC60L7QvNCw0L3QtNGLINCyIFJFU1Ag0YTQvtGA0LzQsNGCIiIiCiAgICAg
ICAgcGFydHMgPSBbZicqe2xlbihhcmdzKX1cclxuJy5lbmNvZGUoKV0KCiAgICAgICAgZm9yIGFy
ZyBpbiBhcmdzOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFyZywgYnl0ZXMpOgogICAgICAg
ICAgICAgICAgZGF0YSA9IGFyZwogICAgICAgICAgICBlbGlmIGlzaW5zdGFuY2UoYXJnLCBzdHIp
OgogICAgICAgICAgICAgICAgZGF0YSA9IGFyZy5lbmNvZGUoJ3V0Zi04JykKICAgICAgICAgICAg
ZWxpZiBpc2luc3RhbmNlKGFyZywgaW50KToKICAgICAgICAgICAgICAgIGRhdGEgPSBzdHIoYXJn
KS5lbmNvZGUoJ3V0Zi04JykKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKGFyZywgZmxvYXQp
OgogICAgICAgICAgICAgICAgZGF0YSA9IHN0cihhcmcpLmVuY29kZSgndXRmLTgnKQogICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgZGF0YSA9IHN0cihhcmcpLmVuY29kZSgndXRmLTgn
KQoKICAgICAgICAgICAgcGFydHMuYXBwZW5kKGYnJHtsZW4oZGF0YSl9XHJcbicuZW5jb2RlKCkp
CiAgICAgICAgICAgIHBhcnRzLmFwcGVuZChkYXRhKQogICAgICAgICAgICBwYXJ0cy5hcHBlbmQo
YidcclxuJykKCiAgICAgICAgcmV0dXJuIGInJy5qb2luKHBhcnRzKQoKICAgIEBzdGF0aWNtZXRo
b2QKICAgIGRlZiBkZWNvZGVfcmVzcG9uc2Uoc29jaykgLT4gQW55OgogICAgICAgICIiItCU0LXQ
utC+0LTQuNGA0L7QstCw0L3QuNC1INC+0YLQstC10YLQsCBSRVNQIiIiCiAgICAgICAgbGluZSA9
IFJFU1BQYXJzZXIuX3JlYWRfbGluZShzb2NrKQoKICAgICAgICBpZiBub3QgbGluZToKICAgICAg
ICAgICAgcmFpc2UgUmVkaXNDb25uZWN0aW9uRXJyb3IoIkNvbm5lY3Rpb24gY2xvc2VkIikKCiAg
ICAgICAgcHJlZml4ID0gY2hyKGxpbmVbMF0pCiAgICAgICAgZGF0YSA9IGxpbmVbMTpdCgogICAg
ICAgIGlmIHByZWZpeCA9PSAnKyc6CiAgICAgICAgICAgIHJldHVybiBkYXRhLmRlY29kZSgndXRm
LTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgIGVsaWYgcHJlZml4ID09ICctJzoKICAgICAg
ICAgICAgZXJyb3JfbXNnID0gZGF0YS5kZWNvZGUoJ3V0Zi04JywgZXJyb3JzPSdyZXBsYWNlJykK
ICAgICAgICAgICAgcmFpc2UgUmVkaXNFcnJvcihlcnJvcl9tc2cpCiAgICAgICAgZWxpZiBwcmVm
aXggPT0gJzonOgogICAgICAgICAgICByZXR1cm4gaW50KGRhdGEpCiAgICAgICAgZWxpZiBwcmVm
aXggPT0gJyQnOgogICAgICAgICAgICBsZW5ndGggPSBpbnQoZGF0YSkKICAgICAgICAgICAgaWYg
bGVuZ3RoID09IC0xOgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAgICAgYnVs
a19kYXRhID0gc29jay5yZWN2KGxlbmd0aCkKICAgICAgICAgICAgd2hpbGUgbGVuKGJ1bGtfZGF0
YSkgPCBsZW5ndGg6CiAgICAgICAgICAgICAgICBjaHVuayA9IHNvY2sucmVjdihsZW5ndGggLSBs
ZW4oYnVsa19kYXRhKSkKICAgICAgICAgICAgICAgIGlmIG5vdCBjaHVuazoKICAgICAgICAgICAg
ICAgICAgICByYWlzZSBSZWRpc0Nvbm5lY3Rpb25FcnJvcigiQ29ubmVjdGlvbiBjbG9zZWQiKQog
ICAgICAgICAgICAgICAgYnVsa19kYXRhICs9IGNodW5rCiAgICAgICAgICAgIHNvY2sucmVjdigy
KQogICAgICAgICAgICByZXR1cm4gYnVsa19kYXRhCiAgICAgICAgZWxpZiBwcmVmaXggPT0gJyon
OgogICAgICAgICAgICBjb3VudCA9IGludChkYXRhKQogICAgICAgICAgICBpZiBjb3VudCA9PSAt
MToKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgICAgIHJldHVybiBbUkVTUFBh
cnNlci5kZWNvZGVfcmVzcG9uc2Uoc29jaykgZm9yIF8gaW4gcmFuZ2UoY291bnQpXQogICAgICAg
IGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFJlZGlzRXJyb3IoZiJVbmtub3duIFJFU1AgcHJlZml4
OiB7cHJlZml4fSIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9yZWFkX2xpbmUoc29jaykg
LT4gYnl0ZXM6CiAgICAgICAgIiIi0KfRgtC10L3QuNC1INGB0YLRgNC+0LrQuCDQtNC+IFxyXG4i
IiIKICAgICAgICBsaW5lID0gYicnCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgY2hh
ciA9IHNvY2sucmVjdigxKQogICAgICAgICAgICBpZiBub3QgY2hhcjoKICAgICAgICAgICAgICAg
IHJhaXNlIFJlZGlzQ29ubmVjdGlvbkVycm9yKCJDb25uZWN0aW9uIGNsb3NlZCIpCiAgICAgICAg
ICAgIGxpbmUgKz0gY2hhcgogICAgICAgICAgICBpZiBsaW5lLmVuZHN3aXRoKGInXHJcbicpOgog
ICAgICAgICAgICAgICAgcmV0dXJuIGxpbmVbOi0yXQoKCmNsYXNzIFJlZGlzQ29ubmVjdGlvbjoK
ICAgICIiItCf0L7QtNC60LvRjtGH0LXQvdC40LUg0Log0L7QtNC90L7QvNGDIFJlZGlzINGD0LfQ
u9GDIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhvc3Q6IHN0ciA9ICdsb2NhbGhvc3QnLCBw
b3J0OiBpbnQgPSA2Mzc5LAogICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBPcHRpb25hbFtzdHJd
ID0gTm9uZSwgdXNlcm5hbWU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICAgICAg
IGRiOiBpbnQgPSAwLCBzb2NrZXRfdGltZW91dDogaW50ID0gNSwKICAgICAgICAgICAgICAgICBz
c2w6IGJvb2wgPSBGYWxzZSwgc3NsX2NhX2NlcnRzOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAg
ICAgICAgICAgICAgICBzc2xfY2VydGZpbGU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBzc2xfa2V5
ZmlsZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICAgICAgc3NsX2NoZWNrX2hv
c3RuYW1lOiBib29sID0gVHJ1ZSk6CgogICAgICAgIHNlbGYuaG9zdCA9IGhvc3QKICAgICAgICBz
ZWxmLnBvcnQgPSBwb3J0CiAgICAgICAgc2VsZi5wYXNzd29yZCA9IHBhc3N3b3JkCiAgICAgICAg
c2VsZi51c2VybmFtZSA9IHVzZXJuYW1lCiAgICAgICAgc2VsZi5kYiA9IGRiCiAgICAgICAgc2Vs
Zi5zb2NrZXRfdGltZW91dCA9IHNvY2tldF90aW1lb3V0CiAgICAgICAgc2VsZi5zc2wgPSBzc2wK
ICAgICAgICBzZWxmLnNzbF9jYV9jZXJ0cyA9IHNzbF9jYV9jZXJ0cwogICAgICAgIHNlbGYuc3Ns
X2NlcnRmaWxlID0gc3NsX2NlcnRmaWxlCiAgICAgICAgc2VsZi5zc2xfa2V5ZmlsZSA9IHNzbF9r
ZXlmaWxlCiAgICAgICAgc2VsZi5zc2xfY2hlY2tfaG9zdG5hbWUgPSBzc2xfY2hlY2tfaG9zdG5h
bWUKICAgICAgICBzZWxmLnNvY2s6IE9wdGlvbmFsW3NvY2tldC5zb2NrZXRdID0gTm9uZQogICAg
ICAgIHNlbGYuX2Nvbm5lY3QoKQoKICAgIGRlZiBfY29ubmVjdChzZWxmKToKICAgICAgICB0cnk6
CiAgICAgICAgICAgIHNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQu
U09DS19TVFJFQU0pCiAgICAgICAgICAgIHNvY2suc2V0dGltZW91dChzZWxmLnNvY2tldF90aW1l
b3V0KQogICAgICAgICAgICBzb2NrLmNvbm5lY3QoKHNlbGYuaG9zdCwgc2VsZi5wb3J0KSkKCiAg
ICAgICAgICAgIGlmIHNlbGYuc3NsOgogICAgICAgICAgICAgICAgY29udGV4dCA9IHNzbF9tb2R1
bGUuY3JlYXRlX2RlZmF1bHRfY29udGV4dCgpCiAgICAgICAgICAgICAgICBpZiBzZWxmLnNzbF9j
YV9jZXJ0czoKICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmxvYWRfdmVyaWZ5X2xvY2F0aW9u
cyhjYWZpbGU9c2VsZi5zc2xfY2FfY2VydHMpCiAgICAgICAgICAgICAgICBpZiBzZWxmLnNzbF9j
ZXJ0ZmlsZSBhbmQgc2VsZi5zc2xfa2V5ZmlsZToKICAgICAgICAgICAgICAgICAgICBjb250ZXh0
LmxvYWRfY2VydF9jaGFpbihjZXJ0ZmlsZT1zZWxmLnNzbF9jZXJ0ZmlsZSwga2V5ZmlsZT1zZWxm
LnNzbF9rZXlmaWxlKQogICAgICAgICAgICAgICAgaWYgbm90IHNlbGYuc3NsX2NoZWNrX2hvc3Ru
YW1lOgogICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY2hlY2tfaG9zdG5hbWUgPSBGYWxzZQog
ICAgICAgICAgICAgICAgICAgIGNvbnRleHQudmVyaWZ5X21vZGUgPSBzc2xfbW9kdWxlLkNFUlRf
Tk9ORQogICAgICAgICAgICAgICAgc29jayA9IGNvbnRleHQud3JhcF9zb2NrZXQoc29jaywgc2Vy
dmVyX2hvc3RuYW1lPXNlbGYuaG9zdCkKCiAgICAgICAgICAgIHNlbGYuc29jayA9IHNvY2sKCiAg
ICAgICAgICAgIGlmIHNlbGYucGFzc3dvcmQ6CiAgICAgICAgICAgICAgICBpZiBzZWxmLnVzZXJu
YW1lOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdBVVRIJywgc2Vs
Zi51c2VybmFtZSwgc2VsZi5wYXNzd29yZCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAg
ICAgICAgICAgICAgc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0FVVEgnLCBzZWxmLnBhc3N3b3JkKQoK
ICAgICAgICAgICAgaWYgc2VsZi5kYiAhPSAwOgogICAgICAgICAgICAgICAgc2VsZi5leGVjdXRl
X2NvbW1hbmQoJ1NFTEVDVCcsIHNlbGYuZGIpCgogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkNv
bm5lY3RlZCB0byB7c2VsZi5ob3N0fTp7c2VsZi5wb3J0fSAoZGI9e3NlbGYuZGJ9KSIpCiAgICAg
ICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBpZiBzZWxmLnNvY2s6CiAgICAg
ICAgICAgICAgICBzZWxmLnNvY2suY2xvc2UoKQogICAgICAgICAgICAgICAgc2VsZi5zb2NrID0g
Tm9uZQogICAgICAgICAgICByYWlzZSBSZWRpc0Nvbm5lY3Rpb25FcnJvcihmIkZhaWxlZCB0byBj
b25uZWN0OiB7ZX0iKQoKICAgIGRlZiBleGVjdXRlX2NvbW1hbmQoc2VsZiwgKmFyZ3MpIC0+IEFu
eToKICAgICAgICBpZiBub3Qgc2VsZi5zb2NrOgogICAgICAgICAgICByYWlzZSBSZWRpc0Nvbm5l
Y3Rpb25FcnJvcigiTm90IGNvbm5lY3RlZCIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb21t
YW5kID0gUkVTUFBhcnNlci5lbmNvZGVfY29tbWFuZCgqYXJncykKICAgICAgICAgICAgc2VsZi5z
b2NrLnNlbmRhbGwoY29tbWFuZCkKICAgICAgICAgICAgcmV0dXJuIFJFU1BQYXJzZXIuZGVjb2Rl
X3Jlc3BvbnNlKHNlbGYuc29jaykKICAgICAgICBleGNlcHQgUmVkaXNFcnJvcjoKICAgICAgICAg
ICAgcmFpc2UKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYu
Y2xvc2UoKQogICAgICAgICAgICByYWlzZSBSZWRpc0Nvbm5lY3Rpb25FcnJvcihmIkNvbW1hbmQg
ZmFpbGVkOiB7ZX0iKQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBpZiBzZWxmLnNvY2s6
CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuc29jay5jbG9zZSgpCiAgICAg
ICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgc2VsZi5zb2Nr
ID0gTm9uZQoKICAgIGRlZiBwaW5nKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgdHJ5OgogICAgICAg
ICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1BJTkcnKSA9PSAnUE9ORycKICAgICAg
ICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKCmNsYXNzIENsdXN0ZXJOb2RlOgog
ICAgIiIi0JjQvdGE0L7RgNC80LDRhtC40Y8g0L7QsSDRg9C30LvQtSDQutC70LDRgdGC0LXRgNCw
IiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhvc3Q6IHN0ciwgcG9ydDogaW50LCBub2RlX2lk
OiBzdHIsIHNsb3RzOiBMaXN0W2ludF0pOgogICAgICAgIHNlbGYuaG9zdCA9IGhvc3QKICAgICAg
ICBzZWxmLnBvcnQgPSBwb3J0CiAgICAgICAgc2VsZi5ub2RlX2lkID0gbm9kZV9pZAogICAgICAg
IHNlbGYuc2xvdHMgPSBzbG90cwoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1
cm4gZiJDbHVzdGVyTm9kZShob3N0PXtzZWxmLmhvc3R9LCBwb3J0PXtzZWxmLnBvcnR9LCBzbG90
cz17bGVuKHNlbGYuc2xvdHMpfSkiCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0
dXJuIGYie3NlbGYuaG9zdH06e3NlbGYucG9ydH0iCgoKY2xhc3MgUmVkaXNDbGllbnQ6CiAgICAi
IiJSZWRpcyDQutC70LjQtdC90YIg0YEg0L/QvtC70L3QvtC5INC/0L7QtNC00LXRgNC20LrQvtC5
IENsdXN0ZXIiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaG9zdDogc3RyID0gJ2xvY2FsaG9z
dCcsIHBvcnQ6IGludCA9IDYzNzksCiAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IE9wdGlvbmFs
W3N0cl0gPSBOb25lLCB1c2VybmFtZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAg
ICAgICAgZGI6IGludCA9IDAsIHNvY2tldF90aW1lb3V0OiBpbnQgPSA1LAogICAgICAgICAgICAg
ICAgIHNzbDogYm9vbCA9IEZhbHNlLCBzc2xfY2FfY2VydHM6IE9wdGlvbmFsW3N0cl0gPSBOb25l
LAogICAgICAgICAgICAgICAgIHNzbF9jZXJ0ZmlsZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsIHNz
bF9rZXlmaWxlOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICAgICAgICAgICBkZWNvZGVf
cmVzcG9uc2VzOiBib29sID0gRmFsc2UsIGlzX2NsdXN0ZXI6IGJvb2wgPSBGYWxzZSk6CgogICAg
ICAgIHNlbGYuaG9zdCA9IGhvc3QKICAgICAgICBzZWxmLnBvcnQgPSBwb3J0CiAgICAgICAgc2Vs
Zi5wYXNzd29yZCA9IHBhc3N3b3JkCiAgICAgICAgc2VsZi51c2VybmFtZSA9IHVzZXJuYW1lCiAg
ICAgICAgc2VsZi5kYiA9IGRiCiAgICAgICAgc2VsZi5zb2NrZXRfdGltZW91dCA9IHNvY2tldF90
aW1lb3V0CiAgICAgICAgc2VsZi5zc2wgPSBzc2wKICAgICAgICBzZWxmLnNzbF9jYV9jZXJ0cyA9
IHNzbF9jYV9jZXJ0cwogICAgICAgIHNlbGYuc3NsX2NlcnRmaWxlID0gc3NsX2NlcnRmaWxlCiAg
ICAgICAgc2VsZi5zc2xfa2V5ZmlsZSA9IHNzbF9rZXlmaWxlCiAgICAgICAgc2VsZi5kZWNvZGVf
cmVzcG9uc2VzID0gZGVjb2RlX3Jlc3BvbnNlcwogICAgICAgIHNlbGYuaXNfY2x1c3RlciA9IGlz
X2NsdXN0ZXIKCiAgICAgICAgc2VsZi5jb25uZWN0aW9uOiBPcHRpb25hbFtSZWRpc0Nvbm5lY3Rp
b25dID0gTm9uZQogICAgICAgIHNlbGYuY2x1c3Rlcl9ub2RlczogRGljdFtzdHIsIFJlZGlzQ29u
bmVjdGlvbl0gPSB7fQogICAgICAgIHNlbGYuY2x1c3Rlcl9zbG90czogRGljdFtpbnQsIHN0cl0g
PSB7fQoKICAgICAgICBzZWxmLl9pbml0X2Nvbm5lY3Rpb24oKQoKICAgIGRlZiBfaW5pdF9jb25u
ZWN0aW9uKHNlbGYpOgogICAgICAgIGNvbm5fa3dhcmdzID0gewogICAgICAgICAgICAnaG9zdCc6
IHNlbGYuaG9zdCwKICAgICAgICAgICAgJ3BvcnQnOiBzZWxmLnBvcnQsCiAgICAgICAgICAgICdw
YXNzd29yZCc6IHNlbGYucGFzc3dvcmQsCiAgICAgICAgICAgICd1c2VybmFtZSc6IHNlbGYudXNl
cm5hbWUsCiAgICAgICAgICAgICdkYic6IHNlbGYuZGIsCiAgICAgICAgICAgICdzb2NrZXRfdGlt
ZW91dCc6IHNlbGYuc29ja2V0X3RpbWVvdXQsCiAgICAgICAgICAgICdzc2wnOiBzZWxmLnNzbCwK
ICAgICAgICAgICAgJ3NzbF9jYV9jZXJ0cyc6IHNlbGYuc3NsX2NhX2NlcnRzLAogICAgICAgICAg
ICAnc3NsX2NlcnRmaWxlJzogc2VsZi5zc2xfY2VydGZpbGUsCiAgICAgICAgICAgICdzc2xfa2V5
ZmlsZSc6IHNlbGYuc3NsX2tleWZpbGUsCiAgICAgICAgfQoKICAgICAgICBzZWxmLmNvbm5lY3Rp
b24gPSBSZWRpc0Nvbm5lY3Rpb24oKipjb25uX2t3YXJncykKCiAgICAgICAgaWYgc2VsZi5pc19j
bHVzdGVyOgogICAgICAgICAgICBzZWxmLl9sb2FkX2NsdXN0ZXJfdG9wb2xvZ3koKQoKICAgIGRl
ZiBfbG9hZF9jbHVzdGVyX3RvcG9sb2d5KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAg
c2xvdHNfaW5mbyA9IHNlbGYuY29ubmVjdGlvbi5leGVjdXRlX2NvbW1hbmQoJ0NMVVNURVInLCAn
U0xPVFMnKQoKICAgICAgICAgICAgZm9yIHNsb3RfcmFuZ2UgaW4gc2xvdHNfaW5mbzoKICAgICAg
ICAgICAgICAgIHN0YXJ0X3Nsb3QgPSBzbG90X3JhbmdlWzBdCiAgICAgICAgICAgICAgICBlbmRf
c2xvdCA9IHNsb3RfcmFuZ2VbMV0KICAgICAgICAgICAgICAgIG1hc3Rlcl9pbmZvID0gc2xvdF9y
YW5nZVsyXQoKICAgICAgICAgICAgICAgIG5vZGVfaG9zdCA9IG1hc3Rlcl9pbmZvWzBdLmRlY29k
ZSgndXRmLTgnKQogICAgICAgICAgICAgICAgbm9kZV9wb3J0ID0gbWFzdGVyX2luZm9bMV0KICAg
ICAgICAgICAgICAgIG5vZGVfaWQgPSBmIntub2RlX2hvc3R9Ontub2RlX3BvcnR9IgoKICAgICAg
ICAgICAgICAgIGlmIG5vZGVfaWQgbm90IGluIHNlbGYuY2x1c3Rlcl9ub2RlczoKICAgICAgICAg
ICAgICAgICAgICBjb25uID0gUmVkaXNDb25uZWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAg
ICBob3N0PW5vZGVfaG9zdCwKICAgICAgICAgICAgICAgICAgICAgICAgcG9ydD1ub2RlX3BvcnQs
CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPXNlbGYucGFzc3dvcmQsCiAgICAgICAg
ICAgICAgICAgICAgICAgIHVzZXJuYW1lPXNlbGYudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAg
ICAgICAgIHNvY2tldF90aW1lb3V0PXNlbGYuc29ja2V0X3RpbWVvdXQsCiAgICAgICAgICAgICAg
ICAgICAgICAgIHNzbD1zZWxmLnNzbCwKICAgICAgICAgICAgICAgICAgICAgICAgc3NsX2NhX2Nl
cnRzPXNlbGYuc3NsX2NhX2NlcnRzLAogICAgICAgICAgICAgICAgICAgICAgICBzc2xfY2VydGZp
bGU9c2VsZi5zc2xfY2VydGZpbGUsCiAgICAgICAgICAgICAgICAgICAgICAgIHNzbF9rZXlmaWxl
PXNlbGYuc3NsX2tleWZpbGUKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAg
ICAgc2VsZi5jbHVzdGVyX25vZGVzW25vZGVfaWRdID0gY29ubgoKICAgICAgICAgICAgICAgIGZv
ciBzbG90IGluIHJhbmdlKHN0YXJ0X3Nsb3QsIGVuZF9zbG90ICsgMSk6CiAgICAgICAgICAgICAg
ICAgICAgc2VsZi5jbHVzdGVyX3Nsb3RzW3Nsb3RdID0gbm9kZV9pZAoKICAgICAgICAgICAgbG9n
Z2VyLmluZm8oZiJMb2FkZWQgY2x1c3Rlcjoge2xlbihzZWxmLmNsdXN0ZXJfbm9kZXMpfSBub2Rl
cyIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIud2Fy
bmluZyhmIkZhaWxlZCB0byBsb2FkIGNsdXN0ZXIgdG9wb2xvZ3k6IHtlfSIpCgogICAgZGVmIF9n
ZXRfc2xvdChzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6CiAgICAgICAgIiIi
Q1JDMTYgaGFzaCBzbG90IGNhbGN1bGF0aW9uIiIiCiAgICAgICAgaWYgaXNpbnN0YW5jZShrZXks
IHN0cik6CiAgICAgICAgICAgIGtleSA9IGtleS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgc3Rh
cnQgPSBrZXkuZmluZChiJ3snKQogICAgICAgIGlmIHN0YXJ0ICE9IC0xOgogICAgICAgICAgICBl
bmQgPSBrZXkuZmluZChiJ30nLCBzdGFydCArIDEpCiAgICAgICAgICAgIGlmIGVuZCAhPSAtMSBh
bmQgZW5kID4gc3RhcnQgKyAxOgogICAgICAgICAgICAgICAga2V5ID0ga2V5W3N0YXJ0ICsgMTpl
bmRdCgogICAgICAgIGNyYyA9IDAKICAgICAgICBmb3IgYnl0ZSBpbiBrZXk6CiAgICAgICAgICAg
IGNyYyBePSBieXRlIDw8IDgKICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2UoOCk6CiAgICAgICAg
ICAgICAgICBpZiBjcmMgJiAweDgwMDA6CiAgICAgICAgICAgICAgICAgICAgY3JjID0gKGNyYyA8
PCAxKSBeIDB4MTAyMQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBj
cmMgPSBjcmMgPDwgMQogICAgICAgICAgICAgICAgY3JjICY9IDB4RkZGRgoKICAgICAgICByZXR1
cm4gY3JjICUgMTYzODQKCiAgICBkZWYgX2dldF9jb25uZWN0aW9uX2Zvcl9rZXkoc2VsZiwga2V5
OiBVbmlvbltzdHIsIGJ5dGVzXSkgLT4gUmVkaXNDb25uZWN0aW9uOgogICAgICAgIGlmIG5vdCBz
ZWxmLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmNvbm5lY3Rpb24KCiAgICAg
ICAgc2xvdCA9IHNlbGYuX2dldF9zbG90KGtleSkKICAgICAgICBub2RlX2lkID0gc2VsZi5jbHVz
dGVyX3Nsb3RzLmdldChzbG90KQoKICAgICAgICBpZiBub2RlX2lkIGFuZCBub2RlX2lkIGluIHNl
bGYuY2x1c3Rlcl9ub2RlczoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuY2x1c3Rlcl9ub2Rlc1tu
b2RlX2lkXQoKICAgICAgICByZXR1cm4gc2VsZi5jb25uZWN0aW9uCgogICAgZGVmIGV4ZWN1dGVf
Y29tbWFuZChzZWxmLCAqYXJncywga2V5OiBPcHRpb25hbFtVbmlvbltzdHIsIGJ5dGVzXV0gPSBO
b25lKSAtPiBBbnk6CiAgICAgICAgbWF4X3JlZGlyZWN0cyA9IDUKICAgICAgICByZWRpcmVjdF9j
b3VudCA9IDAKCiAgICAgICAgaWYga2V5IGlzIE5vbmUgYW5kIGxlbihhcmdzKSA+IDE6CiAgICAg
ICAgICAgIGtleSA9IGFyZ3NbMV0KCiAgICAgICAgY29ubiA9IHNlbGYuX2dldF9jb25uZWN0aW9u
X2Zvcl9rZXkoa2V5KSBpZiBrZXkgZWxzZSBzZWxmLmNvbm5lY3Rpb24KCiAgICAgICAgd2hpbGUg
cmVkaXJlY3RfY291bnQgPCBtYXhfcmVkaXJlY3RzOgogICAgICAgICAgICB0cnk6CiAgICAgICAg
ICAgICAgICByZXNwb25zZSA9IGNvbm4uZXhlY3V0ZV9jb21tYW5kKCphcmdzKQogICAgICAgICAg
ICAgICAgaWYgc2VsZi5kZWNvZGVfcmVzcG9uc2VzOgogICAgICAgICAgICAgICAgICAgIHJlc3Bv
bnNlID0gc2VsZi5fZGVjb2RlX3Jlc3BvbnNlKHJlc3BvbnNlKQogICAgICAgICAgICAgICAgcmV0
dXJuIHJlc3BvbnNlCiAgICAgICAgICAgIGV4Y2VwdCBSZWRpc0Vycm9yIGFzIGU6CiAgICAgICAg
ICAgICAgICBlcnJvcl9tc2cgPSBzdHIoZSkKCiAgICAgICAgICAgICAgICBpZiBlcnJvcl9tc2cu
c3RhcnRzd2l0aCgnTU9WRUQnKToKICAgICAgICAgICAgICAgICAgICBwYXJ0cyA9IGVycm9yX21z
Zy5zcGxpdCgpCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHBhcnRzKSA+PSAzOgogICAgICAg
ICAgICAgICAgICAgICAgICBzbG90ID0gaW50KHBhcnRzWzFdKQogICAgICAgICAgICAgICAgICAg
ICAgICBub2RlX2FkZHIgPSBwYXJ0c1syXQogICAgICAgICAgICAgICAgICAgICAgICBob3N0LCBw
b3J0ID0gbm9kZV9hZGRyLnNwbGl0KCc6JykKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9p
ZCA9IGYie2hvc3R9Ontwb3J0fSIKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vZGVfaWQg
bm90IGluIHNlbGYuY2x1c3Rlcl9ub2RlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bm4gPSBSZWRpc0Nvbm5lY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9z
dD1ob3N0LCBwb3J0PWludChwb3J0KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBw
YXNzd29yZD1zZWxmLnBhc3N3b3JkLCB1c2VybmFtZT1zZWxmLnVzZXJuYW1lLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHNvY2tldF90aW1lb3V0PXNlbGYuc29ja2V0X3RpbWVvdXQs
IHNzbD1zZWxmLnNzbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc2VsZi5jbHVzdGVyX25vZGVzW25vZGVfaWRdID0gY29ubgogICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubiA9
IHNlbGYuY2x1c3Rlcl9ub2Rlc1tub2RlX2lkXQoKICAgICAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5jbHVzdGVyX3Nsb3RzW3Nsb3RdID0gbm9kZV9pZAogICAgICAgICAgICAgICAgICAgICAgICBy
ZWRpcmVjdF9jb3VudCArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAg
ICAgICAgICAgICAgZWxpZiBlcnJvcl9tc2cuc3RhcnRzd2l0aCgnQVNLJyk6CiAgICAgICAgICAg
ICAgICAgICAgcGFydHMgPSBlcnJvcl9tc2cuc3BsaXQoKQogICAgICAgICAgICAgICAgICAgIGlm
IGxlbihwYXJ0cykgPj0gMzoKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9hZGRyID0gcGFy
dHNbMl0KICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCwgcG9ydCA9IG5vZGVfYWRkci5zcGxp
dCgnOicpCiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfY29ubiA9IFJlZGlzQ29ubmVjdGlv
bigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q9aG9zdCwgcG9ydD1pbnQocG9ydCks
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1zZWxmLnBhc3N3b3JkLCB1c2Vy
bmFtZT1zZWxmLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0X3Rp
bWVvdXQ9c2VsZi5zb2NrZXRfdGltZW91dCwgc3NsPXNlbGYuc3NsCiAgICAgICAgICAgICAgICAg
ICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcF9jb25uLmV4ZWN1dGVfY29tbWFu
ZCgnQVNLSU5HJykKICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSB0ZW1wX2Nvbm4u
ZXhlY3V0ZV9jb21tYW5kKCphcmdzKQogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2Nvbm4u
Y2xvc2UoKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLmRlY29kZV9yZXNwb25zZXM6
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IHNlbGYuX2RlY29kZV9yZXNw
b25zZShyZXNwb25zZSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlCiAg
ICAgICAgICAgICAgICByYWlzZQoKICAgICAgICByYWlzZSBSZWRpc0NsdXN0ZXJFcnJvcihmIlRv
byBtYW55IHJlZGlyZWN0cyIpCgogICAgZGVmIF9kZWNvZGVfcmVzcG9uc2Uoc2VsZiwgcmVzcG9u
c2UpOgogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzcG9uc2UsIGJ5dGVzKToKICAgICAgICAgICAg
cmV0dXJuIHJlc3BvbnNlLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAg
IGVsaWYgaXNpbnN0YW5jZShyZXNwb25zZSwgbGlzdCk6CiAgICAgICAgICAgIHJldHVybiBbc2Vs
Zi5fZGVjb2RlX3Jlc3BvbnNlKGl0ZW0pIGZvciBpdGVtIGluIHJlc3BvbnNlXQogICAgICAgIGVs
aWYgaXNpbnN0YW5jZShyZXNwb25zZSwgZGljdCk6CiAgICAgICAgICAgIHJldHVybiB7c2VsZi5f
ZGVjb2RlX3Jlc3BvbnNlKGspOiBzZWxmLl9kZWNvZGVfcmVzcG9uc2UodikgZm9yIGssIHYgaW4g
cmVzcG9uc2UuaXRlbXMoKX0KICAgICAgICByZXR1cm4gcmVzcG9uc2UKCiAgICAjID09PT09PT09
PT09PSBCYXNpYyA9PT09PT09PT09PT0KCiAgICBkZWYgcGluZyhzZWxmKSAtPiBib29sOgogICAg
ICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnUElO
RycpCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSBpbiAoJ1BPTkcnLCBiJ1BPTkcnKQogICAg
ICAgIGV4Y2VwdDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIGluZm8oc2VsZiwg
c2VjdGlvbjogT3B0aW9uYWxbc3RyXSA9IE5vbmUpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAg
IGlmIHNlY3Rpb246CiAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5leGVjdXRlX2NvbW1hbmQo
J0lORk8nLCBzZWN0aW9uKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlc3BvbnNlID0gc2Vs
Zi5leGVjdXRlX2NvbW1hbmQoJ0lORk8nKQoKICAgICAgICBpZiBpc2luc3RhbmNlKHJlc3BvbnNl
LCBieXRlcyk6CiAgICAgICAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuZGVjb2RlKCd1dGYtOCcp
CgogICAgICAgIHJlc3VsdCA9IHt9CiAgICAgICAgY3VycmVudF9zZWN0aW9uID0gTm9uZQoKICAg
ICAgICBmb3IgbGluZSBpbiByZXNwb25zZS5zcGxpdCgnXG4nKToKICAgICAgICAgICAgbGluZSA9
IGxpbmUuc3RyaXAoKQogICAgICAgICAgICBpZiBub3QgbGluZSBvciBsaW5lLnN0YXJ0c3dpdGgo
JyMnKToKICAgICAgICAgICAgICAgIGlmIGxpbmUuc3RhcnRzd2l0aCgnIycpOgogICAgICAgICAg
ICAgICAgICAgIGN1cnJlbnRfc2VjdGlvbiA9IGxpbmVbMTpdLnN0cmlwKCkubG93ZXIoKQogICAg
ICAgICAgICAgICAgICAgIHJlc3VsdFtjdXJyZW50X3NlY3Rpb25dID0ge30KICAgICAgICAgICAg
ICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmICc6JyBpbiBsaW5lOgogICAgICAgICAgICAgICAg
a2V5LCB2YWx1ZSA9IGxpbmUuc3BsaXQoJzonLCAxKQogICAgICAgICAgICAgICAgdHJ5OgogICAg
ICAgICAgICAgICAgICAgIHZhbHVlID0gZmxvYXQodmFsdWUpIGlmICcuJyBpbiB2YWx1ZSBlbHNl
IGludCh2YWx1ZSkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBw
YXNzCiAgICAgICAgICAgICAgICBpZiBjdXJyZW50X3NlY3Rpb246CiAgICAgICAgICAgICAgICAg
ICAgcmVzdWx0W2N1cnJlbnRfc2VjdGlvbl1ba2V5XSA9IHZhbHVlCiAgICAgICAgICAgICAgICBl
bHNlOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWUKICAgICAgICByZXR1
cm4gcmVzdWx0CgogICAgZGVmIHNlbGVjdChzZWxmLCBkYjogaW50KToKICAgICAgICBpZiBzZWxm
LmlzX2NsdXN0ZXI6CiAgICAgICAgICAgIHJhaXNlIFJlZGlzRXJyb3IoIlNFTEVDVCBub3QgYWxs
b3dlZCBpbiBjbHVzdGVyIikKICAgICAgICBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnU0VMRUNUJywg
ZGIpCiAgICAgICAgc2VsZi5kYiA9IGRiCgogICAgZGVmIGRic2l6ZShzZWxmKSAtPiBpbnQ6CiAg
ICAgICAgIiIiREJTSVpFIC0g0LrQvtC70LjRh9C10YHRgtCy0L4g0LrQu9GO0YfQtdC5INCyINGC
0LXQutGD0YnQtdC5INCR0JQiIiIKICAgICAgICBpZiBzZWxmLmlzX2NsdXN0ZXI6CiAgICAgICAg
ICAgIGxvZ2dlci53YXJuaW5nKCJEQlNJWkUgaW4gY2x1c3RlciBtb2RlIHJldHVybnMgYXBwcm94
aW1hdGUgY291bnQiKQogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnREJTSVpF
JykKICAgIAogICAgZGVmIGZsdXNoZGIoc2VsZiwgYXN5bmNocm9ub3VzOiBib29sID0gRmFsc2Up
IC0+IHN0cjoKICAgICAgICAiIiJGTFVTSERCIC0g0L7Rh9C40YHRgtC40YLRjCDRgtC10LrRg9GJ
0YPRjiDQkdCUIiIiCiAgICAgICAgaWYgc2VsZi5pc19jbHVzdGVyOgogICAgICAgICAgICByYWlz
ZSBSZWRpc0Vycm9yKCJGTFVTSERCIHJlcXVpcmVzIGNsdXN0ZXItd2lkZSBvcGVyYXRpb24iKQog
ICAgICAgIGlmIGFzeW5jaHJvbm91czoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9j
b21tYW5kKCdGTFVTSERCJywgJ0FTWU5DJykKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2Nv
bW1hbmQoJ0ZMVVNIREInKQogICAgCiAgICBkZWYgZmx1c2hhbGwoc2VsZiwgYXN5bmNocm9ub3Vz
OiBib29sID0gRmFsc2UpIC0+IHN0cjoKICAgICAgICAiIiJGTFVTSEFMTCAtINC+0YfQuNGB0YLQ
uNGC0Ywg0LLRgdC1INCR0JQiIiIKICAgICAgICBpZiBhc3luY2hyb25vdXM6CiAgICAgICAgICAg
IHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnRkxVU0hBTEwnLCAnQVNZTkMnKQogICAgICAg
IHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnRkxVU0hBTEwnKQoKCiAgICAjID09PT09PT09
PT09PSBLZXlzID09PT09PT09PT09PQoKICAgIGRlZiBrZXlzKHNlbGYsIHBhdHRlcm46IHN0ciA9
ICcqJykgLT4gTGlzdFtieXRlc106CiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5k
KCdLRVlTJywgcGF0dGVybikKCiAgICBkZWYgc2NhbihzZWxmLCBjdXJzb3I6IGludCA9IDAsIG1h
dGNoOiBPcHRpb25hbFtzdHJdID0gTm9uZSwgCiAgICAgICAgICAgICBjb3VudDogT3B0aW9uYWxb
aW50XSA9IE5vbmUpIC0+IFR1cGxlW2ludCwgTGlzdFtieXRlc11dOgogICAgICAgIGFyZ3MgPSBb
J1NDQU4nLCBjdXJzb3JdCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICAgIGFyZ3MuZXh0ZW5k
KFsnTUFUQ0gnLCBtYXRjaF0pCiAgICAgICAgaWYgY291bnQ6CiAgICAgICAgICAgIGFyZ3MuZXh0
ZW5kKFsnQ09VTlQnLCBjb3VudF0pCiAgICAgICAgcmVzcG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29t
bWFuZCgqYXJncykKICAgICAgICByZXR1cm4gaW50KHJlc3BvbnNlWzBdKSwgcmVzcG9uc2VbMV0K
CiAgICBkZWYgc2Nhbl9pdGVyKHNlbGYsIG1hdGNoOiBPcHRpb25hbFtzdHJdID0gTm9uZSwgY291
bnQ6IGludCA9IDEwMCkgLT4gSXRlcmF0b3JbYnl0ZXNdOgogICAgICAgIGN1cnNvciA9IDAKICAg
ICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjdXJzb3IsIGtleXMgPSBzZWxmLnNjYW4oY3Vy
c29yLCBtYXRjaD1tYXRjaCwgY291bnQ9Y291bnQpCiAgICAgICAgICAgIGZvciBrZXkgaW4ga2V5
czoKICAgICAgICAgICAgICAgIHlpZWxkIGtleQogICAgICAgICAgICBpZiBjdXJzb3IgPT0gMDoK
ICAgICAgICAgICAgICAgIGJyZWFrCgogICAgZGVmIGV4aXN0cyhzZWxmLCAqa2V5cykgLT4gaW50
OgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnRVhJU1RTJywgKmtleXMpCgog
ICAgZGVmIGRlbGV0ZShzZWxmLCAqa2V5cykgLT4gaW50OgogICAgICAgIHJldHVybiBzZWxmLmV4
ZWN1dGVfY29tbWFuZCgnREVMJywgKmtleXMsIGtleT1rZXlzWzBdIGlmIGtleXMgZWxzZSBOb25l
KQoKICAgIGRlZiB0eXBlKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IGJ5dGVzOgog
ICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnVFlQRScsIGtleSwga2V5PWtleSkK
CiAgICBkZWYgdHRsKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAgICAg
ICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1RUTCcsIGtleSwga2V5PWtleSkKCiAgICBk
ZWYgZXhwaXJlKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10sIHNlY29uZHM6IGludCkgLT4g
aW50OgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnRVhQSVJFJywga2V5LCBz
ZWNvbmRzLCBrZXk9a2V5KQoKICAgIGRlZiBwZXJzaXN0KHNlbGYsIGtleTogVW5pb25bc3RyLCBi
eXRlc10pIC0+IGludDoKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1BFUlNJ
U1QnLCBrZXksIGtleT1rZXkpCgogICAgZGVmIHJlbmFtZShzZWxmLCBvbGQ6IFVuaW9uW3N0ciwg
Ynl0ZXNdLCBuZXc6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIHNl
bGYuZXhlY3V0ZV9jb21tYW5kKCdSRU5BTUUnLCBvbGQsIG5ldywga2V5PW9sZCkKCiAgICAjID09
PT09PT09PT09PSBTdHJpbmcgPT09PT09PT09PT09CgogICAgZGVmIGdldChzZWxmLCBrZXk6IFVu
aW9uW3N0ciwgYnl0ZXNdKSAtPiBPcHRpb25hbFtieXRlc106CiAgICAgICAgcmV0dXJuIHNlbGYu
ZXhlY3V0ZV9jb21tYW5kKCdHRVQnLCBrZXksIGtleT1rZXkpCgogICAgZGVmIHNldChzZWxmLCBr
ZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCB2YWx1ZTogVW5pb25bc3RyLCBieXRlcywgaW50LCBmbG9h
dF0sCiAgICAgICAgICAgIGV4OiBPcHRpb25hbFtpbnRdID0gTm9uZSwgcHg6IE9wdGlvbmFsW2lu
dF0gPSBOb25lLAogICAgICAgICAgICBueDogYm9vbCA9IEZhbHNlLCB4eDogYm9vbCA9IEZhbHNl
KSAtPiBPcHRpb25hbFtzdHJdOgogICAgICAgIGFyZ3MgPSBbJ1NFVCcsIGtleSwgdmFsdWVdCiAg
ICAgICAgaWYgZXggaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGFyZ3MuZXh0ZW5kKFsnRVgnLCBl
eF0pCiAgICAgICAgaWYgcHggaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGFyZ3MuZXh0ZW5kKFsn
UFgnLCBweF0pCiAgICAgICAgaWYgbng6CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCdOWCcpCiAg
ICAgICAgaWYgeHg6CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCdYWCcpCiAgICAgICAgcmV0dXJu
IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCphcmdzLCBrZXk9a2V5KQoKICAgIGRlZiBpbmNyKHNlbGYs
IGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAgICAgICByZXR1cm4gc2VsZi5leGVj
dXRlX2NvbW1hbmQoJ0lOQ1InLCBrZXksIGtleT1rZXkpCgogICAgZGVmIHN0cmxlbihzZWxmLCBr
ZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6CiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0
ZV9jb21tYW5kKCdTVFJMRU4nLCBrZXksIGtleT1rZXkpCgogICAgIyA9PT09PT09PT09PT0gSGFz
aCA9PT09PT09PT09PT0KCiAgICBkZWYgaGdldChzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNd
LCBmaWVsZDogVW5pb25bc3RyLCBieXRlc10pIC0+IE9wdGlvbmFsW2J5dGVzXToKICAgICAgICBy
ZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0hHRVQnLCBrZXksIGZpZWxkLCBrZXk9a2V5KQoK
ICAgIGRlZiBoc2V0KHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10sIGZpZWxkOiBPcHRpb25h
bFtVbmlvbltzdHIsIGJ5dGVzXV0gPSBOb25lLAogICAgICAgICAgICAgdmFsdWU6IE9wdGlvbmFs
W1VuaW9uW3N0ciwgYnl0ZXNdXSA9IE5vbmUsIG1hcHBpbmc6IE9wdGlvbmFsW0RpY3RdID0gTm9u
ZSkgLT4gaW50OgogICAgICAgIGFyZ3MgPSBbJ0hTRVQnLCBrZXldCiAgICAgICAgaWYgbWFwcGlu
ZzoKICAgICAgICAgICAgZm9yIGssIHYgaW4gbWFwcGluZy5pdGVtcygpOgogICAgICAgICAgICAg
ICAgYXJncy5leHRlbmQoW2ssIHZdKQogICAgICAgIGVsaWYgZmllbGQgaXMgbm90IE5vbmUgYW5k
IHZhbHVlIGlzIG5vdCBOb25lOgogICAgICAgICAgICBhcmdzLmV4dGVuZChbZmllbGQsIHZhbHVl
XSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJmaWVsZCt2YWx1
ZSBvciBtYXBwaW5nIHJlcXVpcmVkIikKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1h
bmQoKmFyZ3MsIGtleT1rZXkpCgogICAgZGVmIGhnZXRhbGwoc2VsZiwga2V5OiBVbmlvbltzdHIs
IGJ5dGVzXSkgLT4gRGljdFtieXRlcywgYnl0ZXNdOgogICAgICAgIHJlc3BvbnNlID0gc2VsZi5l
eGVjdXRlX2NvbW1hbmQoJ0hHRVRBTEwnLCBrZXksIGtleT1rZXkpCiAgICAgICAgcmVzdWx0ID0g
e30KICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4ocmVzcG9uc2UpLCAyKToKICAgICAgICAg
ICAgcmVzdWx0W3Jlc3BvbnNlW2ldXSA9IHJlc3BvbnNlW2kgKyAxXQogICAgICAgIHJldHVybiBy
ZXN1bHQKCiAgICBkZWYgaGxlbihzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6
CiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdITEVOJywga2V5LCBrZXk9a2V5
KQoKICAgIGRlZiBoc2NhbihzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCBjdXJzb3I6IGlu
dCA9IDAsCiAgICAgICAgICAgICAgbWF0Y2g6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBjb3VudDog
T3B0aW9uYWxbaW50XSA9IE5vbmUpIC0+IFR1cGxlW2ludCwgRGljdF06CiAgICAgICAgYXJncyA9
IFsnSFNDQU4nLCBrZXksIGN1cnNvcl0KICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgYXJn
cy5leHRlbmQoWydNQVRDSCcsIG1hdGNoXSkKICAgICAgICBpZiBjb3VudDoKICAgICAgICAgICAg
YXJncy5leHRlbmQoWydDT1VOVCcsIGNvdW50XSkKICAgICAgICByZXNwb25zZSA9IHNlbGYuZXhl
Y3V0ZV9jb21tYW5kKCphcmdzLCBrZXk9a2V5KQogICAgICAgIG5ld19jdXJzb3IgPSBpbnQocmVz
cG9uc2VbMF0pCiAgICAgICAgaXRlbXMgPSByZXNwb25zZVsxXQogICAgICAgIHJlc3VsdCA9IHt9
CiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKGl0ZW1zKSwgMik6CiAgICAgICAgICAgIHJl
c3VsdFtpdGVtc1tpXV0gPSBpdGVtc1tpICsgMV0KICAgICAgICByZXR1cm4gbmV3X2N1cnNvciwg
cmVzdWx0CgogICAgZGVmIGhzY2FuX2l0ZXIoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSwg
bWF0Y2g6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCAKICAgICAgICAgICAgICAgICAgIGNvdW50OiBp
bnQgPSAxMDApIC0+IEl0ZXJhdG9yW1R1cGxlW2J5dGVzLCBieXRlc11dOgogICAgICAgIGN1cnNv
ciA9IDAKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjdXJzb3IsIGRhdGEgPSBzZWxm
LmhzY2FuKGtleSwgY3Vyc29yLCBtYXRjaD1tYXRjaCwgY291bnQ9Y291bnQpCiAgICAgICAgICAg
IGZvciBmaWVsZCwgdmFsdWUgaW4gZGF0YS5pdGVtcygpOgogICAgICAgICAgICAgICAgeWllbGQg
ZmllbGQsIHZhbHVlCiAgICAgICAgICAgIGlmIGN1cnNvciA9PSAwOgogICAgICAgICAgICAgICAg
YnJlYWsKCiAgICAjID09PT09PT09PT09PSBMaXN0ID09PT09PT09PT09PQoKICAgIGRlZiBscHVz
aChzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCAqdmFsdWVzKSAtPiBpbnQ6CiAgICAgICAg
cmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdMUFVTSCcsIGtleSwgKnZhbHVlcywga2V5PWtl
eSkKCiAgICBkZWYgcnB1c2goc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSwgKnZhbHVlcykg
LT4gaW50OgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnUlBVU0gnLCBrZXks
ICp2YWx1ZXMsIGtleT1rZXkpCgogICAgZGVmIGxsZW4oc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5
dGVzXSkgLT4gaW50OgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnTExFTics
IGtleSwga2V5PWtleSkKCiAgICBkZWYgbHJhbmdlKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRl
c10sIHN0YXJ0OiBpbnQsIHN0b3A6IGludCkgLT4gTGlzdFtieXRlc106CiAgICAgICAgcmV0dXJu
IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdMUkFOR0UnLCBrZXksIHN0YXJ0LCBzdG9wLCBrZXk9a2V5
KQoKICAgICMgPT09PT09PT09PT09IFNldCA9PT09PT09PT09PT0KCiAgICBkZWYgc2FkZChzZWxm
LCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCAqbWVtYmVycykgLT4gaW50OgogICAgICAgIHJldHVy
biBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnU0FERCcsIGtleSwgKm1lbWJlcnMsIGtleT1rZXkpCgog
ICAgZGVmIHNtZW1iZXJzKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IHNldDoKICAg
ICAgICByZXN1bHQgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnU01FTUJFUlMnLCBrZXksIGtleT1r
ZXkpCiAgICAgICAgcmV0dXJuIHNldChyZXN1bHQpIGlmIHJlc3VsdCBlbHNlIHNldCgpCgogICAg
ZGVmIHNjYXJkKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAgICAgICBy
ZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1NDQVJEJywga2V5LCBrZXk9a2V5KQoKICAgIGRl
ZiBzc2NhbihzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCBjdXJzb3I6IGludCA9IDAsCiAg
ICAgICAgICAgICAgbWF0Y2g6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBjb3VudDogT3B0aW9uYWxb
aW50XSA9IE5vbmUpIC0+IFR1cGxlW2ludCwgTGlzdFtieXRlc11dOgogICAgICAgIGFyZ3MgPSBb
J1NTQ0FOJywga2V5LCBjdXJzb3JdCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICAgIGFyZ3Mu
ZXh0ZW5kKFsnTUFUQ0gnLCBtYXRjaF0pCiAgICAgICAgaWYgY291bnQ6CiAgICAgICAgICAgIGFy
Z3MuZXh0ZW5kKFsnQ09VTlQnLCBjb3VudF0pCiAgICAgICAgcmVzcG9uc2UgPSBzZWxmLmV4ZWN1
dGVfY29tbWFuZCgqYXJncywga2V5PWtleSkKICAgICAgICByZXR1cm4gaW50KHJlc3BvbnNlWzBd
KSwgcmVzcG9uc2VbMV0KCiAgICBkZWYgc3NjYW5faXRlcihzZWxmLCBrZXk6IFVuaW9uW3N0ciwg
Ynl0ZXNdLCBtYXRjaDogT3B0aW9uYWxbc3RyXSA9IE5vbmUsIAogICAgICAgICAgICAgICAgICAg
Y291bnQ6IGludCA9IDEwMCkgLT4gSXRlcmF0b3JbYnl0ZXNdOgogICAgICAgIGN1cnNvciA9IDAK
ICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjdXJzb3IsIG1lbWJlcnMgPSBzZWxmLnNz
Y2FuKGtleSwgY3Vyc29yLCBtYXRjaD1tYXRjaCwgY291bnQ9Y291bnQpCiAgICAgICAgICAgIGZv
ciBtZW1iZXIgaW4gbWVtYmVyczoKICAgICAgICAgICAgICAgIHlpZWxkIG1lbWJlcgogICAgICAg
ICAgICBpZiBjdXJzb3IgPT0gMDoKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgIyA9PT09PT09
PT09PT0gU29ydGVkIFNldCA9PT09PT09PT09PT0KCiAgICBkZWYgemFkZChzZWxmLCBrZXk6IFVu
aW9uW3N0ciwgYnl0ZXNdLCBtYXBwaW5nOiBEaWN0W1VuaW9uW3N0ciwgYnl0ZXNdLCBmbG9hdF0s
CiAgICAgICAgICAgICBueDogYm9vbCA9IEZhbHNlLCB4eDogYm9vbCA9IEZhbHNlLCBndDogYm9v
bCA9IEZhbHNlLCBsdDogYm9vbCA9IEZhbHNlKSAtPiBpbnQ6CiAgICAgICAgYXJncyA9IFsnWkFE
RCcsIGtleV0KICAgICAgICBpZiBueDoKICAgICAgICAgICAgYXJncy5hcHBlbmQoJ05YJykKICAg
ICAgICBpZiB4eDoKICAgICAgICAgICAgYXJncy5hcHBlbmQoJ1hYJykKICAgICAgICBpZiBndDoK
ICAgICAgICAgICAgYXJncy5hcHBlbmQoJ0dUJykKICAgICAgICBpZiBsdDoKICAgICAgICAgICAg
YXJncy5hcHBlbmQoJ0xUJykKICAgICAgICBmb3IgbWVtYmVyLCBzY29yZSBpbiBtYXBwaW5nLml0
ZW1zKCk6CiAgICAgICAgICAgIGFyZ3MuZXh0ZW5kKFtzY29yZSwgbWVtYmVyXSkKICAgICAgICBy
ZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoKmFyZ3MsIGtleT1rZXkpCgogICAgZGVmIHpjYXJk
KHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAgICAgICByZXR1cm4gc2Vs
Zi5leGVjdXRlX2NvbW1hbmQoJ1pDQVJEJywga2V5LCBrZXk9a2V5KQoKICAgIGRlZiB6cmFuZ2Uo
c2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSwgc3RhcnQ6IGludCwgc3RvcDogaW50LAogICAg
ICAgICAgICAgICB3aXRoc2NvcmVzOiBib29sID0gRmFsc2UsIGRlc2M6IGJvb2wgPSBGYWxzZSkg
LT4gTGlzdDoKICAgICAgICBhcmdzID0gWydaUkFOR0UnLCBrZXksIHN0YXJ0LCBzdG9wXQogICAg
ICAgIGlmIHdpdGhzY29yZXM6CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCdXSVRIU0NPUkVTJykK
ICAgICAgICByZXNwb25zZSA9IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCphcmdzLCBrZXk9a2V5KQog
ICAgICAgIGlmIHdpdGhzY29yZXMgYW5kIHJlc3BvbnNlOgogICAgICAgICAgICByZXN1bHQgPSBb
XQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4ocmVzcG9uc2UpLCAyKToKICAgICAg
ICAgICAgICAgIHJlc3VsdC5hcHBlbmQoKHJlc3BvbnNlW2ldLCBmbG9hdChyZXNwb25zZVtpICsg
MV0pKSkKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIHJldHVybiByZXNwb25zZQoK
ICAgIGRlZiB6c2NhbihzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCBjdXJzb3I6IGludCA9
IDAsCiAgICAgICAgICAgICAgbWF0Y2g6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBjb3VudDogT3B0
aW9uYWxbaW50XSA9IE5vbmUpIC0+IFR1cGxlW2ludCwgTGlzdF06CiAgICAgICAgYXJncyA9IFsn
WlNDQU4nLCBrZXksIGN1cnNvcl0KICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgYXJncy5l
eHRlbmQoWydNQVRDSCcsIG1hdGNoXSkKICAgICAgICBpZiBjb3VudDoKICAgICAgICAgICAgYXJn
cy5leHRlbmQoWydDT1VOVCcsIGNvdW50XSkKICAgICAgICByZXNwb25zZSA9IHNlbGYuZXhlY3V0
ZV9jb21tYW5kKCphcmdzLCBrZXk9a2V5KQogICAgICAgIG5ld19jdXJzb3IgPSBpbnQocmVzcG9u
c2VbMF0pCiAgICAgICAgaXRlbXMgPSByZXNwb25zZVsxXQogICAgICAgIHJlc3VsdCA9IFtdCiAg
ICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKGl0ZW1zKSwgMik6CiAgICAgICAgICAgIHJlc3Vs
dC5hcHBlbmQoKGl0ZW1zW2ldLCBmbG9hdChpdGVtc1tpICsgMV0pKSkKICAgICAgICByZXR1cm4g
bmV3X2N1cnNvciwgcmVzdWx0CgogICAgZGVmIHpzY2FuX2l0ZXIoc2VsZiwga2V5OiBVbmlvbltz
dHIsIGJ5dGVzXSwgbWF0Y2g6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCAKICAgICAgICAgICAgICAg
ICAgIGNvdW50OiBpbnQgPSAxMDApIC0+IEl0ZXJhdG9yW1R1cGxlW2J5dGVzLCBmbG9hdF1dOgog
ICAgICAgIGN1cnNvciA9IDAKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjdXJzb3Is
IGl0ZW1zID0gc2VsZi56c2NhbihrZXksIGN1cnNvciwgbWF0Y2g9bWF0Y2gsIGNvdW50PWNvdW50
KQogICAgICAgICAgICBmb3IgbWVtYmVyLCBzY29yZSBpbiBpdGVtczoKICAgICAgICAgICAgICAg
IHlpZWxkIG1lbWJlciwgc2NvcmUKICAgICAgICAgICAgaWYgY3Vyc29yID09IDA6CiAgICAgICAg
ICAgICAgICBicmVhawoKICAgICMgPT09PT09PT09PT09IFNlcnZlciA9PT09PT09PT09PT0KCiAg
ICBkZWYgY29uZmlnX2dldChzZWxmLCBwYXJhbWV0ZXI6IHN0cikgLT4gRGljdDoKICAgICAgICBy
ZXNwb25zZSA9IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdDT05GSUcnLCAnR0VUJywgcGFyYW1ldGVy
KQogICAgICAgIHJlc3VsdCA9IHt9CiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKHJlc3Bv
bnNlKSwgMik6CiAgICAgICAgICAgIGtleSA9IHJlc3BvbnNlW2ldCiAgICAgICAgICAgIGlmIGlz
aW5zdGFuY2Uoa2V5LCBieXRlcyk6CiAgICAgICAgICAgICAgICBrZXkgPSBrZXkuZGVjb2RlKCd1
dGYtOCcpCiAgICAgICAgICAgIHZhbHVlID0gcmVzcG9uc2VbaSArIDFdCiAgICAgICAgICAgIGlm
IGlzaW5zdGFuY2UodmFsdWUsIGJ5dGVzKToKICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUu
ZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWUKICAgICAgICBy
ZXR1cm4gcmVzdWx0CgogICAgZGVmIGNsaWVudF9saXN0KHNlbGYpIC0+IHN0cjoKICAgICAgICBy
ZXNwb25zZSA9IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdDTElFTlQnLCAnTElTVCcpCiAgICAgICAg
aWYgaXNpbnN0YW5jZShyZXNwb25zZSwgYnl0ZXMpOgogICAgICAgICAgICByZXR1cm4gcmVzcG9u
c2UuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlCgogICAgIyA9PT09PT09
PT09PT0gQ2x1c3RlciA9PT09PT09PT09PT0KCiAgICBkZWYga2V5c2xvdChzZWxmLCBrZXk6IFVu
aW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6CiAgICAgICAgIiIi0JLRi9GH0LjRgdC70Y/QtdGCIGhh
c2ggc2xvdCDQtNC70Y8g0LrQu9GO0YfQsCAoQ1JDMTYgJSAxNjM4NCkiIiIKICAgICAgICByZXR1
cm4gc2VsZi5fZ2V0X3Nsb3Qoa2V5KQoKICAgIGRlZiBnZXRfbm9kZV9mcm9tX2tleShzZWxmLCBr
ZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBDbHVzdGVyTm9kZToKICAgICAgICAiIiLQktC+0LfQ
stGA0LDRidCw0LXRgiDQuNC90YTQvtGA0LzQsNGG0LjRjiDQvtCxINGD0LfQu9C1INC00LvRjyDQ
utC70Y7Rh9CwIiIiCiAgICAgICAgaWYgbm90IHNlbGYuaXNfY2x1c3RlcjoKICAgICAgICAgICAg
cmV0dXJuIENsdXN0ZXJOb2RlKAogICAgICAgICAgICAgICAgaG9zdD1zZWxmLmhvc3QsCiAgICAg
ICAgICAgICAgICBwb3J0PXNlbGYucG9ydCwKICAgICAgICAgICAgICAgIG5vZGVfaWQ9ZiJ7c2Vs
Zi5ob3N0fTp7c2VsZi5wb3J0fSIsCiAgICAgICAgICAgICAgICBzbG90cz1bXQogICAgICAgICAg
ICApCgogICAgICAgIHNsb3QgPSBzZWxmLl9nZXRfc2xvdChrZXkpCiAgICAgICAgbm9kZV9pZCA9
IHNlbGYuY2x1c3Rlcl9zbG90cy5nZXQoc2xvdCkKCiAgICAgICAgaWYgbm9kZV9pZCBhbmQgbm9k
ZV9pZCBpbiBzZWxmLmNsdXN0ZXJfbm9kZXM6CiAgICAgICAgICAgIGhvc3QsIHBvcnQgPSBub2Rl
X2lkLnNwbGl0KCc6JykKICAgICAgICAgICAgcmV0dXJuIENsdXN0ZXJOb2RlKAogICAgICAgICAg
ICAgICAgaG9zdD1ob3N0LAogICAgICAgICAgICAgICAgcG9ydD1pbnQocG9ydCksCiAgICAgICAg
ICAgICAgICBub2RlX2lkPW5vZGVfaWQsCiAgICAgICAgICAgICAgICBzbG90cz1bc2xvdF0KICAg
ICAgICAgICAgKQoKICAgICAgICByZXR1cm4gQ2x1c3Rlck5vZGUoCiAgICAgICAgICAgIGhvc3Q9
c2VsZi5ob3N0LAogICAgICAgICAgICBwb3J0PXNlbGYucG9ydCwKICAgICAgICAgICAgbm9kZV9p
ZD1mIntzZWxmLmhvc3R9OntzZWxmLnBvcnR9IiwKICAgICAgICAgICAgc2xvdHM9W10KICAgICAg
ICApCgogICAgZGVmIGNsdXN0ZXJfa2V5c2xvdChzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNd
KSAtPiBpbnQ6CiAgICAgICAgIiIiQ0xVU1RFUiBLRVlTTE9UIC0g0YHQv9GA0L7RgdC40YLRjCDR
gdC10YDQstC10YAg0L4g0YHQu9C+0YLQtSIiIgogICAgICAgIGlmIG5vdCBzZWxmLmlzX2NsdXN0
ZXI6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9nZXRfc2xvdChrZXkpCiAgICAgICAgdHJ5Ogog
ICAgICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0NMVVNURVInLCAnS0VZU0xP
VCcsIGtleSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9nZXRfc2xv
dChrZXkpCgogICAgZGVmIGdldF9jbHVzdGVyX25vZGVzKHNlbGYpIC0+IExpc3RbQ2x1c3Rlck5v
ZGVdOgogICAgICAgICIiItCh0L/QuNGB0L7QuiDQstGB0LXRhSDRg9C30LvQvtCyINC60LvQsNGB
0YLQtdGA0LAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5pc19jbHVzdGVyOgogICAgICAgICAgICBy
ZXR1cm4gW0NsdXN0ZXJOb2RlKAogICAgICAgICAgICAgICAgaG9zdD1zZWxmLmhvc3QsCiAgICAg
ICAgICAgICAgICBwb3J0PXNlbGYucG9ydCwKICAgICAgICAgICAgICAgIG5vZGVfaWQ9ZiJ7c2Vs
Zi5ob3N0fTp7c2VsZi5wb3J0fSIsCiAgICAgICAgICAgICAgICBzbG90cz1bXQogICAgICAgICAg
ICApXQoKICAgICAgICBub2RlcyA9IFtdCiAgICAgICAgZm9yIG5vZGVfaWQsIGNvbm4gaW4gc2Vs
Zi5jbHVzdGVyX25vZGVzLml0ZW1zKCk6CiAgICAgICAgICAgIGhvc3QsIHBvcnQgPSBub2RlX2lk
LnNwbGl0KCc6JykKICAgICAgICAgICAgc2xvdHMgPSBbc2xvdCBmb3Igc2xvdCwgbmlkIGluIHNl
bGYuY2x1c3Rlcl9zbG90cy5pdGVtcygpIGlmIG5pZCA9PSBub2RlX2lkXQogICAgICAgICAgICBu
b2Rlcy5hcHBlbmQoQ2x1c3Rlck5vZGUoCiAgICAgICAgICAgICAgICBob3N0PWhvc3QsCiAgICAg
ICAgICAgICAgICBwb3J0PWludChwb3J0KSwKICAgICAgICAgICAgICAgIG5vZGVfaWQ9bm9kZV9p
ZCwKICAgICAgICAgICAgICAgIHNsb3RzPXNsb3RzCiAgICAgICAgICAgICkpCiAgICAgICAgcmV0
dXJuIG5vZGVzCgogICAgZGVmIHNjYW5fYWxsX25vZGVzX2l0ZXIoc2VsZiwgbWF0Y2g6IE9wdGlv
bmFsW3N0cl0gPSBOb25lLCBjb3VudDogaW50ID0gMTAwKSAtPiBJdGVyYXRvcltieXRlc106CiAg
ICAgICAgIiIi0JjRgtC10YDQsNGC0L7RgCDQv9C+INCS0KHQldCcINC60LvRjtGH0LDQvCDQutC7
0LDRgdGC0LXRgNCwICjQstGB0LUg0YPQt9C70YspIiIiCiAgICAgICAgaWYgbm90IHNlbGYuaXNf
Y2x1c3RlcjoKICAgICAgICAgICAgeWllbGQgZnJvbSBzZWxmLnNjYW5faXRlcihtYXRjaD1tYXRj
aCwgY291bnQ9Y291bnQpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZWVuX2tleXMgPSBz
ZXQoKQoKICAgICAgICBmb3Igbm9kZV9pZCwgbm9kZV9jb25uIGluIHNlbGYuY2x1c3Rlcl9ub2Rl
cy5pdGVtcygpOgogICAgICAgICAgICBsb2dnZXIuZGVidWcoZiJTY2FubmluZyBub2RlIHtub2Rl
X2lkfSIpCiAgICAgICAgICAgIGN1cnNvciA9IDAKICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAg
ICAgICAgICAgICAgIGFyZ3MgPSBbJ1NDQU4nLCBjdXJzb3JdCiAgICAgICAgICAgICAgICBpZiBt
YXRjaDoKICAgICAgICAgICAgICAgICAgICBhcmdzLmV4dGVuZChbJ01BVENIJywgbWF0Y2hdKQog
ICAgICAgICAgICAgICAgaWYgY291bnQ6CiAgICAgICAgICAgICAgICAgICAgYXJncy5leHRlbmQo
WydDT1VOVCcsIGNvdW50XSkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAg
ICByZXNwb25zZSA9IG5vZGVfY29ubi5leGVjdXRlX2NvbW1hbmQoKmFyZ3MpCiAgICAgICAgICAg
ICAgICAgICAgY3Vyc29yID0gaW50KHJlc3BvbnNlWzBdKQogICAgICAgICAgICAgICAgICAgIGtl
eXMgPSByZXNwb25zZVsxXQogICAgICAgICAgICAgICAgICAgIGZvciBrZXkgaW4ga2V5czoKICAg
ICAgICAgICAgICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBzZWVuX2tleXM6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzZWVuX2tleXMuYWRkKGtleSkKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHlpZWxkIGtleQogICAgICAgICAgICAgICAgICAgIGlmIGN1cnNvciA9PSAwOgogICAg
ICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlv
biBhcyBlOgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHNjYW5uaW5n
IG5vZGUge25vZGVfaWR9OiB7ZX0iKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgZGVm
IGNsdXN0ZXJfaW5mbyhzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIiQ0xVU1RFUiBJTkZPIiIiCiAg
ICAgICAgcmVzcG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnQ0xVU1RFUicsICdJTkZPJykK
ICAgICAgICBpZiBpc2luc3RhbmNlKHJlc3BvbnNlLCBieXRlcyk6CiAgICAgICAgICAgIHJldHVy
biByZXNwb25zZS5kZWNvZGUoJ3V0Zi04JykKICAgICAgICByZXR1cm4gcmVzcG9uc2UKCiAgICBk
ZWYgY2x1c3Rlcl9ub2RlcyhzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIiQ0xVU1RFUiBOT0RFUyIi
IgogICAgICAgIHJlc3BvbnNlID0gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0NMVVNURVInLCAnTk9E
RVMnKQogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzcG9uc2UsIGJ5dGVzKToKICAgICAgICAgICAg
cmV0dXJuIHJlc3BvbnNlLmRlY29kZSgndXRmLTgnKQogICAgICAgIHJldHVybiByZXNwb25zZQoK
ICAgICMgPT09PT09PT09PT09IFBpcGVsaW5lID09PT09PT09PT09PQoKICAgIGRlZiBwaXBlbGlu
ZShzZWxmLCB0cmFuc2FjdGlvbjogYm9vbCA9IFRydWUsIHNoYXJkX2hpbnQ6IE9wdGlvbmFsW3N0
cl0gPSBOb25lKToKICAgICAgICAiIiJQaXBlbGluZSDQtNC70Y8gYmF0Y2gg0L7Qv9C10YDQsNGG
0LjQuSIiIgogICAgICAgIHJldHVybiBSZWRpc1BpcGVsaW5lKHNlbGYpCgogICAgIyA9PT09PT09
PT09PT0gQ2xvc2UgPT09PT09PT09PT09CgogICAgZGVmIGNsb3NlKHNlbGYpOgogICAgICAgICIi
ItCX0LDQutGA0YvRgtGMINCy0YHQtSDQv9C+0LTQutC70Y7Rh9C10L3QuNGPIiIiCiAgICAgICAg
aWYgc2VsZi5jb25uZWN0aW9uOgogICAgICAgICAgICBzZWxmLmNvbm5lY3Rpb24uY2xvc2UoKQog
ICAgICAgIGZvciBjb25uIGluIHNlbGYuY2x1c3Rlcl9ub2Rlcy52YWx1ZXMoKToKICAgICAgICAg
ICAgY29ubi5jbG9zZSgpCiAgICAgICAgc2VsZi5jbHVzdGVyX25vZGVzLmNsZWFyKCkKCgpjbGFz
cyBSZWRpc1BpcGVsaW5lOgogICAgIiIi0KPQv9GA0L7RidC10L3QvdGL0LkgUGlwZWxpbmUiIiIK
CiAgICBkZWYgX19pbml0X18oc2VsZiwgY2xpZW50OiBSZWRpc0NsaWVudCk6CiAgICAgICAgc2Vs
Zi5jbGllbnQgPSBjbGllbnQKICAgICAgICBzZWxmLmNvbW1hbmRzID0gW10KCiAgICBkZWYgZXhl
Y3V0ZShzZWxmKToKICAgICAgICByZXN1bHRzID0gW10KICAgICAgICBmb3IgY21kLCBhcmdzLCBr
d2FyZ3MgaW4gc2VsZi5jb21tYW5kczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAg
cmVzdWx0cy5hcHBlbmQoZ2V0YXR0cihzZWxmLmNsaWVudCwgY21kKSgqYXJncywgKiprd2FyZ3Mp
KQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICByZXN1
bHRzLmFwcGVuZChlKQogICAgICAgIHNlbGYuY29tbWFuZHMuY2xlYXIoKQogICAgICAgIHJldHVy
biByZXN1bHRzCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoK
ICAgIGRlZiBfX2V4aXRfXyhzZWxmLCBleGNfdHlwZSwgZXhjX3ZhbCwgZXhjX3RiKToKICAgICAg
ICBpZiBleGNfdHlwZSBpcyBOb25lOgogICAgICAgICAgICBzZWxmLmV4ZWN1dGUoKQogICAgICAg
IHJldHVybiBGYWxzZQoKICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKICAgICAgICBk
ZWYgbWV0aG9kKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHNlbGYuY29tbWFuZHMuYXBw
ZW5kKChuYW1lLCBhcmdzLCBrd2FyZ3MpKQogICAgICAgICAgICByZXR1cm4gc2VsZgogICAgICAg
IHJldHVybiBtZXRob2QKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABjb25maWdfZW5jcnlwdG9yLnB5AAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAMDAwMDc3MAAwMDAwMDAwADAwMDE3MzQAMDAwMDAwMDM3MzYAMTUxMzE3NzA2
NDEAMDE0MDYxACAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHVz
dGFyICAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB2Ym94c2YAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMhL3Vzci9iaW4vZW52IHB5dGhvbjMKaW1wb3J0IHN5
cwppbXBvcnQganNvbgppbXBvcnQgYmFzZTY0CmltcG9ydCBvcwppbXBvcnQgZ2V0cGFzcwpmcm9t
IGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIGNyeXB0b2dyYXBoeS5oYXpt
YXQucHJpbWl0aXZlcyBpbXBvcnQgaGFzaGVzCmZyb20gY3J5cHRvZ3JhcGh5Lmhhem1hdC5wcmlt
aXRpdmVzLmtkZi5wYmtkZjIgaW1wb3J0IFBCS0RGMkhNQUMKZnJvbSBjcnlwdG9ncmFwaHkuaGF6
bWF0LmJhY2tlbmRzIGltcG9ydCBkZWZhdWx0X2JhY2tlbmQKCmRlZiBkZXJpdmVfa2V5KHBhc3N3
b3JkLCBzYWx0KToKICAgICIiItCT0LXQvdC10YDQsNGG0LjRjyDQutC70Y7Rh9CwINC40Lcg0L/Q
sNGA0L7Qu9GPINC4INGB0L7Qu9C4IiIiCiAgICBrZGYgPSBQQktERjJITUFDKAogICAgICAgIGFs
Z29yaXRobT1oYXNoZXMuU0hBMjU2KCksCiAgICAgICAgbGVuZ3RoPTMyLAogICAgICAgIHNhbHQ9
c2FsdCwKICAgICAgICBpdGVyYXRpb25zPTEwMDAwMCwKICAgICAgICBiYWNrZW5kPWRlZmF1bHRf
YmFja2VuZCgpIAogICAgKQogICAgcmV0dXJuIGJhc2U2NC51cmxzYWZlX2I2NGVuY29kZShrZGYu
ZGVyaXZlKHBhc3N3b3JkLmVuY29kZSgpKSkKCmRlZiBlbmNyeXB0X2ZpbGUoaW5wdXRfZmlsZSwg
b3V0cHV0X2ZpbGUpOgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGlucHV0X2ZpbGUpOgogICAg
ICAgIHByaW50KGYiRXJyb3I6IElucHV0IGZpbGUgJ3tpbnB1dF9maWxlfScgbm90IGZvdW5kLiIp
CiAgICAgICAgcmV0dXJuCgogICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihpbnB1dF9maWxlLCAn
cmInKSBhcyBmOgogICAgICAgICAgICBkYXRhID0gZi5yZWFkKCkKICAgICAgICAgICAgIyDQn9GA
0L7QstC10YDQutCwINCy0LDQu9C40LTQvdC+0YHRgtC4IEpTT04g0L/QtdGA0LXQtCDRiNC40YTR
gNC+0LLQsNC90LjQtdC8CiAgICAgICAgICAgIGpzb24ubG9hZHMoZGF0YSkKICAgIGV4Y2VwdCBq
c29uLkpTT05EZWNvZGVFcnJvcjoKICAgICAgICBwcmludCgiRXJyb3I6IElucHV0IGZpbGUgaXMg
bm90IHZhbGlkIEpTT04uIikKICAgICAgICByZXR1cm4KCiAgICBwYXNzd29yZCA9IGdldHBhc3Mu
Z2V0cGFzcygiRW50ZXIgcGFzc3dvcmQgZm9yIGVuY3J5cHRpb246ICIpCiAgICBjb25maXJtID0g
Z2V0cGFzcy5nZXRwYXNzKCJDb25maXJtIHBhc3N3b3JkOiAiKQogICAgCiAgICBpZiBwYXNzd29y
ZCAhPSBjb25maXJtOgogICAgICAgIHByaW50KCJFcnJvcjogUGFzc3dvcmRzIGRvIG5vdCBtYXRj
aC4iKQogICAgICAgIHJldHVybgoKICAgICMg0JPQtdC90LXRgNC40YDRg9C10Lwg0YHQu9GD0YfQ
sNC50L3Rg9GOINGB0L7Qu9GMICgxNiDQsdCw0LnRgikKICAgIHNhbHQgPSBvcy51cmFuZG9tKDE2
KQogICAga2V5ID0gZGVyaXZlX2tleShwYXNzd29yZCwgc2FsdCkKICAgIGYgPSBGZXJuZXQoa2V5
KQogICAgCiAgICBlbmNyeXB0ZWRfZGF0YSA9IGYuZW5jcnlwdChkYXRhKQoKICAgICMg0KHQvtGF
0YDQsNC90Y/QtdC8OiDQv9C10YDQstGL0LUgMTYg0LHQsNC50YIgLSDRgdC+0LvRjCwg0L7RgdGC
0LDQu9GM0L3QvtC1IC0g0LTQsNC90L3Ri9C1CiAgICB3aXRoIG9wZW4ob3V0cHV0X2ZpbGUsICd3
YicpIGFzIGY6CiAgICAgICAgZi53cml0ZShzYWx0ICsgZW5jcnlwdGVkX2RhdGEpCiAgICAKICAg
IHByaW50KGYiU3VjY2VzcyEgRW5jcnlwdGVkIGNvbmZpZyBzYXZlZCB0byAne291dHB1dF9maWxl
fSciKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGlmIGxlbihzeXMuYXJndikgIT0g
MzoKICAgICAgICBwcmludCgiVXNhZ2U6IHB5dGhvbjMgY29uZmlnX2VuY3J5cHRvci5weSA8aW5w
dXRfanNvbj4gPG91dHB1dF9lbmM+IikKICAgICAgICBwcmludCgiRXhhbXBsZTogcHl0aG9uMyBj
b25maWdfZW5jcnlwdG9yLnB5IGNvbmZpZy5qc29uIGNvbmZpZy5lbmMiKQogICAgZWxzZToKICAg
ICAgICBlbmNyeXB0X2ZpbGUoc3lzLmFyZ3ZbMV0sIHN5cy5hcmd2WzJdKQoAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAA==
