cmVkaXNfY29tbWFuZGVyX3R1aS12MS4xLjEucHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA3NzAAMDAwMDAw
MAAwMDAxNzM0ADAwMDAwNDM1MTY1ADE1MTMyMTc1MTQxADAxNTM0NQAgMAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAdmJveHNmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAj
IS91c3IvYmluL2VudiBweXRob24zCiIiIgpSZWRpcyBDb21tYW5kZXIgVFVJIC0gVGVybWluYWwg
VXNlciBJbnRlcmZhY2Ug0LIg0YHRgtC40LvQtSBSZWRpcyBDb21tYW5kZXIK0J/QvtC70L3QsNGP
INGE0YPQvdC60YbQuNC+0L3QsNC70YzQvdC+0YHRgtGMOiDQv9GA0L7RgdC80L7RgtGAINC60LvR
jtGH0LXQuSwg0LLRi9C/0L7Qu9C90LXQvdC40LUg0LrQvtC80LDQvdC0LCDQtNC+0LHQsNCy0LvQ
tdC90LjQtSDQutC70Y7Rh9C10LkKIiIiCgppbXBvcnQgdXJ3aWQKIyBpbXBvcnQgcmVkaXMKZnJv
bSBzaW1wbGVfcmVkaXNfY2xpZW50IGltcG9ydCBSZWRpc0NsaWVudCwgUmVkaXNFcnJvciwgUmVk
aXNDb25uZWN0aW9uRXJyb3IsIFJlZGlzQ2x1c3RlckVycm9yCmltcG9ydCBhcmdwYXJzZQppbXBv
cnQganNvbgppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgdGltZQpmcm9tIGRhdGV0aW1lIGlt
cG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgRGljdCwgQW55LCBPcHRpb25h
bCwgVHVwbGUKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgT3JkZXJlZERpY3QsIGRlZmF1bHRkaWN0
CmltcG9ydCBsb2dnaW5nCmltcG9ydCBiYXNlNjQKaW1wb3J0IGdldHBhc3MKZnJvbSB0eXBpbmcg
aW1wb3J0IERpY3QKIyDQlNC70Y8g0YjQuNGE0YDQvtCy0LDQvdC40Y8gKNC90YPQttC10L0gcGlw
IGluc3RhbGwgY3J5cHRvZ3JhcGh5KQp0cnk6CiAgICBmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQg
aW1wb3J0IEZlcm5ldAogICAgZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LnByaW1pdGl2ZXMgaW1w
b3J0IGhhc2hlcwogICAgZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LnByaW1pdGl2ZXMua2RmLnBi
a2RmMiBpbXBvcnQgUEJLREYySE1BQwogICAgZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LmJhY2tl
bmRzIGltcG9ydCBkZWZhdWx0X2JhY2tlbmQKICAgIEhBU19DUllQVE8gPSBUcnVlCmV4Y2VwdCBJ
bXBvcnRFcnJvcjoKICAgIEhBU19DUllQVE8gPSBGYWxzZQoKCl9fVkVSU0lPTl9fID0gIjEuMS4x
IgpfX0FVVEhPUl9fID0gItCi0LDRgNCw0YHQvtCyINCU0LzQuNGC0YDQuNC5IgoKIyDQndCw0YHR
gtGA0L7QudC60LAg0LvQvtCz0LjRgNC+0LLQsNC90LjRjwpsb2dnaW5nLmJhc2ljQ29uZmlnKAog
ICAgZmlsZW5hbWU9J3JlZGlzX3R1aV9hdWRpdC5sb2cnLAogICAgbGV2ZWw9bG9nZ2luZy5JTkZP
LAogICAgZm9ybWF0PSclKGFzY3RpbWUpcyAtICUobGV2ZWxuYW1lKXMgLSAlKG1lc3NhZ2UpcycK
KQpsb2dnZXIgPSBsb2dnaW5nLmdldExvZ2dlcigncmVkaXNfY29tbWFuZGVyX3R1aScpCgoKY2xh
c3MgQ29ubmVjdGlvblByb2ZpbGU6CiAgICAiIiLQn9GA0L7RhNC40LvRjCDQv9C+0LTQutC70Y7R
h9C10L3QuNGPINC6IFJlZGlzIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZTogc3RyLCBo
b3N0OiBzdHIgPSAnbG9jYWxob3N0JywgcG9ydDogaW50ID0gNjM3OSwKICAgICAgICAgICAgIHBh
c3N3b3JkOiBPcHRpb25hbFtzdHJdID0gTm9uZSwgdXNlcm5hbWU6IE9wdGlvbmFsW3N0cl0gPSBO
b25lLAogICAgICAgICAgICAgc3NsOiBib29sID0gRmFsc2UsIHNzbF9jYV9jZXJ0czogT3B0aW9u
YWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICBzc2xfY2VydGZpbGU6IE9wdGlvbmFsW3N0cl0g
PSBOb25lLCBzc2xfa2V5ZmlsZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICBz
b2NrZXRfcGF0aDogT3B0aW9uYWxbc3RyXSA9IE5vbmUsIHJlYWRvbmx5OiBib29sID0gRmFsc2Us
CiAgICAgICAgICAgICBjbHVzdGVyX21vZGU6IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgIGNs
dXN0ZXJfbm9kZXM6IE9wdGlvbmFsW0xpc3RbVHVwbGVbc3RyLCBpbnRdXV0gPSBOb25lKTogICMg
0J3QvtC00Ysg0LTQu9GPINC60LvQsNGB0YLQtdGA0LAKICAgICAgICBzZWxmLm5hbWUgPSBuYW1l
CiAgICAgICAgc2VsZi5ob3N0ID0gaG9zdAogICAgICAgIHNlbGYucG9ydCA9IHBvcnQKICAgICAg
ICBzZWxmLnBhc3N3b3JkID0gcGFzc3dvcmQKICAgICAgICBzZWxmLnVzZXJuYW1lID0gdXNlcm5h
bWUKICAgICAgICBzZWxmLnNzbCA9IHNzbAogICAgICAgIHNlbGYuc3NsX2NhX2NlcnRzID0gc3Ns
X2NhX2NlcnRzCiAgICAgICAgc2VsZi5zc2xfY2VydGZpbGUgPSBzc2xfY2VydGZpbGUKICAgICAg
ICBzZWxmLnNzbF9rZXlmaWxlID0gc3NsX2tleWZpbGUKICAgICAgICBzZWxmLnNvY2tldF9wYXRo
ID0gc29ja2V0X3BhdGgKICAgICAgICBzZWxmLnJlYWRvbmx5ID0gcmVhZG9ubHkKICAgICAgICBz
ZWxmLmNsdXN0ZXJfbW9kZSA9IGNsdXN0ZXJfbW9kZQogICAgICAgIHNlbGYuY2x1c3Rlcl9ub2Rl
cyA9IGNsdXN0ZXJfbm9kZXMgb3IgWyhob3N0LCBwb3J0KV0KCiAgICBkZWYgdG9fZGljdChzZWxm
KSAtPiBEaWN0OgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICduYW1lJzogc2VsZi5uYW1l
LAogICAgICAgICAgICAnaG9zdCc6IHNlbGYuaG9zdCwKICAgICAgICAgICAgJ3BvcnQnOiBzZWxm
LnBvcnQsCiAgICAgICAgICAgICdzc2wnOiBzZWxmLnNzbCwKICAgICAgICAgICAgJ3JlYWRvbmx5
Jzogc2VsZi5yZWFkb25seQogICAgICAgIH0KCgpjbGFzcyBSZWRpc0Nvbm5lY3Rpb246CiAgICAi
IiLQnNC10L3QtdC00LbQtdGAINC/0L7QtNC60LvRjtGH0LXQvdC40Lkg0LogUmVkaXMiIiIKCiAg
ICBkZWYgX19pbml0X18oc2VsZiwgcHJvZmlsZTogQ29ubmVjdGlvblByb2ZpbGUpOgogICAgICAg
IHNlbGYucHJvZmlsZSA9IHByb2ZpbGUKICAgICAgICBzZWxmLmNsaWVudDogT3B0aW9uYWxbcmVk
aXMuUmVkaXNdID0gTm9uZQogICAgICAgICMgc2VsZi5jbGllbnQ6IFJlZGlzQ2xpZW50CiAgICAg
ICAgc2VsZi5jbHVzdGVyX2NsaWVudDogT3B0aW9uYWxbcmVkaXMuUmVkaXNDbHVzdGVyXSA9IE5v
bmUgICMg0J3QvtCy0YvQuSDQutC70LjQtdC90YIKICAgICAgICBzZWxmLmNvbm5lY3RlZCA9IEZh
bHNlCiAgICAgICAgc2VsZi5jdXJyZW50X2RiID0gMAogICAgICAgIHNlbGYuaXNfY2x1c3RlciA9
IHByb2ZpbGUuY2x1c3Rlcl9tb2RlCgogICAgZGVmIGNvbm5lY3Qoc2VsZikgLT4gVHVwbGVbYm9v
bCwgc3RyXToKICAgICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IFJlZGlzINC40LvQ
uCBSZWRpcyBDbHVzdGVyIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBzZWxmLnByb2Zp
bGUuY2x1c3Rlcl9tb2RlOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2Nvbm5lY3RfY2x1
c3RlcigpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fY29u
bmVjdF9zdGFuZGFsb25lKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgIHNlbGYuY29ubmVjdGVkID0gRmFsc2UKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiQ29u
bmVjdGlvbiBmYWlsZWQ6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgc3RyKGUpCgog
ICAgZGVmIF9jb25uZWN0X3N0YW5kYWxvbmUoc2VsZikgLT4gVHVwbGVbYm9vbCwgc3RyXToKICAg
ICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IHN0YW5kYWxvbmUgUmVkaXMiIiIKICAg
ICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3QuNC1INC6IFJlZGlzIiIiCiAgICAgICAgdHJ5Ogog
ICAgICAgICAgICBrd2FyZ3MgPSB7CiAgICAgICAgICAgICAgICAnZGInOiAwLCAgIyDQktGB0LXQ
s9C00LAg0L3QsNGH0LjQvdCw0LXQvCDRgSBEQjAKICAgICAgICAgICAgICAgICdzb2NrZXRfdGlt
ZW91dCc6IDUsCiAgICAgICAgICAgICAgICAnZGVjb2RlX3Jlc3BvbnNlcyc6IEZhbHNlCiAgICAg
ICAgICAgIH0KCiAgICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS5zb2NrZXRfcGF0aDoKICAgICAg
ICAgICAgICAgIGt3YXJnc1sndW5peF9zb2NrZXRfcGF0aCddID0gc2VsZi5wcm9maWxlLnNvY2tl
dF9wYXRoCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBrd2FyZ3NbJ2hvc3QnXSA9
IHNlbGYucHJvZmlsZS5ob3N0CiAgICAgICAgICAgICAgICBrd2FyZ3NbJ3BvcnQnXSA9IHNlbGYu
cHJvZmlsZS5wb3J0CgogICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUucGFzc3dvcmQ6CiAgICAg
ICAgICAgICAgICBrd2FyZ3NbJ3Bhc3N3b3JkJ10gPSBzZWxmLnByb2ZpbGUucGFzc3dvcmQKCiAg
ICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS51c2VybmFtZToKICAgICAgICAgICAgICAgIGt3YXJn
c1sndXNlcm5hbWUnXSA9IHNlbGYucHJvZmlsZS51c2VybmFtZQoKICAgICAgICAgICAgaWYgc2Vs
Zi5wcm9maWxlLnNzbDoKICAgICAgICAgICAgICAgIGt3YXJnc1snc3NsJ10gPSBUcnVlCiAgICAg
ICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NhX2NlcnRzOgogICAgICAgICAgICAgICAg
ICAgIGt3YXJnc1snc3NsX2NhX2NlcnRzJ10gPSBzZWxmLnByb2ZpbGUuc3NsX2NhX2NlcnRzCiAg
ICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NlcnRmaWxlOgogICAgICAgICAgICAg
ICAgICAgIGt3YXJnc1snc3NsX2NlcnRmaWxlJ10gPSBzZWxmLnByb2ZpbGUuc3NsX2NlcnRmaWxl
CiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2tleWZpbGU6CiAgICAgICAgICAg
ICAgICAgICAga3dhcmdzWydzc2xfa2V5ZmlsZSddID0gc2VsZi5wcm9maWxlLnNzbF9rZXlmaWxl
CgogICAgICAgICAgICBzZWxmLmNsaWVudCA9IFJlZGlzQ2xpZW50KCoqa3dhcmdzKQogICAgICAg
ICAgICBzZWxmLmNsaWVudC5waW5nKCkKICAgICAgICAgICAgc2VsZi5jb25uZWN0ZWQgPSBUcnVl
CiAgICAgICAgICAgIHNlbGYuY3VycmVudF9kYiA9IDAKICAgICAgICAgICAgbG9nZ2VyLmluZm8o
ZiJDb25uZWN0ZWQgdG8ge3NlbGYucHJvZmlsZS5ob3N0fTp7c2VsZi5wcm9maWxlLnBvcnR9IikK
ICAgICAgICAgICAgcmV0dXJuIFRydWUsICJDb25uZWN0ZWQiCgogICAgICAgIGV4Y2VwdCBSZWRp
c0Nvbm5lY3Rpb25FcnJvciBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJDb25uZWN0
aW9uIGZhaWxlZDoge2V9IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKICAgICAg
ICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuY29ubmVjdGVkID0gRmFs
c2UKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiQ29ubmVjdGlvbiBmYWlsZWQ6IHtlfSIpCiAg
ICAgICAgICAgIHJldHVybiBGYWxzZSwgc3RyKGUpCgogICAgZGVmIF9jb25uZWN0X2NsdXN0ZXIo
c2VsZikgLT4gVHVwbGVbYm9vbCwgc3RyXToKICAgICAgICAiIiLQn9C+0LTQutC70Y7Rh9C10L3Q
uNC1INC6IFJlZGlzIENsdXN0ZXIgLSDQv9GA0L7RgdGC0LDRjyDQstC10YDRgdC40Y8iIiIKICAg
ICAgICB0cnk6CiAgICAgICAgICAgICMg0J/RgNC+0YHRgtC+INC/0LXRgNC10LTQsNC10Lwg0YHQ
v9C40YHQvtC6INGD0LfQu9C+0LIg0LrQsNC6INC10YHRgtGMCiAgICAgICAgICAgIGt3YXJncyA9
IHsKICAgICAgICAgICAgICAgICdob3N0Jzogc2VsZi5wcm9maWxlLmhvc3QsCiAgICAgICAgICAg
ICAgICAncG9ydCc6IHNlbGYucHJvZmlsZS5wb3J0LAogICAgICAgICAgICAgICAgJ2RlY29kZV9y
ZXNwb25zZXMnOiBGYWxzZSwKICAgICAgICAgICAgICAgICdzb2NrZXRfdGltZW91dCc6IDUsCiAg
ICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIHNlbGYucHJvZmlsZS5wYXNzd29yZDoKICAgICAg
ICAgICAgICAgIGt3YXJnc1sncGFzc3dvcmQnXSA9IHNlbGYucHJvZmlsZS5wYXNzd29yZAoKICAg
ICAgICAgICAgaWYgc2VsZi5wcm9maWxlLnNzbDoKICAgICAgICAgICAgICAgIGt3YXJnc1snc3Ns
J10gPSBUcnVlCiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NhX2NlcnRzOgog
ICAgICAgICAgICAgICAgICAgIGt3YXJnc1snc3NsX2NhX2NlcnRzJ10gPSBzZWxmLnByb2ZpbGUu
c3NsX2NhX2NlcnRzCiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2NlcnRmaWxl
OgogICAgICAgICAgICAgICAgICAgIGt3YXJnc1snc3NsX2NlcnRmaWxlJ10gPSBzZWxmLnByb2Zp
bGUuc3NsX2NlcnRmaWxlCiAgICAgICAgICAgICAgICBpZiBzZWxmLnByb2ZpbGUuc3NsX2tleWZp
bGU6CiAgICAgICAgICAgICAgICAgICAga3dhcmdzWydzc2xfa2V5ZmlsZSddID0gc2VsZi5wcm9m
aWxlLnNzbF9rZXlmaWxlCgogICAgICAgICAgICAjINCU0LvRjyDQvtGC0LvQsNC00LrQuAogICAg
ICAgICAgICBsb2dnZXIuaW5mbyhmIkNvbm5lY3RpbmcgdG8gUmVkaXMgQ2x1c3RlciBhdCB7c2Vs
Zi5wcm9maWxlLmhvc3R9OntzZWxmLnByb2ZpbGUucG9ydH0iKQoKICAgICAgICAgICAgIyBSZWRp
c0NsdXN0ZXIg0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60Lgg0L7QsdC90LDRgNGD0LbQuNGCINC0
0YDRg9Cz0LjQtSDRg9C30LvRiwogICAgICAgICAgICAjIHNlbGYuY2x1c3Rlcl9jbGllbnQgPSBy
ZWRpcy5SZWRpc0NsdXN0ZXIoKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYuY2x1c3Rlcl9jbGll
bnQgPSBSZWRpc0NsaWVudCgqKmt3YXJncywgaXNfY2x1c3Rlcj1UcnVlKQogICAgICAgICAgICBz
ZWxmLmNsdXN0ZXJfY2xpZW50LnBpbmcoKQogICAgICAgICAgICBzZWxmLmNvbm5lY3RlZCA9IFRy
dWUKICAgICAgICAgICAgc2VsZi5pc19jbHVzdGVyID0gVHJ1ZQoKICAgICAgICAgICAgIyDQn9GA
0L7QstC10YDRj9C10LwsINGH0YLQviDRjdGC0L4g0LTQtdC50YHRgtCy0LjRgtC10LvRjNC90L4g
0LrQu9Cw0YHRgtC10YAKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgY2x1c3Rlcl9p
bmZvID0gc2VsZi5jbHVzdGVyX2NsaWVudC5jbHVzdGVyX2luZm8oKQogICAgICAgICAgICAgICAg
bG9nZ2VyLmluZm8oZiJDbHVzdGVyIHN0YXRlOiB7Y2x1c3Rlcl9pbmZvLmdldCgnY2x1c3Rlcl9z
dGF0ZScsICd1bmtub3duJyl9IikKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAg
cGFzcwoKICAgICAgICAgICAgcmV0dXJuIFRydWUsICJDb25uZWN0ZWQgdG8gY2x1c3RlciIKCiAg
ICAgICAgZXhjZXB0IFJlZGlzQ2x1c3RlckVycm9yIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5l
cnJvcihmIlJlZGlzIENsdXN0ZXIgZXJyb3I6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiBGYWxz
ZSwgZiJDbHVzdGVyIGVycm9yOiB7c3RyKGUpfSIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFz
IGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkNvbm5lY3Rpb24gZmFpbGVkOiB7ZX0iKQog
ICAgICAgICAgICByZXR1cm4gRmFsc2UsIHN0cihlKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGFj
dGl2ZV9jbGllbnQoc2VsZik6CiAgICAgICAgIiIi0JLQvtC30LLRgNCw0YnQsNC10YIg0LDQutGC
0LjQstC90YvQuSDQutC70LjQtdC90YIiIiIKICAgICAgICBpZiBzZWxmLmlzX2NsdXN0ZXI6CiAg
ICAgICAgICAgIHJldHVybiBzZWxmLmNsdXN0ZXJfY2xpZW50CiAgICAgICAgcmV0dXJuIHNlbGYu
Y2xpZW50CgogICAgZGVmIHNlbGVjdF9kYihzZWxmLCBkYjogaW50KSAtPiBUdXBsZVtib29sLCBz
dHJdOgogICAgICAgICIiItCf0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQvdCwINC00YDRg9Cz0YPR
jiDQsdCw0LfRgyDQtNCw0L3QvdGL0YUgKNC90LUg0L/QvtC00LTQtdGA0LbQuNCy0LDQtdGC0YHR
jyDQsiDQutC70LDRgdGC0LXRgNC1KSIiIgogICAgICAgIGlmIHNlbGYuaXNfY2x1c3RlcjoKICAg
ICAgICAgICAgcmV0dXJuIEZhbHNlLCAiUmVkaXMgQ2x1c3RlciBzdXBwb3J0cyBvbmx5IERCMCIK
CiAgICAgICAgaWYgbm90IHNlbGYuY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4gRmFsc2Us
ICJOb3QgY29ubmVjdGVkIgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuY2xpZW50LnNl
bGVjdChkYikKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2RiID0gZGIKICAgICAgICAgICAgbG9n
Z2VyLmluZm8oZiJTd2l0Y2hlZCB0byBEQjp7ZGJ9IikKICAgICAgICAgICAgcmV0dXJuIFRydWUs
IGYiU3dpdGNoZWQgdG8gREI6e2RifSIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAg
ICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBzd2l0Y2ggREI6IHtlfSIpCiAgICAg
ICAgICAgIHJldHVybiBGYWxzZSwgc3RyKGUpCgogICAgZGVmIGRpc2Nvbm5lY3Qoc2VsZik6CiAg
ICAgICAgaWYgc2VsZi5jbGllbnQ6CiAgICAgICAgICAgIHNlbGYuY2xpZW50LmNsb3NlKCkKICAg
ICAgICAgICAgc2VsZi5jb25uZWN0ZWQgPSBGYWxzZQogICAgICAgICAgICBsb2dnZXIuaW5mbyhm
IkRpc2Nvbm5lY3RlZCBmcm9tIHtzZWxmLnByb2ZpbGUuaG9zdH06e3NlbGYucHJvZmlsZS5wb3J0
fSIpCgoKY2xhc3MgS2V5TGlzdEl0ZW0odXJ3aWQuV2lkZ2V0V3JhcCk6CiAgICAiIiLQrdC70LXQ
vNC10L3RgiDRgdC/0LjRgdC60LAg0LrQu9GO0YfQtdC5INGBINC/0L7QtNC00LXRgNC20LrQvtC5
INCy0YvQtNC10LvQtdC90LjRjyIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBrZXk6IGJ5dGVz
LCBrZXlfdHlwZTogc3RyLCBvbl9zZWxlY3RfY2FsbGJhY2ssIG1hcmtlZDogYm9vbCA9IEZhbHNl
KToKICAgICAgICAiIiIKICAgICAgICBBcmdzOgogICAgICAgICAgICBrZXk6INC60LvRjtGHIChi
eXRlcykKICAgICAgICAgICAga2V5X3R5cGU6INGC0LjQvyDQutC70Y7Rh9CwIChzdHJpbmcsIGhh
c2gsIGxpc3QsIGV0YykKICAgICAgICAgICAgb25fc2VsZWN0X2NhbGxiYWNrOiDRhNGD0L3QutGG
0LjRjyDQtNC70Y8g0LLRi9C30L7QstCwINC/0YDQuCDQstGL0LHQvtGA0LUg0LrQu9GO0YfQsAog
ICAgICAgICAgICBtYXJrZWQ6INC+0YLQvNC10YfQtdC9INC70Lgg0Y3Qu9C10LzQtdC90YIKICAg
ICAgICAiIiIKICAgICAgICBzZWxmLmtleSA9IGtleQogICAgICAgIHNlbGYua2V5X3R5cGUgPSBr
ZXlfdHlwZQogICAgICAgIHNlbGYubWFya2VkID0gbWFya2VkCiAgICAgICAgc2VsZi5vbl9zZWxl
Y3RfY2FsbGJhY2sgPSBvbl9zZWxlY3RfY2FsbGJhY2sKCiAgICAgICAgIyDQlNC10LrQvtC00LjR
gNGD0LXQvCDQutC70Y7RhyDQtNC70Y8g0L7RgtC+0LHRgNCw0LbQtdC90LjRjwogICAgICAgIHRy
eToKICAgICAgICAgICAgc2VsZi5rZXlfc3RyID0ga2V5LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9
J3JlcGxhY2UnKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgc2VsZi5rZXlfc3RyID0gc3Ry
KGtleSkKCiAgICAgICAgIyDQmNC60L7QvdC60LAg0YLQuNC/0LAKICAgICAgICB0eXBlX2ljb25z
ID0gewogICAgICAgICAgICAnc3RyaW5nJzogJ1tTdF0nLAogICAgICAgICAgICAnaGFzaCc6ICdb
SHNdJywKICAgICAgICAgICAgJ2xpc3QnOiAnW0xpXScsCiAgICAgICAgICAgICdzZXQnOiAnW1Nl
XScsCiAgICAgICAgICAgICd6c2V0JzogJ1tac10nLAogICAgICAgICAgICAnc3RyZWFtJzogJ1tU
cl0nLAogICAgICAgICAgICAnbm9uZSc6ICdbTm9dJywKICAgICAgICAgICAgJ3Vua25vd24nOiAn
Wz9dJywKICAgICAgICB9CiAgICAgICAgaWNvbiA9IHR5cGVfaWNvbnMuZ2V0KGtleV90eXBlLCAn
Wz9dJykKCiAgICAgICAgIyDQntGC0LzQtdGC0LrQsCAo0LTQu9GPINC80LDRgdGB0L7QstGL0YUg
0L7Qv9C10YDQsNGG0LjQuSkKICAgICAgICBtYXJrID0gJ+KckycgaWYgbWFya2VkIGVsc2UgJyAn
CgogICAgICAgICMg0KLQtdC60YHRgiDRjdC70LXQvNC10L3RgtCwCiAgICAgICAgdGV4dCA9IGYi
e21hcmt9e2ljb259IHtzZWxmLmtleV9zdHJ9IgoKICAgICAgICBzZWxmLnRleHRfd2lkZ2V0ID0g
dXJ3aWQuU2VsZWN0YWJsZUljb24odGV4dCwgY3Vyc29yX3Bvc2l0aW9uPTApCgogICAgICAgIHN1
cGVyKCkuX19pbml0X18oc2VsZi50ZXh0X3dpZGdldCkKCiAgICBkZWYgdG9nZ2xlX21hcmsoc2Vs
Zik6CiAgICAgICAgIiIi0J/QtdGA0LXQutC70Y7Rh9C40YLRjCDQvtGC0LzQtdGC0LrRgyIiIgog
ICAgICAgIHNlbGYubWFya2VkID0gbm90IHNlbGYubWFya2VkCiAgICAgICAgc2VsZi51cGRhdGVf
ZGlzcGxheSgpCgogICAgZGVmIHVwZGF0ZV9kaXNwbGF5KHNlbGYpOgogICAgICAgICIiItCe0LHQ
vdC+0LLQuNGC0Ywg0L7RgtC+0LHRgNCw0LbQtdC90LjQtSIiIgogICAgICAgIHR5cGVfaWNvbnMg
PSB7CiAgICAgICAgICAgICdzdHJpbmcnOiAnW1N0XScsCiAgICAgICAgICAgICdoYXNoJzogJ1tI
c10nLAogICAgICAgICAgICAnbGlzdCc6ICdbTGldJywKICAgICAgICAgICAgJ3NldCc6ICdbU2Vd
JywKICAgICAgICAgICAgJ3pzZXQnOiAnW1pzXScsCiAgICAgICAgICAgICdzdHJlYW0nOiAnW1Ry
XScsCiAgICAgICAgICAgICdub25lJzogJ1tOb10nLAogICAgICAgICAgICAndW5rbm93bic6ICdb
P10nLAogICAgICAgIH0KICAgICAgICBpY29uID0gdHlwZV9pY29ucy5nZXQoc2VsZi5rZXlfdHlw
ZSwgJ1s/XScpCiAgICAgICAgbWFyayA9ICfinJMnIGlmIHNlbGYubWFya2VkIGVsc2UgJyAnCiAg
ICAgICAgdGV4dCA9IGYie21hcmt9e2ljb259IHtzZWxmLmtleV9zdHJ9IgogICAgICAgIHNlbGYu
dGV4dF93aWRnZXQuc2V0X3RleHQodGV4dCkKCiAgICBkZWYgc2VsZWN0YWJsZShzZWxmKToKICAg
ICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBrZXlwcmVzcyhzZWxmLCBzaXplLCBrZXkpOgogICAg
ICAgIGlmIGtleSA9PSAnfic6ICAjINCf0YDQvtCx0LXQuyAtINC/0LXRgNC10LrQu9GO0YfQuNGC
0Ywg0L7RgtC80LXRgtC60YMKICAgICAgICAgICAgc2VsZi50b2dnbGVfbWFyaygpCiAgICAgICAg
ICAgIHJldHVybiBOb25lCiAgICAgICAgZWxpZiBrZXkgPT0gJ2VudGVyJzoKICAgICAgICAgICAg
IyDQktGL0LfRi9Cy0LDQtdC8IGNhbGxiYWNrINC90LDQv9GA0Y/QvNGD0Y4KICAgICAgICAgICAg
aWYgc2VsZi5vbl9zZWxlY3RfY2FsbGJhY2s6CiAgICAgICAgICAgICAgICBzZWxmLm9uX3NlbGVj
dF9jYWxsYmFjayhzZWxmLmtleSkKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICByZXR1
cm4ga2V5CgoKY2xhc3MgS2V5TGlzdFZpZXcodXJ3aWQuV2lkZ2V0V3JhcCk6CiAgICAiIiLQktC4
0YDRgtGD0LDQu9C40LfQuNGA0L7QstCw0L3QvdGL0Lkg0YHQv9C40YHQvtC6INC60LvRjtGH0LXQ
uSDRgSDRhNC40LvRjNGC0YDQsNGG0LjQtdC5INC4INC60LXRiNC40YDQvtCy0LDQvdC40LXQvCIi
IgoKICAgIHNpZ25hbHMgPSBbJ2tleV9zZWxlY3RlZCddCgogICAgZGVmIF9faW5pdF9fKHNlbGYp
OgogICAgICAgIHNlbGYuYWxsX2tleXMgPSBbXSAgIyDQktGB0LUg0LrQu9GO0YfQuDogWyhrZXlf
Ynl0ZXMsIHR5cGVfc3RyKSwgLi4uXQogICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cyA9IFtdICAj
INCe0YLRhNC40LvRjNGC0YDQvtCy0LDQvdC90YvQtSDQutC70Y7Rh9C4CiAgICAgICAgc2VsZi5m
aWx0ZXJfcGF0dGVybiA9IE5vbmUgICMg0KLQtdC60YPRidC40Lkg0YTQuNC70YzRgtGACiAgICAg
ICAgc2VsZi5tYXJrZWRfa2V5cyA9IHNldCgpICAjINCe0YLQvNC10YfQtdC90L3Ri9C1INC60LvR
jtGH0LgKICAgICAgICBzZWxmLmtleV9jYWNoZSA9IHt9ICAjINCa0LXRiCDQstC40LTQttC10YLQ
vtCyOiB7a2V5OiBLZXlMaXN0SXRlbX0KCiAgICAgICAgIyBXYWxrZXIg0LTQu9GPIExpc3RCb3gK
ICAgICAgICBzZWxmLndhbGtlciA9IHVyd2lkLlNpbXBsZUZvY3VzTGlzdFdhbGtlcihbXSkKICAg
ICAgICBzZWxmLmxpc3Rib3ggPSB1cndpZC5MaXN0Qm94KHNlbGYud2Fsa2VyKQoKICAgICAgICAj
INCX0LDQs9C+0LvQvtCy0L7QuiDRgSDQuNC90YTQvtGA0LzQsNGG0LjQtdC5CiAgICAgICAgc2Vs
Zi5oZWFkZXIgPSB1cndpZC5UZXh0KCcnKQogICAgICAgIHNlbGYudXBkYXRlX2hlYWRlcigpCgog
ICAgICAgICMg0JrQvtC80L/QvtC90L7QstC60LAKICAgICAgICBwaWxlID0gdXJ3aWQuUGlsZShb
CiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5oZWFkZXIsICdpbmZvX2xh
YmVsJykpLAogICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5EaXZpZGVyKCfilIAnKSksCiAgICAg
ICAgICAgICgnd2VpZ2h0JywgMSwgc2VsZi5saXN0Ym94KSwKICAgICAgICBdKQoKICAgICAgICBz
dXBlcigpLl9faW5pdF9fKHBpbGUpCgogICAgZGVmIHNldF9rZXlzKHNlbGYsIGtleXNfd2l0aF90
eXBlczogTGlzdFtUdXBsZVtieXRlcywgc3RyXV0pOgogICAgICAgICIiItCj0YHRgtCw0L3QvtCy
0LjRgtGMINGB0L/QuNGB0L7QuiDQutC70Y7Rh9C10LkgKNGBINGC0LjQv9Cw0LzQuCkiIiIKICAg
ICAgICBsb2dnZXIuaW5mbyhmIktleUxpc3RWaWV3LnNldF9rZXlzIGNhbGxlZCB3aXRoIHtsZW4o
a2V5c193aXRoX3R5cGVzKX0ga2V5cyIpCiAgICAgICAgc2VsZi5hbGxfa2V5cyA9IGtleXNfd2l0
aF90eXBlcwogICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cyA9IGtleXNfd2l0aF90eXBlcy5jb3B5
KCkKICAgICAgICBzZWxmLmtleV9jYWNoZS5jbGVhcigpICAjINCe0YfQuNGJ0LDQtdC8INC60LXR
iCDQv9GA0Lgg0L/QvtC70L3QvtC8INC+0LHQvdC+0LLQu9C10L3QuNC4CiAgICAgICAgbG9nZ2Vy
LmluZm8oZiJhbGxfa2V5czoge2xlbihzZWxmLmFsbF9rZXlzKX0sIGZpbHRlcmVkX2tleXM6IHts
ZW4oc2VsZi5maWx0ZXJlZF9rZXlzKX0iKQogICAgICAgIHNlbGYucmVmcmVzaF9kaXNwbGF5KCkK
ICAgICAgICBsb2dnZXIuaW5mbygiS2V5TGlzdFZpZXcuc2V0X2tleXMgY29tcGxldGVkIikKCiAg
ICBkZWYgYXBwbHlfZmlsdGVyKHNlbGYsIHBhdHRlcm46IE9wdGlvbmFsW3N0cl0pOgogICAgICAg
ICIiItCf0YDQuNC80LXQvdC40YLRjCDRhNC40LvRjNGC0YAg0L/QviDQv9Cw0YLRgtC10YDQvdGD
IiIiCiAgICAgICAgc2VsZi5maWx0ZXJfcGF0dGVybiA9IHBhdHRlcm4KCiAgICAgICAgaWYgbm90
IHBhdHRlcm46CiAgICAgICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cyA9IHNlbGYuYWxsX2tleXMu
Y29weSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaW1wb3J0IGZubWF0Y2gKICAgICAgICAg
ICAgc2VsZi5maWx0ZXJlZF9rZXlzID0gW10KICAgICAgICAgICAgcGF0dGVybl9sb3dlciA9IHBh
dHRlcm4ubG93ZXIoKQoKICAgICAgICAgICAgZm9yIGtleSwga2V5X3R5cGUgaW4gc2VsZi5hbGxf
a2V5czoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBrZXlfc3RyID0g
a2V5LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKS5sb3dlcigpCiAgICAgICAgICAg
ICAgICAgICAgIyDQn9C+0LTQtNC10YDQttC60LAgd2lsZGNhcmQg0LjQu9C4INC/0YDQvtGB0YLQ
vtCz0L4g0L/QvtC40YHQutCwCiAgICAgICAgICAgICAgICAgICAgaWYgJyonIGluIHBhdHRlcm4g
b3IgJz8nIGluIHBhdHRlcm46CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZubWF0Y2guZm5t
YXRjaChrZXlfc3RyLCBwYXR0ZXJuX2xvd2VyKToKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNlbGYuZmlsdGVyZWRfa2V5cy5hcHBlbmQoKGtleSwga2V5X3R5cGUpKQogICAgICAgICAgICAg
ICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBhdHRlcm5fbG93ZXIgaW4g
a2V5X3N0cjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZmlsdGVyZWRfa2V5cy5h
cHBlbmQoKGtleSwga2V5X3R5cGUpKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAg
ICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5yZWZyZXNoX2Rpc3BsYXkoKQoKICAgIGRlZiBy
ZWZyZXNoX2Rpc3BsYXkoc2VsZik6CiAgICAgICAgIiIi0J7QsdC90L7QstC40YLRjCDQvtGC0L7Q
sdGA0LDQttC10L3QuNC1INGB0L/QuNGB0LrQsCIiIgogICAgICAgIGxvZ2dlci5pbmZvKGYiS2V5
TGlzdFZpZXcucmVmcmVzaF9kaXNwbGF5IGNhbGxlZCwgZmlsdGVyZWRfa2V5czoge2xlbihzZWxm
LmZpbHRlcmVkX2tleXMpfSIpCgogICAgICAgIHNlbGYud2Fsa2VyLmNsZWFyKCkKICAgICAgICBs
b2dnZXIuaW5mbygiV2Fsa2VyIGNsZWFyZWQiKQoKICAgICAgICAjINCh0L7Qt9C00LDQtdC8INCy
0LjQtNC20LXRgtGLCiAgICAgICAgYWRkZWRfY291bnQgPSAwCiAgICAgICAgZm9yIGlkeCwgKGtl
eSwga2V5X3R5cGUpIGluIGVudW1lcmF0ZShzZWxmLmZpbHRlcmVkX2tleXMpOgogICAgICAgICAg
ICB0cnk6CiAgICAgICAgICAgICAgICAjINCf0YDQvtCy0LXRgNGP0LXQvCDQutC10YgKICAgICAg
ICAgICAgICAgIGlmIGtleSBpbiBzZWxmLmtleV9jYWNoZToKICAgICAgICAgICAgICAgICAgICBp
dGVtID0gc2VsZi5rZXlfY2FjaGVba2V5XQogICAgICAgICAgICAgICAgICAgIGl0ZW0ubWFya2Vk
ID0ga2V5IGluIHNlbGYubWFya2VkX2tleXMKICAgICAgICAgICAgICAgICAgICBpdGVtLnVwZGF0
ZV9kaXNwbGF5KCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgIyDi
nIUg0KHQvtC30LTQsNC10Lwg0LLQuNC00LbQtdGCINGBIGNhbGxiYWNrINC90LDQv9GA0Y/QvNGD
0Y4KICAgICAgICAgICAgICAgICAgICBpdGVtID0gS2V5TGlzdEl0ZW0oCiAgICAgICAgICAgICAg
ICAgICAgICAgIGtleSwKICAgICAgICAgICAgICAgICAgICAgICAga2V5X3R5cGUsCiAgICAgICAg
ICAgICAgICAgICAgICAgIG9uX3NlbGVjdF9jYWxsYmFjaz1zZWxmLm9uX2tleV9zZWxlY3RlZCwg
ICMg0L/QtdGA0LXQtNCw0LXQvCDQvNC10YLQvtC0CiAgICAgICAgICAgICAgICAgICAgICAgIG1h
cmtlZD1rZXkgaW4gc2VsZi5tYXJrZWRfa2V5cwogICAgICAgICAgICAgICAgICAgICkKICAgICAg
ICAgICAgICAgICAgICBzZWxmLmtleV9jYWNoZVtrZXldID0gaXRlbQoKICAgICAgICAgICAgICAg
ICMg0J7QsdC+0YDQsNGH0LjQstCw0LXQvCDQuCDQtNC+0LHQsNCy0LvRj9C10LwKICAgICAgICAg
ICAgICAgIHdyYXBwZWQgPSB1cndpZC5BdHRyTWFwKGl0ZW0sICdrZXlfaXRlbScsICdrZXlfaXRl
bV9mb2N1cycpCiAgICAgICAgICAgICAgICBzZWxmLndhbGtlci5hcHBlbmQod3JhcHBlZCkKICAg
ICAgICAgICAgICAgIGFkZGVkX2NvdW50ICs9IDEKCiAgICAgICAgICAgICAgICBpZiBhZGRlZF9j
b3VudCA8PSAzOgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQWRkZWQga2V5ICN7
YWRkZWRfY291bnR9OiB7a2V5Wzo1MF0gaWYgbGVuKGtleSkgPiA1MCBlbHNlIGtleX0iKQoKICAg
ICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgbG9nZ2VyLmVy
cm9yKGYiRXJyb3IgY3JlYXRpbmcgd2lkZ2V0IGZvciBrZXkge2tleX06IHtlfSIsIGV4Y19pbmZv
PVRydWUpCgogICAgICAgIGxvZ2dlci5pbmZvKGYiV2Fsa2VyIG5vdyBoYXMge2xlbihzZWxmLndh
bGtlcil9IGl0ZW1zIChhZGRlZCB7YWRkZWRfY291bnR9KSIpCgogICAgICAgIHNlbGYudXBkYXRl
X2hlYWRlcigpCiAgICAgICAgbG9nZ2VyLmluZm8oIktleUxpc3RWaWV3LnJlZnJlc2hfZGlzcGxh
eSBjb21wbGV0ZWQiKQoKICAgIGRlZiB1cGRhdGVfaGVhZGVyKHNlbGYpOgogICAgICAgICIiItCe
0LHQvdC+0LLQuNGC0Ywg0LfQsNCz0L7Qu9C+0LLQvtC6INGBINC40L3RhNC+0YDQvNCw0YbQuNC1
0LkiIiIKICAgICAgICB0b3RhbCA9IGxlbihzZWxmLmFsbF9rZXlzKQogICAgICAgIGZpbHRlcmVk
ID0gbGVuKHNlbGYuZmlsdGVyZWRfa2V5cykKICAgICAgICBtYXJrZWQgPSBsZW4oc2VsZi5tYXJr
ZWRfa2V5cykKCiAgICAgICAgaWYgc2VsZi5maWx0ZXJfcGF0dGVybjoKICAgICAgICAgICAgdGV4
dCA9IGYiIEtleXM6IHtmaWx0ZXJlZH0ve3RvdGFsfSAoZmlsdGVyOiB7c2VsZi5maWx0ZXJfcGF0
dGVybn0pIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRleHQgPSBmIiBLZXlzOiB7dG90YWx9
IgoKICAgICAgICBpZiBtYXJrZWQgPiAwOgogICAgICAgICAgICB0ZXh0ICs9IGYiIHwgTWFya2Vk
OiB7bWFya2VkfSIKCiAgICAgICAgc2VsZi5oZWFkZXIuc2V0X3RleHQodGV4dCkKCiAgICBkZWYg
b25fa2V5X3NlbGVjdGVkKHNlbGYsIGtleSk6CiAgICAgICAgIiIi0J7QsdGA0LDQsdC+0YLRh9C4
0Log0LLRi9Cx0L7RgNCwINC60LvRjtGH0LAiIiIKICAgICAgICBsb2dnZXIuaW5mbyhmIktleUxp
c3RWaWV3Lm9uX2tleV9zZWxlY3RlZCBjYWxsZWQiKQogICAgICAgIGxvZ2dlci5pbmZvKGYiVHlw
ZSBvZiAna2V5Jzoge3R5cGUoa2V5KX0iKQogICAgICAgIGxvZ2dlci5pbmZvKGYiVmFsdWUgb2Yg
J2tleSc6IHtrZXl9IikKICAgICAgICBsb2dnZXIuaW5mbyhmIk51bWJlciBvZiBhcmdzIHJlY2Vp
dmVkOiAxIikKCiAgICAgICAgIyDQn9C10YDQtdC00LDQtdC8INC00LDQu9GM0YjQtSDRh9C10YDQ
tdC3INGB0LjQs9C90LDQuwogICAgICAgIGxvZ2dlci5pbmZvKCJDYWxsaW5nIHVyd2lkLmVtaXRf
c2lnbmFsLi4uIikKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVyd2lkLmVtaXRfc2lnbmFsKHNl
bGYsICdrZXlfc2VsZWN0ZWQnLCBrZXkpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJlbWl0X3Np
Z25hbCBjb21wbGV0ZWQiKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAg
ICAgbG9nZ2VyLmVycm9yKGYiZW1pdF9zaWduYWwgZmFpbGVkOiB7ZX0iLCBleGNfaW5mbz1UcnVl
KQoKICAgIGRlZiBnZXRfZm9jdXNlZF9rZXkoc2VsZikgLT4gT3B0aW9uYWxbYnl0ZXNdOgogICAg
ICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg0LrQu9GO0Ycg0LIg0YTQvtC60YPRgdC1IiIiCiAgICAg
ICAgZm9jdXNfd2lkZ2V0LCBmb2N1c19wb3MgPSBzZWxmLndhbGtlci5nZXRfZm9jdXMoKQogICAg
ICAgIGlmIGZvY3VzX3dpZGdldCBhbmQgaXNpbnN0YW5jZShmb2N1c193aWRnZXQuYmFzZV93aWRn
ZXQsIEtleUxpc3RJdGVtKToKICAgICAgICAgICAgcmV0dXJuIGZvY3VzX3dpZGdldC5iYXNlX3dp
ZGdldC5rZXkKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBnZXRfbWFya2VkX2tleXMoc2Vs
ZikgLT4gTGlzdFtieXRlc106CiAgICAgICAgIiIi0J/QvtC70YPRh9C40YLRjCDRgdC/0LjRgdC+
0Log0L7RgtC80LXRh9C10L3QvdGL0YUg0LrQu9GO0YfQtdC5IiIiCiAgICAgICAgcmV0dXJuIGxp
c3Qoc2VsZi5tYXJrZWRfa2V5cykKCiAgICBkZWYgbWFya19ieV9wYXR0ZXJuKHNlbGYsIHBhdHRl
cm46IHN0cik6CiAgICAgICAgIiIi0J7RgtC80LXRgtC40YLRjCDQutC70Y7Rh9C4INC/0L4g0L/Q
sNGC0YLQtdGA0L3RgyIiIgogICAgICAgIGltcG9ydCBmbm1hdGNoCiAgICAgICAgcGF0dGVybl9s
b3dlciA9IHBhdHRlcm4ubG93ZXIoKQoKICAgICAgICBmb3Iga2V5LCBfIGluIHNlbGYuYWxsX2tl
eXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGtleV9zdHIgPSBrZXkuZGVjb2Rl
KCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScpLmxvd2VyKCkKICAgICAgICAgICAgICAgIGlmIGZu
bWF0Y2guZm5tYXRjaChrZXlfc3RyLCBwYXR0ZXJuX2xvd2VyKToKICAgICAgICAgICAgICAgICAg
ICBzZWxmLm1hcmtlZF9rZXlzLmFkZChrZXkpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAg
ICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5yZWZyZXNoX2Rpc3BsYXkoKQoKICAgIGRlZiB1bm1h
cmtfYWxsKHNlbGYpOgogICAgICAgICIiItCh0L3Rj9GC0Ywg0LLRgdC1INC+0YLQvNC10YLQutC4
IiIiCiAgICAgICAgc2VsZi5tYXJrZWRfa2V5cy5jbGVhcigpCiAgICAgICAgc2VsZi5yZWZyZXNo
X2Rpc3BsYXkoKQoKICAgIGRlZiB0b2dnbGVfbWFya19mb2N1c2VkKHNlbGYpOgogICAgICAgICIi
ItCf0LXRgNC10LrQu9GO0YfQuNGC0Ywg0L7RgtC80LXRgtC60YMg0L3QsCDRgtC10LrRg9GJ0LXQ
vCDRjdC70LXQvNC10L3RgtC1IiIiCiAgICAgICAgZm9jdXNfd2lkZ2V0LCBmb2N1c19wb3MgPSBz
ZWxmLndhbGtlci5nZXRfZm9jdXMoKQogICAgICAgIGlmIGZvY3VzX3dpZGdldCBhbmQgaXNpbnN0
YW5jZShmb2N1c193aWRnZXQuYmFzZV93aWRnZXQsIEtleUxpc3RJdGVtKToKICAgICAgICAgICAg
aXRlbSA9IGZvY3VzX3dpZGdldC5iYXNlX3dpZGdldAogICAgICAgICAgICBpZiBpdGVtLmtleSBp
biBzZWxmLm1hcmtlZF9rZXlzOgogICAgICAgICAgICAgICAgc2VsZi5tYXJrZWRfa2V5cy5yZW1v
dmUoaXRlbS5rZXkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLm1hcmtl
ZF9rZXlzLmFkZChpdGVtLmtleSkKICAgICAgICAgICAgaXRlbS5tYXJrZWQgPSBpdGVtLmtleSBp
biBzZWxmLm1hcmtlZF9rZXlzCiAgICAgICAgICAgIGl0ZW0udXBkYXRlX2Rpc3BsYXkoKQogICAg
ICAgICAgICBzZWxmLnVwZGF0ZV9oZWFkZXIoKQoKICAgICAgICAgICAgIyDQn9C10YDQtdGF0L7Q
tCDQuiDRgdC70LXQtNGD0Y7RidC10LzRgyDRjdC70LXQvNC10L3RgtGDCiAgICAgICAgICAgIGlm
IGZvY3VzX3BvcyA8IGxlbihzZWxmLndhbGtlcikgLSAxOgogICAgICAgICAgICAgICAgc2VsZi53
YWxrZXIuc2V0X2ZvY3VzKGZvY3VzX3BvcyArIDEpCgoKY2xhc3MgQ29tbWFuZFByb21wdFdyYXBw
ZXIodXJ3aWQuV2lkZ2V0V3JhcCk6CiAgICAiIiLQntCx0LXRgNGC0LrQsCDQtNC70Y8gRWRpdCDR
gSDQv9C10YDQtdGF0LLQsNGC0L7QvCDRgdGC0YDQtdC70L7QuiDQstCy0LXRgNGFL9Cy0L3QuNC3
IiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGVkaXRfd2lkZ2V0LCBvbl91cCwgb25fZG93biwg
b25fZW50ZXIpOgogICAgICAgIHNlbGYuZWRpdF93aWRnZXQgPSBlZGl0X3dpZGdldAogICAgICAg
IHNlbGYub25fdXAgPSBvbl91cAogICAgICAgIHNlbGYub25fZG93biA9IG9uX2Rvd24KICAgICAg
ICBzZWxmLm9uX2VudGVyID0gb25fZW50ZXIKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGVkaXRf
d2lkZ2V0KQoKICAgIGRlZiBzZWxlY3RhYmxlKHNlbGYpOgogICAgICAgICIiItCS0LjQtNC20LXR
giDQvNC+0LbQtdGCINC/0L7Qu9GD0YfQsNGC0Ywg0YTQvtC60YPRgSIiIgogICAgICAgIHJldHVy
biBUcnVlCgogICAgZGVmIGtleXByZXNzKHNlbGYsIHNpemUsIGtleSk6CiAgICAgICAgIiIi0J/Q
tdGA0LXRhdCy0LDRgtGL0LLQsNC10Lwg0LrQu9Cw0LLQuNGI0LgiIiIKICAgICAgICBpZiBrZXkg
PT0gJ2N0cmwgcCcgb3Iga2V5ID09ICdwYWdlIHVwJzoKICAgICAgICAgICAgIyDinIUg0JLRi9C3
0YvQstCw0LXQvCBjYWxsYmFjayDQuCDQstC+0LfQstGA0LDRidCw0LXQvCBOb25lICjQvtCx0YDQ
sNCx0L7RgtCw0L3QvikKICAgICAgICAgICAgc2VsZi5vbl91cCgpCiAgICAgICAgICAgIHJldHVy
biBOb25lCiAgICAgICAgZWxpZiBrZXkgPT0gJ2N0cmwgbicgb3Iga2V5ID09ICdwYWdlIGRvd24n
OgogICAgICAgICAgICAjIOKchSDQktGL0LfRi9Cy0LDQtdC8IGNhbGxiYWNrINC4INCy0L7Qt9Cy
0YDQsNGJ0LDQtdC8IE5vbmUgKNC+0LHRgNCw0LHQvtGC0LDQvdC+KQogICAgICAgICAgICBzZWxm
Lm9uX2Rvd24oKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGVsaWYga2V5ID09ICdl
bnRlcic6CiAgICAgICAgICAgICMg4pyFINCS0YvQt9GL0LLQsNC10LwgY2FsbGJhY2sg0Lgg0LLQ
vtC30LLRgNCw0YnQsNC10LwgTm9uZSAo0L7QsdGA0LDQsdC+0YLQsNC90L4pCiAgICAgICAgICAg
IHNlbGYub25fZW50ZXIoKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGVsc2U6CiAg
ICAgICAgICAgICMg0J7RgdGC0LDQu9GM0L3Ri9C1INC60LvQsNCy0LjRiNC4INC/0LXRgNC10LTQ
sNC10Lwg0LIgRWRpdAogICAgICAgICAgICByZXR1cm4gc2VsZi5lZGl0X3dpZGdldC5rZXlwcmVz
cyhzaXplLCBrZXkpCgoKY2xhc3MgQWRkS2V5RGlhbG9nKHVyd2lkLldpZGdldFdyYXApOgogICAg
IiIi0JTQuNCw0LvQvtCzINC00L7QsdCw0LLQu9C10L3QuNGPL9GA0LXQtNCw0LrRgtC40YDQvtCy
0LDQvdC40Y8g0LrQu9GO0YfQsCIiIgogICAgc2lnbmFscyA9IFsnY2xvc2UnXQoKICAgIGRlZiBf
X2luaXRfXyhzZWxmLCBjb25uZWN0aW9uOiBSZWRpc0Nvbm5lY3Rpb24sIG9uX3N1Y2Nlc3NfY2Fs
bGJhY2ssIGVkaXRfa2V5PU5vbmUpOgogICAgICAgIHNlbGYuY29ubmVjdGlvbiA9IGNvbm5lY3Rp
b24KICAgICAgICBzZWxmLm9uX3N1Y2Nlc3MgPSBvbl9zdWNjZXNzX2NhbGxiYWNrCiAgICAgICAg
c2VsZi5lZGl0X2tleSA9IGVkaXRfa2V5CiAgICAgICAgc2VsZi5jdXJyZW50X3R5cGUgPSAnc3Ry
aW5nJwogICAgICAgIHNlbGYudmFsdWVfY2hhbmdlZCA9IEZhbHNlCgogICAgICAgICMg0J/QvtC7
0Y8g0LLQstC+0LTQsCDRgSDRgtC10LzQvdGL0Lwg0YHRgtC40LvQtdC8CiAgICAgICAgc2VsZi5r
ZXlfZWRpdCA9IHVyd2lkLkF0dHJNYXAoCiAgICAgICAgICAgIHVyd2lkLkVkaXQoJycpLCAgIyDi
nIUg0KPQsdC40YDQsNC10LwgIktleTogIiDQvtGC0YHRjtC00LAKICAgICAgICAgICAgJ2lucHV0
JywKICAgICAgICAgICAgJ2lucHV0X2ZvY3VzJwogICAgICAgICkKCiAgICAgICAgc2VsZi50eXBl
X2dyb3VwID0gW10KCiAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDQutC90L7Qv9C60Lgg0YEg0L7Q
sdGA0LDQsdC+0YLRh9C40LrQvtC8CiAgICAgICAgc2VsZi50eXBlX2J1dHRvbnMgPSBbCiAgICAg
ICAgICAgIHVyd2lkLlJhZGlvQnV0dG9uKHNlbGYudHlwZV9ncm91cCwgJ1N0cmluZycsIHN0YXRl
PVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uX3N0YXRlX2NoYW5nZT1sYW1i
ZGEgYnRuLCBzdGF0ZTogc2VsZi5vbl90eXBlX2NoYW5nZWQoYnRuLCBzdGF0ZSwgJ3N0cmluZycp
KSwKICAgICAgICAgICAgdXJ3aWQuUmFkaW9CdXR0b24oc2VsZi50eXBlX2dyb3VwLCAnSGFzaCcs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uX3N0YXRlX2NoYW5nZT1sYW1iZGEgYnRu
LCBzdGF0ZTogc2VsZi5vbl90eXBlX2NoYW5nZWQoYnRuLCBzdGF0ZSwgJ2hhc2gnKSksCiAgICAg
ICAgICAgIHVyd2lkLlJhZGlvQnV0dG9uKHNlbGYudHlwZV9ncm91cCwgJ0xpc3QnLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBvbl9zdGF0ZV9jaGFuZ2U9bGFtYmRhIGJ0biwgc3RhdGU6
IHNlbGYub25fdHlwZV9jaGFuZ2VkKGJ0biwgc3RhdGUsICdsaXN0JykpLAogICAgICAgICAgICB1
cndpZC5SYWRpb0J1dHRvbihzZWxmLnR5cGVfZ3JvdXAsICdTZXQnLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBvbl9zdGF0ZV9jaGFuZ2U9bGFtYmRhIGJ0biwgc3RhdGU6IHNlbGYub25f
dHlwZV9jaGFuZ2VkKGJ0biwgc3RhdGUsICdzZXQnKSksCiAgICAgICAgICAgIHVyd2lkLlJhZGlv
QnV0dG9uKHNlbGYudHlwZV9ncm91cCwgJ1pTZXQnLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBvbl9zdGF0ZV9jaGFuZ2U9bGFtYmRhIGJ0biwgc3RhdGU6IHNlbGYub25fdHlwZV9jaGFu
Z2VkKGJ0biwgc3RhdGUsICd6c2V0JykpLAogICAgICAgICAgICB1cndpZC5SYWRpb0J1dHRvbihz
ZWxmLnR5cGVfZ3JvdXAsICdCaXRtYXAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBv
bl9zdGF0ZV9jaGFuZ2U9bGFtYmRhIGJ0biwgc3RhdGU6IHNlbGYub25fdHlwZV9jaGFuZ2VkKGJ0
biwgc3RhdGUsICdiaXRtYXAnKSksCiAgICAgICAgICAgIHVyd2lkLlJhZGlvQnV0dG9uKHNlbGYu
dHlwZV9ncm91cCwgJ1N0cmVhbScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uX3N0
YXRlX2NoYW5nZT1sYW1iZGEgYnRuLCBzdGF0ZTogc2VsZi5vbl90eXBlX2NoYW5nZWQoYnRuLCBz
dGF0ZSwgJ3N0cmVhbScpKSwKICAgICAgICBdCgogICAgICAgICMg0KPQvdC40LLQtdGA0YHQsNC7
0YzQvdGL0LUg0LLQuNC00LbQtdGC0YsKICAgICAgICBzZWxmLnZhbHVlX2VkaXQgPSBOb25lCiAg
ICAgICAgc2VsZi52YWx1ZV9jb250YWluZXIgPSB1cndpZC5QaWxlKFtdKQogICAgICAgIHNlbGYu
dHRsX2VkaXQgPSB1cndpZC5BdHRyTWFwKAogICAgICAgICAgICB1cndpZC5FZGl0KCcnKSwgICMg
4pyFINCj0LHQuNGA0LDQtdC8ICJUVEw6ICIg0L7RgtGB0Y7QtNCwCiAgICAgICAgICAgICdpbnB1
dCcsCiAgICAgICAgICAgICdpbnB1dF9mb2N1cycKICAgICAgICApCiAgICAgICAgc2VsZi5lcnJv
cl90ZXh0ID0gdXJ3aWQuVGV4dCgnJykKICAgICAgICBzZWxmLmNvbmZpcm1fZGlhbG9nID0gTm9u
ZQoKICAgICAgICAjINCa0L3QvtC/0LrQuAogICAgICAgIHNhdmVfYnRuID0gdXJ3aWQuQnV0dG9u
KCdTYXZlIChGNyknLCBvbl9wcmVzcz1zZWxmLm9uX3NhdmUpCiAgICAgICAgY2FuY2VsX2J0biA9
IHVyd2lkLkJ1dHRvbignQ2FuY2VsIChFc2MpJywgb25fcHJlc3M9c2VsZi5vbl9jYW5jZWwpCgog
ICAgICAgICMg4pyFINCf0L7QtNC/0LjRgdC4INGBINCx0LXQu9GL0Lwg0L3QsCDRgdC40L3QtdC8
CiAgICAgICAga2V5X2xhYmVsID0gdXJ3aWQuQXR0ck1hcCh1cndpZC5UZXh0KCdLZXk6JyksICdp
bmZvX2xhYmVsJykKICAgICAgICB0eXBlX2xhYmVsID0gdXJ3aWQuQXR0ck1hcCh1cndpZC5UZXh0
KCdUeXBlOicpLCAnaW5mb19sYWJlbCcpCiAgICAgICAgdHRsX2xhYmVsID0gdXJ3aWQuQXR0ck1h
cCh1cndpZC5UZXh0KCdUVEwgKHNlY29uZHMsIG9wdGlvbmFsKTonKSwgJ2luZm9fbGFiZWwnKQoK
ICAgICAgICAjINCa0L7QvNC/0L7QvdC+0LLQutCwCiAgICAgICAgdGl0bGUgPSAnRWRpdCBLZXkn
IGlmIGVkaXRfa2V5IGVsc2UgJ0FkZCBOZXcgS2V5JwogICAgICAgIGJvZHkgPSBbCiAgICAgICAg
ICAgIHNlbGYuZXJyb3JfdGV4dCwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAogICAgICAg
ICAgICBrZXlfbGFiZWwsICAjIOKchSDQn9C+0LTQv9C40YHRjCDQvtGC0LTQtdC70YzQvdC+CiAg
ICAgICAgICAgIHNlbGYua2V5X2VkaXQsCiAgICAgICAgICAgIHVyd2lkLkRpdmlkZXIoKSwKICAg
ICAgICAgICAgdHlwZV9sYWJlbCwgICMg4pyFINCf0L7QtNC/0LjRgdGMINC+0YLQtNC10LvRjNC9
0L4KICAgICAgICBdCiAgICAgICAgYm9keS5leHRlbmQoc2VsZi50eXBlX2J1dHRvbnMpCiAgICAg
ICAgYm9keS5leHRlbmQoWwogICAgICAgICAgICB1cndpZC5EaXZpZGVyKCksCiAgICAgICAgICAg
IHNlbGYudmFsdWVfY29udGFpbmVyLAogICAgICAgICAgICB1cndpZC5EaXZpZGVyKCksCiAgICAg
ICAgICAgIHR0bF9sYWJlbCwgICMg4pyFINCf0L7QtNC/0LjRgdGMINC+0YLQtNC10LvRjNC90L4K
ICAgICAgICAgICAgc2VsZi50dGxfZWRpdCwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAog
ICAgICAgICAgICB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAo
c2F2ZV9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJyksCiAgICAgICAgICAgICAgICB1cndp
ZC5BdHRyTWFwKGNhbmNlbF9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJyksCiAgICAgICAg
ICAgIF0pLAogICAgICAgIF0pCgogICAgICAgIHNlbGYucGlsZSA9IHVyd2lkLlBpbGUoYm9keSkK
ICAgICAgICBmaWxsID0gdXJ3aWQuRmlsbGVyKHNlbGYucGlsZSwgdmFsaWduPSd0b3AnKQogICAg
ICAgIHBhZGRpbmcgPSB1cndpZC5QYWRkaW5nKGZpbGwsIGxlZnQ9MiwgcmlnaHQ9MikKICAgICAg
ICBsaW5lYm94ID0gdXJ3aWQuTGluZUJveChwYWRkaW5nLCB0aXRsZT10aXRsZSkKCiAgICAgICAg
c3VwZXIoKS5fX2luaXRfXyh1cndpZC5BdHRyTWFwKGxpbmVib3gsICdkaWFsb2cnKSkKCiAgICAg
ICAgIyDQldGB0LvQuCDRgNC10LbQuNC8INGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8sINC3
0LDQs9GA0YPQttCw0LXQvCDQtNCw0L3QvdGL0LUKICAgICAgICBpZiBlZGl0X2tleToKICAgICAg
ICAgICAgc2VsZi5sb2FkX2tleV9kYXRhKGVkaXRfa2V5KQogICAgICAgIGVsc2U6CiAgICAgICAg
ICAgICMg0JjQvdC40YbQuNCw0LvQuNC30LjRgNGD0LXQvCDQstC40LTQttC10YLRiyDQtNC70Y8g
U3RyaW5nICjQv9C+INGD0LzQvtC70YfQsNC90LjRjikKICAgICAgICAgICAgc2VsZi51cGRhdGVf
dmFsdWVfd2lkZ2V0KCdzdHJpbmcnKQoKICAgIGRlZiBsb2FkX2tleV9kYXRhKHNlbGYsIGtleSk6
CiAgICAgICAgIiIi0JfQsNCz0YDRg9C30LjRgtGMINC00LDQvdC90YvQtSDRgdGD0YnQtdGB0YLQ
stGD0Y7RidC10LPQviDQutC70Y7Rh9CwINC00LvRjyDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3Q
uNGPIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBzZWxmLmNvbm5lY3Rpb24u
YWN0aXZlX2NsaWVudAoKICAgICAgICAgICAgIyDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDQ
uNC80Y8g0LrQu9GO0YfQsCAo0LIg0YDQtdC20LjQvNC1INGA0LXQtNCw0LrRgtC40YDQvtCy0LDQ
vdC40Y8g0L3QtdC70YzQt9GPINC80LXQvdGP0YLRjCkKICAgICAgICAgICAgc2VsZi5rZXlfZWRp
dC5iYXNlX3dpZGdldC5zZXRfZWRpdF90ZXh0KGtleSkKICAgICAgICAgICAgc2VsZi5rZXlfZWRp
dC5iYXNlX3dpZGdldC5zZXRfZWRpdF9wb3MobGVuKGtleSkpCgogICAgICAgICAgICAjINCf0L7Q
u9GD0YfQsNC10Lwg0YLQuNC/INC60LvRjtGH0LAKICAgICAgICAgICAga2V5X3R5cGUgPSBjbGll
bnQudHlwZShrZXkpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoa2V5X3R5cGUsIGJ5dGVzKToK
ICAgICAgICAgICAgICAgIGtleV90eXBlID0ga2V5X3R5cGUuZGVjb2RlKCd1dGYtOCcpCgogICAg
ICAgICAgICAjINCj0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INGC0LjQvwogICAgICAgICAgICB0
eXBlX2luZGV4ID0gWydzdHJpbmcnLCAnaGFzaCcsICdsaXN0JywgJ3NldCcsICd6c2V0JywgJ2Jp
dG1hcCcsICdzdHJlYW0nXS5pbmRleChrZXlfdHlwZSkKICAgICAgICAgICAgc2VsZi50eXBlX2J1
dHRvbnNbdHlwZV9pbmRleF0uc2V0X3N0YXRlKFRydWUpCiAgICAgICAgICAgIHNlbGYuY3VycmVu
dF90eXBlID0ga2V5X3R5cGUKICAgICAgICAgICAgc2VsZi51cGRhdGVfdmFsdWVfd2lkZ2V0KGtl
eV90eXBlKQoKICAgICAgICAgICAgIyDQl9Cw0LPRgNGD0LbQsNC10Lwg0LfQvdCw0YfQtdC90LjQ
tSDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YIg0YLQuNC/0LAKICAgICAgICAgICAgaWYg
a2V5X3R5cGUgPT0gJ3N0cmluZyc6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGNsaWVudC5nZXQo
a2V5KQogICAgICAgICAgICAgICAgaWYgdmFsdWU6CiAgICAgICAgICAgICAgICAgICAgaWYgaXNp
bnN0YW5jZSh2YWx1ZSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZh
bHVlLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAgICAg
ICMg0KDQsNC30LHQuNCy0LDQtdC8INC/0L4gXG4g0L3QsCDRgdGC0YDQvtC60Lgg0LTQu9GPINC8
0L3QvtCz0L7RgdGC0YDQvtGH0L3QvtCz0L4g0YDQtdC00LDQutGC0L7RgNCwCiAgICAgICAgICAg
ICAgICAgICAgbGluZXMgPSB2YWx1ZS5zcGxpdCgnXFxuJykKICAgICAgICAgICAgICAgICAgICBz
ZWxmLnZhbHVlX2VkaXQuYmFzZV93aWRnZXQuc2V0X2VkaXRfdGV4dCgnXG4nLmpvaW4obGluZXMp
KQoKICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnaGFzaCc6CiAgICAgICAgICAgICAgICBo
YXNoX2RhdGEgPSBjbGllbnQuaGdldGFsbChrZXkpCiAgICAgICAgICAgICAgICBsaW5lcyA9IFtd
CiAgICAgICAgICAgICAgICBmb3IgZmllbGQsIHZhbCBpbiBoYXNoX2RhdGEuaXRlbXMoKToKICAg
ICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGZpZWxkLCBieXRlcyk6CiAgICAgICAgICAg
ICAgICAgICAgICAgIGZpZWxkID0gZmllbGQuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFj
ZScpCiAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWwsIGJ5dGVzKToKICAgICAg
ICAgICAgICAgICAgICAgICAgdmFsID0gdmFsLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxh
Y2UnKQogICAgICAgICAgICAgICAgICAgIGxpbmVzLmFwcGVuZChmIntmaWVsZH06e3ZhbH0iKQog
ICAgICAgICAgICAgICAgc2VsZi52YWx1ZV9lZGl0LmJhc2Vfd2lkZ2V0LnNldF9lZGl0X3RleHQo
J1xuJy5qb2luKGxpbmVzKSkKCiAgICAgICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ2xpc3QnOgog
ICAgICAgICAgICAgICAgaXRlbXMgPSBjbGllbnQubHJhbmdlKGtleSwgMCwgLTEpCiAgICAgICAg
ICAgICAgICBsaW5lcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgaXRlbSBpbiBpdGVtczoKICAg
ICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGl0ZW0sIGJ5dGVzKToKICAgICAgICAgICAg
ICAgICAgICAgICAgaXRlbSA9IGl0ZW0uZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScp
CiAgICAgICAgICAgICAgICAgICAgbGluZXMuYXBwZW5kKGl0ZW0pCiAgICAgICAgICAgICAgICBz
ZWxmLnZhbHVlX2VkaXQuYmFzZV93aWRnZXQuc2V0X2VkaXRfdGV4dCgnXG4nLmpvaW4obGluZXMp
KQoKICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnc2V0JzoKICAgICAgICAgICAgICAgIG1l
bWJlcnMgPSBjbGllbnQuc21lbWJlcnMoa2V5KQogICAgICAgICAgICAgICAgbGluZXMgPSBbXQog
ICAgICAgICAgICAgICAgZm9yIG1lbWJlciBpbiBtZW1iZXJzOgogICAgICAgICAgICAgICAgICAg
IGlmIGlzaW5zdGFuY2UobWVtYmVyLCBieXRlcyk6CiAgICAgICAgICAgICAgICAgICAgICAgIG1l
bWJlciA9IG1lbWJlci5kZWNvZGUoJ3V0Zi04JywgZXJyb3JzPSdyZXBsYWNlJykKICAgICAgICAg
ICAgICAgICAgICBsaW5lcy5hcHBlbmQobWVtYmVyKQogICAgICAgICAgICAgICAgc2VsZi52YWx1
ZV9lZGl0LmJhc2Vfd2lkZ2V0LnNldF9lZGl0X3RleHQoJ1xuJy5qb2luKGxpbmVzKSkKCiAgICAg
ICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3pzZXQnOgogICAgICAgICAgICAgICAgaXRlbXMgPSBj
bGllbnQuenJhbmdlKGtleSwgMCwgLTEsIHdpdGhzY29yZXM9VHJ1ZSkKICAgICAgICAgICAgICAg
IGxpbmVzID0gW10KICAgICAgICAgICAgICAgIGZvciBtZW1iZXIsIHNjb3JlIGluIGl0ZW1zOgog
ICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UobWVtYmVyLCBieXRlcyk6CiAgICAgICAg
ICAgICAgICAgICAgICAgIG1lbWJlciA9IG1lbWJlci5kZWNvZGUoJ3V0Zi04JywgZXJyb3JzPSdy
ZXBsYWNlJykKICAgICAgICAgICAgICAgICAgICBsaW5lcy5hcHBlbmQoZiJ7bWVtYmVyfTp7c2Nv
cmV9IikKICAgICAgICAgICAgICAgIHNlbGYudmFsdWVfZWRpdC5iYXNlX3dpZGdldC5zZXRfZWRp
dF90ZXh0KCdcbicuam9pbihsaW5lcykpCgogICAgICAgICAgICAjINCf0L7Qu9GD0YfQsNC10Lwg
VFRMCiAgICAgICAgICAgIHR0bCA9IGNsaWVudC50dGwoa2V5KQogICAgICAgICAgICBpZiB0dGwg
PiAwOgogICAgICAgICAgICAgICAgc2VsZi50dGxfZWRpdC5iYXNlX3dpZGdldC5zZXRfZWRpdF90
ZXh0KHN0cih0dGwpKQoKICAgICAgICAgICAgIyDQodCx0YDQsNGB0YvQstCw0LXQvCDRhNC70LDQ
syDQuNC30LzQtdC90LXQvdC40Y8g0L/QvtGB0LvQtSDQt9Cw0LPRgNGD0LfQutC4CiAgICAgICAg
ICAgIHNlbGYudmFsdWVfY2hhbmdlZCA9IEZhbHNlCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRmFpbGVkIHRvIGxvYWQga2V5IGRhdGE6
IHtlfSIpCiAgICAgICAgICAgIHNlbGYuc2hvd19lcnJvcihmIkZhaWxlZCB0byBsb2FkIGtleTog
e2V9IikKCiAgICBkZWYga2V5cHJlc3Moc2VsZiwgc2l6ZSwga2V5KToKICAgICAgICAiIiLQntCx
0YDQsNCx0L7RgtC60LAg0L3QsNC20LDRgtC40Lkg0LrQu9Cw0LLQuNGIIiIiCiAgICAgICAgIyDQ
ldGB0LvQuCDQvtGC0LrRgNGL0YIg0LTQuNCw0LvQvtCzINC/0L7QtNGC0LLQtdGA0LbQtNC10L3Q
uNGPLCDQv9C10YDQtdC00LDQtdC8INC10LzRgyDRg9C/0YDQsNCy0LvQtdC90LjQtQogICAgICAg
IGlmIHNlbGYuY29uZmlybV9kaWFsb2c6CiAgICAgICAgICAgIHJldHVybiBzdXBlcigpLmtleXBy
ZXNzKHNpemUsIGtleSkKCiAgICAgICAgaWYga2V5ID09ICdlc2MnOgogICAgICAgICAgICBzZWxm
LnJlcXVlc3RfY2xvc2UoKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGVsaWYga2V5
ID09ICdmNyc6CiAgICAgICAgICAgIHNlbGYub25fc2F2ZShOb25lKQogICAgICAgICAgICByZXR1
cm4gTm9uZQoKICAgICAgICAjINCe0YLRgdC70LXQttC40LLQsNC10Lwg0LjQt9C80LXQvdC10L3Q
uNGPINCyIHZhbHVlX2VkaXQKICAgICAgICByZXN1bHQgPSBzdXBlcigpLmtleXByZXNzKHNpemUs
IGtleSkKCiAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10LwsINCx0YvQuyDQu9C4INC40LfQvNC1
0L3QtdC9INGC0LXQutGB0YIKICAgICAgICBpZiBzZWxmLnZhbHVlX2VkaXQgYW5kIGhhc2F0dHIo
c2VsZi52YWx1ZV9lZGl0LCAnYmFzZV93aWRnZXQnKToKICAgICAgICAgICAgY3VycmVudF90ZXh0
ID0gc2VsZi52YWx1ZV9lZGl0LmJhc2Vfd2lkZ2V0LmdldF9lZGl0X3RleHQoKQogICAgICAgICAg
ICBpZiBjdXJyZW50X3RleHQuc3RyaXAoKToKICAgICAgICAgICAgICAgIHNlbGYudmFsdWVfY2hh
bmdlZCA9IFRydWUKCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiByZXF1ZXN0X2Nsb3Nl
KHNlbGYpOgogICAgICAgICIiItCX0LDQv9GA0L7RgSDQvdCwINC30LDQutGA0YvRgtC40LUg0YEg
0L/RgNC+0LLQtdGA0LrQvtC5INC40LfQvNC10L3QtdC90LjQuSIiIgogICAgICAgIGlmIHNlbGYu
dmFsdWVfY2hhbmdlZDoKICAgICAgICAgICAgc2VsZi5zaG93X2NvbmZpcm1fZGlhbG9nKAogICAg
ICAgICAgICAgICAgIkRpc2NhcmQgY2hhbmdlcz8iLAogICAgICAgICAgICAgICAgIllvdSBoYXZl
IHVuc2F2ZWQgY2hhbmdlcy4gQ2xvc2UgYW55d2F5PyIsCiAgICAgICAgICAgICAgICBvbl95ZXM9
bGFtYmRhOiBzZWxmLl9lbWl0KCdjbG9zZScpLAogICAgICAgICAgICAgICAgb25fbm89bGFtYmRh
OiBOb25lCiAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9lbWl0
KCdjbG9zZScpCgogICAgZGVmIG9uX3R5cGVfY2hhbmdlZChzZWxmLCBidXR0b24sIG5ld19zdGF0
ZSwgdHlwZV9uYW1lKToKICAgICAgICAiIiLQntCx0YDQsNCx0L7RgtGH0LjQuiDQuNC30LzQtdC9
0LXQvdC40Y8g0YLQuNC/0LAg0YEg0L/QvtC00YLQstC10YDQttC00LXQvdC40LXQvCIiIgogICAg
ICAgIGlmIG5vdCBuZXdfc3RhdGU6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiB0eXBl
X25hbWUgPT0gc2VsZi5jdXJyZW50X3R5cGU6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAj
INCV0YHQu9C4INC10YHRgtGMINC90LXRgdC+0YXRgNCw0L3QtdC90L3Ri9C1INC40LfQvNC10L3Q
tdC90LjRjywg0YHQv9GA0LDRiNC40LLQsNC10LwKICAgICAgICBpZiBzZWxmLnZhbHVlX2NoYW5n
ZWQ6CiAgICAgICAgICAgICMg0JfQsNC/0L7QvNC40L3QsNC10Lwg0L3QvtCy0YvQuSDRgtC40L8K
ICAgICAgICAgICAgc2VsZi5wZW5kaW5nX3R5cGUgPSB0eXBlX25hbWUKCiAgICAgICAgICAgIHNl
bGYuc2hvd19jb25maXJtX2RpYWxvZygKICAgICAgICAgICAgICAgICJDaGFuZ2UgdHlwZT8iLAog
ICAgICAgICAgICAgICAgIktlZXAgY3VycmVudCB2YWx1ZSBvciBjbGVhcj8iLAogICAgICAgICAg
ICAgICAgeWVzX3RleHQ9IktlZXAiLAogICAgICAgICAgICAgICAgbm9fdGV4dD0iQ2xlYXIiLAog
ICAgICAgICAgICAgICAgb25feWVzPWxhbWJkYTogc2VsZi5jaGFuZ2VfdHlwZV9rZWVwX3ZhbHVl
KHR5cGVfbmFtZSksCiAgICAgICAgICAgICAgICBvbl9ubz1sYW1iZGE6IHNlbGYuY2hhbmdlX3R5
cGVfY2xlYXJfdmFsdWUodHlwZV9uYW1lKQogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAg
ICAgICAgICAgbG9nZ2VyLmRlYnVnKGYiVHlwZSBjaGFuZ2VkIGZyb20ge3NlbGYuY3VycmVudF90
eXBlfSB0byB7dHlwZV9uYW1lfSIpCiAgICAgICAgICAgIHNlbGYuY3VycmVudF90eXBlID0gdHlw
ZV9uYW1lCiAgICAgICAgICAgIHNlbGYudXBkYXRlX3ZhbHVlX3dpZGdldCh0eXBlX25hbWUpCgog
ICAgZGVmIGNoYW5nZV90eXBlX2tlZXBfdmFsdWUoc2VsZiwgdHlwZV9uYW1lKToKICAgICAgICAi
IiLQodC80LXQvdC40YLRjCDRgtC40L8sINGB0L7RhdGA0LDQvdC40LIg0LfQvdCw0YfQtdC90LjQ
tSIiIgogICAgICAgIG9sZF92YWx1ZSA9IHNlbGYuZ2V0X3ZhbHVlX3RleHQoKQogICAgICAgIHNl
bGYuY3VycmVudF90eXBlID0gdHlwZV9uYW1lCiAgICAgICAgc2VsZi51cGRhdGVfdmFsdWVfd2lk
Z2V0KHR5cGVfbmFtZSkKICAgICAgICAjINCf0YvRgtCw0LXQvNGB0Y8g0YHQvtGF0YDQsNC90LjR
gtGMINGB0YLQsNGA0L7QtSDQt9C90LDRh9C10L3QuNC1CiAgICAgICAgaWYgc2VsZi52YWx1ZV9l
ZGl0IGFuZCBvbGRfdmFsdWU6CiAgICAgICAgICAgIHNlbGYudmFsdWVfZWRpdC5iYXNlX3dpZGdl
dC5zZXRfZWRpdF90ZXh0KG9sZF92YWx1ZSkKCiAgICBkZWYgY2hhbmdlX3R5cGVfY2xlYXJfdmFs
dWUoc2VsZiwgdHlwZV9uYW1lKToKICAgICAgICAiIiLQodC80LXQvdC40YLRjCDRgtC40L8sINC+
0YfQuNGB0YLQuNCyINC30L3QsNGH0LXQvdC40LUiIiIKICAgICAgICBzZWxmLmN1cnJlbnRfdHlw
ZSA9IHR5cGVfbmFtZQogICAgICAgIHNlbGYudXBkYXRlX3ZhbHVlX3dpZGdldCh0eXBlX25hbWUp
CiAgICAgICAgc2VsZi52YWx1ZV9jaGFuZ2VkID0gRmFsc2UKCiAgICBkZWYgc2hvd19jb25maXJt
X2RpYWxvZyhzZWxmLCB0aXRsZSwgbWVzc2FnZSwgeWVzX3RleHQ9IlllcyIsIG5vX3RleHQ9Ik5v
Iiwgb25feWVzPU5vbmUsIG9uX25vPU5vbmUpOgogICAgICAgICIiItCf0L7QutCw0LfQsNGC0Ywg
0LTQuNCw0LvQvtCzINC/0L7QtNGC0LLQtdGA0LbQtNC10L3QuNGPIiIiCiAgICAgICAgeWVzX2J0
biA9IHVyd2lkLkJ1dHRvbih5ZXNfdGV4dCwgb25fcHJlc3M9bGFtYmRhIGJ0bjogc2VsZi5jbG9z
ZV9jb25maXJtX2RpYWxvZyhvbl95ZXMpKQogICAgICAgIG5vX2J0biA9IHVyd2lkLkJ1dHRvbihu
b190ZXh0LCBvbl9wcmVzcz1sYW1iZGEgYnRuOiBzZWxmLmNsb3NlX2NvbmZpcm1fZGlhbG9nKG9u
X25vKSkKCiAgICAgICAgcGlsZSA9IHVyd2lkLlBpbGUoWwogICAgICAgICAgICB1cndpZC5UZXh0
KG1lc3NhZ2UpLAogICAgICAgICAgICB1cndpZC5EaXZpZGVyKCksCiAgICAgICAgICAgIHVyd2lk
LkNvbHVtbnMoWwogICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcCh5ZXNfYnRuLCAnYnV0dG9u
JywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChub19idG4s
ICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJyksCiAgICAgICAgICAgIF0pLAogICAgICAgIF0pCgog
ICAgICAgIGxpbmVib3ggPSB1cndpZC5MaW5lQm94KHVyd2lkLkZpbGxlcihwaWxlKSwgdGl0bGU9
dGl0bGUpCiAgICAgICAgb3ZlcmxheSA9IHVyd2lkLk92ZXJsYXkoCiAgICAgICAgICAgIHVyd2lk
LkF0dHJNYXAobGluZWJveCwgJ2RpYWxvZycpLAogICAgICAgICAgICBzZWxmLl93LAogICAgICAg
ICAgICBhbGlnbj0nY2VudGVyJywKICAgICAgICAgICAgd2lkdGg9KCdyZWxhdGl2ZScsIDYwKSwK
ICAgICAgICAgICAgdmFsaWduPSdtaWRkbGUnLAogICAgICAgICAgICBoZWlnaHQ9KCdyZWxhdGl2
ZScsIDMwKQogICAgICAgICkKCiAgICAgICAgc2VsZi5jb25maXJtX2RpYWxvZyA9IG92ZXJsYXkK
ICAgICAgICBzZWxmLl93ID0gb3ZlcmxheQoKICAgIGRlZiBjbG9zZV9jb25maXJtX2RpYWxvZyhz
ZWxmLCBjYWxsYmFjayk6CiAgICAgICAgIiIi0JfQsNC60YDRi9GC0Ywg0LTQuNCw0LvQvtCzINC/
0L7QtNGC0LLQtdGA0LbQtNC10L3QuNGPIiIiCiAgICAgICAgIyDQktC+0YHRgdGC0LDQvdCw0LLQ
u9C40LLQsNC10Lwg0LjRgdGF0L7QtNC90YvQuSDQstC40LTQttC10YIKICAgICAgICBzZWxmLl93
ID0gdXJ3aWQuQXR0ck1hcCgKICAgICAgICAgICAgdXJ3aWQuTGluZUJveCgKICAgICAgICAgICAg
ICAgIHVyd2lkLlBhZGRpbmcoCiAgICAgICAgICAgICAgICAgICAgdXJ3aWQuRmlsbGVyKHNlbGYu
cGlsZSwgdmFsaWduPSd0b3AnKSwKICAgICAgICAgICAgICAgICAgICBsZWZ0PTIsIHJpZ2h0PTIK
ICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB0aXRsZT0nRWRpdCBLZXknIGlmIHNl
bGYuZWRpdF9rZXkgZWxzZSAnQWRkIE5ldyBLZXknCiAgICAgICAgICAgICksCiAgICAgICAgICAg
ICdkaWFsb2cnCiAgICAgICAgKQogICAgICAgIHNlbGYuY29uZmlybV9kaWFsb2cgPSBOb25lCgog
ICAgICAgICMg0JLRi9C/0L7Qu9C90Y/QtdC8IGNhbGxiYWNrCiAgICAgICAgaWYgY2FsbGJhY2s6
CiAgICAgICAgICAgIGNhbGxiYWNrKCkKCiAgICBkZWYgdXBkYXRlX3ZhbHVlX3dpZGdldChzZWxm
LCBrZXlfdHlwZSk6CiAgICAgICAgIiIi0J7QsdC90L7QstC40YLRjCDQstC40LTQttC10YIg0LTQ
u9GPINCy0LLQvtC00LAg0LfQvdCw0YfQtdC90LjRjyDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4
INC+0YIg0YLQuNC/0LAiIiIKICAgICAgICBzZWxmLmN1cnJlbnRfdHlwZSA9IGtleV90eXBlCgog
ICAgICAgICMg0J7Rh9C40YnQsNC10Lwg0LrQvtC90YLQtdC50L3QtdGACiAgICAgICAgc2VsZi52
YWx1ZV9jb250YWluZXIuY29udGVudHMuY2xlYXIoKQoKICAgICAgICAjIOKchSDQn9C+0LTQv9C4
0YHRjCDQtNC70Y8g0LfQvdCw0YfQtdC90LjRjwogICAgICAgIHZhbHVlX2xhYmVsID0gdXJ3aWQu
QXR0ck1hcCh1cndpZC5UZXh0KCdWYWx1ZTonKSwgJ2luZm9fbGFiZWwnKQogICAgICAgIHNlbGYu
dmFsdWVfY29udGFpbmVyLmNvbnRlbnRzLmFwcGVuZCgodmFsdWVfbGFiZWwsICgncGFjaycsIE5v
bmUpKSkKCiAgICAgICAgaWYga2V5X3R5cGUgPT0gJ3N0cmluZyc6CiAgICAgICAgICAgICMg0JzQ
vdC+0LPQvtGB0YLRgNC+0YfQvdC+0LUg0L/QvtC70LUg0LTQu9GPIHN0cmluZwogICAgICAgICAg
ICBzZWxmLnZhbHVlX2VkaXQgPSB1cndpZC5BdHRyTWFwKAogICAgICAgICAgICAgICAgdXJ3aWQu
RWRpdCgnJywgbXVsdGlsaW5lPVRydWUpLAogICAgICAgICAgICAgICAgJ2lucHV0JywKICAgICAg
ICAgICAgICAgICdpbnB1dF9mb2N1cycKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLnZh
bHVlX2NvbnRhaW5lci5jb250ZW50cy5hcHBlbmQoCiAgICAgICAgICAgICAgICAodXJ3aWQuTGlu
ZUJveChzZWxmLnZhbHVlX2VkaXQpLCAoJ3dlaWdodCcsIDEpKQogICAgICAgICAgICApCgogICAg
ICAgIGVsaWYga2V5X3R5cGUgPT0gJ2hhc2gnOgogICAgICAgICAgICAjINCU0LvRjyBoYXNoIC0g
0YLQsNCx0LvQuNGG0LAga2V5LXZhbHVlINC/0LDRgAogICAgICAgICAgICBoZWxwX3RleHQgPSB1
cndpZC5UZXh0KCdFbnRlciBrZXktdmFsdWUgcGFpcnMgKG9uZSBwZXIgbGluZSwgZm9ybWF0OiBr
ZXk9dmFsdWUpJykKICAgICAgICAgICAgc2VsZi52YWx1ZV9lZGl0ID0gdXJ3aWQuQXR0ck1hcCgK
ICAgICAgICAgICAgICAgIHVyd2lkLkVkaXQoJycsIG11bHRpbGluZT1UcnVlKSwKICAgICAgICAg
ICAgICAgICdpbnB1dCcsCiAgICAgICAgICAgICAgICAnaW5wdXRfZm9jdXMnCiAgICAgICAgICAg
ICkKICAgICAgICAgICAgc2VsZi52YWx1ZV9jb250YWluZXIuY29udGVudHMuZXh0ZW5kKFsKICAg
ICAgICAgICAgICAgIChoZWxwX3RleHQsICgncGFjaycsIE5vbmUpKSwKICAgICAgICAgICAgICAg
ICh1cndpZC5MaW5lQm94KHNlbGYudmFsdWVfZWRpdCksICgnd2VpZ2h0JywgMSkpCiAgICAgICAg
ICAgIF0pCgogICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ2xpc3QnOgogICAgICAgICAgICAjINCU
0LvRjyBsaXN0IC0g0L7QtNC90L4g0LfQvdCw0YfQtdC90LjQtSDQvdCwINGB0YLRgNC+0LrRgwog
ICAgICAgICAgICBoZWxwX3RleHQgPSB1cndpZC5UZXh0KCdFbnRlciBsaXN0IGl0ZW1zIChvbmUg
cGVyIGxpbmUpJykKICAgICAgICAgICAgc2VsZi52YWx1ZV9lZGl0ID0gdXJ3aWQuQXR0ck1hcCgK
ICAgICAgICAgICAgICAgIHVyd2lkLkVkaXQoJycsIG11bHRpbGluZT1UcnVlKSwKICAgICAgICAg
ICAgICAgICdpbnB1dCcsCiAgICAgICAgICAgICAgICAnaW5wdXRfZm9jdXMnCiAgICAgICAgICAg
ICkKICAgICAgICAgICAgc2VsZi52YWx1ZV9jb250YWluZXIuY29udGVudHMuZXh0ZW5kKFsKICAg
ICAgICAgICAgICAgIChoZWxwX3RleHQsICgncGFjaycsIE5vbmUpKSwKICAgICAgICAgICAgICAg
ICh1cndpZC5MaW5lQm94KHNlbGYudmFsdWVfZWRpdCksICgnd2VpZ2h0JywgMSkpCiAgICAgICAg
ICAgIF0pCgogICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3NldCc6CiAgICAgICAgICAgICMg0JTQ
u9GPIHNldCAtINC+0LTQvdC+INC30L3QsNGH0LXQvdC40LUg0L3QsCDRgdGC0YDQvtC60YMKICAg
ICAgICAgICAgaGVscF90ZXh0ID0gdXJ3aWQuVGV4dCgnRW50ZXIgc2V0IG1lbWJlcnMgKG9uZSBw
ZXIgbGluZSknKQogICAgICAgICAgICBzZWxmLnZhbHVlX2VkaXQgPSB1cndpZC5BdHRyTWFwKAog
ICAgICAgICAgICAgICAgdXJ3aWQuRWRpdCgnJywgbXVsdGlsaW5lPVRydWUpLAogICAgICAgICAg
ICAgICAgJ2lucHV0JywKICAgICAgICAgICAgICAgICdpbnB1dF9mb2N1cycKICAgICAgICAgICAg
KQogICAgICAgICAgICBzZWxmLnZhbHVlX2NvbnRhaW5lci5jb250ZW50cy5leHRlbmQoWwogICAg
ICAgICAgICAgICAgKGhlbHBfdGV4dCwgKCdwYWNrJywgTm9uZSkpLAogICAgICAgICAgICAgICAg
KHVyd2lkLkxpbmVCb3goc2VsZi52YWx1ZV9lZGl0KSwgKCd3ZWlnaHQnLCAxKSkKICAgICAgICAg
ICAgXSkKCiAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnenNldCc6CiAgICAgICAgICAgICMg0JTQ
u9GPIHpzZXQgLSBzY29yZTptZW1iZXIg0L/QsNGA0YsKICAgICAgICAgICAgaGVscF90ZXh0ID0g
dXJ3aWQuVGV4dCgnRW50ZXIgc2NvcmVkIGl0ZW1zIChmb3JtYXQ6IHNjb3JlOm1lbWJlciwgb25l
IHBlciBsaW5lKScpCiAgICAgICAgICAgIHNlbGYudmFsdWVfZWRpdCA9IHVyd2lkLkF0dHJNYXAo
CiAgICAgICAgICAgICAgICB1cndpZC5FZGl0KCcnLCBtdWx0aWxpbmU9VHJ1ZSksCiAgICAgICAg
ICAgICAgICAnaW5wdXQnLAogICAgICAgICAgICAgICAgJ2lucHV0X2ZvY3VzJwogICAgICAgICAg
ICApCiAgICAgICAgICAgIHNlbGYudmFsdWVfY29udGFpbmVyLmNvbnRlbnRzLmV4dGVuZChbCiAg
ICAgICAgICAgICAgICAoaGVscF90ZXh0LCAoJ3BhY2snLCBOb25lKSksCiAgICAgICAgICAgICAg
ICAodXJ3aWQuTGluZUJveChzZWxmLnZhbHVlX2VkaXQpLCAoJ3dlaWdodCcsIDEpKQogICAgICAg
ICAgICBdKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICAjINCU0LvRjyDQvtGB0YLQsNC70YzQ
vdGL0YUg0YLQuNC/0L7QsgogICAgICAgICAgICBoZWxwX3RleHQgPSB1cndpZC5UZXh0KGYne2tl
eV90eXBlfSB0eXBlIC0gdXNlIGFwcHJvcHJpYXRlIGZvcm1hdCcpCiAgICAgICAgICAgIHNlbGYu
dmFsdWVfZWRpdCA9IHVyd2lkLkF0dHJNYXAoCiAgICAgICAgICAgICAgICB1cndpZC5FZGl0KCcn
LCBtdWx0aWxpbmU9VHJ1ZSksCiAgICAgICAgICAgICAgICAnaW5wdXQnLAogICAgICAgICAgICAg
ICAgJ2lucHV0X2ZvY3VzJwogICAgICAgICAgICApCiAgICAgICAgICAgIHNlbGYudmFsdWVfY29u
dGFpbmVyLmNvbnRlbnRzLmV4dGVuZChbCiAgICAgICAgICAgICAgICAoaGVscF90ZXh0LCAoJ3Bh
Y2snLCBOb25lKSksCiAgICAgICAgICAgICAgICAodXJ3aWQuTGluZUJveChzZWxmLnZhbHVlX2Vk
aXQpLCAoJ3dlaWdodCcsIDEpKQogICAgICAgICAgICBdKQoKICAgIGRlZiBnZXRfdmFsdWVfdGV4
dChzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIi0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0LzQ
tdGC0L7QtCDQv9C+0LvRg9GH0LXQvdC40Y8g0YLQtdC60YHRgtCwINC40LcgdmFsdWVfZWRpdCIi
IgogICAgICAgIGlmIHNlbGYudmFsdWVfZWRpdDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYudmFs
dWVfZWRpdC5iYXNlX3dpZGdldC5nZXRfZWRpdF90ZXh0KCkuc3RyaXAoKQogICAgICAgIHJldHVy
biAnJwoKICAgIGRlZiBvbl9zYXZlKHNlbGYsIGJ1dHRvbik6CiAgICAgICAgIiIi0KHQvtGF0YDQ
sNC90LXQvdC40LUg0LrQu9GO0YfQsCIiIgogICAgICAgIGtleSA9IHNlbGYua2V5X2VkaXQuYmFz
ZV93aWRnZXQuZ2V0X2VkaXRfdGV4dCgpLnN0cmlwKCkKICAgICAgICBrZXlfdHlwZSA9IHNlbGYu
Y3VycmVudF90eXBlCiAgICAgICAgdHRsX3RleHQgPSBzZWxmLnR0bF9lZGl0LmJhc2Vfd2lkZ2V0
LmdldF9lZGl0X3RleHQoKS5zdHJpcCgpCgogICAgICAgIGlmIG5vdCBrZXk6CiAgICAgICAgICAg
IHNlbGYuc2hvd19lcnJvcigiS2V5IGNhbm5vdCBiZSBlbXB0eSIpCiAgICAgICAgICAgIHJldHVy
bgoKICAgICAgICAjINCf0YDQvtCy0LXRgNC60LAg0LTQu9GPINC60LvQsNGB0YLQtdGA0LAKICAg
ICAgICBpZiBzZWxmLmNvbm5lY3Rpb24uaXNfY2x1c3RlcjoKICAgICAgICAgICAgaWYgJ3snIGlu
IGtleSBhbmQgJ30nIGluIGtleToKICAgICAgICAgICAgICAgIGltcG9ydCByZQogICAgICAgICAg
ICAgICAgaWYgbm90IHJlLnNlYXJjaChyJ1x7Lio/XH0nLCBrZXkpOgogICAgICAgICAgICAgICAg
ICAgIHNlbGYuc2hvd19lcnJvcigiSW52YWxpZCBoYXNoIHRhZyBmb3JtYXQuIFVzZSB7dGFnfSBm
b3JtYXQuIikKICAgICAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdHJ5OgogICAgICAg
ICAgICB0dGwgPSBpbnQodHRsX3RleHQpIGlmIHR0bF90ZXh0IGVsc2UgTm9uZQogICAgICAgICAg
ICBjbGllbnQgPSBzZWxmLmNvbm5lY3Rpb24uYWN0aXZlX2NsaWVudAogICAgICAgICAgICB2YWx1
ZSA9IHNlbGYuZ2V0X3ZhbHVlX3RleHQoKQoKICAgICAgICAgICAgIyDQn9GA0Lgg0YDQtdC00LDQ
utGC0LjRgNC+0LLQsNC90LjQuCDRg9C00LDQu9GP0LXQvCDRgdGC0LDRgNGL0Lkg0LrQu9GO0Ycg
0LXRgdC70Lgg0YLQuNC/INC40LfQvNC10L3QuNC70YHRjwogICAgICAgICAgICBpZiBzZWxmLmVk
aXRfa2V5OgogICAgICAgICAgICAgICAgb2xkX3R5cGUgPSBjbGllbnQudHlwZShzZWxmLmVkaXRf
a2V5KQogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShvbGRfdHlwZSwgYnl0ZXMpOgogICAg
ICAgICAgICAgICAgICAgIG9sZF90eXBlID0gb2xkX3R5cGUuZGVjb2RlKCd1dGYtOCcpCiAgICAg
ICAgICAgICAgICBpZiBvbGRfdHlwZSAhPSBrZXlfdHlwZToKICAgICAgICAgICAgICAgICAgICBj
bGllbnQuZGVsZXRlKHNlbGYuZWRpdF9rZXkpCgogICAgICAgICAgICBpZiBrZXlfdHlwZSA9PSAn
c3RyaW5nJzoKICAgICAgICAgICAgICAgIGlmIG5vdCB2YWx1ZToKICAgICAgICAgICAgICAgICAg
ICBzZWxmLnNob3dfZXJyb3IoIlZhbHVlIGNhbm5vdCBiZSBlbXB0eSIpCiAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAjINCf0YDQtdC+0LHRgNCw0LfRg9C10Lwg0LzQ
vdC+0LPQvtGB0YLRgNC+0YfQvdGL0Lkg0LLQstC+0LQg0LIg0L7QtNC90YMg0YHRgtGA0L7QutGD
INGBIFxuCiAgICAgICAgICAgICAgICBmaW5hbF92YWx1ZSA9ICdcXG4nLmpvaW4odmFsdWUuc3Bs
aXQoJ1xuJykpCiAgICAgICAgICAgICAgICBjbGllbnQuc2V0KGtleSwgZmluYWxfdmFsdWUpCgog
ICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdoYXNoJzoKICAgICAgICAgICAgICAgIHBhaXJz
ID0ge30KICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIHZhbHVlLnNwbGl0KCdcbicpOgogICAg
ICAgICAgICAgICAgICAgIGxpbmUgPSBsaW5lLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBp
ZiAnOicgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICAgICAgaywgdiA9IGxpbmUuc3BsaXQo
JzonLCAxKQogICAgICAgICAgICAgICAgICAgICAgICBwYWlyc1trLnN0cmlwKCldID0gdi5zdHJp
cCgpCiAgICAgICAgICAgICAgICBpZiBub3QgcGFpcnM6CiAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5zaG93X2Vycm9yKCJBdCBsZWFzdCBvbmUgZmllbGQ6dmFsdWUgcGFpciByZXF1aXJlZCIpCiAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAjINCf0YDQuCDRgNC10LTQ
sNC60YLQuNGA0L7QstCw0L3QuNC4INGB0L3QsNGH0LDQu9CwINC+0YfQuNGJ0LDQtdC8CiAgICAg
ICAgICAgICAgICBpZiBzZWxmLmVkaXRfa2V5OgogICAgICAgICAgICAgICAgICAgIGNsaWVudC5k
ZWxldGUoa2V5KQogICAgICAgICAgICAgICAgY2xpZW50LmhzZXQoa2V5LCBtYXBwaW5nPXBhaXJz
KQoKICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnbGlzdCc6CiAgICAgICAgICAgICAgICBp
dGVtcyA9IFtpdGVtLnN0cmlwKCkgZm9yIGl0ZW0gaW4gdmFsdWUuc3BsaXQoJ1xuJykgaWYgaXRl
bS5zdHJpcCgpXQogICAgICAgICAgICAgICAgaWYgbm90IGl0ZW1zOgogICAgICAgICAgICAgICAg
ICAgIHNlbGYuc2hvd19lcnJvcigiQXQgbGVhc3Qgb25lIGVsZW1lbnQgcmVxdWlyZWQiKQogICAg
ICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgIyDQn9GA0Lgg0YDQtdC00LDQ
utGC0LjRgNC+0LLQsNC90LjQuCDRgdC90LDRh9Cw0LvQsCDQvtGH0LjRidCw0LXQvAogICAgICAg
ICAgICAgICAgaWYgc2VsZi5lZGl0X2tleToKICAgICAgICAgICAgICAgICAgICBjbGllbnQuZGVs
ZXRlKGtleSkKICAgICAgICAgICAgICAgIGNsaWVudC5ycHVzaChrZXksICppdGVtcykKCiAgICAg
ICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3NldCc6CiAgICAgICAgICAgICAgICBpdGVtcyA9IFtp
dGVtLnN0cmlwKCkgZm9yIGl0ZW0gaW4gdmFsdWUuc3BsaXQoJ1xuJykgaWYgaXRlbS5zdHJpcCgp
XQogICAgICAgICAgICAgICAgaWYgbm90IGl0ZW1zOgogICAgICAgICAgICAgICAgICAgIHNlbGYu
c2hvd19lcnJvcigiQXQgbGVhc3Qgb25lIG1lbWJlciByZXF1aXJlZCIpCiAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAjINCf0YDQuCDRgNC10LTQsNC60YLQuNGA0L7Q
stCw0L3QuNC4INGB0L3QsNGH0LDQu9CwINC+0YfQuNGJ0LDQtdC8CiAgICAgICAgICAgICAgICBp
ZiBzZWxmLmVkaXRfa2V5OgogICAgICAgICAgICAgICAgICAgIGNsaWVudC5kZWxldGUoa2V5KQog
ICAgICAgICAgICAgICAgY2xpZW50LnNhZGQoa2V5LCAqaXRlbXMpCgogICAgICAgICAgICBlbGlm
IGtleV90eXBlID09ICd6c2V0JzoKICAgICAgICAgICAgICAgIHBhaXJzID0ge30KICAgICAgICAg
ICAgICAgIGZvciBsaW5lIGluIHZhbHVlLnNwbGl0KCdcbicpOgogICAgICAgICAgICAgICAgICAg
IGxpbmUgPSBsaW5lLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBpZiAnOicgaW4gbGluZToK
ICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyLCBzY29yZSA9IGxpbmUucnNwbGl0KCc6Jywg
MSkKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcGFpcnNbbWVtYmVyLnN0cmlwKCldID0gZmxvYXQoc2NvcmUuc3RyaXAoKSkKICAgICAgICAg
ICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzZWxmLnNob3dfZXJyb3IoZiJJbnZhbGlkIHNjb3JlIGluIGxpbmU6IHtsaW5lfSIpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGlmIG5vdCBw
YWlyczoKICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoIkF0IGxlYXN0IG9uZSBt
ZW1iZXI6c2NvcmUgcGFpciByZXF1aXJlZCIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAg
ICAgICAgICAgICAgICAjINCf0YDQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC4INGB0L3Q
sNGH0LDQu9CwINC+0YfQuNGJ0LDQtdC8CiAgICAgICAgICAgICAgICBpZiBzZWxmLmVkaXRfa2V5
OgogICAgICAgICAgICAgICAgICAgIGNsaWVudC5kZWxldGUoa2V5KQogICAgICAgICAgICAgICAg
Y2xpZW50LnphZGQoa2V5LCBwYWlycykKCiAgICAgICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ2Jp
dG1hcCc6CiAgICAgICAgICAgICAgICBjbGllbnQuc2V0KGtleSwgJycpCgogICAgICAgICAgICAg
ICAgYml0X3NldCA9IEZhbHNlCiAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiB2YWx1ZS5zcGxp
dCgnXG4nKToKICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAg
ICAgICAgICAgICAgaWYgJzonIGluIGxpbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNl
dF9zdHIsIGJpdF9zdHIgPSBsaW5lLnNwbGl0KCc6JywgMSkKICAgICAgICAgICAgICAgICAgICAg
ICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gaW50KG9mZnNldF9z
dHIuc3RyaXAoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCA9IGludChiaXRfc3Ry
LnN0cmlwKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBiaXQgbm90IGluICgwLCAx
KToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoZiJCaXQg
dmFsdWUgbXVzdCBiZSAwIG9yIDEsIGdvdDoge2JpdH0iKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNsaWVudC5kZWxldGUoa2V5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LmV4ZWN1dGVfY29t
bWFuZCgnU0VUQklUJywga2V5LCBvZmZzZXQsIGJpdCwga2V5PWtleSkKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGJpdF9zZXQgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2Vw
dCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93X2Vycm9y
KGYiSW52YWxpZCBvZmZzZXQ6Yml0IGZvcm1hdCBpbiBsaW5lOiB7bGluZX0iKQogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY2xpZW50LmRlbGV0ZShrZXkpCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4KCiAgICAgICAgICAgICAgICBpZiBub3QgYml0X3NldDoKICAgICAgICAg
ICAgICAgICAgICBzZWxmLnNob3dfZXJyb3IoIkF0IGxlYXN0IG9uZSBvZmZzZXQ6Yml0IHBhaXIg
cmVxdWlyZWQiKQogICAgICAgICAgICAgICAgICAgIGNsaWVudC5kZWxldGUoa2V5KQogICAgICAg
ICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnc3RyZWFt
JzoKICAgICAgICAgICAgICAgIGZpZWxkcyA9IHt9CiAgICAgICAgICAgICAgICBmb3IgbGluZSBp
biB2YWx1ZS5zcGxpdCgnXG4nKToKICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZS5zdHJp
cCgpCiAgICAgICAgICAgICAgICAgICAgaWYgJzonIGluIGxpbmU6CiAgICAgICAgICAgICAgICAg
ICAgICAgIGssIHYgPSBsaW5lLnNwbGl0KCc6JywgMSkKICAgICAgICAgICAgICAgICAgICAgICAg
ZmllbGRzW2suc3RyaXAoKV0gPSB2LnN0cmlwKCkKCiAgICAgICAgICAgICAgICBpZiBub3QgZmll
bGRzOgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd19lcnJvcigiQXQgbGVhc3Qgb25lIGZp
ZWxkOnZhbHVlIHBhaXIgcmVxdWlyZWQgZm9yIHN0cmVhbSBlbnRyeSIpCiAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuCgogICAgICAgICAgICAgICAgYXJncyA9IFtrZXksICcqJ10KICAgICAgICAg
ICAgICAgIGZvciBrLCB2IGluIGZpZWxkcy5pdGVtcygpOgogICAgICAgICAgICAgICAgICAgIGFy
Z3MuZXh0ZW5kKFtrLCB2XSkKCiAgICAgICAgICAgICAgICBjbGllbnQuZXhlY3V0ZV9jb21tYW5k
KCdYQUREJywgKmFyZ3MsIGtleT1rZXkpCgogICAgICAgICAgICAjINCj0YHRgtCw0L3QsNCy0LvQ
uNCy0LDQtdC8IFRUTCDQtdGB0LvQuCDRg9C60LDQt9Cw0L0KICAgICAgICAgICAgaWYgdHRsOgog
ICAgICAgICAgICAgICAgY2xpZW50LmV4cGlyZShrZXksIHR0bCkKCiAgICAgICAgICAgIGFjdGlv
biA9ICJVcGRhdGVkIiBpZiBzZWxmLmVkaXRfa2V5IGVsc2UgIkNyZWF0ZWQiCiAgICAgICAgICAg
IGxvZ2dlci5pbmZvKGYie2FjdGlvbn0ga2V5OiB7a2V5fSAodHlwZToge2tleV90eXBlfSkiKQog
ICAgICAgICAgICBzZWxmLm9uX3N1Y2Nlc3MoKQogICAgICAgICAgICBzZWxmLl9lbWl0KCdjbG9z
ZScpCgogICAgICAgIGV4Y2VwdCBSZWRpc0NsdXN0ZXJFcnJvciBhcyBlOgogICAgICAgICAgICBz
ZWxmLnNob3dfZXJyb3IoZiJDbHVzdGVyIGVycm9yOiB7ZX0iKQogICAgICAgICAgICBsb2dnZXIu
ZXJyb3IoZiJDbHVzdGVyIGVycm9yIHdpdGgga2V5OiB7ZX0iKQogICAgICAgIGV4Y2VwdCBSZWRp
c0Vycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuc2hvd19lcnJvcihmIlJlZGlzIGVycm9yOiB7
ZX0iKQogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJSZWRpcyBlcnJvciB3aXRoIGtleToge2V9
IikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuc2hvd19l
cnJvcihmIkZhaWxlZCB0byBzYXZlIGtleToge2V9IikKICAgICAgICAgICAgbG9nZ2VyLmVycm9y
KGYiRmFpbGVkIHRvIHNhdmUga2V5OiB7ZX0iLCBleGNfaW5mbz1UcnVlKQoKICAgIGRlZiBzaG93
X2Vycm9yKHNlbGYsIG1lc3NhZ2UpOgogICAgICAgICIiItCf0L7QutCw0LfQsNGC0Ywg0YHQvtC+
0LHRidC10L3QuNC1INC+0LEg0L7RiNC40LHQutC1IiIiCiAgICAgICAgc2VsZi5lcnJvcl90ZXh0
LnNldF90ZXh0KCgnZXJyb3InLCBmIuKdjCBFcnJvcjoge21lc3NhZ2V9IikpCgogICAgZGVmIG9u
X2NhbmNlbChzZWxmLCBidXR0b24pOgogICAgICAgICIiItCe0YLQvNC10L3QsCIiIgogICAgICAg
IHNlbGYucmVxdWVzdF9jbG9zZSgpCgoKY2xhc3MgU2Nyb2xsQmFyKHVyd2lkLldpZGdldFdyYXAp
OgogICAgIiIi0J/RgNC+0YHRgtC+0Lkg0LjQvdC00LjQutCw0YLQvtGAINC/0YDQvtC60YDRg9GC
0LrQuCDQtNC70Y8gTGlzdEJveCIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB3aWRnZXQpOgog
ICAgICAgICIiIgogICAgICAgIHdpZGdldCAtIExpc3RCb3gg0LjQu9C4IFBpbGUg0YEgTGlzdEJv
eCDQstC90YPRgtGA0LgKICAgICAgICAiIiIKICAgICAgICBzZWxmLndpZGdldCA9IHdpZGdldAog
ICAgICAgIHNlbGYuc2Nyb2xsYmFyX3dpZHRoID0gMQoKICAgICAgICAjINCd0LDRhdC+0LTQuNC8
IExpc3RCb3gg0LLQvdGD0YLRgNC4INCy0LjQtNC20LXRgtCwCiAgICAgICAgc2VsZi5saXN0Ym94
ID0gc2VsZi5fZmluZF9saXN0Ym94KHdpZGdldCkKCiAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDR
gtC10LrRgdGC0L7QstGL0Lkg0LjQvdC00LjQutCw0YLQvtGACiAgICAgICAgc2VsZi5zY3JvbGxi
YXJfdGV4dCA9IHVyd2lkLlRleHQoJ+KUgicsIGFsaWduPSdsZWZ0JykKCiAgICAgICAgIyDQmtC+
0LzQsdC40L3QuNGA0YPQtdC8INC+0YHQvdC+0LLQvdC+0Lkg0LLQuNC00LbQtdGCINC4INGB0LrR
gNC+0LvQu9Cx0LDRgAogICAgICAgIHNlbGYuY29sdW1ucyA9IHVyd2lkLkNvbHVtbnMoWwogICAg
ICAgICAgICAoJ3dlaWdodCcsIDEsIHdpZGdldCksCiAgICAgICAgICAgICgnZ2l2ZW4nLCBzZWxm
LnNjcm9sbGJhcl93aWR0aCwgdXJ3aWQuQXR0ck1hcCgKICAgICAgICAgICAgICAgIHVyd2lkLkZp
bGxlcihzZWxmLnNjcm9sbGJhcl90ZXh0LCB2YWxpZ249J3RvcCcpLAogICAgICAgICAgICAgICAg
J3Njcm9sbGJhcicKICAgICAgICAgICAgKSksCiAgICAgICAgXSwgZGl2aWRlY2hhcnM9MCkKCiAg
ICAgICAgc3VwZXIoKS5fX2luaXRfXyhzZWxmLmNvbHVtbnMpCgogICAgZGVmIF9maW5kX2xpc3Ri
b3goc2VsZiwgd2lkZ2V0KToKICAgICAgICAiIiLQoNC10LrRg9GA0YHQuNCy0L3QviDQuNGJ0LXQ
vCBMaXN0Qm94INCy0L3Rg9GC0YDQuCDQstC40LTQttC10YLQsCIiIgogICAgICAgIGlmIGlzaW5z
dGFuY2Uod2lkZ2V0LCB1cndpZC5MaXN0Qm94KToKICAgICAgICAgICAgcmV0dXJuIHdpZGdldAog
ICAgICAgIGVsaWYgaGFzYXR0cih3aWRnZXQsICdvcmlnaW5hbF93aWRnZXQnKToKICAgICAgICAg
ICAgcmV0dXJuIHNlbGYuX2ZpbmRfbGlzdGJveCh3aWRnZXQub3JpZ2luYWxfd2lkZ2V0KQogICAg
ICAgIGVsaWYgaXNpbnN0YW5jZSh3aWRnZXQsIHVyd2lkLlBpbGUpOgogICAgICAgICAgICBmb3Ig
aXRlbSwgXyBpbiB3aWRnZXQuY29udGVudHM6CiAgICAgICAgICAgICAgICBsYiA9IHNlbGYuX2Zp
bmRfbGlzdGJveChpdGVtKQogICAgICAgICAgICAgICAgaWYgbGI6CiAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIGxiCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgcmVuZGVyKHNlbGYsIHNp
emUsIGZvY3VzPUZhbHNlKToKICAgICAgICAiIiLQntCx0L3QvtCy0LvRj9C10Lwg0LjQvdC00LjQ
utCw0YLQvtGAINC/0YDQuCDQutCw0LbQtNC+0Lkg0L7RgtGA0LjRgdC+0LLQutC1IiIiCiAgICAg
ICAgbWF4Y29sLCBtYXhyb3cgPSBzaXplCgogICAgICAgIGlmIHNlbGYubGlzdGJveCBpcyBOb25l
OgogICAgICAgICAgICByZXR1cm4gc2VsZi5jb2x1bW5zLnJlbmRlcihzaXplLCBmb2N1cykKCiAg
ICAgICAgdHJ5OgogICAgICAgICAgICB3YWxrZXIgPSBzZWxmLmxpc3Rib3guYm9keQoKICAgICAg
ICAgICAgaWYgbm90IGhhc2F0dHIod2Fsa2VyLCAnX19sZW5fXycpIG9yIGxlbih3YWxrZXIpID09
IDA6CiAgICAgICAgICAgICAgICAjINCf0YPRgdGC0L7QuSDRgdC/0LjRgdC+0LoKICAgICAgICAg
ICAgICAgIHNlbGYuc2Nyb2xsYmFyX3RleHQuc2V0X3RleHQoJyAnICogbWF4cm93KQogICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgdG90YWxfaXRlbXMgPSBsZW4od2Fsa2VyKQoKICAg
ICAgICAgICAgICAgICMg0J/QvtC70YPRh9Cw0LXQvCDRgtC10LrRg9GJ0YPRjiDQv9C+0LfQuNGG
0LjRjiDRhNC+0LrRg9GB0LAKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAg
ICBmb2N1c19wb3MgPSB3YWxrZXIuZm9jdXMKICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNp
bnN0YW5jZShmb2N1c19wb3MsIGludCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzX3Bv
cyA9IDAKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBmb2N1c19w
b3MgPSAwCgogICAgICAgICAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDQstC40LfRg9Cw0LvRjNC9
0YvQuSDQuNC90LTQuNC60LDRgtC+0YAKICAgICAgICAgICAgICAgIGlmIHRvdGFsX2l0ZW1zIDw9
IG1heHJvdzoKICAgICAgICAgICAgICAgICAgICAjINCS0YHRkSDQv9C+0LzQtdGJ0LDQtdGC0YHR
jyDQvdCwINGN0LrRgNCw0L0KICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3IgPSAn4paIJyAq
IG1heHJvdwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjINCV0YHR
gtGMINC/0YDQvtC60YDRg9GC0LrQsAogICAgICAgICAgICAgICAgICAgIGxpbmVzID0gW10KCiAg
ICAgICAgICAgICAgICAgICAgIyDQktGL0YfQuNGB0LvRj9C10Lwg0YDQsNC30LzQtdGAINC4INC/
0L7Qt9C40YbQuNGOICLQv9C+0LvQt9GD0L3QutCwIgogICAgICAgICAgICAgICAgICAgIHRodW1i
X3NpemUgPSBtYXgoMSwgaW50KG1heHJvdyAqIG1heHJvdyAvIHRvdGFsX2l0ZW1zKSkKICAgICAg
ICAgICAgICAgICAgICBzY3JvbGxfcHJvZ3Jlc3MgPSBmb2N1c19wb3MgLyBtYXgoMSwgdG90YWxf
aXRlbXMgLSAxKQogICAgICAgICAgICAgICAgICAgIHRodW1iX3BvcyA9IGludChzY3JvbGxfcHJv
Z3Jlc3MgKiAobWF4cm93IC0gdGh1bWJfc2l6ZSkpCgogICAgICAgICAgICAgICAgICAgIGZvciBp
IGluIHJhbmdlKG1heHJvdyk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGkgPT0gMCBhbmQg
Zm9jdXNfcG9zID4gMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzLmFwcGVuZCgn
4payJykgICMg0KHRgtGA0LXQu9C60LAg0LLQstC10YDRhSAtINC10YHRgtGMINC00LDQvdC90YvQ
tSDQstGL0YjQtQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIGkgPT0gbWF4cm93IC0gMSBh
bmQgZm9jdXNfcG9zIDwgdG90YWxfaXRlbXMgLSAxOgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbGluZXMuYXBwZW5kKCfilrwnKSAgIyDQodGC0YDQtdC70LrQsCDQstC90LjQtyAtINC10YHR
gtGMINC00LDQvdC90YvQtSDQvdC40LbQtQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIHRo
dW1iX3BvcyA8PSBpIDwgdGh1bWJfcG9zICsgdGh1bWJfc2l6ZToKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGxpbmVzLmFwcGVuZCgn4paIJykgICMg0J/QvtC70LfRg9C90L7QugogICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZXMu
YXBwZW5kKCfilIInKSAgIyDQlNC+0YDQvtC20LrQsAoKICAgICAgICAgICAgICAgICAgICBpbmRp
Y2F0b3IgPSAnXG4nLmpvaW4obGluZXMpCgogICAgICAgICAgICAgICAgc2VsZi5zY3JvbGxiYXJf
dGV4dC5zZXRfdGV4dChpbmRpY2F0b3IpCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToK
ICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGYiU2Nyb2xsQmFyIHVwZGF0ZSBlcnJvcjoge2V9IikK
ICAgICAgICAgICAgIyBGYWxsYmFjawogICAgICAgICAgICBzZWxmLnNjcm9sbGJhcl90ZXh0LnNl
dF90ZXh0KCfilIInICogbWF4cm93KQoKICAgICAgICByZXR1cm4gc2VsZi5jb2x1bW5zLnJlbmRl
cihzaXplLCBmb2N1cykKCgpjbGFzcyBSZWRpc0NvbW1hbmRlclVJOgogICAgIiIi0JPQu9Cw0LLQ
vdC+0LUg0L7QutC90L4g0LIg0YHRgtC40LvQtSBSZWRpcyBDb21tYW5kZXIiIiIKCiAgICBwYWxl
dHRlID0gWwogICAgICAgICgnaGVhZGVyJywgJ3doaXRlJywgJ2RhcmsgYmx1ZScsICdib2xkJyks
CiAgICAgICAgKCdoZWFkZXJfdGV4dCcsICd3aGl0ZScsICdkYXJrIGJsdWUnKSwKICAgICAgICAo
J2Zvb3RlcicsICd3aGl0ZScsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ3NpZGViYXInLCAnbGln
aHQgZ3JheScsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ3NpZGViYXJfZm9jdXMnLCAnd2hpdGUn
LCAnZGFyayBibHVlJywgJ2JvbGQnKSwKICAgICAgICAoJ2Nvbm5lY3Rpb24nLCAnbGlnaHQgY3lh
bicsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ2Nvbm5lY3Rpb25fc2VsZWN0ZWQnLCAnYmxhY2sn
LCAnbGlnaHQgY3lhbicsICdib2xkJyksCiAgICAgICAgKCdrZXlfZm9sZGVyJywgJ3doaXRlJywg
J2RhcmsgYmx1ZScpLAogICAgICAgICgna2V5X2ZvbGRlcl9mb2N1cycsICdibGFjaycsICdsaWdo
dCBjeWFuJywgJ2JvbGQnKSwKICAgICAgICAoJ2tleV9pdGVtJywgJ3llbGxvdycsICdkYXJrIGJs
dWUnKSwKICAgICAgICAoJ2tleV9pdGVtX2ZvY3VzJywgJ2JsYWNrJywgJ2xpZ2h0IGN5YW4nLCAn
Ym9sZCcpLAogICAgICAgICgnYnV0dG9uJywgJ3doaXRlJywgJ2RhcmsgYmx1ZScpLAogICAgICAg
ICgnYnV0dG9uX2ZvY3VzJywgJ3doaXRlJywgJ2xpZ2h0IGJsdWUnLCAnYm9sZCcpLAogICAgICAg
ICgnYnV0dG9uX2RhbmdlcicsICd3aGl0ZScsICdkYXJrIHJlZCcpLAogICAgICAgICgnaW5mb19s
YWJlbCcsICdsaWdodCBjeWFuJywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgnaW5mb192YWx1ZScs
ICd3aGl0ZScsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ3RhYl9hY3RpdmUnLCAnd2hpdGUnLCAn
bGlnaHQgYmx1ZScsICdib2xkJyksCiAgICAgICAgKCd0YWJfaW5hY3RpdmUnLCAnbGlnaHQgZ3Jh
eScsICdkYXJrIGJsdWUnKSwKICAgICAgICAoJ2Vycm9yJywgJ2xpZ2h0IHJlZCcsICdkYXJrIGJs
dWUnKSwKICAgICAgICAoJ3N1Y2Nlc3MnLCAnbGlnaHQgZ3JlZW4nLCAnZGFyayBibHVlJyksCiAg
ICAgICAgKCdkaWFsb2cnLCAnd2hpdGUnLCAnZGFyayBibHVlJyksCiAgICAgICAgKCdiYWNrZ3Jv
dW5kJywgJ3doaXRlJywgJ2RhcmsgYmx1ZScpLAogICAgICAgICgnaW5wdXQnLCAnYmxhY2snLCAn
ZGFyayBjeWFuJyksCiAgICAgICAgKCdpbnB1dF9mb2N1cycsICdibGFjaycsICdsaWdodCBjeWFu
JyksCiAgICAgICAgKCdzY3JvbGxiYXInLCAnZGFyayBncmF5JywgJ2RhcmsgYmx1ZScpLAogICAg
XQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhcmdzKToKICAgICAgICBzZWxmLmNvbm5lY3Rpb25z
OiBEaWN0W3N0ciwgUmVkaXNDb25uZWN0aW9uXSA9IHt9CiAgICAgICAgc2VsZi5jdXJyZW50X2Nv
bm5lY3Rpb246IE9wdGlvbmFsW1JlZGlzQ29ubmVjdGlvbl0gPSBOb25lCiAgICAgICAgc2VsZi5h
cmdzID0gYXJncwoKICAgICAgICAjINCX0LDQs9GA0YPQttCw0LXQvCDQv9GA0L7RhNC40LvQuAog
ICAgICAgIHNlbGYucHJvZmlsZXMgPSBzZWxmLmxvYWRfcHJvZmlsZXMoKQoKICAgICAgICBzZWxm
LnZhbGlkYXRlX3Byb2ZpbGVzKCkKCiAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3ID0gS2V5TGlz
dFZpZXcoKQogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKHNlbGYua2V5X2xpc3Rfdmlldywg
J2tleV9zZWxlY3RlZCcsIHNlbGYub25fa2V5X3NlbGVjdCkKCiAgICAgICAgIyBkZWYgZGVidWdf
d3JhcHBlcigqYXJncywgKiprd2FyZ3MpOgogICAgICAgICMgICAgIGxvZ2dlci5pbmZvKGYiZGVi
dWdfd3JhcHBlciBjYWxsZWQgd2l0aCBhcmdzPXthcmdzfSwga3dhcmdzPXtrd2FyZ3N9IikKICAg
ICAgICAjICAgICBsb2dnZXIuaW5mbyhmIk51bWJlciBvZiBhcmdzOiB7bGVuKGFyZ3MpfSIpCiAg
ICAgICAgIyAgICAgZm9yIGksIGFyZyBpbiBlbnVtZXJhdGUoYXJncyk6CiAgICAgICAgIyAgICAg
ICAgIGxvZ2dlci5pbmZvKGYiICBhcmdbe2l9XTogdHlwZT17dHlwZShhcmcpfSwgdmFsdWU9e2Fy
Z30iKQogICAgICAgICMKICAgICAgICAjICAgICAjINCY0LfQstC70LXQutCw0LXQvCDQutC70Y7R
hyAo0L/QvtGB0LvQtdC00L3QuNC5INCw0YDQs9GD0LzQtdC90YIpCiAgICAgICAgIyAgICAgaWYg
YXJnczoKICAgICAgICAjICAgICAgICAga2V5ID0gYXJnc1stMV0gICMg0JHQtdGA0LXQvCDQv9C+
0YHQu9C10LTQvdC40Lkg0LDRgNCz0YPQvNC10L3RggogICAgICAgICMgICAgICAgICBsb2dnZXIu
aW5mbyhmIkNhbGxpbmcgb25fa2V5X3NlbGVjdCB3aXRoIGtleT17a2V5fSIpCiAgICAgICAgIyAg
ICAgICAgIHNlbGYub25fa2V5X3NlbGVjdChrZXkpCiAgICAgICAgIyAgICAgZWxzZToKICAgICAg
ICAjICAgICAgICAgbG9nZ2VyLmVycm9yKCJObyBhcmdzIHJlY2VpdmVkISIpCiAgICAgICAgIwog
ICAgICAgICMgdXJ3aWQuY29ubmVjdF9zaWduYWwoc2VsZi5rZXlfbGlzdF92aWV3LCAna2V5X3Nl
bGVjdGVkJywgZGVidWdfd3JhcHBlcikKCiAgICAgICAgIyBzZWxmLmtleXNfbGlzdDogTGlzdFti
eXRlc10gPSBbXSAgIyDQn9GA0L7RgdGC0L7QuSDRgdC/0LjRgdC+0Log0LrQu9GO0YfQtdC5CiAg
ICAgICAgc2VsZi5jdXJyZW50X2tleTogT3B0aW9uYWxbYnl0ZXNdID0gTm9uZQogICAgICAgIHNl
bGYuc2VwYXJhdG9yID0gJ+KElicKICAgICAgICBzZWxmLmNvbnNvbGVfbW9kZSA9IEZhbHNlCiAg
ICAgICAgc2VsZi5tYXhfZGIgPSAxNSAgIyBSZWRpcyDQv9C+0LTQtNC10YDQttC40LLQsNC10YIg
MC0xNSDQsdCw0Lcg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4KICAgICAgICBzZWxmLmtleV9jb3Vu
dCA9IDAKCiAgICAgICAgIyDQmNGB0YLQvtGA0LjRjyDQutC+0LzQsNC90LQKICAgICAgICBzZWxm
LmNvbW1hbmRfaGlzdG9yeSA9IFtdICAjINCh0L/QuNGB0L7QuiDQstGB0LXRhSDQutC+0LzQsNC9
0LQKICAgICAgICBzZWxmLmhpc3RvcnlfaW5kZXggPSAtMSAgIyDQotC10LrRg9GJ0LDRjyDQv9C+
0LfQuNGG0LjRjyDQsiDQuNGB0YLQvtGA0LjQuCAoLTEgPSDQvdC+0LLQsNGPINC60L7QvNCw0L3Q
tNCwKQogICAgICAgIHNlbGYuY3VycmVudF9pbnB1dCA9ICcnICAjINCS0YDQtdC80LXQvdC90L7Q
tSDRhdGA0LDQvdC40LvQuNGJ0LUg0LTQu9GPINGC0LXQutGD0YnQtdCz0L4g0LLQstC+0LTQsAoK
ICAgICAgICAjINCh0L7Qt9C00LDQtdC8INC40L3RgtC10YDRhNC10LnRgQogICAgICAgIHNlbGYu
Y3JlYXRlX3VpKCkKCiAgICAgICAgIyDQl9Cw0LPRgNGD0LbQsNC10Lwg0LjRgdGC0L7RgNC40Y4g
0LjQtyDRhNCw0LnQu9CwCiAgICAgICAgc2VsZi5sb2FkX2NvbW1hbmRfaGlzdG9yeSgpCgogICAg
ICAgICMg0JDQstGC0L7QvNCw0YLQuNGH0LXRgdC60Lgg0L/QvtC00LrQu9GO0YfQsNC10LzRgdGP
INC6INC/0LXRgNCy0L7QvNGDINC/0YDQvtGE0LjQu9GOCiAgICAgICAgaWYgc2VsZi5wcm9maWxl
czoKICAgICAgICAgICAgZmlyc3RfcHJvZmlsZSA9IGxpc3Qoc2VsZi5wcm9maWxlcy52YWx1ZXMo
KSlbMF0KICAgICAgICAgICAgc2VsZi5jb25uZWN0X3RvX3Byb2ZpbGUoZmlyc3RfcHJvZmlsZSkK
CiAgICAgICAgc2VsZi5sb29wID0gdXJ3aWQuTWFpbkxvb3AoCiAgICAgICAgICAgIHNlbGYubWFp
bl9mcmFtZSwKICAgICAgICAgICAgcGFsZXR0ZT1zZWxmLnBhbGV0dGUsCiAgICAgICAgICAgIHVu
aGFuZGxlZF9pbnB1dD1zZWxmLmhhbmRsZV9pbnB1dCwKICAgICAgICAgICAgcG9wX3Vwcz1UcnVl
CiAgICAgICAgKQoKICAgIGRlZiBsb2FkX2NvbW1hbmRfaGlzdG9yeShzZWxmKToKICAgICAgICAi
IiLQl9Cw0LPRgNGD0LfQuNGC0Ywg0LjRgdGC0L7RgNC40Y4g0LrQvtC80LDQvdC0INC40Lcg0YTQ
sNC50LvQsCIiIgogICAgICAgIGhpc3RvcnlfZmlsZSA9IG9zLnBhdGguZXhwYW5kdXNlcignfi8u
cmVkaXNfY29tbWFuZGVyX2hpc3RvcnknKQogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgb3Mu
cGF0aC5leGlzdHMoaGlzdG9yeV9maWxlKToKICAgICAgICAgICAgICAgIHdpdGggb3BlbihoaXN0
b3J5X2ZpbGUsICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoKICAgICAgICAgICAgICAgICAg
ICBzZWxmLmNvbW1hbmRfaGlzdG9yeSA9IFtsaW5lLnN0cmlwKCkgZm9yIGxpbmUgaW4gZiBpZiBs
aW5lLnN0cmlwKCldCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkxvYWRlZCB7bGVuKHNl
bGYuY29tbWFuZF9oaXN0b3J5KX0gY29tbWFuZHMgZnJvbSBoaXN0b3J5IikKICAgICAgICBleGNl
cHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBs
b2FkIGNvbW1hbmQgaGlzdG9yeToge2V9IikKCiAgICBkZWYgc2F2ZV9jb21tYW5kX2hpc3Rvcnko
c2VsZik6CiAgICAgICAgIiIi0KHQvtGF0YDQsNC90LjRgtGMINC40YHRgtC+0YDQuNGOINC60L7Q
vNCw0L3QtCDQsiDRhNCw0LnQuyIiIgogICAgICAgIGhpc3RvcnlfZmlsZSA9IG9zLnBhdGguZXhw
YW5kdXNlcignfi8ucmVkaXNfY29tbWFuZGVyX2hpc3RvcnknKQogICAgICAgIHRyeToKICAgICAg
ICAgICAgIyDQodC+0YXRgNCw0L3Rj9C10Lwg0L/QvtGB0LvQtdC00L3QuNC1IDEwMDAg0LrQvtC8
0LDQvdC0CiAgICAgICAgICAgIHdpdGggb3BlbihoaXN0b3J5X2ZpbGUsICd3JywgZW5jb2Rpbmc9
J3V0Zi04JykgYXMgZjoKICAgICAgICAgICAgICAgIGZvciBjbWQgaW4gc2VsZi5jb21tYW5kX2hp
c3RvcnlbLTEwMDpdOgogICAgICAgICAgICAgICAgICAgIGYud3JpdGUoY21kICsgJ1xuJykKICAg
ICAgICAgICAgbG9nZ2VyLmluZm8oZiJTYXZlZCB7bGVuKHNlbGYuY29tbWFuZF9oaXN0b3J5KX0g
Y29tbWFuZHMgdG8gaGlzdG9yeSIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAg
ICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gc2F2ZSBjb21tYW5kIGhpc3Rvcnk6IHtl
fSIpCgogICAgZGVmIGFkZF90b19oaXN0b3J5KHNlbGYsIGNvbW1hbmQ6IHN0cik6CiAgICAgICAg
IiIi0JTQvtCx0LDQstC40YLRjCDQutC+0LzQsNC90LTRgyDQsiDQuNGB0YLQvtGA0LjRjiIiIgog
ICAgICAgIGNvbW1hbmQgPSBjb21tYW5kLnN0cmlwKCkKICAgICAgICBpZiBub3QgY29tbWFuZDoK
ICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMg0J3QtSDQtNC+0LHQsNCy0LvRj9C10Lwg0LTR
g9Cx0LvQuNC60LDRgtGLINC/0L7QtNGA0Y/QtAogICAgICAgIGlmIHNlbGYuY29tbWFuZF9oaXN0
b3J5IGFuZCBzZWxmLmNvbW1hbmRfaGlzdG9yeVstMV0gPT0gY29tbWFuZDoKICAgICAgICAgICAg
cmV0dXJuCgogICAgICAgIHNlbGYuY29tbWFuZF9oaXN0b3J5LmFwcGVuZChjb21tYW5kKQogICAg
ICAgIHNlbGYuaGlzdG9yeV9pbmRleCA9IC0xICAjINCh0LHRgNCw0YHRi9Cy0LDQtdC8INC40L3Q
tNC10LrRgQogICAgICAgIHNlbGYuY3VycmVudF9pbnB1dCA9ICcnCgogICAgICAgICMg0KHQvtGF
0YDQsNC90Y/QtdC8INC40YHRgtC+0YDQuNGOCiAgICAgICAgc2VsZi5zYXZlX2NvbW1hbmRfaGlz
dG9yeSgpCgogICAgZGVmIG5hdmlnYXRlX2hpc3Rvcnkoc2VsZiwgZGlyZWN0aW9uOiBzdHIpOgog
ICAgICAgICIiItCd0LDQstC40LPQsNGG0LjRjyDQv9C+INC40YHRgtC+0YDQuNC4INC60L7QvNCw
0L3QtAoKICAgICAgICBBcmdzOgogICAgICAgICAgICBkaXJlY3Rpb246ICd1cCcg0LjQu9C4ICdk
b3duJwogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLmNvbW1hbmRfaGlzdG9yeToKICAg
ICAgICAgICAgcmV0dXJuCgogICAgICAgICMg0KHQvtGF0YDQsNC90Y/QtdC8INGC0LXQutGD0YnQ
uNC5INCy0LLQvtC0INC10YHQu9C4INC80Ysg0LIg0YDQtdC20LjQvNC1INC90L7QstC+0Lkg0LrQ
vtC80LDQvdC00YsKICAgICAgICBpZiBzZWxmLmhpc3RvcnlfaW5kZXggPT0gLTE6CiAgICAgICAg
ICAgIHNlbGYuY3VycmVudF9pbnB1dCA9IHNlbGYuY29tbWFuZF9wcm9tcHQuZ2V0X2VkaXRfdGV4
dCgpCgogICAgICAgIGlmIGRpcmVjdGlvbiA9PSAndXAnOgogICAgICAgICAgICAjINCY0LTQtdC8
INC90LDQt9Cw0LQg0LIg0LjRgdGC0L7RgNC40LgKICAgICAgICAgICAgaWYgc2VsZi5oaXN0b3J5
X2luZGV4ID09IC0xOgogICAgICAgICAgICAgICAgIyDQn9C10YDQstC+0LUg0L3QsNC20LDRgtC4
0LUgLSDQv9C10YDQtdGF0L7QtNC40Lwg0Log0L/QvtGB0LvQtdC00L3QtdC5INC60L7QvNCw0L3Q
tNC1CiAgICAgICAgICAgICAgICBzZWxmLmhpc3RvcnlfaW5kZXggPSBsZW4oc2VsZi5jb21tYW5k
X2hpc3RvcnkpIC0gMQogICAgICAgICAgICBlbGlmIHNlbGYuaGlzdG9yeV9pbmRleCA+IDA6CiAg
ICAgICAgICAgICAgICBzZWxmLmhpc3RvcnlfaW5kZXggLT0gMQoKICAgICAgICBlbGlmIGRpcmVj
dGlvbiA9PSAnZG93bic6CiAgICAgICAgICAgICMg0JjQtNC10Lwg0LLQv9C10YDQtdC0INCyINC4
0YHRgtC+0YDQuNC4CiAgICAgICAgICAgIGlmIHNlbGYuaGlzdG9yeV9pbmRleCA9PSAtMToKICAg
ICAgICAgICAgICAgICMg0KPQttC1INCyINGA0LXQttC40LzQtSDQvdC+0LLQvtC5INC60L7QvNCw
0L3QtNGLCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZWxpZiBzZWxmLmhpc3Rv
cnlfaW5kZXggPCBsZW4oc2VsZi5jb21tYW5kX2hpc3RvcnkpIC0gMToKICAgICAgICAgICAgICAg
IHNlbGYuaGlzdG9yeV9pbmRleCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAg
ICAjINCU0L7RiNC70Lgg0LTQviDQutC+0L3RhtCwIC0g0LLQvtC30LLRgNCw0YnQsNC10LzRgdGP
INC6INGC0LXQutGD0YnQtdC80YMg0LLQstC+0LTRgwogICAgICAgICAgICAgICAgc2VsZi5oaXN0
b3J5X2luZGV4ID0gLTEKICAgICAgICAgICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHQuc2V0X2Vk
aXRfdGV4dChzZWxmLmN1cnJlbnRfaW5wdXQpCiAgICAgICAgICAgICAgICBzZWxmLmNvbW1hbmRf
cHJvbXB0LnNldF9lZGl0X3BvcyhsZW4oc2VsZi5jdXJyZW50X2lucHV0KSkKICAgICAgICAgICAg
ICAgIHJldHVybgoKICAgICAgICAjINCj0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INGC0LXQutGB
0YIg0LjQtyDQuNGB0YLQvtGA0LjQuAogICAgICAgIGlmIHNlbGYuaGlzdG9yeV9pbmRleCA+PSAw
OgogICAgICAgICAgICBjb21tYW5kID0gc2VsZi5jb21tYW5kX2hpc3Rvcnlbc2VsZi5oaXN0b3J5
X2luZGV4XQogICAgICAgICAgICBzZWxmLmNvbW1hbmRfcHJvbXB0LnNldF9lZGl0X3RleHQoY29t
bWFuZCkKICAgICAgICAgICAgc2VsZi5jb21tYW5kX3Byb21wdC5zZXRfZWRpdF9wb3MobGVuKGNv
bW1hbmQpKQoKICAgIGRlZiBnZXRfa2V5X3R5cGVfaWNvbihzZWxmLCBrZXk6IHN0cikgLT4gc3Ry
OgogICAgICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg0LjQutC+0L3QutGDINC00LvRjyDRgtC40L/Q
sCDQutC70Y7Rh9CwICjQv9GA0L7RgdGC0YvQtSDRgdC40LzQstC+0LvRiykiIiIKCiAgICAgICAg
IyDQkNC70YzRgtC10YDQvdCw0YLQuNCy0LA6IEFTQ0lJINGB0LjQvNCy0L7Qu9GLCiAgICAgICAg
YXNjaWlfaWNvbnMgPSB7CiAgICAgICAgICAgICdzdHJpbmcnOiAnW1N0XSAnLAogICAgICAgICAg
ICAnaGFzaCc6ICdbSHNdICcsCiAgICAgICAgICAgICdsaXN0JzogJ1tMaV0gJywKICAgICAgICAg
ICAgJ3NldCc6ICdbU2VdICcsCiAgICAgICAgICAgICd6c2V0JzogJ1tac10gJywKICAgICAgICAg
ICAgJ3N0cmVhbSc6ICdbVHJdICcsCiAgICAgICAgICAgICdub25lJzogJ1tOb10gJywKICAgICAg
ICAgICAgJ3Vua25vd24nOiAnWz9dICcsCiAgICAgICAgfQoKICAgICAgICAjINCY0YHQv9C+0LvR
jNC30YPQtdC8IGFzY2lpX2ljb25zINC00LvRjyDQvNCw0LrRgdC40LzQsNC70YzQvdC+0Lkg0YHQ
vtCy0LzQtdGB0YLQuNC80L7RgdGC0LgKICAgICAgICBpY29uX3NldCA9IGFzY2lpX2ljb25zCgog
ICAgICAgIGlmIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBub3Qgc2VsZi5jdXJyZW50
X2Nvbm5lY3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4gaWNvbl9zZXRbJ3Vua25v
d24nXQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNsaWVudCA9IHNlbGYuY3VycmVudF9jb25u
ZWN0aW9uLmFjdGl2ZV9jbGllbnQKICAgICAgICAgICAga2V5X3R5cGUgPSBjbGllbnQudHlwZShr
ZXkuZW5jb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScpKQoKICAgICAgICAgICAgaWYgaXNp
bnN0YW5jZShrZXlfdHlwZSwgYnl0ZXMpOgogICAgICAgICAgICAgICAga2V5X3R5cGUgPSBrZXlf
dHlwZS5kZWNvZGUoJ3V0Zi04JykubG93ZXIoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAg
ICAgICAga2V5X3R5cGUgPSBzdHIoa2V5X3R5cGUpLmxvd2VyKCkKCiAgICAgICAgICAgIHJldHVy
biBpY29uX3NldC5nZXQoa2V5X3R5cGUsIGljb25fc2V0Wyd1bmtub3duJ10pCiAgICAgICAgZXhj
ZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBnZXR0
aW5nIGtleSB0eXBlIGZvciB7a2V5fToge2V9IikKICAgICAgICAgICAgcmV0dXJuIGljb25fc2V0
Wyd1bmtub3duJ10KCiAgICBkZWYgbG9hZF9wcm9maWxlcyhzZWxmKSAtPiBEaWN0W3N0ciwgQ29u
bmVjdGlvblByb2ZpbGVdOgogICAgICAgICIiItCX0LDQs9GA0YPQt9C60LAg0L/RgNC+0YTQuNC7
0LXQuSDRgSDQv9C+0LTQtNC10YDQttC60L7QuSDRgtGA0LXRhSDRgNC10LbQuNC80L7QsiIiIgoK
ICAgICAgICAjINCe0L/RgNC10LTQtdC70Y/QtdC8INGA0LXQttC40Lwg0YDQsNCx0L7RgtGLCiAg
ICAgICAgaWYgc2VsZi5hcmdzLnZhdWx0X3VybDoKICAgICAgICAgICAgIyDQoNC10LbQuNC8IDM6
IFZhdWx0CiAgICAgICAgICAgIHByb2ZpbGVzX2RhdGEgPSBzZWxmLl9sb2FkX2Zyb21fdmF1bHQo
KQogICAgICAgIGVsaWYgc2VsZi5hcmdzLmVuY3J5cHRlZF9jb25maWc6CiAgICAgICAgICAgICMg
0KDQtdC20LjQvCAyOiDQl9Cw0YjQuNGE0YDQvtCy0LDQvdC90YvQuSDRhNCw0LnQuwogICAgICAg
ICAgICBwcm9maWxlc19kYXRhID0gc2VsZi5fbG9hZF9lbmNyeXB0ZWRfY29uZmlnKHNlbGYuYXJn
cy5lbmNyeXB0ZWRfY29uZmlnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMg0KDQtdC20LjQ
vCAxOiDQntCx0YvRh9C90YvQuSDRhNCw0LnQuwogICAgICAgICAgICBwcm9maWxlc19kYXRhID0g
c2VsZi5fbG9hZF9wbGFpbnRleHRfY29uZmlnKHNlbGYuYXJncy5jb25maWcpCgogICAgICAgICMg
0J/QsNGA0YHQuNC8INC30LDQs9GA0YPQttC10L3QvdGL0LUg0LTQsNC90L3Ri9C1INCyINC/0YDQ
vtGE0LjQu9C4CiAgICAgICAgcmV0dXJuIHNlbGYuX3BhcnNlX3Byb2ZpbGVzKHByb2ZpbGVzX2Rh
dGEpCgogICAgZGVmIF9sb2FkX3BsYWludGV4dF9jb25maWcoc2VsZiwgY29uZmlnX3BhdGg6IHN0
cikgLT4gZGljdDoKICAgICAgICAiIiLQoNC10LbQuNC8IDE6INCX0LDQs9GA0YPQt9C60LAg0LjQ
tyDQvtCx0YvRh9C90L7Qs9C+IEpTT04g0YTQsNC50LvQsCIiIgogICAgICAgIGlmIG5vdCBvcy5w
YXRoLmV4aXN0cyhjb25maWdfcGF0aCk6CiAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiQ29u
ZmlnIGZpbGUgbm90IGZvdW5kOiB7Y29uZmlnX3BhdGh9IikKICAgICAgICAgICAgcmV0dXJuIHt9
CgogICAgICAgIHRyeToKICAgICAgICAgICAgd2l0aCBvcGVuKGNvbmZpZ19wYXRoLCAncicpIGFz
IGY6CiAgICAgICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkKGYpCiAgICAgICAgZXhjZXB0IGpz
b24uSlNPTkRlY29kZUVycm9yIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkludmFs
aWQgSlNPTiBpbiBjb25maWcgZmlsZToge2V9IikKICAgICAgICAgICAgcmV0dXJuIHt9CiAgICAg
ICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWls
ZWQgdG8gbG9hZCBjb25maWc6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiBf
bG9hZF9lbmNyeXB0ZWRfY29uZmlnKHNlbGYsIGNvbmZpZ19wYXRoOiBzdHIpIC0+IGRpY3Q6CiAg
ICAgICAgIiIi0KDQtdC20LjQvCAyOiDQl9Cw0LPRgNGD0LfQutCwINC40Lcg0LfQsNGI0LjRhNGA
0L7QstCw0L3QvdC+0LPQviDRhNCw0LnQu9CwIiIiCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhp
c3RzKGNvbmZpZ19wYXRoKToKICAgICAgICAgICAgc2VsZi5fZXhpdF9lcnJvcihmIkVuY3J5cHRl
ZCBjb25maWcgZmlsZSBub3QgZm91bmQ6IHtjb25maWdfcGF0aH0iKQoKICAgICAgICB0cnk6CiAg
ICAgICAgICAgIHdpdGggb3Blbihjb25maWdfcGF0aCwgJ3JiJykgYXMgZjoKICAgICAgICAgICAg
ICAgIGZpbGVfZGF0YSA9IGYucmVhZCgpCgogICAgICAgICAgICAjINCf0LXRgNCy0YvQtSAxNiDQ
sdCw0LnRgiAtINGN0YLQviBzYWx0CiAgICAgICAgICAgIGlmIGxlbihmaWxlX2RhdGEpIDwgMTY6
CiAgICAgICAgICAgICAgICBzZWxmLl9leGl0X2Vycm9yKCJFbmNyeXB0ZWQgZmlsZSBpcyBjb3Jy
dXB0ZWQgKHRvbyBzaG9ydCkiKQoKICAgICAgICAgICAgc2FsdCA9IGZpbGVfZGF0YVs6MTZdCiAg
ICAgICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZmlsZV9kYXRhWzE2Ol0KCiAgICAgICAgICAgICMg
0JfQsNC/0YDQsNGI0LjQstCw0LXQvCDQv9Cw0YDQvtC70YwKICAgICAgICAgICAgcGFzc3dvcmQg
PSBnZXRwYXNzLmdldHBhc3MoIkVudGVyIGRlY3J5cHRpb24gcGFzc3dvcmQ6ICIpCgogICAgICAg
ICAgICAjINCT0LXQvdC10YDQuNGA0YPQtdC8INC60LvRjtGHICjQv9Cw0YDQsNC80LXRgtGA0Ysg
0JTQntCb0JbQndCrINGB0L7QstC/0LDQtNCw0YLRjCDRgSBlbmNyeXB0b3IucHkpCiAgICAgICAg
ICAgIGtkZiA9IFBCS0RGMkhNQUMoCiAgICAgICAgICAgICAgICBhbGdvcml0aG09aGFzaGVzLlNI
QTI1NigpLAogICAgICAgICAgICAgICAgbGVuZ3RoPTMyLAogICAgICAgICAgICAgICAgc2FsdD1z
YWx0LAogICAgICAgICAgICAgICAgaXRlcmF0aW9ucz0xMDAwMDAsCiAgICAgICAgICAgICAgICBi
YWNrZW5kPWRlZmF1bHRfYmFja2VuZCgpCiAgICAgICAgICAgICkKICAgICAgICAgICAga2V5ID0g
YmFzZTY0LnVybHNhZmVfYjY0ZW5jb2RlKGtkZi5kZXJpdmUocGFzc3dvcmQuZW5jb2RlKCd1dGYt
OCcpKSkKCiAgICAgICAgICAgIGYgPSBGZXJuZXQoa2V5KQoKICAgICAgICAgICAgIyDQoNCw0YHR
iNC40YTRgNC+0LLRi9Cy0LDQtdC8CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGRl
Y3J5cHRlZF9kYXRhID0gZi5kZWNyeXB0KGVuY3J5cHRlZF9kYXRhKQogICAgICAgICAgICAgICAg
cmV0dXJuIGpzb24ubG9hZHMoZGVjcnlwdGVkX2RhdGEuZGVjb2RlKCd1dGYtOCcpKQogICAgICAg
ICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICAgICAgc2VsZi5fZXhpdF9lcnJvcigi
RGVjcnlwdGlvbiBmYWlsZWQhIEludmFsaWQgcGFzc3dvcmQgb3IgY29ycnVwdGVkIGZpbGUuIikK
CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLl9leGl0X2Vy
cm9yKGYiRXJyb3IgcmVhZGluZyBlbmNyeXB0ZWQgY29uZmlnOiB7ZX0iKQoKICAgIGRlZiBfbG9h
ZF9mcm9tX3ZhdWx0KHNlbGYpIC0+IGRpY3Q6CiAgICAgICAgIiIi0KDQtdC20LjQvCAzOiDQl9Cw
0LPRgNGD0LfQutCwINC40LcgSGFzaGlDb3JwIFZhdWx0IiIiCiAgICAgICAgdmF1bHRfdXJsID0g
c2VsZi5hcmdzLnZhdWx0X3VybAogICAgICAgIHZhdWx0X3BhdGggPSBzZWxmLmFyZ3MudmF1bHRf
cGF0aAoKICAgICAgICBpZiBub3QgdmF1bHRfcGF0aDoKICAgICAgICAgICAgc2VsZi5fZXhpdF9l
cnJvcigiLS12YXVsdC1wYXRoIGlzIHJlcXVpcmVkIHdoZW4gdXNpbmcgVmF1bHQgbW9kZSIpCgog
ICAgICAgICMg0J/QvtC70YPRh9Cw0LXQvCDRg9GH0LXRgtC90YvQtSDQtNCw0L3QvdGL0LUKICAg
ICAgICB1c2VybmFtZSA9IHNlbGYuYXJncy52YXVsdF91c2VyCiAgICAgICAgaWYgbm90IHVzZXJu
YW1lOgogICAgICAgICAgICB1c2VybmFtZSA9IGlucHV0KCJWYXVsdCB1c2VybmFtZTogIikKCiAg
ICAgICAgcGFzc3dvcmQgPSBzZWxmLmFyZ3MudmF1bHRfcGFzcwogICAgICAgIGlmIG5vdCBwYXNz
d29yZDoKICAgICAgICAgICAgcGFzc3dvcmQgPSBnZXRwYXNzLmdldHBhc3MoIlZhdWx0IHBhc3N3
b3JkOiAiKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgICMg0J/QvtC00LrQu9GO0YfQsNC10LzR
gdGPINC6IFZhdWx0CiAgICAgICAgICAgIGNsaWVudCA9IGh2YWMuQ2xpZW50KHVybD12YXVsdF91
cmwpCgogICAgICAgICAgICAjINCQ0YPRgtC10L3RgtC40YTQuNC60LDRhtC40Y8gKHVzZXJwYXNz
INC80LXRgtC+0LQpCiAgICAgICAgICAgIGNsaWVudC5hdXRoLnVzZXJwYXNzLmxvZ2luKAogICAg
ICAgICAgICAgICAgdXNlcm5hbWU9dXNlcm5hbWUsCiAgICAgICAgICAgICAgICBwYXNzd29yZD1w
YXNzd29yZAogICAgICAgICAgICApCgogICAgICAgICAgICBpZiBub3QgY2xpZW50LmlzX2F1dGhl
bnRpY2F0ZWQoKToKICAgICAgICAgICAgICAgIHNlbGYuX2V4aXRfZXJyb3IoIlZhdWx0IGF1dGhl
bnRpY2F0aW9uIGZhaWxlZCIpCgogICAgICAgICAgICAjINCn0LjRgtCw0LXQvCDRgdC10LrRgNC1
0YIg0LjQtyBLViB2MgogICAgICAgICAgICAjINCU0LvRjyBLViB2MiDQv9GD0YLRjCDQtNC+0LvQ
ttC10L0g0YHQvtC00LXRgNC20LDRgtGMIC9kYXRhLwogICAgICAgICAgICBzZWNyZXRfcmVzcG9u
c2UgPSBjbGllbnQuc2VjcmV0cy5rdi52Mi5yZWFkX3NlY3JldF92ZXJzaW9uKAogICAgICAgICAg
ICAgICAgcGF0aD12YXVsdF9wYXRoLnJlcGxhY2UoJ3NlY3JldC9kYXRhLycsICcnKS5yZXBsYWNl
KCdzZWNyZXQvJywgJycpCiAgICAgICAgICAgICkKCiAgICAgICAgICAgICMg0JjQt9Cy0LvQtdC6
0LDQtdC8INC00LDQvdC90YvQtQogICAgICAgICAgICBwcm9maWxlc19kYXRhID0gc2VjcmV0X3Jl
c3BvbnNlWydkYXRhJ11bJ2RhdGEnXQogICAgICAgICAgICByZXR1cm4gcHJvZmlsZXNfZGF0YQoK
ICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuX2V4aXRfZXJy
b3IoZiJGYWlsZWQgdG8gbG9hZCBmcm9tIFZhdWx0OiB7ZX0iKQoKICAgIGRlZiBfcGFyc2VfcHJv
ZmlsZXMoc2VsZiwgZGF0YTogZGljdCkgLT4gRGljdFtzdHIsIENvbm5lY3Rpb25Qcm9maWxlXToK
ICAgICAgICAiIiLQn9Cw0YDRgdC40L3QsyDQt9Cw0LPRgNGD0LbQtdC90L3Ri9GFINC00LDQvdC9
0YvRhSDQsiDQvtCx0YrQtdC60YLRiyBDb25uZWN0aW9uUHJvZmlsZSIiIgogICAgICAgIHByb2Zp
bGVzID0ge30KCiAgICAgICAgZm9yIG5hbWUsIGNvbmZpZyBpbiBkYXRhLml0ZW1zKCk6CiAgICAg
ICAgICAgICMg0J/QvtC00LPQvtGC0LDQstC70LjQstCw0LXQvCDQutC+0L3RhNC40LMg0LTQu9GP
IENvbm5lY3Rpb25Qcm9maWxlCiAgICAgICAgICAgIGNsZWFuX2NvbmZpZyA9IHt9CgogICAgICAg
ICAgICAjINCR0LDQt9C+0LLRi9C1INC/0LDRgNCw0LzQtdGC0YDRiwogICAgICAgICAgICBiYXNl
X3BhcmFtcyA9IFsnbmFtZScsICdob3N0JywgJ3BvcnQnLCAncGFzc3dvcmQnLCAndXNlcm5hbWUn
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAnc3NsJywgJ3NzbF92ZXJpZnknLCAnc29ja2V0
X3BhdGgnLCAncmVhZG9ubHknLCAnc3NsX2NhX2NlcnRzJywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJ3NzbF9jZXJ0ZmlsZScsICdzc2xfa2V5ZmlsZSddCiAgICAgICAgICAgIGZvciBwYXJh
bSBpbiBiYXNlX3BhcmFtczoKICAgICAgICAgICAgICAgIGlmIHBhcmFtIGluIGNvbmZpZzoKICAg
ICAgICAgICAgICAgICAgICBjbGVhbl9jb25maWdbcGFyYW1dID0gY29uZmlnW3BhcmFtXQoKICAg
ICAgICAgICAgIyDQn9Cw0YDQsNC80LXRgtGA0Ysg0LrQu9Cw0YHRgtC10YDQsAogICAgICAgICAg
ICBpZiAnY2x1c3Rlcl9tb2RlJyBpbiBjb25maWc6CiAgICAgICAgICAgICAgICBjbGVhbl9jb25m
aWdbJ2NsdXN0ZXJfbW9kZSddID0gYm9vbChjb25maWdbJ2NsdXN0ZXJfbW9kZSddKQoKICAgICAg
ICAgICAgIyDQntCx0YDQsNCx0L7RgtC60LAgY2x1c3Rlcl9ub2RlcwogICAgICAgICAgICBpZiAn
Y2x1c3Rlcl9ub2RlcycgaW4gY29uZmlnOgogICAgICAgICAgICAgICAgbm9kZXMgPSBjb25maWdb
J2NsdXN0ZXJfbm9kZXMnXQogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShub2RlcywgbGlz
dCk6CiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkX25vZGVzID0gW10KICAgICAgICAgICAg
ICAgICAgICBmb3Igbm9kZSBpbiBub2RlczoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNp
bnN0YW5jZShub2RlLCBzdHIpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQpNC+0YDQ
vNCw0YIgImhvc3Q6cG9ydCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICc6JyBpbiBu
b2RlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QsIHBvcnRfc3RyID0gbm9k
ZS5zcGxpdCgnOicsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0ID0gaW50KHBvcnRfc3RyKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRfbm9kZXMuYXBwZW5kKCho
b3N0LCBwb3J0KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVF
cnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmco
ZiJJbnZhbGlkIHBvcnQgaW4gbm9kZSB7bm9kZX0iKQogICAgICAgICAgICAgICAgICAgICAgICBl
bGlmIGlzaW5zdGFuY2Uobm9kZSwgZGljdCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAj
INCk0L7RgNC80LDRgiB7Imhvc3QiOiAiLi4uIiwgInBvcnQiOiAuLi59CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBob3N0ID0gbm9kZS5nZXQoJ2hvc3QnLCAnbG9jYWxob3N0JykKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBvcnQgPSBub2RlLmdldCgncG9ydCcsIDYzNzkpCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcG9ydCA9IGludChwb3J0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1h
dHRlZF9ub2Rlcy5hcHBlbmQoKGhvc3QsIHBvcnQpKQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9n
Z2VyLndhcm5pbmcoZiJJbnZhbGlkIHBvcnQgaW4gbm9kZSB7bm9kZX0iKQogICAgICAgICAgICAg
ICAgICAgICAgICBlbGlmIGlzaW5zdGFuY2Uobm9kZSwgbGlzdCkgYW5kIGxlbihub2RlKSA9PSAy
OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQpNC+0YDQvNCw0YIgWyJob3N0IiwgcG9y
dF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QsIHBvcnQgPSBub2RlWzBdLCBub2Rl
WzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcG9ydCA9IGludChwb3J0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGZvcm1hdHRlZF9ub2Rlcy5hcHBlbmQoKHN0cihob3N0KSwgcG9ydCkpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIkludmFsaWQgcG9ydCBpbiBub2RlIHtub2RlfSIp
CiAgICAgICAgICAgICAgICAgICAgaWYgZm9ybWF0dGVkX25vZGVzOgogICAgICAgICAgICAgICAg
ICAgICAgICBjbGVhbl9jb25maWdbJ2NsdXN0ZXJfbm9kZXMnXSA9IGZvcm1hdHRlZF9ub2RlcwoK
ICAgICAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDQv9GA0L7RhNC40LvRjAogICAgICAgICAgICB0
cnk6CiAgICAgICAgICAgICAgICAjINCj0LHQtdC00LjQvNGB0Y8sINGH0YLQviDQtdGB0YLRjCBo
b3N0INC4IHBvcnQKICAgICAgICAgICAgICAgIGlmICdob3N0JyBub3QgaW4gY2xlYW5fY29uZmln
OgogICAgICAgICAgICAgICAgICAgIGlmICdjbHVzdGVyX25vZGVzJyBpbiBjbGVhbl9jb25maWcg
YW5kIGNsZWFuX2NvbmZpZ1snY2x1c3Rlcl9ub2RlcyddOgogICAgICAgICAgICAgICAgICAgICAg
ICBjbGVhbl9jb25maWdbJ2hvc3QnXSA9IGNsZWFuX2NvbmZpZ1snY2x1c3Rlcl9ub2RlcyddWzBd
WzBdCiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuX2NvbmZpZ1sncG9ydCddID0gY2xlYW5f
Y29uZmlnWydjbHVzdGVyX25vZGVzJ11bMF1bMV0KICAgICAgICAgICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgICAgICAgICBjbGVhbl9jb25maWdbJ2hvc3QnXSA9ICdsb2NhbGhvc3Qn
CiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuX2NvbmZpZ1sncG9ydCddID0gNjM3OQoKICAg
ICAgICAgICAgICAgIHByb2ZpbGVzW25hbWVdID0gQ29ubmVjdGlvblByb2ZpbGUoKipjbGVhbl9j
b25maWcpCiAgICAgICAgICAgIGV4Y2VwdCBUeXBlRXJyb3IgYXMgZToKICAgICAgICAgICAgICAg
IGxvZ2dlci5lcnJvcihmIkludmFsaWQgY29uZmlnIGZvciBwcm9maWxlICd7bmFtZX0nOiB7ZX0i
KQogICAgICAgICAgICAgICAgIyDQn9GA0L7QsdGD0LXQvCDRgdC+0LfQtNCw0YLRjCDQv9GA0L7R
hNC40LvRjCDRgSDQvNC40L3QuNC80LDQu9GM0L3Ri9C80Lgg0L/QsNGA0LDQvNC10YLRgNCw0LzQ
uAogICAgICAgICAgICAgICAgbWluaW1hbF9jb25maWcgPSB7CiAgICAgICAgICAgICAgICAgICAg
J25hbWUnOiBuYW1lLAogICAgICAgICAgICAgICAgICAgICdob3N0JzogY29uZmlnLmdldCgnaG9z
dCcsICdsb2NhbGhvc3QnKSwKICAgICAgICAgICAgICAgICAgICAncG9ydCc6IGNvbmZpZy5nZXQo
J3BvcnQnLCA2Mzc5KSwKICAgICAgICAgICAgICAgICAgICAnY2x1c3Rlcl9tb2RlJzogY29uZmln
LmdldCgnY2x1c3Rlcl9tb2RlJywgRmFsc2UpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICBpZiAncGFzc3dvcmQnIGluIGNvbmZpZzoKICAgICAgICAgICAgICAgICAgICBtaW5pbWFs
X2NvbmZpZ1sncGFzc3dvcmQnXSA9IGNvbmZpZ1sncGFzc3dvcmQnXQogICAgICAgICAgICAgICAg
cHJvZmlsZXNbbmFtZV0gPSBDb25uZWN0aW9uUHJvZmlsZSgqKm1pbmltYWxfY29uZmlnKQoKICAg
ICAgICAjINCf0YDQvtGE0LjQu9GMINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOLCDQtdGB0LvQuCDQ
tNCw0L3QvdGL0YUg0L3QtdGCCiAgICAgICAgaWYgbm90IHByb2ZpbGVzOgogICAgICAgICAgICBw
cm9maWxlc1snbG9jYWxob3N0J10gPSBDb25uZWN0aW9uUHJvZmlsZSgnbG9jYWxob3N0JywgJ2xv
Y2FsaG9zdCcsIDYzNzkpCgogICAgICAgIHJldHVybiBwcm9maWxlcwoKICAgIGRlZiBfZXhpdF9l
cnJvcihzZWxmLCBtZXNzYWdlOiBzdHIpOgogICAgICAgICIiItCS0YvQstC+0LQg0L7RiNC40LHQ
utC4INC4INCy0YvRhdC+0LQg0LjQtyDQv9GA0L7Qs9GA0LDQvNC80YsiIiIKICAgICAgICBwcmlu
dChmIkVSUk9SOiB7bWVzc2FnZX0iLCBmaWxlPXN5cy5zdGRlcnIpCiAgICAgICAgbG9nZ2VyLmVy
cm9yKG1lc3NhZ2UpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBkZWYgdmFsaWRhdGVfcHJvZmls
ZXMoc2VsZik6CiAgICAgICAgIiIi0JLQsNC70LjQtNCw0YbQuNGPINC30LDQs9GA0YPQttC10L3Q
vdGL0YUg0L/RgNC+0YTQuNC70LXQuSIiIgogICAgICAgIGZvciBuYW1lLCBwcm9maWxlIGluIHNl
bGYucHJvZmlsZXMuaXRlbXMoKToKICAgICAgICAgICAgaWYgcHJvZmlsZS5jbHVzdGVyX21vZGU6
CiAgICAgICAgICAgICAgICAjINCf0YDQvtCy0LXRgNC60LAg0YPQt9C70L7QsiDQutC70LDRgdGC
0LXRgNCwCiAgICAgICAgICAgICAgICBpZiBub3QgaGFzYXR0cihwcm9maWxlLCAnY2x1c3Rlcl9u
b2RlcycpIG9yIG5vdCBwcm9maWxlLmNsdXN0ZXJfbm9kZXM6CiAgICAgICAgICAgICAgICAgICAg
bG9nZ2VyLndhcm5pbmcoZiJQcm9maWxlICd7bmFtZX0nIGhhcyBjbHVzdGVyX21vZGU9VHJ1ZSBi
dXQgbm8gY2x1c3Rlcl9ub2RlcyBkZWZpbmVkIikKICAgICAgICAgICAgICAgICAgICBwcm9maWxl
LmNsdXN0ZXJfbW9kZSA9IEZhbHNlICAjINCe0YLQutC70Y7Rh9Cw0LXQvCDRgNC10LbQuNC8INC6
0LvQsNGB0YLQtdGA0LAKCiAgICAgICAgICAgICAgICAjINCf0YDQvtCy0LXRgNC60LAg0YTQvtGA
0LzQsNGC0LAg0YPQt9C70L7QsgogICAgICAgICAgICAgICAgZm9yIGksIG5vZGUgaW4gZW51bWVy
YXRlKHByb2ZpbGUuY2x1c3Rlcl9ub2Rlcyk6CiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlz
aW5zdGFuY2Uobm9kZSwgKGxpc3QsIHR1cGxlKSkgb3IgbGVuKG5vZGUpICE9IDI6CiAgICAgICAg
ICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIlByb2ZpbGUgJ3tuYW1lfSc6IEludmFsaWQg
bm9kZSBmb3JtYXQgYXQgaW5kZXgge2l9OiB7bm9kZX0iKQogICAgICAgICAgICAgICAgICAgIGVs
aWYgbm90IGlzaW5zdGFuY2Uobm9kZVswXSwgc3RyKSBvciBub3QgaXNpbnN0YW5jZShub2RlWzFd
LCBpbnQpOgogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJQcm9maWxlICd7
bmFtZX0nOiBOb2RlIHtpfSBzaG91bGQgYmUgKGhvc3Q6c3RyLCBwb3J0OmludCkiKQoKICAgICAg
ICAgICAgIyDQn9GA0L7QstC10YDQutCwINC+0LHRj9C30LDRgtC10LvRjNC90YvRhSDQv9C+0LvQ
tdC5INC00LvRjyBzdGFuZGFsb25lCiAgICAgICAgICAgIGVsaWYgbm90IHByb2ZpbGUuc29ja2V0
X3BhdGggYW5kIChub3QgcHJvZmlsZS5ob3N0IG9yIG5vdCBwcm9maWxlLnBvcnQpOgogICAgICAg
ICAgICAgICAgbG9nZ2VyLmVycm9yKGYiUHJvZmlsZSAne25hbWV9JyBtaXNzaW5nIGhvc3QvcG9y
dCBmb3Igc3RhbmRhbG9uZSBjb25uZWN0aW9uIikKCiAgICAgICAgbG9nZ2VyLmluZm8oZiJWYWxp
ZGF0ZWQge2xlbihzZWxmLnByb2ZpbGVzKX0gcHJvZmlsZXMiKQoKICAgIGRlZiBjcmVhdGVfdG9v
bGJhcihzZWxmKToKICAgICAgICAiIiLQodC+0LfQtNCw0L3QuNC1IHRvb2xiYXIg0YEg0LrQvdC+
0L/QutCw0LzQuCIiIgogICAgICAgIHJldHVybiB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAg
KCd3ZWlnaHQnLCAyMCwgdXJ3aWQuQXR0ck1hcChzZWxmLmhlbHBfYnRuLCAnYnV0dG9uJywgJ2J1
dHRvbl9mb2N1cycpKSwKICAgICAgICAgICAgKCdwYWNrJywgdXJ3aWQuVGV4dCgnICcpKSwKICAg
ICAgICAgICAgKCd3ZWlnaHQnLCAyMCwgdXJ3aWQuQXR0ck1hcChzZWxmLmNvbW1hbmRzX2J0biwg
J2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAgICgncGFjaycsIHVyd2lkLlRl
eHQoJyAnKSksCiAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0dHJNYXAoc2VsZi5h
ZGRfa2V5X2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAgICAgICgncGFj
aycsIHVyd2lkLlRleHQoJyAnKSksCiAgICAgICAgICAgICgnd2VpZ2h0JywgMjAsIHVyd2lkLkF0
dHJNYXAoc2VsZi5lZGl0X2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSksCiAgICAgICAg
ICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuVGV4dCgnJykpLAogICAgICAgICAgICAoJ3dlaWdodCcs
IDIwLCB1cndpZC5BdHRyTWFwKHNlbGYuZGVsZXRlX2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9j
dXMnKSksCiAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuVGV4dCgnJykpLAogICAgICAg
ICAgICAoJ3dlaWdodCcsIDIwLCB1cndpZC5BdHRyTWFwKHNlbGYuZGlzY29ubmVjdF9idG4sICdi
dXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5UZXh0
KCcgJykpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDIwLCB1cndpZC5BdHRyTWFwKHNlbGYuZXhp
dF9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgICAgICAoJ3BhY2snLCB1
cndpZC5UZXh0KCcgJykpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDIwLCB1cndpZC5BdHRyTWFw
KHNlbGYucmVmcmVzaF9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJykpLAogICAgICAgIF0s
IGRpdmlkZWNoYXJzPTApCgogICAgZGVmIGNyZWF0ZV91aShzZWxmKToKICAgICAgICAiIiLQodC+
0LfQtNCw0L3QuNC1INC40L3RgtC10YDRhNC10LnRgdCwIiIiCiAgICAgICAgIyBIZWFkZXIKICAg
ICAgICBoZWFkZXJfdGV4dCA9IHVyd2lkLlRleHQoWwogICAgICAgICAgICAoJ2hlYWRlcl90ZXh0
JywgJyDil48gJyksCiAgICAgICAgICAgICgnaGVhZGVyX3RleHQnLCAnUmVkaXMgQ29tbWFuZGVy
IFRVSScpCiAgICAgICAgXSwgYWxpZ249J2xlZnQnKQoKICAgICAgICBzZWxmLmhlYWRlciA9IHVy
d2lkLkF0dHJNYXAoCiAgICAgICAgICAgIHVyd2lkLlBhZGRpbmcoaGVhZGVyX3RleHQsIGxlZnQ9
MSwgcmlnaHQ9MSksCiAgICAgICAgICAgICdoZWFkZXInCiAgICAgICAgKQoKICAgICAgICAjIFRv
b2xiYXIKICAgICAgICBzZWxmLmNvcHlfYnRuID0gdXJ3aWQuQnV0dG9uKCdGNTogQ29weScpCiAg
ICAgICAgc2VsZi5tb3ZlX2J0biA9IHVyd2lkLkJ1dHRvbignRjY6IE1vdmUnKQogICAgICAgIHNl
bGYucmVmcmVzaF9idG4gPSB1cndpZC5CdXR0b24oJ0YxMTogUmVmcmVzaCcpCiAgICAgICAgc2Vs
Zi5kZWxldGVfYnRuID0gdXJ3aWQuQnV0dG9uKCdGODogRGVsZXRlJykKICAgICAgICBzZWxmLmNv
bW1hbmRzX2J0biA9IHVyd2lkLkJ1dHRvbignRjI6IENvbW1hbmRzJykKICAgICAgICBzZWxmLmFk
ZF9rZXlfYnRuID0gdXJ3aWQuQnV0dG9uKCdGMzogQWRkIE5ldyBLZXknKQogICAgICAgIHNlbGYu
ZWRpdF9idG4gPSB1cndpZC5CdXR0b24oJ0Y0OiBFZGl0JykKICAgICAgICBzZWxmLmRpc2Nvbm5l
Y3RfYnRuID0gdXJ3aWQuQnV0dG9uKCdGOTogRGlzY29ubmVjdCcpCiAgICAgICAgc2VsZi5oZWxw
X2J0biA9IHVyd2lkLkJ1dHRvbignRjE6IEhlbHAnKQogICAgICAgIHNlbGYuZXhpdF9idG4gPSB1
cndpZC5CdXR0b24oJ0YxMDogRXhpdCcpCgogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKHNl
bGYucmVmcmVzaF9idG4sICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLnJlZnJlc2hfa2V5cygpKQog
ICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKHNlbGYuZGVsZXRlX2J0biwgJ2NsaWNrJywgbGFt
YmRhIGI6IHNlbGYuZGVsZXRlX21hcmtlZF9rZXlzKCkpCiAgICAgICAgdXJ3aWQuY29ubmVjdF9z
aWduYWwoc2VsZi5jb21tYW5kc19idG4sICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLnRvZ2dsZV9j
b25zb2xlKCkpCiAgICAgICAgdXJ3aWQuY29ubmVjdF9zaWduYWwoc2VsZi5lZGl0X2J0biwgJ2Ns
aWNrJywgbGFtYmRhIGI6IHNlbGYuZWRpdF9rZXlfd3JhcHBlcigpKQogICAgICAgIHVyd2lkLmNv
bm5lY3Rfc2lnbmFsKHNlbGYuYWRkX2tleV9idG4sICdjbGljaycsIGxhbWJkYSBiOiBzZWxmLnNo
b3dfYWRkX2tleV9kaWFsb2coKSkKICAgICAgICB1cndpZC5jb25uZWN0X3NpZ25hbChzZWxmLmRp
c2Nvbm5lY3RfYnRuLCAnY2xpY2snLCBsYW1iZGEgYjogc2VsZi5kaXNjb25uZWN0KCkpCiAgICAg
ICAgdXJ3aWQuY29ubmVjdF9zaWduYWwoc2VsZi5leGl0X2J0biwgJ2NsaWNrJywgbGFtYmRhIGI6
IHNlbGYuZXhpdF9tYWluKCkpCiAgICAgICAgdXJ3aWQuY29ubmVjdF9zaWduYWwoc2VsZi5oZWxw
X2J0biwgJ2NsaWNrJywgbGFtYmRhIGI6IHNlbGYuc2hvd19oZWxwKCkpCgogICAgICAgICMg0JjR
gdC/0L7Qu9GM0LfRg9C10Lwg0LzQtdGC0L7QtCDQtNC70Y8g0YHQvtC30LTQsNC90LjRjyB0b29s
YmFyCiAgICAgICAgdG9vbGJhciA9IHNlbGYuY3JlYXRlX3Rvb2xiYXIoKQoKICAgICAgICAjINCb
0LXQstCw0Y8g0L/QsNC90LXQu9GMOiDQmtCe0JzQkdCY0J3QmNCg0J7QktCQ0J3QndCQ0K8gKNGB
0LXRgNCy0LXRgNGLL0RCINCy0LLQtdGA0YXRgyArINC60LvRjtGH0Lgg0LLQvdC40LfRgykKICAg
ICAgICAjINCU0LXRgNC10LLQviDQv9C+0LTQutC70Y7Rh9C10L3QuNC5INC4INCx0LDQtyDQtNCw
0L3QvdGL0YUKICAgICAgICBzZWxmLmNvbm5lY3Rpb25fdHJlZSA9IHVyd2lkLlNpbXBsZUxpc3RX
YWxrZXIoW10pCiAgICAgICAgc2VsZi5jb25uZWN0aW9uX2xpc3Rib3ggPSB1cndpZC5MaXN0Qm94
KHNlbGYuY29ubmVjdGlvbl90cmVlKQoKICAgICAgICAjINCe0LHRitC10LTQuNC90Y/QtdC8OiDQ
tNC10YDQtdCy0L4g0L/QvtC00LrQu9GO0YfQtdC90LjQuSArINGB0L/QuNGB0L7QuiDQutC70Y7R
h9C10LksINCa0JDQltCU0KvQmSDRgdC+INGB0LLQvtC40Lwgc2Nyb2xsYmFyCiAgICAgICAgc2Vs
Zi5sZWZ0X3BhbmVsX3BpbGUgPSB1cndpZC5QaWxlKFsKICAgICAgICAgICAgKCd3ZWlnaHQnLCAx
LCBTY3JvbGxCYXIodXJ3aWQuQXR0ck1hcChzZWxmLmNvbm5lY3Rpb25fbGlzdGJveCwgJ3NpZGVi
YXInKSkpLCAgIyDinIUgU2Nyb2xsYmFyINC00LvRjyDQtNC10YDQtdCy0LAKICAgICAgICAgICAg
KCdwYWNrJywgdXJ3aWQuRGl2aWRlcign4pSAJykpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDQs
IFNjcm9sbEJhcihzZWxmLmtleV9saXN0X3ZpZXcubGlzdGJveCkpLCAgIyDinIUgU2Nyb2xsYmFy
INC00LvRjyDQutC70Y7Rh9C10LkKICAgICAgICBdKQoKICAgICAgICAjINCd0JUg0L7QsdC+0YDQ
sNGH0LjQstCw0LXQvCBQaWxlINCyIFNjcm9sbEJhciwg0YIu0LouIHNjcm9sbGJhcifRiyDRg9C2
0LUg0LLQvdGD0YLRgNC4CiAgICAgICAgc2VsZi5sZWZ0X3BhbmVsID0gdXJ3aWQuTGluZUJveCgK
ICAgICAgICAgICAgc2VsZi5sZWZ0X3BhbmVsX3BpbGUsCiAgICAgICAgICAgIHRpdGxlPSdDb25u
ZWN0aW9ucyAmIEtleXMnCiAgICAgICAgKQoKICAgICAgICAjINCf0YDQsNCy0LDRjyDQv9Cw0L3Q
tdC70YwKICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIgPSB1cndpZC5TaW1wbGVMaXN0V2Fsa2Vy
KFtdKQogICAgICAgIHNlbGYuZGV0YWlsX2xpc3Rib3ggPSB1cndpZC5MaXN0Qm94KHNlbGYuZGV0
YWlsX3dhbGtlcikKCiAgICAgICAgc2VsZi5yaWdodF9wYW5lbCA9IHVyd2lkLkxpbmVCb3goCiAg
ICAgICAgICAgIFNjcm9sbEJhcih1cndpZC5BdHRyTWFwKHNlbGYuZGV0YWlsX2xpc3Rib3gsICdi
YWNrZ3JvdW5kJykpLCAgIyDinIUg0J7QsdC+0YDQsNGH0LjQstCw0LXQvAogICAgICAgICAgICB0
aXRsZT0nRGV0YWlscycKICAgICAgICApCgogICAgICAgICMg0J7RgdC90L7QstC90LDRjyDQvtCx
0LvQsNGB0YLRjAogICAgICAgIGNvbnRlbnQgPSB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAg
KCd3ZWlnaHQnLCAxLCBzZWxmLmxlZnRfcGFuZWwpLAogICAgICAgICAgICAoJ3dlaWdodCcsIDEs
IHNlbGYucmlnaHRfcGFuZWwpLAogICAgICAgIF0sIGRpdmlkZWNoYXJzPTEpCgogICAgICAgICMg
VGFicwogICAgICAgIHNlbGYudGFiX3RleHQgPSB1cndpZC5UZXh0KCcnKQoKICAgICAgICAjINCh
0YLQsNGC0YPRgQogICAgICAgIHNlbGYuc3RhdHVzX3RleHQgPSB1cndpZC5UZXh0KCdSZWFkeScp
CgogICAgICAgICMg0JrQvtC90YHQvtC70YwgLSDQuNGB0YLQvtGA0LjRjyDQutC+0LzQsNC90LQg
0Lgg0YDQtdC30YPQu9GM0YLQsNGC0L7QsgogICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5ID0g
dXJ3aWQuU2ltcGxlTGlzdFdhbGtlcihbXSkKICAgICAgICBzZWxmLmNvbnNvbGVfbGlzdGJveCA9
IHVyd2lkLkxpc3RCb3goc2VsZi5jb25zb2xlX2hpc3RvcnkpCgogICAgICAgICMg0J/RgNC+0LzQ
v9GCINC00LvRjyDQstCy0L7QtNCwINC60L7QvNCw0L3QtNGLCiAgICAgICAgc2VsZi5jb21tYW5k
X3Byb21wdCA9IHVyd2lkLkVkaXQoJ3JlZGlzPiAnKQoKICAgICAgICAjINCe0LHQvtGA0LDRh9C4
0LLQsNC10Lwg0L/RgNC+0LzQv9GCINC00LvRjyDQv9C10YDQtdGF0LLQsNGC0LAg0LrQu9Cw0LLQ
uNGICiAgICAgICAgc2VsZi5jb21tYW5kX3Byb21wdF93cmFwcGVyID0gQ29tbWFuZFByb21wdFdy
YXBwZXIoCiAgICAgICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHQsCiAgICAgICAgICAgIG9uX3Vw
PWxhbWJkYTogc2VsZi5uYXZpZ2F0ZV9oaXN0b3J5KCd1cCcpLAogICAgICAgICAgICBvbl9kb3du
PWxhbWJkYTogc2VsZi5uYXZpZ2F0ZV9oaXN0b3J5KCdkb3duJyksCiAgICAgICAgICAgIG9uX2Vu
dGVyPXNlbGYuZXhlY3V0ZV9jb25zb2xlX2NvbW1hbmQKICAgICAgICApCiAgICAgICAgIyDQn9Cw
0L3QtdC70Ywg0LrQvtC90YHQvtC70LgKICAgICAgICBjb25zb2xlX3BpbGUgPSB1cndpZC5QaWxl
KFsKICAgICAgICAgICAgKCd3ZWlnaHQnLCAxLCBTY3JvbGxCYXIodXJ3aWQuQXR0ck1hcChzZWxm
LmNvbnNvbGVfbGlzdGJveCwgJ2JhY2tncm91bmQnKSkpLCAgIyDinIUg0J7QsdC+0YDQsNGH0LjQ
stCw0LXQvAogICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5EaXZpZGVyKCfilIAnKSksCiAgICAg
ICAgICAgICgncGFjaycsIHVyd2lkLkF0dHJNYXAoc2VsZi5jb21tYW5kX3Byb21wdF93cmFwcGVy
LCAnZm9vdGVyJykpLAogICAgICAgIF0pCgogICAgICAgIGNvbnNvbGVfcGlsZS5mb2N1c19wb3Np
dGlvbiA9IDIgICMg0KTQvtC60YPRgSDQvdCwINC/0YDQvtC80L/RgiDQv9C+INGD0LzQvtC70YfQ
sNC90LjRjgoKICAgICAgICBzZWxmLmNvbnNvbGVfcGFuZWwgPSB1cndpZC5MaW5lQm94KAogICAg
ICAgICAgICBjb25zb2xlX3BpbGUsCiAgICAgICAgICAgIHRpdGxlPSdSZWRpcyBDb25zb2xlJwog
ICAgICAgICkKCiAgICAgICAgIyDQntGB0L3QvtCy0L3QvtC1INGC0LXQu9C+INGBINCy0L7Qt9C8
0L7QttC90L7RgdGC0YzRjiDQv9C10YDQtdC60LvRjtGH0LXQvdC40Y8KICAgICAgICBzZWxmLm1h
aW5fY29udGVudCA9IHVyd2lkLlBpbGUoWwogICAgICAgICAgICAoJ3BhY2snLCB1cndpZC5BdHRy
TWFwKHVyd2lkLlBhZGRpbmcodG9vbGJhciwgbGVmdD0xLCByaWdodD0xKSwgJ2JhY2tncm91bmQn
KSksCiAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuQXR0ck1hcChjb250ZW50LCAnYmFj
a2dyb3VuZCcpKSwKICAgICAgICBdKQoKICAgICAgICAjIEZvb3RlciBwaWxlCiAgICAgICAgc2Vs
Zi5mb290ZXJfcGlsZSA9IHVyd2lkLlBpbGUoWwogICAgICAgICAgICB1cndpZC5BdHRyTWFwKHNl
bGYudGFiX3RleHQsICdmb290ZXInKSwKICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChzZWxmLnN0
YXR1c190ZXh0LCAnZm9vdGVyJyksCiAgICAgICAgXSkKCiAgICAgICAgc2VsZi5tYWluX2ZyYW1l
ID0gdXJ3aWQuRnJhbWUoCiAgICAgICAgICAgIGhlYWRlcj1zZWxmLmhlYWRlciwKICAgICAgICAg
ICAgYm9keT1zZWxmLm1haW5fY29udGVudCwKICAgICAgICAgICAgZm9vdGVyPXNlbGYuZm9vdGVy
X3BpbGUKICAgICAgICApCgogICAgICAgICMg0KPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0L3Q
sNGH0LDQu9GM0L3Ri9C5INGE0L7QutGD0YEg0L3QsCBib2R5ICjQvdC1INC90LAgaGVhZGVyINGB
INC60L3QvtC/0LrQsNC80LgpCiAgICAgICAgc2VsZi5tYWluX2ZyYW1lLmZvY3VzX3Bvc2l0aW9u
ID0gJ2JvZHknCgogICAgICAgICMg0KPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0YTQvtC60YPR
gSDQvdCwIGNvbnRlbnRfYXJlYSAo0L/RgNC+0L/Rg9GB0LrQsNC10LwgdG9vbGJhcikKICAgICAg
ICBzZWxmLm1haW5fY29udGVudC5mb2N1c19wb3NpdGlvbiA9IDEgICMgMD10b29sYmFyLCAxPWNv
bnRlbnRfYXJlYQoKICAgICAgICBzZWxmLnVwZGF0ZV9jb25uZWN0aW9uX3RyZWUoKQoKICAgIGRl
ZiB0b2dnbGVfY29uc29sZShzZWxmKToKICAgICAgICAiIiLQn9C10YDQtdC60LvRjtGH0LXQvdC4
0LUg0LrQvtC90YHQvtC70LgiIiIKICAgICAgICBpZiBzZWxmLmNvbnNvbGVfbW9kZToKICAgICAg
ICAgICAgIyDQktGL0LrQu9GO0YfQsNC10Lwg0LrQvtC90YHQvtC70YwgLSDQv9C+0LrQsNC30YvQ
stCw0LXQvCDQvtGB0L3QvtCy0L3QvtC5INC60L7QvdGC0LXQvdGCCiAgICAgICAgICAgIHNlbGYu
bWFpbl9jb250ZW50LmNvbnRlbnRzID0gWwogICAgICAgICAgICAgICAgKHVyd2lkLkF0dHJNYXAo
dXJ3aWQuUGFkZGluZygKICAgICAgICAgICAgICAgICAgICBzZWxmLmNyZWF0ZV90b29sYmFyKCks
ICAjIOKchSDQmNGB0L/QvtC70YzQt9GD0LXQvCDQvNC10YLQvtC0CiAgICAgICAgICAgICAgICAg
ICAgbGVmdD0xLCByaWdodD0xKSwgJ2JhY2tncm91bmQnKSwgKCdwYWNrJywgTm9uZSkpLAogICAg
ICAgICAgICAgICAgKHVyd2lkLkF0dHJNYXAodXJ3aWQuQ29sdW1ucyhbCiAgICAgICAgICAgICAg
ICAgICAgKCd3ZWlnaHQnLCAxLCBzZWxmLmxlZnRfcGFuZWwpLCAgIyDinIUg0JjRgdC/0L7Qu9GM
0LfRg9C10LwgbGVmdF9wYW5lbCDRgSDQtNC10YDQtdCy0L7QvCvQutC70Y7Rh9Cw0LzQuAogICAg
ICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgc2VsZi5yaWdodF9wYW5lbCksICAjIOKchSDQ
mNGB0L/QvtC70YzQt9GD0LXQvCByaWdodF9wYW5lbAogICAgICAgICAgICAgICAgXSwgZGl2aWRl
Y2hhcnM9MSksICdiYWNrZ3JvdW5kJyksICgnd2VpZ2h0JywgMSkpLAogICAgICAgICAgICBdCiAg
ICAgICAgICAgIHNlbGYuY29uc29sZV9tb2RlID0gRmFsc2UKICAgICAgICAgICAgc2VsZi5zZXRf
c3RhdHVzKCJDb25zb2xlIGNsb3NlZCIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyDQktC6
0LvRjtGH0LDQtdC8INC60L7QvdGB0L7Qu9GMIC0g0YDQsNC30LTQtdC70Y/QtdC8INGN0LrRgNCw
0L0KICAgICAgICAgICAgY29udGVudF9hcmVhID0gdXJ3aWQuQ29sdW1ucyhbCiAgICAgICAgICAg
ICAgICAoJ3dlaWdodCcsIDEsIHNlbGYubGVmdF9wYW5lbCksICAjIOKchSDQmNGB0L/QvtC70YzQ
t9GD0LXQvCBsZWZ0X3BhbmVsINGBINC00LXRgNC10LLQvtC8K9C60LvRjtGH0LDQvNC4CiAgICAg
ICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHNlbGYucmlnaHRfcGFuZWwpLCAgIyDinIUg0JjRgdC/
0L7Qu9GM0LfRg9C10LwgcmlnaHRfcGFuZWwKICAgICAgICAgICAgXSwgZGl2aWRlY2hhcnM9MSkK
CiAgICAgICAgICAgIHNlbGYubWFpbl9jb250ZW50LmNvbnRlbnRzID0gWwogICAgICAgICAgICAg
ICAgKHVyd2lkLkF0dHJNYXAodXJ3aWQuUGFkZGluZygKICAgICAgICAgICAgICAgICAgICBzZWxm
LmNyZWF0ZV90b29sYmFyKCksICAjIOKchSDQmNGB0L/QvtC70YzQt9GD0LXQvCDQvNC10YLQvtC0
CiAgICAgICAgICAgICAgICAgICAgbGVmdD0xLCByaWdodD0xKSwgJ2JhY2tncm91bmQnKSwgKCdw
YWNrJywgTm9uZSkpLAogICAgICAgICAgICAgICAgKHVyd2lkLkF0dHJNYXAoY29udGVudF9hcmVh
LCAnYmFja2dyb3VuZCcpLCAoJ3dlaWdodCcsIDIpKSwKICAgICAgICAgICAgICAgICh1cndpZC5B
dHRyTWFwKHNlbGYuY29uc29sZV9wYW5lbCwgJ2JhY2tncm91bmQnKSwgKCd3ZWlnaHQnLCAxKSks
CiAgICAgICAgICAgIF0KICAgICAgICAgICAgc2VsZi5jb25zb2xlX21vZGUgPSBUcnVlCgogICAg
ICAgICAgICAjINCU0L7QsdCw0LLQu9GP0LXQvCDQv9GA0LjQstC10YLRgdGC0LLQtdC90L3QvtC1
INGB0L7QvtCx0YnQtdC90LjQtSDQtdGB0LvQuCDQutC+0L3RgdC+0LvRjCDQv9GD0YHRgtCw0Y8K
ICAgICAgICAgICAgaWYgbGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSA9PSAwOgogICAgICAgICAg
ICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHVy
d2lkLlRleHQoKCdzdWNjZXNzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUmVk
aXMgQ29uc29sZSAtIFR5cGUgY29tbWFuZHMgYW5kIHByZXNzIEVudGVyLiBUeXBlICJleGl0IiBv
ciBwcmVzcyBFc2MgdG8gY2xvc2UuJykpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAg
ICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQoKICAgICAgICAg
ICAgIyDQo9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDRhNC+0LrRg9GBINC90LAg0LrQvtC90YHQ
vtC70YzQvdGD0Y4g0L/QsNC90LXQu9GMCiAgICAgICAgICAgIHNlbGYubWFpbl9jb250ZW50LmZv
Y3VzX3Bvc2l0aW9uID0gMgogICAgICAgICAgICAjINCk0L7QutGD0YEg0L3QsCDQv9GA0L7QvNC/
0YIg0LLQvdGD0YLRgNC4INC60L7QvdGB0L7Qu9GM0L3QvtC5INC/0LDQvdC10LvQuAogICAgICAg
ICAgICBzZWxmLmNvbnNvbGVfcGFuZWwub3JpZ2luYWxfd2lkZ2V0LmZvY3VzX3Bvc2l0aW9uID0g
MgogICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoIkNvbnNvbGUgb3BlbmVkIChwcmVzcyBGMiB0
byBjbG9zZSkiKQoKICAgIGRlZiBleGVjdXRlX2NvbnNvbGVfY29tbWFuZChzZWxmKToKICAgICAg
ICAiIiLQktGL0L/QvtC70L3QtdC90LjQtSDQutC+0LzQsNC90LTRiyDQuNC3INC60L7QvdGB0L7Q
u9C4INGBINC/0L7QtNC00LXRgNC20LrQvtC5INC60LvQsNGB0YLQtdGA0LAiIiIKICAgICAgICBp
ZiBub3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gb3Igbm90IHNlbGYuY3VycmVudF9jb25uZWN0
aW9uLmNvbm5lY3RlZDoKICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVy
d2lkLlRleHQoKCdlcnJvcicsICfinJcgTm90IGNvbm5lY3RlZCB0byBSZWRpcycpKSkKICAgICAg
ICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKICAgICAg
ICAgICAgaWYgbGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSA+IDA6CiAgICAgICAgICAgICAgICBz
ZWxmLmNvbnNvbGVfbGlzdGJveC5zZXRfZm9jdXMobGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSAt
IDEpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjb21tYW5kID0gc2VsZi5jb21tYW5kX3By
b21wdC5nZXRfZWRpdF90ZXh0KCkuc3RyaXAoKQogICAgICAgIGlmIG5vdCBjb21tYW5kOgogICAg
ICAgICAgICByZXR1cm4KCiAgICAgICAgIyDQlNC+0LHQsNCy0LvRj9C10Lwg0LrQvtC80LDQvdC0
0YMg0LIg0LjRgdGC0L7RgNC40Y4g0KHQoNCQ0JfQowogICAgICAgIHNlbGYuYWRkX3RvX2hpc3Rv
cnkoY29tbWFuZCkKCiAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwg0L3QsCDQutC+0LzQsNC9
0LTRgyDQstGL0YXQvtC00LAKICAgICAgICBpZiBjb21tYW5kLmxvd2VyKCkgaW4gWydleGl0Jywg
J3F1aXQnXToKICAgICAgICAgICAgc2VsZi50b2dnbGVfY29uc29sZSgpCiAgICAgICAgICAgIHJl
dHVybgoKICAgICAgICAjINCa0L7QvNCw0L3QtNCwINC+0YfQuNGB0YLQutC4INC60L7QvdGB0L7Q
u9C4CiAgICAgICAgaWYgY29tbWFuZC5sb3dlcigpID09ICdjbGVhcic6CiAgICAgICAgICAgIHNl
bGYuY29uc29sZV9oaXN0b3J5LmNsZWFyKCkKICAgICAgICAgICAgc2VsZi5jb21tYW5kX3Byb21w
dC5zZXRfZWRpdF90ZXh0KCcnKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyDQlNC+0LHQ
sNCy0LvRj9C10Lwg0LrQvtC80LDQvdC00YMg0LIg0LLQuNC30YPQsNC70YzQvdGD0Y4g0LjRgdGC
0L7RgNC40Y4g0LrQvtC90YHQvtC70LgKICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBl
bmQodXJ3aWQuVGV4dCgoJ2luZm9fbGFiZWwnLCBmJ3JlZGlzPiB7Y29tbWFuZH0nKSkpCgogICAg
ICAgIHRyeToKICAgICAgICAgICAgY2xpZW50ID0gc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uYWN0
aXZlX2NsaWVudAogICAgICAgICAgICBpc19jbHVzdGVyID0gc2VsZi5jdXJyZW50X2Nvbm5lY3Rp
b24uaXNfY2x1c3RlcgoKICAgICAgICAgICAgIyDQoNCw0LfQsdC40YDQsNC10Lwg0LrQvtC80LDQ
vdC00YMKICAgICAgICAgICAgcGFydHMgPSBjb21tYW5kLnNwbGl0KCkKICAgICAgICAgICAgY21k
ID0gcGFydHNbMF0udXBwZXIoKQogICAgICAgICAgICBhcmdzID0gcGFydHNbMTpdCgogICAgICAg
ICAgICAjINCh0L/QtdGG0LjQsNC70YzQvdCw0Y8g0L7QsdGA0LDQsdC+0YLQutCwINC00LvRjyDQ
utC70LDRgdGC0LXRgNCwCiAgICAgICAgICAgIGlmIGlzX2NsdXN0ZXI6CiAgICAgICAgICAgICAg
ICAjINCa0L7QvNCw0L3QtNGLLCDQutC+0YLQvtGA0YvQtSDQvdC1INC/0L7QtNC00LXRgNC20LjQ
stCw0Y7RgtGB0Y8g0LIg0LrQu9Cw0YHRgtC10YDQtQogICAgICAgICAgICAgICAgdW5zdXBwb3J0
ZWRfY29tbWFuZHMgPSBbJ1NFTEVDVCcsICdNT1ZFJywgJ1NXQVBEQicsICdNSUdSQVRFJywgJ1JB
TkRPTUtFWSddCiAgICAgICAgICAgICAgICBpZiBjbWQgaW4gdW5zdXBwb3J0ZWRfY29tbWFuZHM6
CiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBwZW5kKAogICAgICAg
ICAgICAgICAgICAgICAgICB1cndpZC5UZXh0KCgnZXJyb3InLCBmIihlcnJvcikgQ29tbWFuZCAn
e2NtZH0nIG5vdCBzdXBwb3J0ZWQgaW4gUmVkaXMgQ2x1c3RlciIpKQogICAgICAgICAgICAgICAg
ICAgICkKICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3
aWQuRGl2aWRlcigpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuY29tbWFuZF9wcm9tcHQuc2V0
X2VkaXRfdGV4dCgnJykKICAgICAgICAgICAgICAgICAgICAjINCf0YDQvtC60YDRg9GH0LjQstCw
0LXQvCDQstC90LjQtwogICAgICAgICAgICAgICAgICAgIGlmIGxlbihzZWxmLmNvbnNvbGVfaGlz
dG9yeSkgPiAwOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbnNvbGVfbGlzdGJveC5z
ZXRfZm9jdXMobGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSAtIDEpCiAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuCgogICAgICAgICAgICAgICAgIyDQmtC+0LzQsNC90LTRiyDQutC70LDRgdGC0LXR
gNCwICjQvdCw0YfQuNC90LDRjtGJ0LjQtdGB0Y8g0YEgQ0xVU1RFUikKICAgICAgICAgICAgICAg
IGlmIGNtZC5zdGFydHN3aXRoKCdDTFVTVEVSJyk6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0
ID0gY2xpZW50LmV4ZWN1dGVfY29tbWFuZChjbWQsICphcmdzKQoKICAgICAgICAgICAgICAgICMg
S0VZUyAtINGC0YDQtdCx0YPQtdGCINGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyDQstGB0LXRhSDR
g9C30LvQvtCyCiAgICAgICAgICAgICAgICBlbGlmIGNtZCA9PSAnS0VZUyc6CiAgICAgICAgICAg
ICAgICAgICAgcGF0dGVybiA9IGFyZ3NbMF0gaWYgYXJncyBlbHNlICcqJwogICAgICAgICAgICAg
ICAgICAgIGtleXMgPSBbXQoKICAgICAgICAgICAgICAgICAgICAjINC/0YDQvtCy0LXRgNGP0LXQ
vCDQvdCw0LvQuNGH0LjQtSDQvNC10YLQvtC00LAgZ2V0X25vZGVzCiAgICAgICAgICAgICAgICAg
ICAgaWYgaGFzYXR0cihjbGllbnQsICdnZXRfbm9kZXMnKToKICAgICAgICAgICAgICAgICAgICAg
ICAgZm9yIG5vZGUgaW4gY2xpZW50LmdldF9ub2RlcygpOgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwg0LDRgtGA0LjQsdGD0YIgc2VydmVyX3R5cGUg0LHQ
tdC30L7Qv9Cw0YHQvdC+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKG5v
ZGUsICdzZXJ2ZXJfdHlwZScpIGFuZCBub2RlLnNlcnZlcl90eXBlID09ICdtYXN0ZXInOgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbm9kZV9rZXlzID0gbm9kZS5rZXlzKHBhdHRlcm4pCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGtleXMuZXh0ZW5kKG5vZGVfa2V5cykKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiRXJyb3IgZ2V0dGluZyBrZXlz
IGZyb20gbm9kZToge2V9IikKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAg
ICAgICAgICAgICAjIEZhbGxiYWNrINC00LvRjyDQtNGA0YPQs9C40YUg0YDQtdCw0LvQuNC30LDR
htC40Lkg0LrQu9Cw0YHRgtC10YDQsAogICAgICAgICAgICAgICAgICAgICAgICBrZXlzID0gbGlz
dChjbGllbnQuc2Nhbl9pdGVyKG1hdGNoPXBhdHRlcm4sIGNvdW50PTEwMCkpCgogICAgICAgICAg
ICAgICAgICAgIHJlc3VsdCA9IGtleXMKCiAgICAgICAgICAgICAgICAjIFNDQU4gLSDRgtGA0LXQ
sdGD0LXRgiDQvtCx0YDQsNCx0L7RgtC60Lgg0LLRgdC10YUg0YPQt9C70L7QsgogICAgICAgICAg
ICAgICAgZWxpZiBjbWQgPT0gJ1NDQU4nOgogICAgICAgICAgICAgICAgICAgIGN1cnNvciA9IGlu
dChhcmdzWzBdKSBpZiBhcmdzIGFuZCBhcmdzWzBdLmlzZGlnaXQoKSBlbHNlIDAKICAgICAgICAg
ICAgICAgICAgICBwYXR0ZXJuID0gYXJnc1syXSBpZiBsZW4oYXJncykgPiAyIGFuZCBhcmdzWzFd
LnVwcGVyKCkgPT0gJ01BVENIJyBlbHNlICcqJwogICAgICAgICAgICAgICAgICAgIGNvdW50ID0g
aW50KGFyZ3NbNF0pIGlmIGxlbihhcmdzKSA+IDQgYW5kIGFyZ3NbM10udXBwZXIoKSA9PSAnQ09V
TlQnIGVsc2UgMTAKCiAgICAgICAgICAgICAgICAgICAgYWxsX2tleXMgPSBbXQoKICAgICAgICAg
ICAgICAgICAgICBpZiBoYXNhdHRyKGNsaWVudCwgJ2dldF9ub2RlcycpOgogICAgICAgICAgICAg
ICAgICAgICAgICBmb3Igbm9kZSBpbiBjbGllbnQuZ2V0X25vZGVzKCk6CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpZiBoYXNhdHRyKG5vZGUsICdzZXJ2ZXJfdHlwZScpIGFuZCBub2RlLnNl
cnZlcl90eXBlID09ICdtYXN0ZXInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRy
eToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9jdXJzb3IgPSAwCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2N1cnNvciwgYmF0Y2ggPSBub2RlLnNj
YW4obm9kZV9jdXJzb3IsIG1hdGNoPXBhdHRlcm4sIGNvdW50PWNvdW50KQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsX2tleXMuZXh0ZW5kKGJhdGNoKQogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm9kZV9jdXJzb3IgPT0gMDoKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJFcnJvciBzY2FubmluZyBu
b2RlOiB7ZX0iKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAg
ICAgICMgRmFsbGJhY2sKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGtleSBpbiBjbGllbnQu
c2Nhbl9pdGVyKG1hdGNoPXBhdHRlcm4sIGNvdW50PWNvdW50KToKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGFsbF9rZXlzLmFwcGVuZChrZXkpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiBsZW4oYWxsX2tleXMpID49IGNvdW50OgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFswLCBhbGxfa2V5c1s6Y291
bnRdXSBpZiBhbGxfa2V5cyBlbHNlIFswLCBbXV0KCiAgICAgICAgICAgICAgICAjIElORk8gLSDR
gdC+0LHQuNGA0LDQtdC8INC40L3RhNC+0YDQvNCw0YbQuNGOINGB0L4g0LLRgdC10YUg0YPQt9C7
0L7QsgogICAgICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ0lORk8nOgogICAgICAgICAgICAgICAg
ICAgIGlmIGFyZ3MgYW5kIGFyZ3NbMF0ubG93ZXIoKSBpbiBbJ2NsdXN0ZXInLCAna2V5c3BhY2Un
LCAnbWVtb3J5JywgJ2NwdScsICdzdGF0cycsICdyZXBsaWNhdGlvbiddOgogICAgICAgICAgICAg
ICAgICAgICAgICBzZWN0aW9uID0gYXJnc1swXS5sb3dlcigpCiAgICAgICAgICAgICAgICAgICAg
ICAgIGluZm9fcmVzdWx0cyA9IFtdCgogICAgICAgICAgICAgICAgICAgICAgICBpZiBoYXNhdHRy
KGNsaWVudCwgJ2dldF9ub2RlcycpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG5v
ZGUgaW4gY2xpZW50LmdldF9ub2RlcygpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGlmIGhhc2F0dHIobm9kZSwgJ3NlcnZlcl90eXBlJykgYW5kIG5vZGUuc2VydmVyX3R5cGUgPT0g
J21hc3Rlcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfaW5mbyA9IG5vZGUuaW5mbyhz
ZWN0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9ob3N0
ID0gZ2V0YXR0cihub2RlLCAnaG9zdCcsICd1bmtub3duJykKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG5vZGVfcG9ydCA9IGdldGF0dHIobm9kZSwgJ3BvcnQnLCAndW5r
bm93bicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvX3Jlc3Vs
dHMuYXBwZW5kKGYiLS0tIHtub2RlX2hvc3R9Ontub2RlX3BvcnR9IC0tLSIpCgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQpNC+0YDQvNCw0YLQuNGA0YPQtdC8INGB
0LvQvtCy0LDRgNGMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBp
c2luc3RhbmNlKG5vZGVfaW5mbywgZGljdCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZm9yIGssIHYgaW4gbm9kZV9pbmZvLml0ZW1zKCk6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9fcmVzdWx0cy5hcHBlbmQo
ZiJ7a306IHt2fSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNl
OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9fcmVzdWx0
cy5hcHBlbmQoc3RyKG5vZGVfaW5mbykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGluZm9fcmVzdWx0cy5hcHBlbmQoZiItLS0gRVJST1I6IHtlfSAtLS0iKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gIlxuIi5qb2luKGluZm9fcmVzdWx0cykK
ICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJlc3VsdCA9IGNsaWVudC5pbmZvKHNlY3Rpb24pCiAgICAgICAgICAgICAgICAgICAgZWxzZToK
ICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gY2xpZW50LmluZm8oKQoKICAgICAgICAg
ICAgICAgICMgREJTSVpFIC0g0YHRg9C80LzQuNGA0YPQtdC8INC/0L4g0LLRgdC10Lwg0YPQt9C7
0LDQvAogICAgICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ0RCU0laRSc6CiAgICAgICAgICAgICAg
ICAgICAgdG90YWwgPSAwCgogICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIoY2xpZW50LCAn
Z2V0X25vZGVzJyk6CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBub2RlIGluIGNsaWVudC5n
ZXRfbm9kZXMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIobm9kZSwg
J3NlcnZlcl90eXBlJykgYW5kIG5vZGUuc2VydmVyX3R5cGUgPT0gJ21hc3Rlcic6CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0b3RhbCArPSBub2RlLmRic2l6ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsb2dnZXIud2FybmluZyhmIkVycm9yIGdldHRpbmcgZGJzaXplIGZyb20gbm9kZTog
e2V9IikKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB0
b3RhbCA9IGNsaWVudC5kYnNpemUoKQoKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0b3Rh
bAoKICAgICAgICAgICAgICAgICMgRkxVU0hBTEwvRkxVU0hEQiAtINCy0YvQv9C+0LvQvdGP0LXQ
vCDQvdCwINCy0YHQtdGFINGD0LfQu9Cw0YUKICAgICAgICAgICAgICAgIGVsaWYgY21kIGluIFsn
RkxVU0hBTEwnLCAnRkxVU0hEQiddOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBbXQoK
ICAgICAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKGNsaWVudCwgJ2dldF9ub2RlcycpOgogICAg
ICAgICAgICAgICAgICAgICAgICBmb3Igbm9kZSBpbiBjbGllbnQuZ2V0X25vZGVzKCk6CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKG5vZGUsICdzZXJ2ZXJfdHlwZScpIGFu
ZCBub2RlLnNlcnZlcl90eXBlID09ICdtYXN0ZXInOgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9yZXN1
bHQgPSBub2RlLmV4ZWN1dGVfY29tbWFuZChjbWQsICphcmdzKQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBub2RlX2hvc3QgPSBnZXRhdHRyKG5vZGUsICdob3N0JywgJ3Vua25v
d24nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX3BvcnQgPSBnZXRh
dHRyKG5vZGUsICdwb3J0JywgJ3Vua25vd24nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICByZXN1bHRzLmFwcGVuZChmIntub2RlX2hvc3R9Ontub2RlX3BvcnR9OiB7bm9kZV9y
ZXN1bHR9IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9u
IGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5k
KGYiRVJST1I6IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9ICJcbiIuam9p
bihyZXN1bHRzKSBpZiByZXN1bHRzIGVsc2UgIk9LIgogICAgICAgICAgICAgICAgICAgIGVsc2U6
CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNsaWVudC5leGVjdXRlX2NvbW1hbmQo
Y21kLCAqYXJncykKCiAgICAgICAgICAgICAgICAjINCe0LHRi9GH0L3Ri9C1INC60L7QvNCw0L3Q
tNGLIC0g0LLRi9C/0L7Qu9C90Y/QtdC8INGH0LXRgNC10Lcg0LrQu9C40LXQvdGCINC60LvQsNGB
0YLQtdGA0LAKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0
ID0gY2xpZW50LmV4ZWN1dGVfY29tbWFuZChjbWQsICphcmdzKQoKICAgICAgICAgICAgZWxzZToK
ICAgICAgICAgICAgICAgICMgU3RhbmRhbG9uZSDRgNC10LbQuNC8CiAgICAgICAgICAgICAgICBy
ZXN1bHQgPSBjbGllbnQuZXhlY3V0ZV9jb21tYW5kKGNtZCwgKmFyZ3MpCgogICAgICAgICAgICAj
INCk0L7RgNC80LDRgtC40YDRg9C10Lwg0YDQtdC30YPQu9GM0YLQsNGCCiAgICAgICAgICAgIHJl
c3VsdF9zdHIgPSBzZWxmLmZvcm1hdF9yZWRpc19yZXN1bHQoY21kLCByZXN1bHQpCgogICAgICAg
ICAgICAjINCU0L7QsdCw0LLQu9GP0LXQvCDRgNC10LfRg9C70YzRgtCw0YIg0LIg0LjRgdGC0L7R
gNC40Y4KICAgICAgICAgICAgaWYgJ1xuJyBpbiByZXN1bHRfc3RyOgogICAgICAgICAgICAgICAg
Zm9yIGxpbmUgaW4gcmVzdWx0X3N0ci5zcGxpdCgnXG4nKToKICAgICAgICAgICAgICAgICAgICBz
ZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuVGV4dCgoJ3N1Y2Nlc3MnLCBsaW5lKSkp
CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5h
cHBlbmQodXJ3aWQuVGV4dCgoJ3N1Y2Nlc3MnLCByZXN1bHRfc3RyKSkpCgogICAgICAgICAgICBs
b2dnZXIuaW5mbyhmIkV4ZWN1dGVkOiB7Y29tbWFuZH0gPT4ge3Jlc3VsdF9zdHJbOjEwMF19IikK
CiAgICAgICAgICAgICMg4pyFINCe0YfQuNGJ0LDQtdC8INC/0YDQvtC80L/RggogICAgICAgICAg
ICBzZWxmLmNvbW1hbmRfcHJvbXB0LnNldF9lZGl0X3RleHQoJycpCgogICAgICAgICAgICAjINCe
0LHQvdC+0LLQu9GP0LXQvCDQtdGB0LvQuCDQutC+0LzQsNC90LTQsCDQvNC+0LPQu9CwINC40LfQ
vNC10L3QuNGC0Ywg0LTQsNC90L3Ri9C1CiAgICAgICAgICAgIG1vZGlmeWluZ19jb21tYW5kcyA9
IFsKICAgICAgICAgICAgICAgICdTRVQnLCAnREVMJywgJ0hTRVQnLCAnSERFTCcsICdMUFVTSCcs
ICdSUFVTSCcsICdMUE9QJywgJ1JQT1AnLAogICAgICAgICAgICAgICAgJ1NBREQnLCAnU1JFTScs
ICdaQUREJywgJ1pSRU0nLCAnRkxVU0hEQicsICdGTFVTSEFMTCcsICdSRU5BTUUnLAogICAgICAg
ICAgICAgICAgJ1JFTkFNRU5YJywgJ0VYUElSRScsICdFWFBJUkVBVCcsICdQRVJTSVNUJywgJ0FQ
UEVORCcsICdERUNSJywKICAgICAgICAgICAgICAgICdJTkNSJywgJ0xTRVQnLCAnTFRSSU0nLCAn
TVNFVCcsICdQRVhQSVJFJywgJ1BFWFBJUkVBVCcsICdQU0VURVgnLAogICAgICAgICAgICAgICAg
J1NFVEVYJywgJ1NFVE5YJywgJ0hTRVROWCcsICdITVNFVCcsICdMUFVTSFgnLCAnUlBVU0hYJywg
J1NJTlRFUlNUT1JFJywKICAgICAgICAgICAgICAgICdTVU5JT05TVE9SRScsICdTRElGRlNUT1JF
JywgJ1pJTlRFUlNUT1JFJywgJ1pVTklPTlNUT1JFJywgJ1pSRU1SQU5HRUJZTEVYJywKICAgICAg
ICAgICAgICAgICdaUkVNUkFOR0VCWVJBTksnLCAnWlJFTVJBTkdFQllTQ09SRScsICdHRVRTRVQn
LCAnVU5MSU5LJwogICAgICAgICAgICBdCgogICAgICAgICAgICBpZiBjbWQgaW4gbW9kaWZ5aW5n
X2NvbW1hbmRzOgogICAgICAgICAgICAgICAgIyDinIUg0J7QsdC90L7QstC70Y/QtdC8INCw0YHQ
uNC90YXRgNC+0L3QvdC+INGH0YLQvtCx0Ysg0L3QtSDQsdC70L7QutC40YDQvtCy0LDRgtGMINC6
0L7QvdGB0L7Qu9GMCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5yZWZyZXNoX2tleXMoKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgog
ICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byByZWZyZXNoIGtleXM6
IHtlfSIpCgogICAgICAgIGV4Y2VwdCBSZWRpc0NsdXN0ZXJFcnJvciBhcyBlOgogICAgICAgICAg
ICAjIENsdXN0ZXIt0YHQv9C10YbQuNGE0LjRh9C90YvQtSDQvtGI0LjQsdC60LgKICAgICAgICAg
ICAgZXJyb3JfbXNnID0gc3RyKGUpCiAgICAgICAgICAgIGlmICdDUk9TU1NMT1QnIGluIGVycm9y
X21zZzoKICAgICAgICAgICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5LmFwcGVuZCh1cndpZC5U
ZXh0KCgnZXJyb3InLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGYnKGVycm9yKSBDUk9TU1NMT1Q6IEtleXMgbXVzdCBiZSBpbiBzYW1lIGhh
c2ggc2xvdCBmb3IgbXVsdGkta2V5IG9wZXJhdGlvbnMnKSkpCiAgICAgICAgICAgIGVsaWYgJ01P
VkVEJyBpbiBlcnJvcl9tc2c6CiAgICAgICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5h
cHBlbmQodXJ3aWQuVGV4dCgoJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBmJyhlcnJvcikgTU9WRUQ6IEtleSBtb3ZlZCB0byBh
bm90aGVyIG5vZGUnKSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmNv
bnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3aWQuVGV4dCgoJ2Vycm9yJywgZicoY2x1c3RlciBlcnJv
cikge2Vycm9yX21zZ30nKSkpCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIlJlZGlzIGNsdXN0
ZXIgZXJyb3I6IHtlfSIpCgogICAgICAgIGV4Y2VwdCBSZWRpc0Nvbm5lY3Rpb25FcnJvciBhcyBl
OgogICAgICAgICAgICAjINCe0YjQuNCx0LrQuCDQv9C+0LTQutC70Y7Rh9C10L3QuNGPCiAgICAg
ICAgICAgIHNlbGYuY29uc29sZV9oaXN0b3J5LmFwcGVuZCh1cndpZC5UZXh0KCgnZXJyb3InLCBm
Jyhjb25uZWN0aW9uIGVycm9yKSB7c3RyKGUpfScpKSkKICAgICAgICAgICAgbG9nZ2VyLmVycm9y
KGYiUmVkaXMgY29ubmVjdGlvbiBlcnJvcjoge2V9IikKCiAgICAgICAgZXhjZXB0IFJlZGlzRXJy
b3IgYXMgZToKICAgICAgICAgICAgIyDQntCx0YnQuNC1IFJlZGlzINC+0YjQuNCx0LrQuCAo0LLQ
utC70Y7Rh9Cw0Y8gUmVzcG9uc2VFcnJvcikKICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3Rv
cnkuYXBwZW5kKHVyd2lkLlRleHQoKCdlcnJvcicsIGYnKGVycm9yKSB7c3RyKGUpfScpKSkKICAg
ICAgICAgICAgbG9nZ2VyLmVycm9yKGYiUmVkaXMgZXJyb3I6IHtlfSIpCgogICAgICAgIGV4Y2Vw
dCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgIyDQktGB0LUg0L7RgdGC0LDQu9GM0L3Ri9C1
INC+0YjQuNCx0LrQuAogICAgICAgICAgICBzZWxmLmNvbnNvbGVfaGlzdG9yeS5hcHBlbmQodXJ3
aWQuVGV4dCgoJ2Vycm9yJywgZicoZXJyb3IpIHtzdHIoZSl9JykpKQogICAgICAgICAgICBsb2dn
ZXIuZXJyb3IoZiJDb21tYW5kIGZhaWxlZDoge2V9IiwgZXhjX2luZm89VHJ1ZSkKCiAgICAgICAg
IyDQoNCw0LfQtNC10LvQuNGC0LXQu9GMCiAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnkuYXBw
ZW5kKHVyd2lkLkRpdmlkZXIoKSkKCiAgICAgICAgIyDQn9GA0L7QutGA0YPRh9C40LLQsNC10Lwg
0LLQvdC40Lcg0Log0L/QvtGB0LvQtdC00L3QtdC5INC60L7QvNCw0L3QtNC1CiAgICAgICAgaWYg
bGVuKHNlbGYuY29uc29sZV9oaXN0b3J5KSA+IDA6CiAgICAgICAgICAgIHRyeToKICAgICAgICAg
ICAgICAgIHNlbGYuY29uc29sZV9saXN0Ym94LnNldF9mb2N1cyhsZW4oc2VsZi5jb25zb2xlX2hp
c3RvcnkpIC0gMSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwoKICAg
ICAgICAjINCe0LPRgNCw0L3QuNGH0LjQstCw0LXQvCDQuNGB0YLQvtGA0LjRjiAo0LLQuNC30YPQ
sNC70YzQvdGD0Y4g0LIg0LrQvtC90YHQvtC70LgpCiAgICAgICAgaWYgbGVuKHNlbGYuY29uc29s
ZV9oaXN0b3J5KSA+IDIwMDoKICAgICAgICAgICAgc2VsZi5jb25zb2xlX2hpc3RvcnlbOl0gPSBz
ZWxmLmNvbnNvbGVfaGlzdG9yeVstMTUwOl0KCiAgICBkZWYgZm9ybWF0X3JlZGlzX3Jlc3VsdChz
ZWxmLCBjbWQ6IHN0ciwgcmVzdWx0KSAtPiBzdHI6CiAgICAgICAgIiIi0KTQvtGA0LzQsNGC0LjR
gNC+0LLQsNC90LjQtSDRgNC10LfRg9C70YzRgtCw0YLQsCBSZWRpcyDQutC+0LzQsNC90LTRiyIi
IgoKICAgICAgICBpZiBjbWQgPT0gJ1BJTkcnOgogICAgICAgICAgICBpZiByZXN1bHQgaXMgVHJ1
ZSBvciByZXN1bHQgPT0gYidQT05HJyBvciByZXN1bHQgPT0gJ1BPTkcnOgogICAgICAgICAgICAg
ICAgcmV0dXJuICdQT05HJwogICAgICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBieXRl
cyk6CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9
J3JlcGxhY2UnKQogICAgICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBzdHIpOgogICAg
ICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAg
ICAgcmV0dXJuICdQT05HJwoKICAgICAgICBlbGlmIHJlc3VsdCBpcyBOb25lOgogICAgICAgICAg
ICByZXR1cm4gJyhuaWwpJwoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBib29sKToK
ICAgICAgICAgICAgcmV0dXJuICdPSycgaWYgcmVzdWx0IGVsc2UgJyhlcnJvciknCgogICAgICAg
IGVsaWYgaXNpbnN0YW5jZShyZXN1bHQsIGludCk6CiAgICAgICAgICAgIHJldHVybiBmJyhpbnRl
Z2VyKSB7cmVzdWx0fScKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3VsdCwgYnl0ZXMpOgog
ICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBkZWNvZGVkID0gcmVzdWx0LmRlY29kZSgn
dXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAgcmV0dXJuIGYnIntkZWNv
ZGVkfSInCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHJldHVybiBmJzxieXRl
czoge2xlbihyZXN1bHQpfT4nCgogICAgICAgIGVsaWYgaXNpbnN0YW5jZShyZXN1bHQsIHN0cik6
CiAgICAgICAgICAgIHJldHVybiBmJyJ7cmVzdWx0fSInCgogICAgICAgIGVsaWYgaXNpbnN0YW5j
ZShyZXN1bHQsIGxpc3QpOgogICAgICAgICAgICBpZiBsZW4ocmVzdWx0KSA9PSAwOgogICAgICAg
ICAgICAgICAgcmV0dXJuICcoZW1wdHkgbGlzdCBvciBzZXQpJwogICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgcmVzdWx0X2xpbmVzID0gW10KICAgICAgICAgICAgICAgIGZvciBpLCBp
dGVtIGluIGVudW1lcmF0ZShyZXN1bHRbOjUwXSk6ICAjINCe0LPRgNCw0L3QuNGH0LjQstCw0LXQ
vCA1MCDRjdC70LXQvNC10L3RgtCw0LzQuAogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFu
Y2UoaXRlbSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBkZWNvZGVkID0gaXRlbS5kZWNvZGUoInV0Zi04IiwgZXJyb3JzPSJy
ZXBsYWNlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcy5hcHBlbmQo
Zid7aSArIDF9KSAie2RlY29kZWR9IicpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcy5hcHBlbmQoZid7aSArIDF9
KSA8Ynl0ZXM6IHtsZW4oaXRlbSl9PicpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBpc2luc3Rh
bmNlKGl0ZW0sIHN0cik6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcy5hcHBl
bmQoZid7aSArIDF9KSAie2l0ZW19IicpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBpc2luc3Rh
bmNlKGl0ZW0sIGxpc3QpOgogICAgICAgICAgICAgICAgICAgICAgICAjINCS0LvQvtC20LXQvdC9
0YvQtSDRgdC/0LjRgdC60LggKNC90LDQv9GA0LjQvNC10YAsIFNDQU4pCiAgICAgICAgICAgICAg
ICAgICAgICAgIGlmIGkgPT0gMCBhbmQgbGVuKGl0ZW0pID09IDIgYW5kIGlzaW5zdGFuY2UoaXRl
bVswXSwgaW50KToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0K3RgtC+INGA0LXQt9GD
0LvRjNGC0LDRgiBTQ0FOCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRfbGluZXMu
YXBwZW5kKGYne2kgKyAxfSkgMSkgIntpdGVtWzBdfSInKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcmVzdWx0X2xpbmVzLmFwcGVuZChmJyAgIDIpIHtzZWxmLmZvcm1hdF9yZWRpc19yZXN1
bHQoIlNDQU4iLCBpdGVtWzFdKX0nKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0X2xpbmVzLmFwcGVuZChmJ3tpICsgMX0pIHtp
dGVtfScpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAg
cmVzdWx0X2xpbmVzLmFwcGVuZChmJ3tpICsgMX0pIHtzdHIoaXRlbSl9JykKCiAgICAgICAgICAg
ICAgICBpZiBsZW4ocmVzdWx0KSA+IDUwOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdF9saW5l
cy5hcHBlbmQoZicuLi4gYW5kIHtsZW4ocmVzdWx0KSAtIDUwfSBtb3JlIGl0ZW1zJykKCiAgICAg
ICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKHJlc3VsdF9saW5lcykKCiAgICAgICAgZWxpZiBp
c2luc3RhbmNlKHJlc3VsdCwgZGljdCk6CiAgICAgICAgICAgIGlmIGxlbihyZXN1bHQpID09IDA6
CiAgICAgICAgICAgICAgICByZXR1cm4gJyhlbXB0eSBoYXNoKScKICAgICAgICAgICAgZWxzZToK
ICAgICAgICAgICAgICAgIHJlc3VsdF9saW5lcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgaSwg
KGtleSwgdmFsdWUpIGluIGVudW1lcmF0ZShsaXN0KHJlc3VsdC5pdGVtcygpKVs6NTBdKToKICAg
ICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGtleSwgYnl0ZXMpOgogICAgICAgICAgICAg
ICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBrZXkuZGVj
b2RlKCJ1dGYtOCIsIGVycm9ycz0icmVwbGFjZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4
Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IGYnPGJ5dGVzOiB7bGVuKGtl
eSl9PicKCiAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgYnl0ZXMpOgog
ICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
YWx1ZSA9IHZhbHVlLmRlY29kZSgidXRmLTgiLCBlcnJvcnM9InJlcGxhY2UiKQogICAgICAgICAg
ICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9
IGYnPGJ5dGVzOiB7bGVuKHZhbHVlKX0+JwoKICAgICAgICAgICAgICAgICAgICByZXN1bHRfbGlu
ZXMuYXBwZW5kKGYne2kgKyAxfSkgIntrZXl9IiA9PiAie3ZhbHVlfSInKQoKICAgICAgICAgICAg
ICAgIGlmIGxlbihyZXN1bHQpID4gNTA6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0X2xpbmVz
LmFwcGVuZChmJy4uLiBhbmQge2xlbihyZXN1bHQpIC0gNTB9IG1vcmUgZmllbGRzJykKCiAgICAg
ICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKHJlc3VsdF9saW5lcykKCiAgICAgICAgZWxzZToK
ICAgICAgICAgICAgcmV0dXJuIHN0cihyZXN1bHQpCgogICAgZGVmIHVwZGF0ZV9jb25uZWN0aW9u
X3RyZWUoc2VsZik6CiAgICAgICAgIiIi0J7QsdC90L7QstC70LXQvdC40LUg0LTQtdGA0LXQstCw
INC/0L7QtNC60LvRjtGH0LXQvdC40LkgKNCR0JXQlyDQutC70Y7Rh9C10LkgLSDQvtC90Lgg0LIg
a2V5X2xpc3RfdmlldykiIiIKICAgICAgICBzZWxmLmNvbm5lY3Rpb25fdHJlZVs6XSA9IFtdCgog
ICAgICAgIGZvciBuYW1lLCBwcm9maWxlIGluIHNlbGYucHJvZmlsZXMuaXRlbXMoKToKICAgICAg
ICAgICAgY29ubiA9IHNlbGYuY29ubmVjdGlvbnMuZ2V0KG5hbWUpCgogICAgICAgICAgICBpZiBj
b25uIGFuZCBjb25uLmNvbm5lY3RlZDoKICAgICAgICAgICAgICAgIGljb24gPSAn4pePICcKICAg
ICAgICAgICAgICAgIGlmIGNvbm4uaXNfY2x1c3RlcjoKICAgICAgICAgICAgICAgICAgICBzZXJ2
ZXJfbGFiZWwgPSBmIntpY29ufXtwcm9maWxlLm5hbWV9IFtDTFVTVEVSXSIKICAgICAgICAgICAg
ICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VydmVyX2xhYmVsID0gZiJ7aWNvbn17cHJv
ZmlsZS5uYW1lfSAoe3Byb2ZpbGUuaG9zdH06e3Byb2ZpbGUucG9ydH0pIgogICAgICAgICAgICAg
ICAgc3R5bGUgPSAnY29ubmVjdGlvbicKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAg
IGljb24gPSAn4peLICcKICAgICAgICAgICAgICAgIHNlcnZlcl9sYWJlbCA9IGYie2ljb259e3By
b2ZpbGUubmFtZX0gKHtwcm9maWxlLmhvc3R9Ontwcm9maWxlLnBvcnR9KSIKICAgICAgICAgICAg
ICAgIHN0eWxlID0gJ2Nvbm5lY3Rpb24nCgogICAgICAgICAgICAjINCX0LDQs9C+0LvQvtCy0L7Q
uiDRgdC10YDQstC10YDQsAogICAgICAgICAgICBzZXJ2ZXJfYnRuID0gdXJ3aWQuQnV0dG9uKHNl
cnZlcl9sYWJlbCwgb25fcHJlc3M9c2VsZi5vbl9zZXJ2ZXJfc2VsZWN0LCB1c2VyX2RhdGE9bmFt
ZSkKCiAgICAgICAgICAgIGlmIGNvbm4gYW5kIGNvbm4uY29ubmVjdGVkOgogICAgICAgICAgICAg
ICAgc2VsZi5jb25uZWN0aW9uX3RyZWUuYXBwZW5kKHVyd2lkLkF0dHJNYXAoc2VydmVyX2J0biwg
c3R5bGUsICdjb25uZWN0aW9uX3NlbGVjdGVkJykpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAg
ICAgICAgICBzZWxmLmNvbm5lY3Rpb25fdHJlZS5hcHBlbmQodXJ3aWQuQXR0ck1hcChzZXJ2ZXJf
YnRuLCBzdHlsZSwgJ3NpZGViYXJfZm9jdXMnKSkKCiAgICAgICAgICAgICMg0J/QvtC60LDQt9GL
0LLQsNC10Lwg0LHQsNC30Ysg0LTQsNC90L3Ri9GFINC00LvRjyDQv9C+0LTQutC70Y7Rh9C10L3Q
vdC+0LPQviDRgdC10YDQstC10YDQsAogICAgICAgICAgICBpZiBjb25uIGFuZCBjb25uLmNvbm5l
Y3RlZDoKICAgICAgICAgICAgICAgIGlmIGNvbm4uaXNfY2x1c3RlcjoKICAgICAgICAgICAgICAg
ICAgICAjINCa0LvQsNGB0YLQtdGAIC0g0YLQvtC70YzQutC+IERCMAogICAgICAgICAgICAgICAg
ICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaXNfY3VycmVudCA9IChzZWxmLmN1cnJl
bnRfY29ubmVjdGlvbiA9PSBjb25uKQogICAgICAgICAgICAgICAgICAgICAgICBkYl9pY29uID0g
JyAg4paqICcgaWYgaXNfY3VycmVudCBlbHNlICcgIOKWqyAnCiAgICAgICAgICAgICAgICAgICAg
ICAgIGRiX2xhYmVsID0gZiJ7ZGJfaWNvbn1EQjAgKHtzZWxmLmtleV9jb3VudH0ga2V5cykiCgog
ICAgICAgICAgICAgICAgICAgICAgICBkYl9idG4gPSB1cndpZC5CdXR0b24oZGJfbGFiZWwsIG9u
X3ByZXNzPXNlbGYub25fZGJfc2VsZWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdXNlcl9kYXRhPShuYW1lLCAwKSkKCiAgICAgICAgICAgICAgICAgICAg
ICAgIGlmIGlzX2N1cnJlbnQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gdXJ3
aWQuQXR0ck1hcChkYl9idG4sICdjb25uZWN0aW9uX3NlbGVjdGVkJywgJ2Nvbm5lY3Rpb25fc2Vs
ZWN0ZWQnKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaXRlbSA9IHVyd2lkLkF0dHJNYXAoZGJfYnRuLCAna2V5X2ZvbGRlcicsICdrZXlf
Zm9sZGVyX2ZvY3VzJykKCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY29ubmVjdGlvbl90
cmVlLmFwcGVuZChpdGVtKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMg
ZToKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZGlzcGxheWlu
ZyBjbHVzdGVyIERCOiB7ZX0iKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAg
ICAgICAjIFN0YW5kYWxvbmUKICAgICAgICAgICAgICAgICAgICBkYl9rZXlfY291bnRzID0gc2Vs
Zi5nZXRfYWxsX2RiX2tleV9jb3VudHMoY29ubikKCiAgICAgICAgICAgICAgICAgICAgZm9yIGRi
X251bSBpbiByYW5nZShzZWxmLm1heF9kYiArIDEpOgogICAgICAgICAgICAgICAgICAgICAgICBp
c19jdXJyZW50ID0gKHNlbGYuY3VycmVudF9jb25uZWN0aW9uID09IGNvbm4gYW5kCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubi5jdXJyZW50X2RiID09IGRiX251bSkK
CiAgICAgICAgICAgICAgICAgICAgICAgIGRiX2ljb24gPSAnICDilqogJyBpZiBpc19jdXJyZW50
IGVsc2UgJyAg4parICcKICAgICAgICAgICAgICAgICAgICAgICAga2V5X2NvdW50ID0gZGJfa2V5
X2NvdW50cy5nZXQoZGJfbnVtLCAwKQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYga2V5X2Nv
dW50ID4gMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiX2xhYmVsID0gZiJ7ZGJfaWNv
bn1EQntkYl9udW19ICh7a2V5X2NvdW50fSBrZXlzKSIKICAgICAgICAgICAgICAgICAgICAgICAg
ZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiX2xhYmVsID0gZiJ7ZGJfaWNvbn1E
QntkYl9udW19IgoKICAgICAgICAgICAgICAgICAgICAgICAgZGJfYnRuID0gdXJ3aWQuQnV0dG9u
KGRiX2xhYmVsLCBvbl9wcmVzcz1zZWxmLm9uX2RiX3NlbGVjdCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfZGF0YT0obmFtZSwgZGJfbnVtKSkKCiAg
ICAgICAgICAgICAgICAgICAgICAgIGlmIGlzX2N1cnJlbnQ6CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpdGVtID0gdXJ3aWQuQXR0ck1hcChkYl9idG4sICdjb25uZWN0aW9uX3NlbGVjdGVk
JywgJ2Nvbm5lY3Rpb25fc2VsZWN0ZWQnKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IHVyd2lkLkF0dHJNYXAoZGJfYnRuLCAn
a2V5X2ZvbGRlcicsICdrZXlfZm9sZGVyX2ZvY3VzJykKCiAgICAgICAgICAgICAgICAgICAgICAg
IHNlbGYuY29ubmVjdGlvbl90cmVlLmFwcGVuZChpdGVtKQoKICAgICAgICBzZWxmLnVwZGF0ZV90
YWJzKCkKCiAgICBkZWYgZ2V0X2FsbF9kYl9rZXlfY291bnRzKHNlbGYsIGNvbm46IFJlZGlzQ29u
bmVjdGlvbikgLT4gRGljdFtpbnQsIGludF06CiAgICAgICAgIiIi0J/QvtC70YPRh9C40YLRjCDQ
utC+0LvQuNGH0LXRgdGC0LLQviDQutC70Y7Rh9C10Lkg0LLQviDQstGB0LXRhSDQsdCw0LfQsNGF
INC00LDQvdC90YvRhSIiIgogICAgICAgIGRiX2NvdW50cyA9IHt9CgogICAgICAgIGlmIG5vdCBj
b25uIG9yIG5vdCBjb25uLmNvbm5lY3RlZDoKICAgICAgICAgICAgcmV0dXJuIGRiX2NvdW50cwoK
ICAgICAgICAjINCU0LvRjyDQutC70LDRgdGC0LXRgNCwINCy0L7Qt9Cy0YDQsNGJ0LDQtdC8INGC
0L7Qu9GM0LrQviBEQjAKICAgICAgICBpZiBjb25uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgIHRy
eToKICAgICAgICAgICAgICAgICMg0JIg0LrQu9Cw0YHRgtC10YDQtSDQvNC+0LbQvdC+INC/0L7Q
u9GD0YfQuNGC0Ywg0L7QsdGJ0LXQtSDQutC+0LvQuNGH0LXRgdGC0LLQviDQutC70Y7Rh9C10Lkg
0YfQtdGA0LXQtyBEQlNJWkUKICAgICAgICAgICAgICAgIHRvdGFsX2tleXMgPSBjb25uLmFjdGl2
ZV9jbGllbnQuZGJzaXplKCkKCiAgICAgICAgICAgICAgICBpZiB0b3RhbF9rZXlzID4gMDoKICAg
ICAgICAgICAgICAgICAgICBkYl9jb3VudHNbMF0gPSB0b3RhbF9rZXlzCiAgICAgICAgICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxl
ZCB0byBnZXQgY2x1c3RlciBrZXkgY291bnQ6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiBkYl9j
b3VudHMKCiAgICAgICAgIyDQodC+0YXRgNCw0L3Rj9C10Lwg0YLQtdC60YPRidGD0Y4g0JHQlAog
ICAgICAgIGN1cnJlbnRfZGIgPSBjb25uLmN1cnJlbnRfZGIKCiAgICAgICAgdHJ5OgogICAgICAg
ICAgICAjINCf0YDQvtGF0L7QtNC40Lwg0L/QviDQstGB0LXQvCDQkdCUINC4INGB0YfQuNGC0LDQ
tdC8INC60LvRjtGH0LgKICAgICAgICAgICAgZm9yIGRiX251bSBpbiByYW5nZShzZWxmLm1heF9k
YiArIDEpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGNvbm4uY2xp
ZW50LnNlbGVjdChkYl9udW0pCiAgICAgICAgICAgICAgICAgICAgY291bnQgPSBjb25uLmNsaWVu
dC5kYnNpemUoKQogICAgICAgICAgICAgICAgICAgIGlmIGNvdW50ID4gMDoKICAgICAgICAgICAg
ICAgICAgICAgICAgZGJfY291bnRzW2RiX251bV0gPSBjb3VudAogICAgICAgICAgICAgICAgZXhj
ZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZh
aWxlZCB0byBnZXQga2V5IGNvdW50IGZvciBEQntkYl9udW19OiB7ZX0iKQogICAgICAgICAgICAg
ICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjINCS0L7Qt9Cy0YDQsNGJ0LDQtdC80YHRjyDQ
uiDRgtC10LrRg9GJ0LXQuSDQkdCUCiAgICAgICAgICAgIGNvbm4uY2xpZW50LnNlbGVjdChjdXJy
ZW50X2RiKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dl
ci5lcnJvcihmIkZhaWxlZCB0byBnZXQgYWxsIERCIGtleSBjb3VudHM6IHtlfSIpCiAgICAgICAg
ICAgICMg0JXRgdC70Lgg0YfRgtC+LdGC0L4g0L/QvtGI0LvQviDQvdC1INGC0LDQuiwg0LLQvtC3
0LLRgNCw0YnQsNC10LzRgdGPINC6INGC0LXQutGD0YnQtdC5INCR0JQKICAgICAgICAgICAgdHJ5
OgogICAgICAgICAgICAgICAgY29ubi5jbGllbnQuc2VsZWN0KGN1cnJlbnRfZGIpCiAgICAgICAg
ICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmV0dXJuIGRiX2NvdW50
cwoKICAgIGRlZiBvbl9zZXJ2ZXJfc2VsZWN0KHNlbGYsIGJ1dHRvbiwgcHJvZmlsZV9uYW1lOiBz
dHIpOgogICAgICAgICIiItCS0YvQsdC+0YAg0YHQtdGA0LLQtdGA0LAgKNC/0L7QtNC60LvRjtGH
0LXQvdC40LUv0L/QtdGA0LXQv9C+0LTQutC70Y7Rh9C10L3QuNC1KSIiIgogICAgICAgIHByb2Zp
bGUgPSBzZWxmLnByb2ZpbGVzLmdldChwcm9maWxlX25hbWUpCiAgICAgICAgaWYgbm90IHByb2Zp
bGU6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjINCV0YHQu9C4INGD0LbQtSDQv9C+0LTQ
utC70Y7Rh9C10L3RiyDQuiDRjdGC0L7QvNGDINGB0LXRgNCy0LXRgNGDCiAgICAgICAgaWYgcHJv
ZmlsZV9uYW1lIGluIHNlbGYuY29ubmVjdGlvbnMgYW5kIHNlbGYuY29ubmVjdGlvbnNbcHJvZmls
ZV9uYW1lXS5jb25uZWN0ZWQ6CiAgICAgICAgICAgIHNlbGYuY3VycmVudF9jb25uZWN0aW9uID0g
c2VsZi5jb25uZWN0aW9uc1twcm9maWxlX25hbWVdCiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1
cyhmIkFscmVhZHkgY29ubmVjdGVkIHRvIHtwcm9maWxlLm5hbWV9IiwgJ3N1Y2Nlc3MnKQogICAg
ICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuY29ubmVjdF90b19wcm9maWxlKHByb2ZpbGUpCgog
ICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkKICAgICAgICBzZWxmLnVwZGF0ZV9jb25uZWN0aW9u
X3RyZWUoKQoKICAgIGRlZiBwYXJzZV9jbHVzdGVyX2luZm8oc2VsZiwgaW5mb19zdHJpbmc6IHN0
cikgLT4gZGljdDoKICAgICAgICAiIiLQn9Cw0YDRgdC40L3QsyDRgNC10LfRg9C70YzRgtCw0YLQ
sCBDTFVTVEVSIElORk8g0LIg0YHQu9C+0LLQsNGA0YwiIiIKICAgICAgICByZXN1bHQgPSB7fQoK
ICAgICAgICBpZiBpc2luc3RhbmNlKGluZm9fc3RyaW5nLCBieXRlcyk6CiAgICAgICAgICAgIGlu
Zm9fc3RyaW5nID0gaW5mb19zdHJpbmcuZGVjb2RlKCd1dGYtOCcpCgogICAgICAgIGZvciBsaW5l
IGluIGluZm9fc3RyaW5nLnN0cmlwKCkuc3BsaXQoJ1xuJyk6CiAgICAgICAgICAgIGxpbmUgPSBs
aW5lLnN0cmlwKCkKICAgICAgICAgICAgaWYgJzonIGluIGxpbmU6CiAgICAgICAgICAgICAgICBr
ZXksIHZhbHVlID0gbGluZS5zcGxpdCgnOicsIDEpCiAgICAgICAgICAgICAgICByZXN1bHRba2V5
XSA9IHZhbHVlCgogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgY29ubmVjdF90b19wcm9m
aWxlKHNlbGYsIHByb2ZpbGU6IENvbm5lY3Rpb25Qcm9maWxlKToKICAgICAgICAiIiLQn9C+0LTQ
utC70Y7Rh9C10L3QuNC1INC6INC/0YDQvtGE0LjQu9GOINGBINC/0L7QtNC00LXRgNC20LrQvtC5
INC60LvQsNGB0YLQtdGA0LAiIiIKICAgICAgICBpZiBwcm9maWxlLmNsdXN0ZXJfbW9kZToKICAg
ICAgICAgICAgIyDQlNC70Y8g0LrQu9Cw0YHRgtC10YDQsCDQuNGB0L/QvtC70YzQt9GD0LXQvCDQ
v9C10YDQstGL0Lkg0YPQt9C10Lsg0LTQu9GPINC40LTQtdC90YLQuNGE0LjQutCw0YbQuNC4CiAg
ICAgICAgICAgIGlmIHByb2ZpbGUuY2x1c3Rlcl9ub2RlczoKICAgICAgICAgICAgICAgIGZpcnN0
X25vZGUgPSBwcm9maWxlLmNsdXN0ZXJfbm9kZXNbMF0KICAgICAgICAgICAgICAgIHNlcnZlcl9r
ZXkgPSBmImNsdXN0ZXI6e2ZpcnN0X25vZGVbMF19OntmaXJzdF9ub2RlWzFdfSIKICAgICAgICAg
ICAgZWxzZToKICAgICAgICAgICAgICAgIHNlcnZlcl9rZXkgPSBmImNsdXN0ZXI6e3Byb2ZpbGUu
aG9zdH06e3Byb2ZpbGUucG9ydH0iCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyDQlNC70Y8g
c3RhbmRhbG9uZQogICAgICAgICAgICBpZiBwcm9maWxlLnNvY2tldF9wYXRoOgogICAgICAgICAg
ICAgICAgc2VydmVyX2tleSA9IGYidW5peDp7cHJvZmlsZS5zb2NrZXRfcGF0aH0iCiAgICAgICAg
ICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZXJ2ZXJfa2V5ID0gZiJ7cHJvZmlsZS5ob3N0fTp7
cHJvZmlsZS5wb3J0fSIKCiAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwg0YHRg9GJ0LXRgdGC
0LLRg9GO0YnQuNC1INC/0L7QtNC60LvRjtGH0LXQvdC40Y8KICAgICAgICBmb3IgZXhpc3Rpbmdf
bmFtZSwgY29ubiBpbiBzZWxmLmNvbm5lY3Rpb25zLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGNv
bm4uY29ubmVjdGVkOgogICAgICAgICAgICAgICAgIyDQodGA0LDQstC90LjQstCw0LXQvCDQv9Cw
0YDQsNC80LXRgtGA0Ysg0L/QvtC00LrQu9GO0YfQtdC90LjRjwogICAgICAgICAgICAgICAgaWYg
KGNvbm4uaXNfY2x1c3RlciA9PSBwcm9maWxlLmNsdXN0ZXJfbW9kZSBhbmQKICAgICAgICAgICAg
ICAgICAgICAgICAgY29ubi5wcm9maWxlLmhvc3QgPT0gcHJvZmlsZS5ob3N0IGFuZAogICAgICAg
ICAgICAgICAgICAgICAgICBjb25uLnByb2ZpbGUucG9ydCA9PSBwcm9maWxlLnBvcnQpOgoKICAg
ICAgICAgICAgICAgICAgICAjINCU0LvRjyDQutC70LDRgdGC0LXRgNCwINC00L7Qv9C+0LvQvdC4
0YLQtdC70YzQvdC+INC/0YDQvtCy0LXRgNGP0LXQvCDRg9C30LvRiwogICAgICAgICAgICAgICAg
ICAgIGlmIHByb2ZpbGUuY2x1c3Rlcl9tb2RlOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAo
aGFzYXR0cihjb25uLnByb2ZpbGUsICdjbHVzdGVyX25vZGVzJykgYW5kCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29ubi5wcm9maWxlLmNsdXN0ZXJfbm9kZXMgPT0gcHJvZmlsZS5j
bHVzdGVyX25vZGVzKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudF9j
b25uZWN0aW9uID0gY29ubgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3Rh
dHVzKGYiQWxyZWFkeSBjb25uZWN0ZWQgdG8gY2x1c3RlciB7c2VydmVyX2tleX0iLCAnc3VjY2Vz
cycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9IGNvbm4KICAg
ICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiQWxyZWFkeSBjb25uZWN0ZWQg
dG8ge3NlcnZlcl9rZXl9IiwgJ3N1Y2Nlc3MnKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxm
LnJlZnJlc2hfa2V5cygpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAj
INCh0L7Qt9C00LDQtdC8INC90L7QstC+0LUg0L/QvtC00LrQu9GO0YfQtdC90LjQtQogICAgICAg
IGNvbm4gPSBSZWRpc0Nvbm5lY3Rpb24ocHJvZmlsZSkKICAgICAgICBzdWNjZXNzLCBtZXNzYWdl
ID0gY29ubi5jb25uZWN0KCkKCiAgICAgICAgaWYgc3VjY2VzczoKICAgICAgICAgICAgc2VsZi5j
b25uZWN0aW9uc1twcm9maWxlLm5hbWVdID0gY29ubgogICAgICAgICAgICBzZWxmLmN1cnJlbnRf
Y29ubmVjdGlvbiA9IGNvbm4KCiAgICAgICAgICAgIGlmIHByb2ZpbGUuY2x1c3Rlcl9tb2RlOgog
ICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICMg0J/QvtC70YPRh9Cw0LXQ
vCDQuNC90YTQvtGA0LzQsNGG0LjRjiDQviDQutC70LDRgdGC0LXRgNC1CiAgICAgICAgICAgICAg
ICAgICAgY2x1c3Rlcl9pbmZvX3N0ciA9IGNvbm4uYWN0aXZlX2NsaWVudC5leGVjdXRlX2NvbW1h
bmQoJ0NMVVNURVInLCAnSU5GTycpCgogICAgICAgICAgICAgICAgICAgICMg0L/QsNGA0YHQuNC8
INGB0YLRgNC+0LrRgyDQsiDRgdC70L7QstCw0YDRjAogICAgICAgICAgICAgICAgICAgIGNsdXN0
ZXJfaW5mbyA9IHNlbGYucGFyc2VfY2x1c3Rlcl9pbmZvKGNsdXN0ZXJfaW5mb19zdHIpCgogICAg
ICAgICAgICAgICAgICAgIHN0YXRlID0gY2x1c3Rlcl9pbmZvLmdldCgnY2x1c3Rlcl9zdGF0ZScs
ICd1bmtub3duJykKICAgICAgICAgICAgICAgICAgICBub2RlX2NvdW50ID0gY2x1c3Rlcl9pbmZv
LmdldCgnY2x1c3Rlcl9rbm93bl9ub2RlcycsICc/JykKCiAgICAgICAgICAgICAgICAgICAgc2Vs
Zi5zZXRfc3RhdHVzKAogICAgICAgICAgICAgICAgICAgICAgICBmIkNvbm5lY3RlZCB0byBSZWRp
cyBDbHVzdGVyIChzdGF0ZToge3N0YXRlfSwgbm9kZXM6IHtub2RlX2NvdW50fSkiLAogICAgICAg
ICAgICAgICAgICAgICAgICAnc3VjY2VzcycKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAg
ICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2Vy
LmVycm9yKGYiQ291bGQgbm90IGdldCBjbHVzdGVyIGluZm86IHtlfSIpCiAgICAgICAgICAgICAg
ICAgICAgIyBGYWxsYmFjayAtINC/0YDQvtGB0YLQviDQv9C+0LrQsNC30YvQstCw0LXQvCDRh9GC
0L4g0L/QvtC00LrQu9GO0YfQuNC70LjRgdGMINC6INC60LvQsNGB0YLQtdGA0YMKICAgICAgICAg
ICAgICAgICAgICBub2RlX2NvdW50ID0gbGVuKHByb2ZpbGUuY2x1c3Rlcl9ub2RlcykgaWYgaGFz
YXR0cihwcm9maWxlLCAnY2x1c3Rlcl9ub2RlcycpIGVsc2UgMQogICAgICAgICAgICAgICAgICAg
IHNlbGYuc2V0X3N0YXR1cyhmIkNvbm5lY3RlZCB0byBSZWRpcyBDbHVzdGVyICh7bm9kZV9jb3Vu
dH0gbm9kZXMpIiwgJ3N1Y2Nlc3MnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAg
c2VsZi5zZXRfc3RhdHVzKGYiQ29ubmVjdGVkIHRvIHtwcm9maWxlLmhvc3R9Ontwcm9maWxlLnBv
cnR9IiwgJ3N1Y2Nlc3MnKQoKICAgICAgICAgICAgc2VsZi5yZWZyZXNoX2tleXMoKQogICAgICAg
IGVsc2U6CiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIkNvbm5lY3Rpb24gZmFpbGVkOiB7
bWVzc2FnZX0iLCAnZXJyb3InKQoKICAgIGRlZiBvbl9kYl9zZWxlY3Qoc2VsZiwgYnV0dG9uLCBk
YXRhOiBUdXBsZVtzdHIsIGludF0pOgogICAgICAgICIiItCS0YvQsdC+0YAg0LHQsNC30Ysg0LTQ
sNC90L3Ri9GFIiIiCiAgICAgICAgcHJvZmlsZV9uYW1lLCBkYl9udW0gPSBkYXRhCgogICAgICAg
IGNvbm4gPSBzZWxmLmNvbm5lY3Rpb25zLmdldChwcm9maWxlX25hbWUpCiAgICAgICAgaWYgbm90
IGNvbm4gb3Igbm90IGNvbm4uY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAg
IyDQlNC70Y8g0LrQu9Cw0YHRgtC10YDQsCDRgNCw0LfRgNC10YjQsNC10Lwg0YLQvtC70YzQutC+
IERCMAogICAgICAgIGlmIGNvbm4uaXNfY2x1c3RlcjoKICAgICAgICAgICAgaWYgZGJfbnVtICE9
IDA6CiAgICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoIlJlZGlzIENsdXN0ZXIgc3VwcG9y
dHMgb25seSBEQjAiLCAnd2FybmluZycpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAg
ICAgIyDQkiDQutC70LDRgdGC0LXRgNC1INC90LXRgiDQutC+0LzQsNC90LTRiyBTRUxFQ1QsINC/
0YDQvtGB0YLQviDQvtCx0L3QvtCy0LvRj9C10Lwg0LjQvdGC0LXRgNGE0LXQudGBCiAgICAgICAg
ICAgIHNlbGYuY3VycmVudF9jb25uZWN0aW9uID0gY29ubgogICAgICAgICAgICBzZWxmLnNldF9z
dGF0dXMoIlJlZGlzIENsdXN0ZXIgKERCMCkiLCAnc3VjY2VzcycpCiAgICAgICAgICAgIHNlbGYu
cmVmcmVzaF9rZXlzKCkKICAgICAgICAgICAgc2VsZi51cGRhdGVfY29ubmVjdGlvbl90cmVlKCkK
ICAgICAgICBlbHNlOgogICAgICAgICAgICAjIFN0YW5kYWxvbmUgUmVkaXMKICAgICAgICAgICAg
c2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24gPSBjb25uCiAgICAgICAgICAgIHN1Y2Nlc3MsIG1lc3Nh
Z2UgPSBjb25uLnNlbGVjdF9kYihkYl9udW0pCgogICAgICAgICAgICBpZiBzdWNjZXNzOgogICAg
ICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiU3dpdGNoZWQgdG8gREJ7ZGJfbnVtfSIsICdz
dWNjZXNzJykKICAgICAgICAgICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkKICAgICAgICAgICAg
ICAgIHNlbGYudXBkYXRlX2Nvbm5lY3Rpb25fdHJlZSgpCiAgICAgICAgICAgIGVsc2U6CiAgICAg
ICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJGYWlsZWQgdG8gc3dpdGNoIERCOiB7bWVzc2Fn
ZX0iLCAnZXJyb3InKQoKICAgIGRlZiBkaXNjb25uZWN0KHNlbGYpOgogICAgICAgICIiItCe0YLQ
utC70Y7Rh9C10L3QuNC1INC+0YIg0YLQtdC60YPRidC10LPQviDRgdC10YDQstC10YDQsCIiIgog
ICAgICAgIGlmIHNlbGYuY3VycmVudF9jb25uZWN0aW9uOgogICAgICAgICAgICBuYW1lID0gc2Vs
Zi5jdXJyZW50X2Nvbm5lY3Rpb24ucHJvZmlsZS5uYW1lCiAgICAgICAgICAgIHNlbGYuY3VycmVu
dF9jb25uZWN0aW9uLmRpc2Nvbm5lY3QoKQogICAgICAgICAgICBkZWwgc2VsZi5jb25uZWN0aW9u
c1tuYW1lXQogICAgICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiA9IE5vbmUKICAgICAg
ICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiRGlzY29ubmVjdGVkIGZyb20ge25hbWV9IiwgJ3N1Y2Nl
c3MnKQogICAgICAgICAgICBzZWxmLmtleXNfbGlzdCA9IFtdICAgIyBzZWxmLmtleV90cmVlX3Jv
b3QgPSBLZXlUcmVlTm9kZSgncm9vdCcpCiAgICAgICAgICAgIHNlbGYudXBkYXRlX2Nvbm5lY3Rp
b25fdHJlZSgpCgogICAgZGVmIGV4aXRfbWFpbihzZWxmKToKICAgICAgICByYWlzZSB1cndpZC5F
eGl0TWFpbkxvb3AoKQoKICAgIGRlZiBnZXRfY2x1c3Rlcl9tYXN0ZXJfbm9kZXMoc2VsZiwgY2xp
ZW50KToKICAgICAgICAiIiLQkdC10LfQvtC/0LDRgdC90L7QtSDQv9C+0LvRg9GH0LXQvdC40LUg
0LzQsNGB0YLQtdGALdC90L7QtCDQutC70LDRgdGC0LXRgNCwIiIiCiAgICAgICAgdHJ5OgogICAg
ICAgICAgICAjINCh0L/QvtGB0L7QsSAxOiDRgdC+0LLQvNC10YHRgtC40LzRi9C5INGBIHJlZGlz
LXB5LWNsdXN0ZXIgPj0gMi4xLjAKICAgICAgICAgICAgaWYgaGFzYXR0cihjbGllbnQsICdnZXRf
cHJpbWFyaWVzJyk6CiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LmdldF9wcmltYXJpZXMo
KQoKICAgICAgICAgICAgIyDQodC/0L7RgdC+0LEgMjog0LTQu9GPINCx0L7Qu9C10LUg0YHRgtCw
0YDRi9GFINCy0LXRgNGB0LjQuQogICAgICAgICAgICBlbGlmIGhhc2F0dHIoY2xpZW50LCAnZ2V0
X25vZGVzJyk6CiAgICAgICAgICAgICAgICBub2RlcyA9IGNsaWVudC5nZXRfbm9kZXMoKQogICAg
ICAgICAgICAgICAgbWFzdGVyX25vZGVzID0gW10KICAgICAgICAgICAgICAgIGZvciBub2RlIGlu
IG5vZGVzOgogICAgICAgICAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8INGA0LDQt9C9
0YvQvNC4INGB0L/QvtGB0L7QsdCw0LzQuAogICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIo
bm9kZSwgJ3NlcnZlcl90eXBlJyk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vZGUuc2Vy
dmVyX3R5cGUgPT0gJ21hc3Rlcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXN0ZXJf
bm9kZXMuYXBwZW5kKG5vZGUpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBoYXNhdHRyKG5vZGUs
ICdyZWRpc19jb25uZWN0aW9uJyk6CiAgICAgICAgICAgICAgICAgICAgICAgICMg0J/QvtC/0YDQ
vtCx0YPQtdC8INC/0L7Qu9GD0YfQuNGC0Ywg0LjQvdGE0L7RgNC80LDRhtC40Y4g0YfQtdGA0LXQ
tyDQutC+0LzQsNC90LTRgwogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpbmZvID0gbm9kZS5leGVjdXRlX2NvbW1hbmQoJ1JPTEUnKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW5mbyBhbmQgaXNpbnN0YW5jZShpbmZvLCBsaXN0
KSBhbmQgaW5mb1swXSA9PSAnbWFzdGVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBtYXN0ZXJfbm9kZXMuYXBwZW5kKG5vZGUpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2Vw
dDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAgICAg
cmV0dXJuIG1hc3Rlcl9ub2RlcwoKICAgICAgICAgICAgIyDQodC/0L7RgdC+0LEgMzog0YfQtdGA
0LXQtyBDTFVTVEVSIE5PREVTCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0cnk6
CiAgICAgICAgICAgICAgICAgICAgbm9kZXNfaW5mbyA9IGNsaWVudC5leGVjdXRlX2NvbW1hbmQo
J0NMVVNURVIgTk9ERVMnKQogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uobm9kZXNf
aW5mbywgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICBub2Rlc19pbmZvID0gbm9kZXNf
aW5mby5kZWNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICAgICAgbWFzdGVyX25vZGVzID0g
W10KICAgICAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBub2Rlc19pbmZvLnNwbGl0KCdcbicp
OgogICAgICAgICAgICAgICAgICAgICAgICBpZiBsaW5lLnN0cmlwKCkgYW5kICdtYXN0ZXInIGlu
IGxpbmUgYW5kICdteXNlbGYnIG5vdCBpbiBsaW5lOgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIyDQn9Cw0YDRgdC40Lwg0LDQtNGA0LXRgSDQvdC+0LTRiwogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcGFydHMgPSBsaW5lLnNwbGl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGlmIGxlbihwYXJ0cykgPiAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHIg
PSBwYXJ0c1sxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICc6JyBpbiBhZGRy
OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0LCBwb3J0ID0gYWRkci5z
cGxpdCgnOicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0KHQvtC30LTQ
sNC10Lwg0L/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiDQvdC+0LTQtQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBub2RlX2NsaWVudCA9IHJlZGlzLlJlZGlzKAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdD1ob3N0LAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcG9ydD1pbnQocG9ydCksCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBkZWNvZGVfcmVzcG9uc2VzPUZhbHNlLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0X3RpbWVvdXQ9MgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG1hc3Rlcl9ub2Rlcy5hcHBlbmQobm9kZV9jbGllbnQpCgogICAgICAgICAgICAgICAg
ICAgIHJldHVybiBtYXN0ZXJfbm9kZXMKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAg
ICAgICAgICAgICByZXR1cm4gW10KCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAg
ICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gZ2V0IG1hc3RlciBub2Rlczoge2V9IikK
ICAgICAgICAgICAgcmV0dXJuIFtdCgogICAgZGVmIHJlZnJlc2hfa2V5cyhzZWxmKToKICAgICAg
ICAiIiLQntCx0L3QvtCy0LvQtdC90LjQtSDRgdC/0LjRgdC60LAg0LrQu9GO0YfQtdC5IiIiCiAg
ICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uIG9yIG5vdCBzZWxmLmN1cnJlbnRf
Y29ubmVjdGlvbi5jb25uZWN0ZWQ6CiAgICAgICAgICAgIHNlbGYua2V5X2xpc3Rfdmlldy5zZXRf
a2V5cyhbXSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgY2xp
ZW50ID0gc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uYWN0aXZlX2NsaWVudAogICAgICAgICAgICBs
b2dnZXIuaW5mbyhmIkNsaWVudCB0eXBlOiB7dHlwZShjbGllbnQpfSIpCiAgICAgICAgICAgIGxv
Z2dlci5pbmZvKGYiSXMgY2x1c3Rlcjoge3NlbGYuY3VycmVudF9jb25uZWN0aW9uLmlzX2NsdXN0
ZXJ9IikKCiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cygiU2Nhbm5pbmcga2V5cy4uLiIpCgog
ICAgICAgICAgICBpZiBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5pc19jbHVzdGVyOgogICAgICAg
ICAgICAgICAgbG9nZ2VyLmluZm8oIlN0YXJ0aW5nIGNsdXN0ZXIgc2Nhbi4uLiIpCiAgICAgICAg
ICAgICAgICBrZXlzX3dpdGhfdHlwZXMgPSBzZWxmLl9zY2FuX2NsdXN0ZXJfa2V5c193aXRoX3R5
cGVzX2l0ZXIoY2xpZW50KQogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJDbHVzdGVyIHNj
YW4gcmV0dXJuZWQge2xlbihrZXlzX3dpdGhfdHlwZXMpfSBrZXlzIikKICAgICAgICAgICAgZWxz
ZToKICAgICAgICAgICAgICAgICMgU3RhbmRhbG9uZSAtINGB0LrQsNC90LjRgNGD0LXQvCDRgSDR
gtC40L/QsNC80LgKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJTdGFydGluZyBzdGFuZGFs
b25lIHNjYW4uLi4iKQogICAgICAgICAgICAgICAga2V5c193aXRoX3R5cGVzID0gW10KICAgICAg
ICAgICAgICAgIHNjYW5fY291bnQgPSAwCiAgICAgICAgICAgICAgICBtYXhfa2V5cyA9IDUwMDAK
CiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiVXNpbmcgc2Nhbl9pdGVyLi4uIikKICAgICAg
ICAgICAgICAgIGZvciBrZXkgaW4gY2xpZW50LnNjYW5faXRlcihtYXRjaD0nKicsIGNvdW50PTEw
MCk6CiAgICAgICAgICAgICAgICAgICAgaWYgc2Nhbl9jb3VudCA+PSBtYXhfa2V5czoKICAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAg
ICAgICAgICAgICAgICAgICBrZXlfdHlwZSA9IGNsaWVudC50eXBlKGtleSkKICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShrZXlfdHlwZSwgYnl0ZXMpOgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAga2V5X3R5cGUgPSBrZXlfdHlwZS5kZWNvZGUoJ3V0Zi04JykKICAgICAg
ICAgICAgICAgICAgICAgICAga2V5c193aXRoX3R5cGVzLmFwcGVuZCgoa2V5LCBrZXlfdHlwZSkp
CiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBrZXlz
X3dpdGhfdHlwZXMuYXBwZW5kKChrZXksICd1bmtub3duJykpCgogICAgICAgICAgICAgICAgICAg
IHNjYW5fY291bnQgKz0gMQoKICAgICAgICAgICAgICAgICAgICBpZiBzY2FuX2NvdW50ICUgMTAw
ID09IDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIlNjYW5uaW5n
Li4uIHtzY2FuX2NvdW50fSBrZXlzIikKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiU3Rh
bmRhbG9uZSBzY2FuIGNvbXBsZXRlOiB7bGVuKGtleXNfd2l0aF90eXBlcyl9IGtleXMiKQoKICAg
ICAgICAgICAgIyDQn9C+0LrQsNC30YvQstCw0LXQvCDQv9C10YDQstGL0LUg0L3QtdGB0LrQvtC7
0YzQutC+INC00LvRjyDQv9GA0L7QstC10YDQutC4CiAgICAgICAgICAgIGlmIGtleXNfd2l0aF90
eXBlczoKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiRmlyc3QgMyBrZXlzOiB7a2V5c193
aXRoX3R5cGVzWzozXX0iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbG9nZ2Vy
Lndhcm5pbmcoIk5vIGtleXMgZm91bmQhIikKCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJTZXR0
aW5nIGtleXMgdG8ga2V5X2xpc3Rfdmlldy4uLiIpCiAgICAgICAgICAgIHNlbGYua2V5X2xpc3Rf
dmlldy5zZXRfa2V5cyhrZXlzX3dpdGhfdHlwZXMpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJL
ZXlzIHNldCBzdWNjZXNzZnVsbHkiKQoKICAgICAgICAgICAgc2VsZi5rZXlfY291bnQgPSBsZW4o
a2V5c193aXRoX3R5cGVzKQogICAgICAgICAgICAjINCe0LHQvdC+0LLQu9GP0LXQvCDQtNC10YDQ
tdCy0L4g0L/QvtC00LrQu9GO0YfQtdC90LjQuSAo0YfRgtC+0LHRiyDQv9C+0LrQsNC30LDRgtGM
INC60L7Qu9C40YfQtdGB0YLQstC+INC60LvRjtGH0LXQuSkKICAgICAgICAgICAgc2VsZi51cGRh
dGVfY29ubmVjdGlvbl90cmVlKCkKCiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIkxvYWRl
ZCB7bGVuKGtleXNfd2l0aF90eXBlcyl9IGtleXMiLCAnc3VjY2VzcycpCgogICAgICAgICAgICBp
ZiBzZWxmLmN1cnJlbnRfa2V5OgogICAgICAgICAgICAgICAgc2VsZi5kaXNwbGF5X2tleV9kZXRh
aWxzKHNlbGYuY3VycmVudF9rZXkpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCI9PT0gcmVmcmVz
aF9rZXlzIGNvbXBsZXRlZCA9PT0iKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAg
ICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIkVycm9yIGxvYWRpbmcga2V5czoge2V9IiwgJ2Vy
cm9yJykKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgbG9hZGluZyBrZXlzOiB7ZX0i
KQoKICAgIGRlZiBvbl9rZXlfc2VsZWN0KHNlbGYsIGtleTogYnl0ZXMpOgogICAgICAgICIiItCe
0LHRgNCw0LHQvtGC0YfQuNC6INCy0YvQsdC+0YDQsCDQutC70Y7Rh9CwCgogICAgICAgIEFyZ3M6
CiAgICAgICAgICAgIHdpZGdldDogS2V5TGlzdFZpZXcgLSDQuNGB0YLQvtGH0L3QuNC6INGB0LjQ
s9C90LDQu9CwICjQtNC+0LHQsNCy0LvRj9C10YLRgdGPIHVyd2lkKQogICAgICAgICAgICBrZXk6
IGJ5dGVzIC0g0LLRi9Cx0YDQsNC90L3Ri9C5INC60LvRjtGHCiAgICAgICAgIiIiCiAgICAgICAg
bG9nZ2VyLmluZm8oZiJVSTogS2V5IHNlbGVjdGVkOiB7a2V5fSIpCgogICAgICAgIGlmIG5vdCBz
ZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBub3Qgc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uY29u
bmVjdGVkOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5jdXJyZW50X2tleSA9IGtl
eQogICAgICAgIHNlbGYuZGlzcGxheV9rZXlfZGV0YWlscyhzZWxmLmN1cnJlbnRfa2V5KQoKICAg
IGRlZiBnZXRfc2VsZWN0ZWRfa2V5KHNlbGYpIC0+IE9wdGlvbmFsW2J5dGVzXToKICAgICAgICAi
IiLQn9C+0LvRg9GH0LjRgtGMINCy0YvQsdGA0LDQvdC90YvQuSDQutC70Y7RhyIiIgogICAgICAg
IHJldHVybiBzZWxmLmtleV9saXN0X3ZpZXcuZ2V0X2ZvY3VzZWRfa2V5KCkKCiAgICBkZWYgX3Nj
YW5fY2x1c3Rlcl9rZXlzX3dpdGhfdHlwZXNfaXRlcihzZWxmLCBjbGllbnQpIC0+IExpc3RbVHVw
bGVbYnl0ZXMsIHN0cl1dOgogICAgICAgICIiItCh0LrQsNC90LjRgNC+0LLQsNC90LjQtSDQutC7
0Y7Rh9C10Lkg0LIgUmVkaXMgQ2x1c3RlciDRgSDQv9C+0LvRg9GH0LXQvdC40LXQvCDQuNGFINGC
0LjQv9C+0LIiIiIKICAgICAgICBrZXlzX3dpdGhfdHlwZXMgPSBbXQogICAgICAgIHNlbGYua2V5
X2NvdW50ID0gMAoKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1heF9rZXlzID0gNTAwMCAgIyDQ
ntCz0YDQsNC90LjRh9C10L3QuNC1INC00LvRjyDQv9GA0L7QuNC30LLQvtC00LjRgtC10LvRjNC9
0L7RgdGC0LgKICAgICAgICAgICAgc2Nhbl9jb3VudCA9IDAKCiAgICAgICAgICAgICMg0J/RgNC+
0LLQtdGA0Y/QtdC8LCDRj9Cy0LvRj9C10YLRgdGPINC70Lgg0Y3RgtC+INC60LvQsNGB0YLQtdGA
0L7QvAogICAgICAgICAgICBpZiBjbGllbnQuaXNfY2x1c3RlciBhbmQgY2xpZW50LmNsdXN0ZXJf
bm9kZXM6CiAgICAgICAgICAgICAgICAjINCh0LrQsNC90LjRgNGD0LXQvCDQmtCQ0JbQlNCr0Jkg
0LzQsNGB0YLQtdGAINGD0LfQtdC7INCyINC60LvQsNGB0YLQtdGA0LUKICAgICAgICAgICAgICAg
IGxvZ2dlci5pbmZvKGYiU2Nhbm5pbmcge2xlbihjbGllbnQuY2x1c3Rlcl9ub2Rlcyl9IGNsdXN0
ZXIgbm9kZXMuLi4iKQoKICAgICAgICAgICAgICAgIGZvciBub2RlX2lkLCBub2RlX2Nvbm4gaW4g
Y2xpZW50LmNsdXN0ZXJfbm9kZXMuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICBsb2dnZXIu
aW5mbyhmIlNjYW5uaW5nIG5vZGU6IHtub2RlX2lkfSIpCgogICAgICAgICAgICAgICAgICAgIHRy
eToKICAgICAgICAgICAgICAgICAgICAgICAgIyBTQ0FOINC90LAg0LrQvtC90LrRgNC10YLQvdC+
0Lwg0YPQt9C70LUKICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yID0gMAogICAgICAgICAg
ICAgICAgICAgICAgICBub2RlX2tleXNfY291bnQgPSAwCgogICAgICAgICAgICAgICAgICAgICAg
ICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQktGL0L/QvtC70L3R
j9C10LwgU0NBTiDQvdCw0L/RgNGP0LzRg9GOINC90LAg0YPQt9C70LUKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGN1cnNvciwga2V5cyA9IHNlbGYuX3NjYW5fbm9kZShub2RlX2Nvbm4sIGN1
cnNvciwgbWF0Y2g9JyonLCBjb3VudD0xMDApCgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
Zm9yIGtleSBpbiBrZXlzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNjYW5f
Y291bnQgPj0gbWF4X2tleXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJy
ZWFrCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIyDQn9C+0LvRg9GH0LDQtdC8INGC0LjQvyDQutC70Y7Rh9Cw
ICjRh9C10YDQtdC3INC/0YDQsNCy0LjQu9GM0L3Ri9C5INGD0LfQtdC7ISkKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAga2V5X3R5cGUgPSBjbGllbnQudHlwZShrZXkpCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoa2V5X3R5cGUsIGJ5
dGVzKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlID0g
a2V5X3R5cGUuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGtleXNfd2l0aF90eXBlcy5hcHBlbmQoKGtleSwga2V5X3R5cGUpKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJFcnJvciBnZXR0aW5nIHR5cGUgZm9y
IGtleSB7a2V5fToge2V9IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5
c193aXRoX3R5cGVzLmFwcGVuZCgoa2V5LCAndW5rbm93bicpKQoKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzY2FuX2NvdW50ICs9IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBub2RlX2tleXNfY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNlbGYua2V5X2NvdW50ICs9IDEKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyDQ
ntCx0L3QvtCy0LvRj9C10Lwg0YHRgtCw0YLRg9GBINC60LDQttC00YvQtSAxMDAg0LrQu9GO0YfQ
tdC5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2Nhbl9jb3VudCAlIDEwMCA9
PSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMo
ZiJTY2FubmluZy4uLiBGb3VuZCB7c2Nhbl9jb3VudH0ga2V5cyIpCgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgY3Vyc29yID09IDAgb3Igc2Nhbl9jb3VudCA+PSBtYXhfa2V5czoKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgICAgICAgICAg
ICAgbG9nZ2VyLmluZm8oZiJOb2RlIHtub2RlX2lkfTogZm91bmQge25vZGVfa2V5c19jb3VudH0g
a2V5cyIpCgogICAgICAgICAgICAgICAgICAgICAgICBpZiBzY2FuX2NvdW50ID49IG1heF9rZXlz
OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiU3RvcHBlZCBh
dCB7bWF4X2tleXN9IGtleXMgKGxpbWl0IHJlYWNoZWQpIikKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToK
ICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3Igc2Nhbm5pbmcgbm9k
ZSB7bm9kZV9pZH06IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAg
ICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyDinIUgU3RhbmRhbG9uZSDRgNC10LbQuNC8
IC0g0L7QsdGL0YfQvdGL0Lkgc2Nhbl9pdGVyCiAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKGNs
aWVudCwgJ3NjYW5faXRlcicpOgogICAgICAgICAgICAgICAgICAgIGZvciBrZXkgaW4gY2xpZW50
LnNjYW5faXRlcihtYXRjaD0nKicsIGNvdW50PTEwMCk6CiAgICAgICAgICAgICAgICAgICAgICAg
IGlmIHNjYW5fY291bnQgPj0gbWF4X2tleXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
ZWxmLnNldF9zdGF0dXMoZiJTdG9wcGVkIGF0IHttYXhfa2V5c30ga2V5cyAobGltaXQgcmVhY2hl
ZCkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICAgICAg
ICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlID0gY2xpZW50
LnR5cGUoa2V5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShrZXlf
dHlwZSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleV90eXBlID0g
a2V5X3R5cGUuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlz
X3dpdGhfdHlwZXMuYXBwZW5kKChrZXksIGtleV90eXBlKSkKICAgICAgICAgICAgICAgICAgICAg
ICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5c193aXRoX3R5cGVzLmFw
cGVuZCgoa2V5LCAndW5rbm93bicpKQoKICAgICAgICAgICAgICAgICAgICAgICAgc2Nhbl9jb3Vu
dCArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYua2V5X2NvdW50ICs9IDEKCiAgICAg
ICAgICAgICAgICAgICAgICAgIGlmIHNjYW5fY291bnQgJSAxMDAgPT0gMDoKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIlNjYW5uaW5nLi4uIEZvdW5kIHtzY2Fu
X2NvdW50fSBrZXlzIikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAg
IyBGYWxsYmFjayDQtNC70Y8g0YHRgtCw0YDRi9GFINCy0LXRgNGB0LjQuQogICAgICAgICAgICAg
ICAgICAgIGN1cnNvciA9IDAKICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAg
ICAgICAgICAgICAgICAgICBjdXJzb3IsIGtleXMgPSBjbGllbnQuc2NhbihjdXJzb3IsIG1hdGNo
PScqJywgY291bnQ9MTAwKQogICAgICAgICAgICAgICAgICAgICAgICBmb3Iga2V5IGluIGtleXM6
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBzY2FuX2NvdW50ID49IG1heF9rZXlzOgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5X3R5cGUgPSBj
bGllbnQudHlwZShrZXkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0
YW5jZShrZXlfdHlwZSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBrZXlfdHlwZSA9IGtleV90eXBlLmRlY29kZSgndXRmLTgnKQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGtleXNfd2l0aF90eXBlcy5hcHBlbmQoKGtleSwga2V5X3R5cGUpKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGtleXNfd2l0aF90eXBlcy5hcHBlbmQoKGtleSwgJ3Vua25vd24nKSkKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNjYW5fY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc2VsZi5rZXlfY291bnQgKz0gMQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY3Vy
c29yID09IDAgb3Igc2Nhbl9jb3VudCA+PSBtYXhfa2V5czoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAg
bG9nZ2VyLmVycm9yKGYiRXJyb3IgcHJvY2Vzc2luZyBrZXlzOiB7ZX0iLCBleGNfaW5mbz1UcnVl
KQoKICAgICAgICAjINCj0LHQuNGA0LDQtdC8INC00YPQsdC70LjQutCw0YLRiwogICAgICAgIHNl
ZW4gPSBzZXQoKQogICAgICAgIHVuaXF1ZV9rZXlzID0gW10KICAgICAgICBmb3Iga2V5LCBrZXlf
dHlwZSBpbiBrZXlzX3dpdGhfdHlwZXM6CiAgICAgICAgICAgIGlmIGtleSBub3QgaW4gc2VlbjoK
ICAgICAgICAgICAgICAgIHNlZW4uYWRkKGtleSkKICAgICAgICAgICAgICAgIHVuaXF1ZV9rZXlz
LmFwcGVuZCgoa2V5LCBrZXlfdHlwZSkpCgogICAgICAgIGxvZ2dlci5pbmZvKGYiU2Nhbm5lZCB7
bGVuKHVuaXF1ZV9rZXlzKX0gdW5pcXVlIGtleXMgd2l0aCB0eXBlcyIpCiAgICAgICAgcmV0dXJu
IHVuaXF1ZV9rZXlzCgogICAgZGVmIF9zY2FuX25vZGUoc2VsZiwgbm9kZV9jb25uLCBjdXJzb3I6
IGludCwgbWF0Y2g6IHN0ciwgY291bnQ6IGludCk6CiAgICAgICAgIiIi0JLRi9C/0L7Qu9C90LjR
gtGMIFNDQU4g0L3QsCDQutC+0L3QutGA0LXRgtC90L7QvCDRg9C30LvQtSDQutC70LDRgdGC0LXR
gNCwIiIiCiAgICAgICAgYXJncyA9IFsnU0NBTicsIGN1cnNvcl0KCiAgICAgICAgaWYgbWF0Y2g6
CiAgICAgICAgICAgIGFyZ3MuZXh0ZW5kKFsnTUFUQ0gnLCBtYXRjaF0pCiAgICAgICAgaWYgY291
bnQ6CiAgICAgICAgICAgIGFyZ3MuZXh0ZW5kKFsnQ09VTlQnLCBjb3VudF0pCgogICAgICAgIHJl
c3BvbnNlID0gbm9kZV9jb25uLmV4ZWN1dGVfY29tbWFuZCgqYXJncykKCiAgICAgICAgbmV3X2N1
cnNvciA9IGludChyZXNwb25zZVswXSkKICAgICAgICBrZXlzID0gcmVzcG9uc2VbMV0KCiAgICAg
ICAgcmV0dXJuIG5ld19jdXJzb3IsIGtleXMKCiAgICBkZWYgZGlzcGxheV9rZXlfZGV0YWlscyhz
ZWxmLCBrZXk6IGJ5dGVzKToKICAgICAgICAiIiLQntGC0L7QsdGA0LDQttC10L3QuNC1INC00LXR
gtCw0LvQtdC5INC60LvRjtGH0LAg0YEg0L/QvtC00LTQtdGA0LbQutC+0Lkg0LrQu9Cw0YHRgtC1
0YDQsCIiIgogICAgICAgIGlmIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBvciBub3Qgc2Vs
Zi5jdXJyZW50X2Nvbm5lY3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICByZXR1cm4KCiAgICAg
ICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5hY3Rp
dmVfY2xpZW50CiAgICAgICAgICAgIGtleV9zdHIgPSBrZXkuZGVjb2RlKCd1dGYtOCcsIGVycm9y
cz0ncmVwbGFjZScpCgogICAgICAgICAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0L7RgdC90L7QstC9
0YPRjiDQuNC90YTQvtGA0LzQsNGG0LjRjiDQviDQutC70Y7Rh9C1CiAgICAgICAgICAgIHRyeToK
ICAgICAgICAgICAgICAgIGtleV90eXBlID0gY2xpZW50LnR5cGUoa2V5KQogICAgICAgICAgICAg
ICAgaWYgaXNpbnN0YW5jZShrZXlfdHlwZSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgICAgIGtl
eV90eXBlID0ga2V5X3R5cGUuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgICAgICB0dGwgPSBj
bGllbnQudHRsKGtleSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
ICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiRXJyb3IgZ2V0dGluZyBrZXkgaW5mbzoge2V9Iiwg
J2Vycm9yJykKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgIyDQndCw0YfQuNC9
0LDQtdC8INGE0L7RgNC80LjRgNC+0LLQsNGC0Ywg0LLRi9Cy0L7QtAogICAgICAgICAgICBzZWxm
LmRldGFpbF93YWxrZXJbOl0gPSBbXQoKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFw
cGVuZCh1cndpZC5UZXh0KFsKICAgICAgICAgICAgICAgICgnaW5mb19sYWJlbCcsICdLZXk6ICcp
LAogICAgICAgICAgICAgICAgKCdpbmZvX3ZhbHVlJywga2V5X3N0cikKICAgICAgICAgICAgXSkp
CiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQoK
ICAgICAgICAgICAgIyDQntGB0L3QvtCy0L3QsNGPINC40L3RhNC+0YDQvNCw0YbQuNGPICjQtNC7
0Y8g0LrQu9Cw0YHRgtC10YDQsCDQuCBzdGFuZGFsb25lKQogICAgICAgICAgICBpbmZvX2l0ZW1z
ID0gWwogICAgICAgICAgICAgICAgKCdUeXBlJywga2V5X3R5cGUpLAogICAgICAgICAgICAgICAg
KCdUVEwnLCBmInt0dGx9cyIgaWYgdHRsID4gMCBlbHNlICdObyBleHBpcmF0aW9uJyBpZiB0dGwg
PT0gLTEgZWxzZSAnTi9BJyksCiAgICAgICAgICAgIF0KCiAgICAgICAgICAgICMg0JTQvtC/0L7Q
u9C90LjRgtC10LvRjNC90LDRjyDQuNC90YTQvtGA0LzQsNGG0LjRjyDQtNC70Y8g0LrQu9Cw0YHR
gtC10YDQsAogICAgICAgICAgICBpZiBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5pc19jbHVzdGVy
OgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNsb3QgPSBjbGllbnQu
a2V5c2xvdChrZXlfc3RyKQogICAgICAgICAgICAgICAgICAgIG5vZGUgPSBjbGllbnQuZ2V0X25v
ZGVfZnJvbV9rZXkoa2V5X3N0cikKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmV4dGVu
ZChbCiAgICAgICAgICAgICAgICAgICAgICAgICgnSGFzaCBTbG90Jywgc3RyKHNsb3QpKSwKICAg
ICAgICAgICAgICAgICAgICAgICAgKCdOb2RlJywgZiJ7bm9kZS5ob3N0fTp7bm9kZS5wb3J0fSIp
LAogICAgICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9u
IGFzIGU6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJDb3VsZCBub3QgZ2V0
IGNsdXN0ZXIgaW5mbyBmb3Iga2V5OiB7ZX0iKQoKICAgICAgICAgICAgIyDQlNC+0LHQsNCy0LvR
j9C10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L4g0YDQsNC30LzQtdGA0LUg0LIg0LfQsNCy0LjR
gdC40LzQvtGB0YLQuCDQvtGCINGC0LjQv9CwCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAg
ICAgIGlmIGtleV90eXBlID09ICdzdHJpbmcnOgogICAgICAgICAgICAgICAgICAgIHNpemUgPSBj
bGllbnQuc3RybGVuKGtleSkKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmFwcGVuZCgo
J1NpemUnLCBmIntzaXplfSBieXRlcyIpKQogICAgICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9
PSAnbGlzdCc6CiAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IGNsaWVudC5sbGVuKGtleSkKICAg
ICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmFwcGVuZCgoJ0xlbmd0aCcsIHN0cihzaXplKSkp
CiAgICAgICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdzZXQnOgogICAgICAgICAgICAgICAg
ICAgIHNpemUgPSBjbGllbnQuc2NhcmQoa2V5KQogICAgICAgICAgICAgICAgICAgIGluZm9faXRl
bXMuYXBwZW5kKCgnTWVtYmVycycsIHN0cihzaXplKSkpCiAgICAgICAgICAgICAgICBlbGlmIGtl
eV90eXBlID09ICd6c2V0JzoKICAgICAgICAgICAgICAgICAgICBzaXplID0gY2xpZW50LnpjYXJk
KGtleSkKICAgICAgICAgICAgICAgICAgICBpbmZvX2l0ZW1zLmFwcGVuZCgoJ01lbWJlcnMnLCBz
dHIoc2l6ZSkpKQogICAgICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnaGFzaCc6CiAgICAg
ICAgICAgICAgICAgICAgc2l6ZSA9IGNsaWVudC5obGVuKGtleSkKICAgICAgICAgICAgICAgICAg
ICBpbmZvX2l0ZW1zLmFwcGVuZCgoJ0ZpZWxkcycsIHN0cihzaXplKSkpCiAgICAgICAgICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiQ291
bGQgbm90IGdldCBzaXplIGluZm8gZm9yIGtleToge2V9IikKCiAgICAgICAgICAgICMg0J7RgtC+
0LHRgNCw0LbQsNC10Lwg0LLRgdGOINC40L3RhNC+0YDQvNCw0YbQuNGOCiAgICAgICAgICAgIGZv
ciBsYWJlbCwgdmFsdWUgaW4gaW5mb19pdGVtczoKICAgICAgICAgICAgICAgIHJvdyA9IHVyd2lk
LkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMSwgdXJ3aWQuQXR0ck1h
cCh1cndpZC5UZXh0KGxhYmVsKSwgJ2luZm9fbGFiZWwnKSksCiAgICAgICAgICAgICAgICAgICAg
KCd3ZWlnaHQnLCAyLCB1cndpZC5BdHRyTWFwKHVyd2lkLlRleHQoc3RyKHZhbHVlKSksICdpbmZv
X3ZhbHVlJykpLAogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWls
X3dhbGtlci5hcHBlbmQocm93KQoKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVu
ZCh1cndpZC5EaXZpZGVyKCkpCiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQo
dXJ3aWQuVGV4dCgoJ2luZm9fbGFiZWwnLCAnVmFsdWU6JykpKQogICAgICAgICAgICBzZWxmLmRl
dGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKCiAgICAgICAgICAgICMg0J7RgtC+
0LHRgNCw0LbQtdC90LjQtSDQt9C90LDRh9C10L3QuNGPINCyINC30LDQstC40YHQuNC80L7RgdGC
0Lgg0L7RgiDRgtC40L/QsCDQutC70Y7Rh9CwCiAgICAgICAgICAgICMg0K3RgtC+0YIg0LrQvtC0
INC+0LHRidC40Lkg0LTQu9GPIGNsdXN0ZXIg0Lggc3RhbmRhbG9uZQogICAgICAgICAgICB0cnk6
CiAgICAgICAgICAgICAgICBpZiBrZXlfdHlwZSA9PSAnc3RyaW5nJzoKICAgICAgICAgICAgICAg
ICAgICB2YWx1ZSA9IGNsaWVudC5nZXQoa2V5KQogICAgICAgICAgICAgICAgICAgIGlmIHZhbHVl
IGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBl
bmQodXJ3aWQuVGV4dCgoJ2Vycm9yJywgJ0tleSBub3QgZm91bmQnKSkpCiAgICAgICAgICAgICAg
ICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdmFsdWVfc3RyID0gdmFsdWUuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVw
bGFjZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBw
ZW5kKHVyd2lkLlRleHQodmFsdWVfc3RyKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0
OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVuZCgK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cndpZC5UZXh0KGYnPGJpbmFyeSBkYXRh
OiB7bGVuKHZhbHVlKX0gYnl0ZXM+JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKCiAg
ICAgICAgICAgICAgICBlbGlmIGtleV90eXBlID09ICdoYXNoJzoKICAgICAgICAgICAgICAgICAg
ICBoYXNoX2RhdGEgPSBjbGllbnQuaGdldGFsbChrZXkpCiAgICAgICAgICAgICAgICAgICAgaWYg
bm90IGhhc2hfZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2Vy
LmFwcGVuZCh1cndpZC5UZXh0KCcoZW1wdHkgaGFzaCknKSkKICAgICAgICAgICAgICAgICAgICBl
bHNlOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmllbGQsIHZhbCBpbiBoYXNoX2RhdGEu
aXRlbXMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBmaWVsZF9zdHIgPSBmaWVsZC5kZWNvZGUoJ3V0Zi04JywgZXJyb3Jz
PSdyZXBsYWNlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxfc3RyID0gdmFs
LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHJvdyA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLlRleHQoKCdrZXlfZm9sZGVyJywgZmllbGRf
c3RyKSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDIs
IHVyd2lkLlRleHQodmFsX3N0cikpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0p
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVu
ZChyb3cpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIyDQlNC70Y8g0LHQuNC90LDRgNC90YvRhSDQtNCw0L3QvdGL0YUK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cgPSB1cndpZC5Db2x1bW5zKFsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd3ZWlnaHQnLCAxLCB1cndpZC5UZXh0
KCgna2V5X2ZvbGRlcicsICc8YmluYXJ5IGZpZWxkPicpKSksCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICgnd2VpZ2h0JywgMiwgdXJ3aWQuVGV4dChmJzxiaW5hcnk6IHtsZW4o
dmFsKX0gYnl0ZXM+JykpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVuZChyb3cp
CgogICAgICAgICAgICAgICAgZWxpZiBrZXlfdHlwZSA9PSAnbGlzdCc6CiAgICAgICAgICAgICAg
ICAgICAgIyDQn9C+0LvRg9GH0LDQtdC8INGC0L7Qu9GM0LrQviDQv9C10YDQstGL0LUgMTAwINGN
0LvQtdC80LXQvdGC0L7QsgogICAgICAgICAgICAgICAgICAgIGxpc3RfZGF0YSA9IGNsaWVudC5s
cmFuZ2Uoa2V5LCAwLCA5OSkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbGlzdF9kYXRhOgog
ICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRl
eHQoJyhlbXB0eSBsaXN0KScpKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAg
ICAgICAgICAgICAgIGZvciBpZHgsIGl0ZW0gaW4gZW51bWVyYXRlKGxpc3RfZGF0YSk6CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaXRlbV9zdHIgPSBpdGVtLmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3
aWQuVGV4dChmIlt7aWR4fV0ge2l0ZW1fc3RyfSIpKQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dh
bGtlci5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVyd2lkLlRl
eHQoZiJbe2lkeH1dIDxiaW5hcnk6IHtsZW4oaXRlbSl9IGJ5dGVzPiIpCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3Nl
dCc6CiAgICAgICAgICAgICAgICAgICAgIyDQn9C+0LvRg9GH0LDQtdC8INGC0L7Qu9GM0LrQviDQ
v9C10YDQstGL0LUgMTAwINGN0LvQtdC80LXQvdGC0L7QsgogICAgICAgICAgICAgICAgICAgIHNl
dF9kYXRhID0gbGlzdChjbGllbnQuc21lbWJlcnMoa2V5KSlbOjEwMF0KICAgICAgICAgICAgICAg
ICAgICBpZiBub3Qgc2V0X2RhdGE6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWls
X3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dCgnKGVtcHR5IHNldCknKSkKICAgICAgICAgICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaXRlbSBpbiBzZXRfZGF0YToK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpdGVtX3N0ciA9IGl0ZW0uZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScp
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2VyLmFwcGVu
ZCh1cndpZC5UZXh0KGYi4oCiIHtpdGVtX3N0cn0iKSkKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRldGFpbF93
YWxrZXIuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cndpZC5U
ZXh0KGYi4oCiIDxiaW5hcnk6IHtsZW4oaXRlbSl9IGJ5dGVzPiIpCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGVsaWYga2V5X3R5cGUgPT0gJ3pzZXQn
OgogICAgICAgICAgICAgICAgICAgICMg0J/QvtC70YPRh9Cw0LXQvCDRgtC+0LvRjNC60L4g0L/Q
tdGA0LLRi9C1IDEwMCDRjdC70LXQvNC10L3RgtC+0LIKICAgICAgICAgICAgICAgICAgICB6c2V0
X2RhdGEgPSBjbGllbnQuenJhbmdlKGtleSwgMCwgOTksIHdpdGhzY29yZXM9VHJ1ZSkKICAgICAg
ICAgICAgICAgICAgICBpZiBub3QgenNldF9kYXRhOgogICAgICAgICAgICAgICAgICAgICAgICBz
ZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoJyhlbXB0eSB6c2V0KScpKQogICAg
ICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtZW1iZXIs
IHNjb3JlIGluIHpzZXRfZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJfc3RyID0gbWVtYmVyLmRlY29kZSgn
dXRmLTgnLCBlcnJvcnM9J3JlcGxhY2UnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJvdyA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAoJ3dlaWdodCcsIDIsIHVyd2lkLlRleHQobWVtYmVyX3N0cikpLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAoJ3dlaWdodCcsIDEsIHVyd2lkLlRleHQoKCdpbmZvX3ZhbHVl
Jywgc3RyKHNjb3JlKSkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQocm93
KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJvdyA9IHVyd2lkLkNvbHVtbnMoWwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAoJ3dlaWdodCcsIDIsIHVyd2lkLlRleHQoZic8YmluYXJ5OiB7bGVuKG1l
bWJlcil9IGJ5dGVzPicpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd3
ZWlnaHQnLCAxLCB1cndpZC5UZXh0KCgnaW5mb192YWx1ZScsIHN0cihzY29yZSkpKSksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHJvdykKCiAgICAgICAgICAgICAgICBlbHNl
OgogICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4
dChmJ1Vua25vd24ga2V5IHR5cGU6IHtrZXlfdHlwZX0nKSkKCiAgICAgICAgICAgIGV4Y2VwdCBF
eGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQo
CiAgICAgICAgICAgICAgICAgICAgdXJ3aWQuVGV4dCgoJ2Vycm9yJywgZidFcnJvciByZXRyaWV2
aW5nIHZhbHVlOiB7c3RyKGUpfScpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAg
bG9nZ2VyLmVycm9yKGYiRXJyb3IgcmV0cmlldmluZyB2YWx1ZSBmb3Iga2V5IHtrZXlfc3RyfTog
e2V9IikKCiAgICAgICAgICAgICMg0JrQvdC+0L/QutC4INC00LXQudGB0YLQstC40LkgKNGD0LTQ
sNC70LXQvdC40LUg0Lgg0YIu0LQuKQogICAgICAgICAgICBpZiBub3Qgc2VsZi5jdXJyZW50X2Nv
bm5lY3Rpb24ucHJvZmlsZS5yZWFkb25seToKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dh
bGtlci5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQogICAgICAgICAgICAgICAgZGVsZXRlX2J0biA9
IHVyd2lkLkJ1dHRvbignRGVsZXRlIEtleScsIG9uX3ByZXNzPWxhbWJkYSBiOiBzZWxmLmRlbGV0
ZV9rZXkoa2V5KSkKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQoCiAg
ICAgICAgICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChkZWxldGVfYnRuLCAnYnV0dG9uX2Rhbmdl
cicsICdidXR0b25fZm9jdXMnKQogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgIyDQldGB
0LvQuCDRjdGC0L4g0LrQu9Cw0YHRgtC10YAsINC00L7QsdCw0LLQu9GP0LXQvCDQuNC90YTQvtGA
0LzQsNGG0LjRjiDQviDQvNC40LPRgNCw0YbQuNC4CiAgICAgICAgICAgIGlmIHNlbGYuY3VycmVu
dF9jb25uZWN0aW9uLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAg
ICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10LwsINC90LUg0LzQuNCz0YDQuNGA0YPQtdGC0YHR
jyDQu9C4INC60LvRjtGHCiAgICAgICAgICAgICAgICAgICAgY2x1c3Rlcl9pbmZvID0gY2xpZW50
LmNsdXN0ZXIoJ0tFWVNMT1QnLCBrZXlfc3RyKQogICAgICAgICAgICAgICAgICAgIGlmIGlzaW5z
dGFuY2UoY2x1c3Rlcl9pbmZvLCBieXRlcyk6CiAgICAgICAgICAgICAgICAgICAgICAgIGNsdXN0
ZXJfaW5mbyA9IGNsdXN0ZXJfaW5mby5kZWNvZGUoJ3V0Zi04JykKICAgICAgICAgICAgICAgICAg
ICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLkRpdmlkZXIoKSkKICAgICAgICAgICAg
ICAgICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAg
ICB1cndpZC5UZXh0KCgnaW5mb19sYWJlbCcsIGYnQ2x1c3RlciBTbG90OiB7Y2x1c3Rlcl9pbmZv
fScpKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAg
ICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAg
ICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiRXJyb3IgZGlzcGxheWluZyBrZXk6IHtlfSIsICdlcnJv
cicpCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIGRpc3BsYXlpbmcga2V5IHtrZXl9
OiB7ZX0iKQogICAgICAgICAgICAjINCf0L7QutCw0LfRi9Cy0LDQtdC8INC+0YjQuNCx0LrRgyDQ
siDQtNC10YLQsNC70Y/RhQogICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXJbOl0gPSBbCiAg
ICAgICAgICAgICAgICB1cndpZC5UZXh0KCgnZXJyb3InLCBmJ0Vycm9yOiB7c3RyKGUpfScpKQog
ICAgICAgICAgICBdCgogICAgZGVmIGRlYnVnX2NsdXN0ZXJfaW5mbyhzZWxmKToKICAgICAgICAi
IiLQntGC0LvQsNC00L7Rh9C90LDRjyDQuNC90YTQvtGA0LzQsNGG0LjRjyDQviDQutC70LDRgdGC
0LXRgNC1IiIiCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25uZWN0aW9uIG9yIG5vdCBz
ZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5pc19jbHVzdGVyOgogICAgICAgICAgICByZXR1cm4KCiAg
ICAgICAgdHJ5OgogICAgICAgICAgICBjbGllbnQgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5h
Y3RpdmVfY2xpZW50CgogICAgICAgICAgICAjINCS0YvQstC+0LTQuNC8INCy0YHRjiDQtNC+0YHR
gtGD0L/QvdGD0Y4g0LjQvdGE0L7RgNC80LDRhtC40Y4KICAgICAgICAgICAgaW5mbyA9IHt9Cgog
ICAgICAgICAgICAjIDEuINCf0YDQvtCy0LXRgNGP0LXQvCDQvNC10YLQvtC00Ysg0LrQu9C40LXQ
vdGC0LAKICAgICAgICAgICAgaW5mb1snY2xpZW50X21ldGhvZHMnXSA9IFttIGZvciBtIGluIGRp
cihjbGllbnQpIGlmIG5vdCBtLnN0YXJ0c3dpdGgoJ18nKV0KCiAgICAgICAgICAgICMgMi4g0J/R
gNC+0LHRg9C10Lwg0L/QvtC70YPRh9C40YLRjCDQuNC90YTQvtGA0LzQsNGG0LjRjiDQviDQvdC+
0LTQsNGFCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIoY2xpZW50
LCAnZ2V0X25vZGVzJyk6CiAgICAgICAgICAgICAgICAgICAgbm9kZXMgPSBjbGllbnQuZ2V0X25v
ZGVzKCkKICAgICAgICAgICAgICAgICAgICBpbmZvWydub2Rlc19jb3VudCddID0gbGVuKG5vZGVz
KQogICAgICAgICAgICAgICAgICAgIGluZm9bJ25vZGVzX2luZm8nXSA9IFtdCiAgICAgICAgICAg
ICAgICAgICAgZm9yIGksIG5vZGUgaW4gZW51bWVyYXRlKG5vZGVzWzozXSk6ICAjINCf0LXRgNCy
0YvQtSAzINC90L7QtNGLCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfaW5mbyA9IHsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICdpbmRleCc6IGksCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAndHlwZSc6IHN0cih0eXBlKG5vZGUpKSwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICdhdHRycyc6IFthIGZvciBhIGluIGRpcihub2RlKSBpZiBub3QgYS5zdGFydHN3aXRoKCdf
JyldCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgIyDQ
n9GA0L7QsdGD0LXQvCDQv9C+0LvRg9GH0LjRgtGMINCw0LTRgNC10YEKICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgaGFzYXR0cihub2RlLCAnaG9zdCcpIGFuZCBoYXNhdHRyKG5vZGUsICdwb3J0
Jyk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2luZm9bJ2FkZHJlc3MnXSA9IGYi
e25vZGUuaG9zdH06e25vZGUucG9ydH0iCiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9bJ25v
ZGVzX2luZm8nXS5hcHBlbmQobm9kZV9pbmZvKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9u
IGFzIGU6CiAgICAgICAgICAgICAgICBpbmZvWydub2Rlc19lcnJvciddID0gc3RyKGUpCgogICAg
ICAgICAgICAjIDMuINCf0YDQvtCx0YPQtdC8IENMVVNURVIgSU5GTwogICAgICAgICAgICB0cnk6
CiAgICAgICAgICAgICAgICBjbHVzdGVyX2luZm8gPSBjbGllbnQuY2x1c3Rlcl9pbmZvKCkKICAg
ICAgICAgICAgICAgIGluZm9bJ2NsdXN0ZXJfaW5mbyddID0gY2x1c3Rlcl9pbmZvCiAgICAgICAg
ICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGluZm9bJ2NsdXN0ZXJf
aW5mb19lcnJvciddID0gc3RyKGUpCgogICAgICAgICAgICAjIDQuINCf0YDQvtCx0YPQtdC8IFJP
TEUKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcm9sZSA9IGNsaWVudC5leGVjdXRl
X2NvbW1hbmQoJ1JPTEUnKQogICAgICAgICAgICAgICAgaW5mb1sncm9sZSddID0gcm9sZQogICAg
ICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBpbmZvWydyb2xl
X2Vycm9yJ10gPSBzdHIoZSkKCiAgICAgICAgICAgICMg0JfQsNC/0LjRgdGL0LLQsNC10Lwg0LIg
0LvQvtCzCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQ2x1c3RlciBkZWJ1ZyBpbmZvOiB7anNv
bi5kdW1wcyhpbmZvLCBkZWZhdWx0PXN0ciwgaW5kZW50PTIpfSIpCgogICAgICAgICAgICAjINCf
0L7QutCw0LfRi9Cy0LDQtdC8INCyIFVJCiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlcls6
XSA9IFtdCiAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuVGV4dCgo
J2hlYWRlcl90ZXh0JywgJ0NsdXN0ZXIgRGVidWcgSW5mbzonKSkpCiAgICAgICAgICAgIHNlbGYu
ZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQuRGl2aWRlcigpKQoKICAgICAgICAgICAgZm9yIGtl
eSwgdmFsdWUgaW4gaW5mby5pdGVtcygpOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2
YWx1ZSwgKGxpc3QsIGRpY3QpKToKICAgICAgICAgICAgICAgICAgICB2YWx1ZV9zdHIgPSBqc29u
LmR1bXBzKHZhbHVlLCBkZWZhdWx0PXN0ciwgaW5kZW50PTIpCiAgICAgICAgICAgICAgICBlbHNl
OgogICAgICAgICAgICAgICAgICAgIHZhbHVlX3N0ciA9IHN0cih2YWx1ZSkKCiAgICAgICAgICAg
ICAgICBzZWxmLmRldGFpbF93YWxrZXIuYXBwZW5kKHVyd2lkLlRleHQoZiJ7a2V5fToge3ZhbHVl
X3N0cn0iKSkKICAgICAgICAgICAgICAgIHNlbGYuZGV0YWlsX3dhbGtlci5hcHBlbmQodXJ3aWQu
RGl2aWRlcigpKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxv
Z2dlci5lcnJvcihmIkRlYnVnIGZhaWxlZDoge2V9IikKCiAgICBkZWYgZGVsZXRlX2tleShzZWxm
LCBrZXk6IGJ5dGVzKToKICAgICAgICAiIiLQo9C00LDQu9C10L3QuNC1INC60LvRjtGH0LAg0YEg
0L/QvtC00LTQtdGA0LbQutC+0Lkg0LrQu9Cw0YHRgtC10YDQsCIiIgogICAgICAgIGlmIG5vdCBz
ZWxmLmN1cnJlbnRfY29ubmVjdGlvbjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToK
ICAgICAgICAgICAgY2xpZW50ID0gc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uYWN0aXZlX2NsaWVu
dAogICAgICAgICAgICBkZWxldGVkID0gY2xpZW50LmRlbGV0ZShrZXkpCgogICAgICAgICAgICBp
ZiBkZWxldGVkOgogICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYiS2V5IGRlbGV0ZWQi
LCAnc3VjY2VzcycpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnNldF9z
dGF0dXMoZiJLZXkgbm90IGZvdW5kIiwgJ3dhcm5pbmcnKQoKICAgICAgICAgICAgc2VsZi5yZWZy
ZXNoX2tleXMoKQogICAgICAgICAgICBzZWxmLmRldGFpbF93YWxrZXJbOl0gPSBbXQoKICAgICAg
ICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIkRl
bGV0ZSBmYWlsZWQ6IHtlfSIsICdlcnJvcicpCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkRl
bGV0ZSBmYWlsZWQgZm9yIGtleSB7a2V5fToge2V9IikKCiAgICBkZWYgdXBkYXRlX3RhYnMoc2Vs
Zik6CiAgICAgICAgIiIi0J7QsdC90L7QstC70LXQvdC40LUg0YLQsNCx0L7QsiIiIgogICAgICAg
IHRhYnMgPSBbXQoKICAgICAgICBpZiBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbiBhbmQgc2VsZi5j
dXJyZW50X2Nvbm5lY3Rpb24uY29ubmVjdGVkOgogICAgICAgICAgICBuYW1lID0gc2VsZi5jdXJy
ZW50X2Nvbm5lY3Rpb24ucHJvZmlsZS5uYW1lCgogICAgICAgICAgICBpZiBzZWxmLmN1cnJlbnRf
Y29ubmVjdGlvbi5pc19jbHVzdGVyOgogICAgICAgICAgICAgICAgIyDQlNC70Y8g0LrQu9Cw0YHR
gtC10YDQsCDQv9C+0LrQsNC30YvQstCw0LXQvCDRgdC/0LXRhtC40LDQu9GM0L3Rg9GOINC40LrQ
vtC90LrRgwogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICMg0J/QvtC7
0YPRh9Cw0LXQvCDQuNC90YTQvtGA0LzQsNGG0LjRjiDQviDQutC70LDRgdGC0LXRgNC1CiAgICAg
ICAgICAgICAgICAgICAgY2x1c3Rlcl9pbmZvX3N0ciA9IGNvbm4uYWN0aXZlX2NsaWVudC5leGVj
dXRlX2NvbW1hbmQoJ0NMVVNURVInLCAnSU5GTycpCiAgICAgICAgICAgICAgICAgICAgY2x1c3Rl
cl9pbmZvID0gc2VsZi5wYXJzZV9jbHVzdGVyX2luZm8oY2x1c3Rlcl9pbmZvX3N0cikKICAgICAg
ICAgICAgICAgICAgICBzdGF0ZSA9IGNsdXN0ZXJfaW5mby5nZXQoJ2NsdXN0ZXJfc3RhdGUnLCAn
dW5rbm93bicpCiAKICAgICAgICAgICAgICAgICAgICBpZiBzdGF0ZSA9PSAnb2snOgogICAgICAg
ICAgICAgICAgICAgICAgICBpY29uID0gJ/Cfn6InCiAgICAgICAgICAgICAgICAgICAgICAgIHN0
eWxlID0gJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAg
ICAgICAgICAgaWNvbiA9ICfwn5S0JwogICAgICAgICAgICAgICAgICAgICAgICBzdHlsZSA9ICdl
cnJvcicKCiAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSBmIiB7aWNvbn0ge25hbWV9IFtDbHVz
dGVyXSAiCiAgICAgICAgICAgICAgICAgICAgdGFicy5hcHBlbmQoKHN0eWxlLCBsYWJlbCkpCgog
ICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAg
IGxhYmVsID0gZiIg4pqgIHtuYW1lfSBbQ2x1c3Rlcl0gIgogICAgICAgICAgICAgICAgICAgIHRh
YnMuYXBwZW5kKCgnd2FybmluZycsIGxhYmVsKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAg
ICAgICAgIGRiID0gc2VsZi5jdXJyZW50X2Nvbm5lY3Rpb24uY3VycmVudF9kYgogICAgICAgICAg
ICAgICAgbGFiZWwgPSBmIiDil48ge25hbWV9IFtEQntkYn1dICIKICAgICAgICAgICAgICAgIHRh
YnMuYXBwZW5kKCgndGFiX2FjdGl2ZScsIGxhYmVsKSkKCiAgICAgICAgc2VsZi50YWJfdGV4dC5z
ZXRfdGV4dCh0YWJzIGlmIHRhYnMgZWxzZSAnJykKCiAgICBkZWYgX2ZpbmRfbGlzdGJveF9pbl91
aShzZWxmKToKICAgICAgICAiIiLQndCw0LnRgtC4IExpc3RCb3gg0LIg0YHRgtGA0YPQutGC0YPR
gNC1IFVJIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjINCf0YDQvtCy0LXRgNGP0LXQvCBt
YWluX2ZyYW1lCiAgICAgICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgJ21haW5fZnJhbWUnKToKICAg
ICAgICAgICAgICAgIGJvZHkgPSBzZWxmLm1haW5fZnJhbWUuZ2V0X2JvZHkoKQogICAgICAgICAg
ICAgICAgbGlzdGJveCA9IHNlbGYuX2ZpbmRfbGlzdGJveF9yZWN1cnNpdmUoYm9keSkKICAgICAg
ICAgICAgICAgIGlmIGxpc3Rib3g6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpc3Rib3gK
CiAgICAgICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8IGNvbHVtbnMgKNC00LLRg9GF0L/QsNC9
0LXQu9GM0L3Ri9C5INC40L3RgtC10YDRhNC10LnRgSkKICAgICAgICAgICAgaWYgaGFzYXR0cihz
ZWxmLCAnY29sdW1ucycpOgogICAgICAgICAgICAgICAgZm9yIHdpZGdldCwgb3B0aW9ucyBpbiBz
ZWxmLmNvbHVtbnMuY29udGVudHM6CiAgICAgICAgICAgICAgICAgICAgbGlzdGJveCA9IHNlbGYu
X2ZpbmRfbGlzdGJveF9yZWN1cnNpdmUod2lkZ2V0KQogICAgICAgICAgICAgICAgICAgIGlmIGxp
c3Rib3g6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsaXN0Ym94CgogICAgICAgICAg
ICAjINCf0YDQvtCy0LXRgNGP0LXQvCBjb250ZW50X2ZyYW1lICjQtdGB0LvQuCDQtdGB0YLRjCkK
ICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAnY29udGVudF9mcmFtZScpOgogICAgICAgICAg
ICAgICAgYm9keSA9IHNlbGYuY29udGVudF9mcmFtZS5nZXRfYm9keSgpCiAgICAgICAgICAgICAg
ICBsaXN0Ym94ID0gc2VsZi5fZmluZF9saXN0Ym94X3JlY3Vyc2l2ZShib2R5KQogICAgICAgICAg
ICAgICAgaWYgbGlzdGJveDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdGJveAoKICAg
ICAgICAgICAgIyDQn9GA0L7QstC10YDRj9C10Lwga2V5X3ZpZXcgKNC10YHQu9C4INC10YHRgtGM
KQogICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICdrZXlfdmlldycpOgogICAgICAgICAgICAg
ICAgbGlzdGJveCA9IHNlbGYuX2ZpbmRfbGlzdGJveF9yZWN1cnNpdmUoc2VsZi5rZXlfdmlldykK
ICAgICAgICAgICAgICAgIGlmIGxpc3Rib3g6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxp
c3Rib3gKCiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZmluZGluZyBsaXN0Ym94OiB7
ZX0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfZmluZF9saXN0Ym94X3JlY3Vy
c2l2ZShzZWxmLCB3aWRnZXQsIGRlcHRoPTApOgogICAgICAgICIiItCg0LXQutGD0YDRgdC40LLQ
vdGL0Lkg0L/QvtC40YHQuiBMaXN0Qm94IiIiCiAgICAgICAgaWYgZGVwdGggPiAxMDoKICAgICAg
ICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgaWYgd2lkZ2V0IGlzIE5vbmU6CiAgICAgICAgICAg
IHJldHVybiBOb25lCgogICAgICAgICMg0J3QsNGI0LvQuCBMaXN0Qm94CiAgICAgICAgaWYgaXNp
bnN0YW5jZSh3aWRnZXQsIHVyd2lkLkxpc3RCb3gpOgogICAgICAgICAgICByZXR1cm4gd2lkZ2V0
CgogICAgICAgICMg0KDQsNC30LLQvtGA0LDRh9C40LLQsNC10Lwg0L7QsdC10YDRgtC60LgKICAg
ICAgICBpZiBoYXNhdHRyKHdpZGdldCwgJ29yaWdpbmFsX3dpZGdldCcpOgogICAgICAgICAgICBy
ZXR1cm4gc2VsZi5fZmluZF9saXN0Ym94X3JlY3Vyc2l2ZSh3aWRnZXQub3JpZ2luYWxfd2lkZ2V0
LCBkZXB0aCArIDEpCgogICAgICAgIGlmIGhhc2F0dHIod2lkZ2V0LCAnYmFzZV93aWRnZXQnKToK
ICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2ZpbmRfbGlzdGJveF9yZWN1cnNpdmUod2lkZ2V0LmJh
c2Vfd2lkZ2V0LCBkZXB0aCArIDEpCgogICAgICAgICMgRnJhbWUgLSDQv9GA0L7QstC10YDRj9C1
0LwgYm9keQogICAgICAgIGlmIGlzaW5zdGFuY2Uod2lkZ2V0LCB1cndpZC5GcmFtZSk6CiAgICAg
ICAgICAgIGJvZHkgPSB3aWRnZXQuZ2V0X2JvZHkoKQogICAgICAgICAgICBpZiBib2R5OgogICAg
ICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5fZmluZF9saXN0Ym94X3JlY3Vyc2l2ZShib2R5LCBk
ZXB0aCArIDEpCiAgICAgICAgICAgICAgICBpZiByZXN1bHQ6CiAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIHJlc3VsdAoKICAgICAgICAjIENvbHVtbnMvUGlsZSAtINC/0YDQvtCy0LXRgNGP0LXQ
vCBjb250ZW50cwogICAgICAgIGlmIGhhc2F0dHIod2lkZ2V0LCAnY29udGVudHMnKToKICAgICAg
ICAgICAgZm9yIGl0ZW0gaW4gd2lkZ2V0LmNvbnRlbnRzOgogICAgICAgICAgICAgICAgaWYgaXNp
bnN0YW5jZShpdGVtLCB0dXBsZSkgYW5kIGxlbihpdGVtKSA+IDA6CiAgICAgICAgICAgICAgICAg
ICAgcmVzdWx0ID0gc2VsZi5fZmluZF9saXN0Ym94X3JlY3Vyc2l2ZShpdGVtWzBdLCBkZXB0aCAr
IDEpCiAgICAgICAgICAgICAgICAgICAgaWYgcmVzdWx0OgogICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gcmVzdWx0CgogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIHNob3dfZWRpdF9r
ZXlfZGlhbG9nKHNlbGYsIGtleSk6CiAgICAgICAgIiIi0J/QvtC60LDQt9Cw0YLRjCDQtNC40LDQ
u9C+0LMg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjyDQutC70Y7Rh9CwIiIiCgogICAgICAg
IGRlZiBvbl9zdWNjZXNzKCk6CiAgICAgICAgICAgIHNlbGYucmVmcmVzaF9rZXlzKCkKCiAgICAg
ICAgZGlhbG9nID0gQWRkS2V5RGlhbG9nKAogICAgICAgICAgICBzZWxmLmN1cnJlbnRfY29ubmVj
dGlvbiwKICAgICAgICAgICAgb25fc3VjY2VzcywKICAgICAgICAgICAgZWRpdF9rZXk9a2V5ICAj
INCf0LXRgNC10LTQsNC10Lwg0LrQu9GO0Ycg0LTQu9GPINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQ
vdC40Y8KICAgICAgICApCgogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKGRpYWxvZywgJ2Ns
b3NlJywgbGFtYmRhIHc6IHNlbGYuY2xvc2VfZGlhbG9nKE5vbmUpKQoKICAgICAgICBvdmVybGF5
ID0gdXJ3aWQuT3ZlcmxheSgKICAgICAgICAgICAgZGlhbG9nLAogICAgICAgICAgICBzZWxmLm1h
aW5fZnJhbWUsCiAgICAgICAgICAgIGFsaWduPSdjZW50ZXInLAogICAgICAgICAgICB3aWR0aD0o
J3JlbGF0aXZlJywgODApLAogICAgICAgICAgICB2YWxpZ249J21pZGRsZScsCiAgICAgICAgICAg
IGhlaWdodD0oJ3JlbGF0aXZlJywgODApCiAgICAgICAgKQoKICAgICAgICBzZWxmLmRpYWxvZyA9
IG92ZXJsYXkKICAgICAgICBzZWxmLmxvb3Aud2lkZ2V0ID0gb3ZlcmxheQoKICAgIGRlZiBzaG93
X2FkZF9rZXlfZGlhbG9nKHNlbGYpOgogICAgICAgICIiItCU0LjQsNC70L7QsyDQtNC+0LHQsNCy
0LvQtdC90LjRjyDQutC70Y7Rh9CwIiIiCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jb25u
ZWN0aW9uIG9yIG5vdCBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5jb25uZWN0ZWQ6CiAgICAgICAg
ICAgIHNlbGYuc2V0X3N0YXR1cygiTm90IGNvbm5lY3RlZCIsICdlcnJvcicpCiAgICAgICAgICAg
IHJldHVybgoKICAgICAgICBkaWFsb2cgPSBBZGRLZXlEaWFsb2coc2VsZi5jdXJyZW50X2Nvbm5l
Y3Rpb24sIHNlbGYub25fa2V5X2FkZGVkKQogICAgICAgIHVyd2lkLmNvbm5lY3Rfc2lnbmFsKGRp
YWxvZywgJ2Nsb3NlJywgc2VsZi5jbG9zZV9kaWFsb2cpCgogICAgICAgIG92ZXJsYXkgPSB1cndp
ZC5PdmVybGF5KAogICAgICAgICAgICBkaWFsb2csCiAgICAgICAgICAgIHNlbGYubWFpbl9mcmFt
ZSwKICAgICAgICAgICAgYWxpZ249J2NlbnRlcicsCiAgICAgICAgICAgIHdpZHRoPSgncmVsYXRp
dmUnLCA2MCksCiAgICAgICAgICAgIHZhbGlnbj0nbWlkZGxlJywKICAgICAgICAgICAgaGVpZ2h0
PSgncmVsYXRpdmUnLCA3MCkKICAgICAgICApCgogICAgICAgIHNlbGYubG9vcC53aWRnZXQgPSBv
dmVybGF5CgogICAgZGVmIHNob3dfbWFya19wYXR0ZXJuX2RpYWxvZyhzZWxmKToKICAgICAgICAi
IiLQlNC40LDQu9C+0LMg0L7RgtC80LXRgtC60Lgg0LrQu9GO0YfQtdC5INC/0L4g0YjQsNCx0LvQ
vtC90YMiIiIKICAgICAgICBlZGl0ID0gdXJ3aWQuRWRpdCgnUGF0dGVybiAoKiBhbmQgPyB3aWxk
Y2FyZHMpOiAnKQoKICAgICAgICBkZWYgb25fbWFyayhidXR0b24pOgogICAgICAgICAgICBwYXR0
ZXJuID0gZWRpdC5nZXRfZWRpdF90ZXh0KCkuc3RyaXAoKQogICAgICAgICAgICBpZiBwYXR0ZXJu
OgogICAgICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3Lm1hcmtfYnlfcGF0dGVybihwYXR0
ZXJuKQogICAgICAgICAgICAgICAgbWFya2VkX2NvdW50ID0gbGVuKHNlbGYua2V5X2xpc3Rfdmll
dy5nZXRfbWFya2VkX2tleXMoKSkKICAgICAgICAgICAgICAgIHNlbGYuc2V0X3N0YXR1cyhmIk1h
cmtlZCB7bWFya2VkX2NvdW50fSBrZXlzIGJ5IHBhdHRlcm46IHtwYXR0ZXJufSIsICdzdWNjZXNz
JykKICAgICAgICAgICAgc2VsZi5jbG9zZV9kaWFsb2coTm9uZSkKCiAgICAgICAgZGVmIG9uX2Nh
bmNlbChidXR0b24pOgogICAgICAgICAgICBzZWxmLmNsb3NlX2RpYWxvZyhOb25lKQoKICAgICAg
ICBtYXJrX2J0biA9IHVyd2lkLkJ1dHRvbignTWFyaycsIG9uX3ByZXNzPW9uX21hcmspCiAgICAg
ICAgY2FuY2VsX2J0biA9IHVyd2lkLkJ1dHRvbignQ2FuY2VsJywgb25fcHJlc3M9b25fY2FuY2Vs
KQoKICAgICAgICBwaWxlID0gdXJ3aWQuUGlsZShbCiAgICAgICAgICAgIHVyd2lkLlRleHQoJ0Vu
dGVyIHBhdHRlcm4gdG8gbWFyayBrZXlzOicpLAogICAgICAgICAgICB1cndpZC5UZXh0KCdFeGFt
cGxlczogdXNlcjoqLCBzZXNzaW9uOj8xMjMsICp0ZW1wKicpLAogICAgICAgICAgICB1cndpZC5E
aXZpZGVyKCksCiAgICAgICAgICAgIGVkaXQsCiAgICAgICAgICAgIHVyd2lkLkRpdmlkZXIoKSwK
ICAgICAgICAgICAgdXJ3aWQuQ29sdW1ucyhbCiAgICAgICAgICAgICAgICB1cndpZC5BdHRyTWFw
KG1hcmtfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICAgICAgdXJ3
aWQuQXR0ck1hcChjYW5jZWxfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAg
ICAgICBdKSwKICAgICAgICBdKQoKICAgICAgICBkaWFsb2cgPSB1cndpZC5MaW5lQm94KHVyd2lk
LkZpbGxlcihwaWxlKSwgdGl0bGU9J01hcmsgS2V5cyBieSBQYXR0ZXJuJykKCiAgICAgICAgb3Zl
cmxheSA9IHVyd2lkLk92ZXJsYXkoCiAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAoZGlhbG9nLCAn
ZGlhbG9nJyksCiAgICAgICAgICAgIHNlbGYubWFpbl9mcmFtZSwKICAgICAgICAgICAgYWxpZ249
J2NlbnRlcicsCiAgICAgICAgICAgIHdpZHRoPSgncmVsYXRpdmUnLCA1MCksCiAgICAgICAgICAg
IHZhbGlnbj0nbWlkZGxlJywKICAgICAgICAgICAgaGVpZ2h0PSgncmVsYXRpdmUnLCAzMCkKICAg
ICAgICApCgogICAgICAgIHNlbGYubG9vcC53aWRnZXQgPSBvdmVybGF5CgogICAgZGVmIHNob3df
ZmlsdGVyX2RpYWxvZyhzZWxmKToKICAgICAgICAiIiLQlNC40LDQu9C+0LMg0YTQuNC70YzRgtGA
0LDRhtC40Lgg0LrQu9GO0YfQtdC5IiIiCiAgICAgICAgZWRpdCA9IHVyd2lkLkVkaXQoJ0ZpbHRl
ciBwYXR0ZXJuICgqIGZvciB3aWxkY2FyZCk6ICcpCgogICAgICAgIGRlZiBvbl9hcHBseShidXR0
b24pOgogICAgICAgICAgICBwYXR0ZXJuID0gZWRpdC5nZXRfZWRpdF90ZXh0KCkuc3RyaXAoKQog
ICAgICAgICAgICBpZiBwYXR0ZXJuOgogICAgICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3
LmFwcGx5X2ZpbHRlcihwYXR0ZXJuKQogICAgICAgICAgICAgICAgc2VsZi5zZXRfc3RhdHVzKGYi
RmlsdGVyIGFwcGxpZWQ6IHtwYXR0ZXJufSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAg
ICAgICBzZWxmLmtleV9saXN0X3ZpZXcuYXBwbHlfZmlsdGVyKE5vbmUpCiAgICAgICAgICAgICAg
ICBzZWxmLnNldF9zdGF0dXMoIkZpbHRlciBjbGVhcmVkIikKICAgICAgICAgICAgc2VsZi5jbG9z
ZV9kaWFsb2coTm9uZSkKCiAgICAgICAgZGVmIG9uX2NsZWFyKGJ1dHRvbik6CiAgICAgICAgICAg
IHNlbGYua2V5X2xpc3Rfdmlldy5hcHBseV9maWx0ZXIoTm9uZSkKICAgICAgICAgICAgc2VsZi5z
ZXRfc3RhdHVzKCJGaWx0ZXIgY2xlYXJlZCIpCiAgICAgICAgICAgIHNlbGYuY2xvc2VfZGlhbG9n
KE5vbmUpCgogICAgICAgIGFwcGx5X2J0biA9IHVyd2lkLkJ1dHRvbignQXBwbHknLCBvbl9wcmVz
cz1vbl9hcHBseSkKICAgICAgICBjbGVhcl9idG4gPSB1cndpZC5CdXR0b24oJ0NsZWFyJywgb25f
cHJlc3M9b25fY2xlYXIpCiAgICAgICAgY2FuY2VsX2J0biA9IHVyd2lkLkJ1dHRvbignQ2FuY2Vs
Jywgb25fcHJlc3M9c2VsZi5jbG9zZV9kaWFsb2coTm9uZSkpCgogICAgICAgIHBpbGUgPSB1cndp
ZC5QaWxlKFsKICAgICAgICAgICAgZWRpdCwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigpLAog
ICAgICAgICAgICB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJNYXAo
YXBwbHlfYnRuLCAnYnV0dG9uJywgJ2J1dHRvbl9mb2N1cycpLAogICAgICAgICAgICAgICAgdXJ3
aWQuQXR0ck1hcChjbGVhcl9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3VzJyksCiAgICAgICAg
ICAgICAgICB1cndpZC5BdHRyTWFwKGNhbmNlbF9idG4sICdidXR0b24nLCAnYnV0dG9uX2ZvY3Vz
JyksCiAgICAgICAgICAgIF0pLAogICAgICAgIF0pCgogICAgICAgIGRpYWxvZyA9IHVyd2lkLkxp
bmVCb3godXJ3aWQuRmlsbGVyKHBpbGUpLCB0aXRsZT0nRmlsdGVyIEtleXMnKQoKICAgICAgICBv
dmVybGF5ID0gdXJ3aWQuT3ZlcmxheSgKICAgICAgICAgICAgdXJ3aWQuQXR0ck1hcChkaWFsb2cs
ICdkaWFsb2cnKSwKICAgICAgICAgICAgc2VsZi5tYWluX2ZyYW1lLAogICAgICAgICAgICBhbGln
bj0nY2VudGVyJywKICAgICAgICAgICAgd2lkdGg9KCdyZWxhdGl2ZScsIDUwKSwKICAgICAgICAg
ICAgdmFsaWduPSdtaWRkbGUnLAogICAgICAgICAgICBoZWlnaHQ9KCdyZWxhdGl2ZScsIDIwKQog
ICAgICAgICkKCiAgICAgICAgc2VsZi5sb29wLndpZGdldCA9IG92ZXJsYXkKCiAgICBkZWYgZGVs
ZXRlX21hcmtlZF9rZXlzKHNlbGYpOgogICAgICAgICIiItCj0LTQsNC70LjRgtGMINC+0YLQvNC1
0YfQtdC90L3Ri9C1INC60LvRjtGH0LgiIiIKICAgICAgICBtYXJrZWQgPSBzZWxmLmtleV9saXN0
X3ZpZXcuZ2V0X21hcmtlZF9rZXlzKCkKCiAgICAgICAgaWYgbm90IG1hcmtlZDoKICAgICAgICAg
ICAgc2VsZi5zZXRfc3RhdHVzKCJObyBrZXlzIG1hcmtlZCIsICd3YXJuaW5nJykKICAgICAgICAg
ICAgcmV0dXJuCgogICAgICAgICMg0J/QvtC00YLQstC10YDQttC00LXQvdC40LUKICAgICAgICBk
ZWYgb25fY29uZmlybShidXR0b24pOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBj
bGllbnQgPSBzZWxmLmN1cnJlbnRfY29ubmVjdGlvbi5hY3RpdmVfY2xpZW50CiAgICAgICAgICAg
ICAgICBkZWxldGVkID0gMAogICAgICAgICAgICAgICAgZm9yIGtleSBpbiBtYXJrZWQ6CiAgICAg
ICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBpZiBjbGllbnQuZGVs
ZXRlKGtleSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVkICs9IDEKICAgICAg
ICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAg
ICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJEZWxldGVkIHtkZWxldGVkfS97bGVuKG1hcmtl
ZCl9IGtleXMiLCAnc3VjY2VzcycpCiAgICAgICAgICAgICAgICBzZWxmLmtleV9saXN0X3ZpZXcu
dW5tYXJrX2FsbCgpCiAgICAgICAgICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCiAgICAgICAg
ICAgICAgICBzZWxmLmNsb3NlX2RpYWxvZyhOb25lKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0
aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJEZWxldGUgZmFpbGVk
OiB7ZX0iLCAnZXJyb3InKQoKICAgICAgICB0ZXh0ID0gdXJ3aWQuVGV4dChmIkRlbGV0ZSB7bGVu
KG1hcmtlZCl9IG1hcmtlZCBrZXlzPyIpCiAgICAgICAgeWVzX2J0biA9IHVyd2lkLkJ1dHRvbign
WWVzJywgb25fcHJlc3M9b25fY29uZmlybSkKICAgICAgICBub19idG4gPSB1cndpZC5CdXR0b24o
J05vJywgb25fcHJlc3M9c2VsZi5jbG9zZV9kaWFsb2coTm9uZSkpCgogICAgICAgIHBpbGUgPSB1
cndpZC5QaWxlKFsKICAgICAgICAgICAgdGV4dCwKICAgICAgICAgICAgdXJ3aWQuRGl2aWRlcigp
LAogICAgICAgICAgICB1cndpZC5Db2x1bW5zKFsKICAgICAgICAgICAgICAgIHVyd2lkLkF0dHJN
YXAoeWVzX2J0biwgJ2J1dHRvbl9kYW5nZXInLCAnYnV0dG9uX2ZvY3VzJyksCiAgICAgICAgICAg
ICAgICB1cndpZC5BdHRyTWFwKG5vX2J0biwgJ2J1dHRvbicsICdidXR0b25fZm9jdXMnKSwKICAg
ICAgICAgICAgXSksCiAgICAgICAgXSkKCiAgICAgICAgZGlhbG9nID0gdXJ3aWQuTGluZUJveCh1
cndpZC5GaWxsZXIocGlsZSksIHRpdGxlPSdDb25maXJtIERlbGV0ZScpCgogICAgICAgIG92ZXJs
YXkgPSB1cndpZC5PdmVybGF5KAogICAgICAgICAgICB1cndpZC5BdHRyTWFwKGRpYWxvZywgJ2Rp
YWxvZycpLAogICAgICAgICAgICBzZWxmLm1haW5fZnJhbWUsCiAgICAgICAgICAgIGFsaWduPSdj
ZW50ZXInLAogICAgICAgICAgICB3aWR0aD0oJ3JlbGF0aXZlJywgNDApLAogICAgICAgICAgICB2
YWxpZ249J21pZGRsZScsCiAgICAgICAgICAgIGhlaWdodD0oJ3JlbGF0aXZlJywgMjApCiAgICAg
ICAgKQoKICAgICAgICBzZWxmLmxvb3Aud2lkZ2V0ID0gb3ZlcmxheQoKICAgIGRlZiBvbl9rZXlf
YWRkZWQoc2VsZik6CiAgICAgICAgIiIi0JrQu9GO0Ycg0LTQvtCx0LDQstC70LXQvSIiIgogICAg
ICAgIHNlbGYuc2V0X3N0YXR1cygiS2V5IGFkZGVkIHN1Y2Nlc3NmdWxseSIsICdzdWNjZXNzJykK
ICAgICAgICBzZWxmLnJlZnJlc2hfa2V5cygpCgogICAgZGVmIGNsb3NlX2RpYWxvZyhzZWxmLCBi
dXR0b24pOgogICAgICAgICIiItCX0LDQutGA0YvRgtGMINC00LjQsNC70L7QsyDQuCDQstC10YDQ
vdGD0YLRjNGB0Y8g0Log0L7RgdC90L7QstC90L7QvNGDINGN0LrRgNCw0L3RgwoKICAgICAgICBB
cmdzOgogICAgICAgICAgICBidXR0b246INC60L3QvtC/0LrQsCDQuNC70LggTm9uZSAodXJ3aWQg
0L/QtdGA0LXQtNCw0LXRgiBidXR0b24g0L/RgNC4IGNhbGxiYWNrKQogICAgICAgICIiIgogICAg
ICAgIHNlbGYubG9vcC53aWRnZXQgPSBzZWxmLm1haW5fZnJhbWUKCiAgICBkZWYgc2V0X3N0YXR1
cyhzZWxmLCBtZXNzYWdlOiBzdHIsIHN0eWxlOiBzdHIgPSAnZm9vdGVyJyk6CiAgICAgICAgIiIi
0KPRgdGC0LDQvdC+0LLQutCwINGB0YLQsNGC0YPRgdCwIiIiCiAgICAgICAgc2VsZi5zdGF0dXNf
dGV4dC5zZXRfdGV4dCgoc3R5bGUsIGYiIHttZXNzYWdlfSIpKQoKICAgIGRlZiBlZGl0X2tleV93
cmFwcGVyKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLmNvbnNvbGVfbW9kZToKICAgICAgICAg
ICAgc2VsZWN0ZWRfa2V5ID0gc2VsZi5nZXRfc2VsZWN0ZWRfa2V5KCkKICAgICAgICAgICAgaWYg
c2VsZWN0ZWRfa2V5OgogICAgICAgICAgICAgICAgIyDQlNC10LrQvtC00LjRgNGD0LXQvCDQtdGB
0LvQuCBieXRlcwogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxlY3RlZF9rZXksIGJ5
dGVzKToKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZF9rZXkgPSBzZWxlY3RlZF9rZXkuZGVj
b2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScpCiAgICAgICAgICAgICAgICBzZWxmLnNob3df
ZWRpdF9rZXlfZGlhbG9nKHNlbGVjdGVkX2tleSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAg
ICAgICAgIHNlbGYuc2V0X3N0YXR1cygiTm8ga2V5IHNlbGVjdGVkIikKCiAgICBkZWYgaGFuZGxl
X2lucHV0KHNlbGYsIGtleSk6CiAgICAgICAgIiIi0J7QsdGA0LDQsdC+0YLQutCwINC60LvQsNCy
0LjRiCIiIgogICAgICAgICMg4pyFIFRhYiAtINC/0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQvNC1
0LbQtNGDINC/0LDQvdC10LvRj9C80LgKICAgICAgICBpZiBrZXkgPT0gJ3RhYic6CiAgICAgICAg
ICAgIHRyeToKICAgICAgICAgICAgICAgICMg0J/QvtC70YPRh9Cw0LXQvCDRgtC10LrRg9GJ0YPR
jiBjb250ZW50X2FyZWEgKNGN0YLQviBDb2x1bW5zKQogICAgICAgICAgICAgICAgY29udGVudF93
aWRnZXQgPSBzZWxmLm1haW5fY29udGVudC5jb250ZW50c1sxXVswXS5vcmlnaW5hbF93aWRnZXQK
CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGNvbnRlbnRfd2lkZ2V0LCB1cndpZC5Db2x1
bW5zKToKICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2ZvY3VzID0gY29udGVudF93aWRnZXQu
Zm9jdXNfcG9zaXRpb24KICAgICAgICAgICAgICAgICAgICBudW1fY29sdW1ucyA9IGxlbihjb250
ZW50X3dpZGdldC5jb250ZW50cykKCiAgICAgICAgICAgICAgICAgICAgIyDQn9C10YDQtdC60LvR
jtGH0LDQtdC8INC90LAg0YHQu9C10LTRg9GO0YnRg9GOINC60L7Qu9C+0L3QutGDINC/0L4g0LrR
gNGD0LPRgwogICAgICAgICAgICAgICAgICAgIG5leHRfZm9jdXMgPSAoY3VycmVudF9mb2N1cyAr
IDEpICUgbnVtX2NvbHVtbnMKICAgICAgICAgICAgICAgICAgICBjb250ZW50X3dpZGdldC5mb2N1
c19wb3NpdGlvbiA9IG5leHRfZm9jdXMKCiAgICAgICAgICAgICAgICAgICAgIyDQntCx0L3QvtCy
0LvRj9C10Lwg0YHRgtCw0YLRg9GBCiAgICAgICAgICAgICAgICAgICAgcGFuZWxfbmFtZXMgPSBb
J0Nvbm5lY3Rpb25zICYgS2V5cycsICdEZXRhaWxzJywgJ0NvbnNvbGUnXQogICAgICAgICAgICAg
ICAgICAgIGlmIG5leHRfZm9jdXMgPCBsZW4ocGFuZWxfbmFtZXMpOgogICAgICAgICAgICAgICAg
ICAgICAgICBzZWxmLnNldF9zdGF0dXMoZiJGb2N1czoge3BhbmVsX25hbWVzW25leHRfZm9jdXNd
fSIpCgogICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIGV4Y2VwdCBF
eGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBz
d2l0Y2ggcGFuZWw6IHtlfSIpCgogICAgICAgIGlmIGtleSA9PSAnZjEwJzoKICAgICAgICAgICAg
cmFpc2UgdXJ3aWQuRXhpdE1haW5Mb29wKCkKICAgICAgICBlbGlmIGtleSBpbiAoJ3EnLCAnUScp
OgogICAgICAgICAgICBpZiBub3Qgc2VsZi5jb25zb2xlX21vZGU6CiAgICAgICAgICAgICAgICBy
YWlzZSB1cndpZC5FeGl0TWFpbkxvb3AoKQogICAgICAgIGVsaWYga2V5ID09ICdmMTEnOgogICAg
ICAgICAgICBpZiBub3Qgc2VsZi5jb25zb2xlX21vZGU6CiAgICAgICAgICAgICAgICBzZWxmLnJl
ZnJlc2hfa2V5cygpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2YxJyBvciBrZXkgPT0gJz8nOgogICAg
ICAgICAgICBzZWxmLnNob3dfaGVscCgpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2YyJzoKICAgICAg
ICAgICAgc2VsZi50b2dnbGVfY29uc29sZSgpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2VzYyc6CiAg
ICAgICAgICAgIGlmIHNlbGYuY29uc29sZV9tb2RlOgogICAgICAgICAgICAgICAgc2VsZi50b2dn
bGVfY29uc29sZSgpCiAgICAgICAgZWxpZiBrZXkgPT0gJ2YzJzoKICAgICAgICAgICAgaWYgbm90
IHNlbGYuY29uc29sZV9tb2RlOgogICAgICAgICAgICAgICAgc2VsZi5zaG93X2FkZF9rZXlfZGlh
bG9nKCkKICAgICAgICBlbGlmIGtleSA9PSAnZjknOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5j
b25zb2xlX21vZGU6CiAgICAgICAgICAgICAgICBzZWxmLmRpc2Nvbm5lY3QoKQogICAgICAgIGVs
aWYga2V5ID09ICdmNCc6CiAgICAgICAgICAgIHNlbGYuZWRpdF9rZXlfd3JhcHBlcigpCiAgICAg
ICAgZWxpZiBrZXkgPT0gJ2YxMic6CiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmNvbnNvbGVfbW9k
ZToKICAgICAgICAgICAgICAgIHNlbGYuZGVidWdfY2x1c3Rlcl9pbmZvKCkKICAgICAgICBlbGlm
IGtleSA9PSAnZW50ZXInOgogICAgICAgICAgICBpZiBzZWxmLmNvbnNvbGVfbW9kZToKICAgICAg
ICAgICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8LCDQvdCw0YXQvtC00LjQvNGB0Y8g0LvQuCDQ
vNGLINCyINC/0YDQvtC80L/RgtC1CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAg
ICAgICAgaWYgc2VsZi5tYWluX2NvbnRlbnQuZm9jdXNfcG9zaXRpb24gPT0gMjogICMg0JrQvtC9
0YHQvtC70YzQvdCw0Y8g0L/QsNC90LXQu9GMCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNv
bGVfcGlsZSA9IHNlbGYuY29uc29sZV9wYW5lbC5vcmlnaW5hbF93aWRnZXQKICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgY29uc29sZV9waWxlLmZvY3VzX3Bvc2l0aW9uID09IDI6ICAjINCf0YDQ
vtC80L/RggogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5leGVjdXRlX2NvbnNvbGVf
Y29tbWFuZCgpCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFz
cwoKICAgICAgICBpZiBrZXkgPT0gJyAnOiAgIyDQn9GA0L7QsdC10LsgLSDQvtGC0LzQtdGC0LjR
gtGML9GB0L3Rj9GC0Ywg0L7RgtC80LXRgtC60YMKICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92
aWV3LnRvZ2dsZV9tYXJrX2ZvY3VzZWQoKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgZWxp
ZiBrZXkgPT0gJ2N0cmwgYSc6ICAjIEN0cmwrQSAtINC+0YLQvNC10YLQuNGC0Ywg0LLRgdC1CiAg
ICAgICAgICAgIHBhdHRlcm4gPSBzZWxmLnNob3dfbWFya19wYXR0ZXJuX2RpYWxvZygpCiAgICAg
ICAgICAgIGlmIHBhdHRlcm46CiAgICAgICAgICAgICAgICBzZWxmLmtleV9saXN0X3ZpZXcubWFy
a19ieV9wYXR0ZXJuKHBhdHRlcm4pCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBlbGlmIGtl
eSA9PSAnY3RybCB1JzogICMgQ3RybCtVIC0g0YHQvdGP0YLRjCDQstGB0LUg0L7RgtC80LXRgtC6
0LgKICAgICAgICAgICAgc2VsZi5rZXlfbGlzdF92aWV3LnVubWFya19hbGwoKQogICAgICAgICAg
ICBzZWxmLnNldF9zdGF0dXMoIkFsbCBtYXJrcyBjbGVhcmVkIikKICAgICAgICAgICAgcmV0dXJu
CgogICAgICAgIGVsaWYga2V5ID09ICcvJzogICMg0KTQuNC70YzRgtGACiAgICAgICAgICAgIHNl
bGYuc2hvd19maWx0ZXJfZGlhbG9nKCkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGVsaWYg
a2V5ID09ICdmOCc6ICAjINCc0LDRgdGB0L7QstC+0LUg0YPQtNCw0LvQtdC90LjQtSDQvtGC0LzQ
tdGH0LXQvdC90YvRhQogICAgICAgICAgICBzZWxmLmRlbGV0ZV9tYXJrZWRfa2V5cygpCiAgICAg
ICAgICAgIHJldHVybgoKICAgIGRlZiBzaG93X2hlbHAoc2VsZik6CiAgICAgICAgIiIi0KHQv9GA
0LDQstC60LAiIiIKICAgICAgICBoZWxwX3RleHQgPSAiIiIKUmVkaXMgQ29tbWFuZGVyIFRVSSAt
IEhlbHAKCkhvdGtleXM6CiAgcSwgUSAgICAgICAtIFF1aXQgKHdoZW4gbm90IGluIGNvbnNvbGUg
bW9kZSkKICA/LCBGMSAgICAgIC0gVGhpcyBoZWxwCiAgRjIgICAgICAgICAtIFRvZ2dsZSBjb25z
b2xlIG1vZGUKICBGMyAgICAgICAgIC0gTmV3IGtleQogIEY0ICAgICAgICAgLSBFZGl0IGtleQog
IEY4ICAgICAgICAgLSBEZWxldGUgTWFya2VkIGtleQogIEY5ICAgICAgICAgLSBEaXNjb25uZWN0
CiAgRjEwICAgICAgICAtIFF1aXQKICBGMTEgICAgICAgIC0gUmVmcmVzaCBrZXlzCgogIC8gICAg
ICAgICAgLSBLZXkgRmlsdGVyCiAgQ3RybCthICAgICAtIG1hcmsga2V5cwogIEN0cmwrdSAgICAg
LSB1bm1hcmsga2V5cyAKICBFbnRlciAgICAgIC0gVmlldyBrZXkKICAgICAgICAgICAgIAoKQ29u
c29sZSBNb2RlOgogIFR5cGUgUmVkaXMgY29tbWFuZHMgYW5kIHByZXNzIEVudGVyCiAgRXhhbXBs
ZXM6IEdFVCBrZXksIFNFVCBrZXkgdmFsdWUsIEtFWVMgKgoKICBQYWdlIHVwICAgLSBwcmV2IGNv
bW1hbmQgZnJvbSBoaXN0b3J5CiAgUGFnZSBkb3duIC0gbmV4dCBjb21tYW5kIGZyb20gaGlzdG9y
eQoiIiIKICAgICAgICBzZWxmLmRldGFpbF93YWxrZXJbOl0gPSBbXQogICAgICAgIGZvciBsaW5l
IGluIGhlbHBfdGV4dC5zcGxpdCgnXG4nKToKICAgICAgICAgICAgc2VsZi5kZXRhaWxfd2Fsa2Vy
LmFwcGVuZCh1cndpZC5UZXh0KGxpbmUpKQoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgIiIi
0JfQsNC/0YPRgdC6IiIiCiAgICAgICAgc2VsZi5sb29wLnJ1bigpCgoKZGVmIG1haW4oKToKICAg
ICIiItCi0L7Rh9C60LAg0LLRhdC+0LTQsCIiIgogICAgcGFyc2VyID0gYXJncGFyc2UuQXJndW1l
bnRQYXJzZXIoZGVzY3JpcHRpb249ZidSRURJUyBDb21tYW5kZXIgLSBUVUkgTWFuYWdlciBmb3Ig
UkVESVMgOyBWZXJzaW9uIHtfX1ZFUlNJT05fX30nKQoKICAgICMg0KDQtdC20LjQvCAxOiDQntCx
0YvRh9C90YvQuSDRhNCw0LnQuyAo0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4pCiAgICBwYXJzZXIu
YWRkX2FyZ3VtZW50KCctYycsICctLWNvbmZpZycsIGRlZmF1bHQ9J3JlZGlzX3Byb2ZpbGVzLmpz
b24nLCBoZWxwPSdQYXRoIHRvIHBsYWludGV4dCBjb25maWcgZmlsZSAoZGVmYXVsdDogcmVkaXNf
cHJvZmlsZXMuanNvbiknKQogICAgIyDQoNC10LbQuNC8IDI6INCX0LDRiNC40YTRgNC+0LLQsNC9
0L3Ri9C5INGE0LDQudC7CiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctZScsICctLWVuY3J5cHRl
ZC1jb25maWcnLCAgaGVscD0nUGF0aCB0byBlbmNyeXB0ZWQgY29uZmlnIGZpbGUgKE1vZGUgMiku
IFJlcXVpcmVzIHBhc3N3b3JkLicpCiAgICAjINCg0LXQttC40LwgMzogVmF1bHQKICAgIHBhcnNl
ci5hZGRfYXJndW1lbnQoJy0tdmF1bHQtdXJsJywgaGVscD0nVmF1bHQgVVJMIChlLmcuIGh0dHA6
Ly8xMjcuMC4wLjE6ODIwMCkuIEFjdGl2YXRlcyBNb2RlIDMuJykKICAgIHBhcnNlci5hZGRfYXJn
dW1lbnQoJy0tdmF1bHQtcGF0aCcsIGhlbHA9J1BhdGggdG8gc2VjcmV0IGluIFZhdWx0IChlLmcu
IHNlY3JldC9kYXRhL3JlZGlzLWNvbW1hbmRlciknKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgn
LS12YXVsdC11c2VyJywgaGVscD0nVmF1bHQgdXNlcm5hbWUgKHdpbGwgcHJvbXB0IGlmIG1pc3Np
bmcpJykKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy0tdmF1bHQtcGFzcycsIGhlbHA9J1ZhdWx0
IHBhc3N3b3JkICh3aWxsIHByb21wdCBpZiBtaXNzaW5nIC0gSU5TRUNVUkUgaW4gaGlzdG9yeSkn
KQoKICAgIGFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncygpCiAgICBwcmludChmJ1JFRElTIENvbW1h
bmRlciAtIFRVSSBNYW5hZ2VyIGZvciBSRURJUyA7IFZlcnNpb24ge19fVkVSU0lPTl9ffScpCgog
ICAgdHJ5OgogICAgICAgIGFwcCA9IFJlZGlzQ29tbWFuZGVyVUkoYXJncykKICAgICAgICBhcHAu
cnVuKCkKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICBwYXNzCiAgICBleGNl
cHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJGYXRhbCBlcnJvcjoge2V9IiwgZmls
ZT1zeXMuc3RkZXJyKQogICAgICAgIGxvZ2dlci5leGNlcHRpb24oIkZhdGFsIGVycm9yIikKICAg
ICAgICBzeXMuZXhpdCgxKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBtYWluKCkK
CgoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHJl
ZGlzX3Byb2ZpbGVzLmpzb24AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwNzcwADAwMDAwMDAA
MDAwMTczNAAwMDAwMDAwMDY1MQAxNTEzMjE2NTU2MwAwMTQwMzQAIDAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdXN0YXIgIAByb290AAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAHZib3hzZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAewog
ICJteS1jbHVzdGVyIjogewogICAgIm5hbWUiOiAibXktY2x1c3RlciIsCiAgICAiaG9zdCI6ICIx
MjcuMC4wLjEiLAogICAgInBvcnQiOiA3MDAwLAogICAgImNsdXN0ZXJfbW9kZSI6IHRydWUsCiAg
ICAiY2x1c3Rlcl9ub2RlcyI6IFsKICAgICAgWyIxMjcuMC4wLjEiLCA3MDAwXSwKICAgICAgWyIx
MjcuMC4wLjEiLCA3MDAxXSwKICAgICAgWyIxMjcuMC4wLjEiLCA3MDAyXSwKICAgICAgWyIxMjcu
MC4wLjEiLCA3MDAzXSwKICAgICAgWyIxMjcuMC4wLjEiLCA3MDA0XSwKICAgICAgWyIxMjcuMC4w
LjEiLCA3MDA1XQogICAgXQogIH0sCiAgIm15LWxvY2FsIjogewogICAgIm5hbWUiOiAibXktbG9j
YWwiLAogICAgImhvc3QiOiAiMTI3LjAuMC4xIiwKICAgICJwb3J0IjogNjM3OSwKICAgICJjbHVz
dGVyX21vZGUiOiBmYWxzZQogIH0KfQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABzaW1w
bGVfcmVkaXNfY2xpZW50LnB5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDAwMDc3MAAwMDAwMDAwADAw
MDE3MzQAMDAwMDAyMDM2MDAAMTUxMzIxNzM1MzUAMDE0NTE0ACAwAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHVzdGFyICAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAB2Ym94c2YAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACIiIgpT
aW1wbGUgUmVkaXMgQ2xpZW50IC0gUHJvZHVjdGlvbiBSZWFkeSB2Mi4xLjUKCtCd0L7QstGL0LUg
0LLQvtC30LzQvtC20L3QvtGB0YLQuDoKLSBBdXRvLXJlY29ubmVjdCDRgSDRjdC60YHQv9C+0L3Q
tdC90YbQuNCw0LvRjNC90YvQvCBiYWNrb2ZmCi0gQ29ubmVjdGlvbiBQb29sCi0gQnVmZmVyZWQg
SS9PINC00LvRjyBSRVNQCi0g0J3QsNGB0YLQvtGP0YnQuNC5IFBpcGVsaW5lIChiYXRjaCDRh9C1
0YDQtdC3INC+0LTQuNC9INGB0L7QutC10YIpCi0gTXVsdGkta2V5INC60L7QvNCw0L3QtNGLINGB
INCz0YDRg9C/0L/QuNGA0L7QstC60L7QuSDQv9C+INGB0LvQvtGC0LDQvAotINCQ0LLRgtC+0L7Q
sdC90L7QstC70LXQvdC40LUg0YLQvtC/0L7Qu9C+0LPQuNC4INC60LvQsNGB0YLQtdGA0LAKLSDQ
n9C+0LTQtNC10YDQttC60LAgUmVwbGljYSAvIFJlYWQtT25seQotIFNlbnRpbmVsIHN1cHBvcnQK
LSBTU0wg0LHQtdC3INC/0YDQvtCy0LXRgNC60Lgg0YHQtdGA0YLQuNGE0LjQutCw0YLQsAotIEhl
YWx0aCBjaGVja3MKLSBDYWxsYmFja3Mg0LTQu9GPINC80L7QvdC40YLQvtGA0LjQvdCz0LAKLSBM
dWEgc2NyaXB0cyAoRVZBTCwgRVZBTFNIQSkKLSBOdWxsSGFuZGxlciDQtNC70Y8g0LHQuNCx0LvQ
uNC+0YLQtdC6Ci0g0J7QsdGA0LDRgtC90LDRjyDRgdC+0LLQvNC10YHRgtC40LzQvtGB0YLRjCDR
gSB2MS4wLjAKLSBjbHVzdGVyX25vZGVzIHByb3BlcnR5INC60LDQuiBhbGlhcyDQtNC70Y8gY2x1
c3Rlcl9wb29scwotIHNjYW5fYWxsX25vZGVzX2l0ZXIg0YDQsNCx0L7RgtCw0LXRgiDRgSBDb25u
ZWN0aW9uUG9vbAoiIiIKCl9fdmVyc2lvbl9fID0gIjIuMS41IgpfX2F1dGhvcl9fID0gIkRtaXRy
eSBUYXJhc292IgoKX19hbGxfXyA9IFsKICAgICdSZWRpc0NsaWVudCcsCiAgICAnUmVkaXNDb25u
ZWN0aW9uJywgCiAgICAnUmVkaXNQaXBlbGluZScsCiAgICAnUmVkaXNFcnJvcicsCiAgICAnUmVk
aXNDb25uZWN0aW9uRXJyb3InLAogICAgJ1JlZGlzQ2x1c3RlckVycm9yJywKICAgICdDbHVzdGVy
Tm9kZScsCiAgICAnQ29ubmVjdGlvblBvb2wnCl0KCmltcG9ydCBzb2NrZXQKaW1wb3J0IHNzbCBh
cyBzc2xfbW9kdWxlCmltcG9ydCB0aW1lCmltcG9ydCByYW5kb20KaW1wb3J0IGxvZ2dpbmcKaW1w
b3J0IGhhc2hsaWIKZnJvbSB0eXBpbmcgaW1wb3J0IE9wdGlvbmFsLCBMaXN0LCBEaWN0LCBBbnks
IFR1cGxlLCBVbmlvbiwgSXRlcmF0b3IsIENhbGxhYmxlCmZyb20gY29sbGVjdGlvbnMgaW1wb3J0
IGRlZmF1bHRkaWN0CmZyb20gdGhyZWFkaW5nIGltcG9ydCBMb2NrCgojINCd0LDRgdGC0YDQvtC5
0LrQsCDQu9C+0LPQuNGA0L7QstCw0L3QuNGPINC00LvRjyDQsdC40LHQu9C40L7RgtC10LrQuCAo
YmVzdCBwcmFjdGljZSkKbG9nZ2VyID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCmxvZ2dl
ci5hZGRIYW5kbGVyKGxvZ2dpbmcuTnVsbEhhbmRsZXIoKSkKCgojID09PT09PT09PT09PSBFeGNl
cHRpb25zID09PT09PT09PT09PQoKY2xhc3MgUmVkaXNFcnJvcihFeGNlcHRpb24pOgogICAgIiIi
0JHQsNC30L7QstCw0Y8g0L7RiNC40LHQutCwIFJlZGlzIiIiCiAgICBwYXNzCgoKY2xhc3MgUmVk
aXNDb25uZWN0aW9uRXJyb3IoUmVkaXNFcnJvcik6CiAgICAiIiLQntGI0LjQsdC60LAg0L/QvtC0
0LrQu9GO0YfQtdC90LjRjyIiIgogICAgcGFzcwoKCmNsYXNzIFJlZGlzQ2x1c3RlckVycm9yKFJl
ZGlzRXJyb3IpOgogICAgIiIi0J7RiNC40LHQutCwINC60LvQsNGB0YLQtdGA0LAiIiIKICAgIHBh
c3MKCgojID09PT09PT09PT09PSBCdWZmZXJlZCBTb2NrZXQgPT09PT09PT09PT09CgpjbGFzcyBC
dWZmZXJlZFNvY2tldDoKICAgICIiItCR0YPRhNC10YDQuNC30L7QstCw0L3QvdC+0LUg0YfRgtC1
0L3QuNC1INC40Lcg0YHQvtC60LXRgtCwINC00LvRjyDRg9GB0LrQvtGA0LXQvdC40Y8gSS9PIiIi
CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNvY2s6IHNvY2tldC5zb2NrZXQsIGJ1ZmZlcl9zaXpl
OiBpbnQgPSA4MTkyKToKICAgICAgICBzZWxmLl9zb2NrID0gc29jawogICAgICAgIHNlbGYuX2J1
ZmZlciA9IGInJwogICAgICAgIHNlbGYuX2J1ZmZlcl9zaXplID0gYnVmZmVyX3NpemUKCiAgICBk
ZWYgcmVjdihzZWxmLCBuOiBpbnQpIC0+IGJ5dGVzOgogICAgICAgICIiItCf0YDQvtGH0LjRgtCw
0YLRjCDRgNC+0LLQvdC+IG4g0LHQsNC50YIg0LjQtyDQsdGD0YTQtdGA0LAiIiIKICAgICAgICB3
aGlsZSBsZW4oc2VsZi5fYnVmZmVyKSA8IG46CiAgICAgICAgICAgIGNodW5rID0gc2VsZi5fc29j
ay5yZWN2KHNlbGYuX2J1ZmZlcl9zaXplKQogICAgICAgICAgICBpZiBub3QgY2h1bms6CiAgICAg
ICAgICAgICAgICByYWlzZSBSZWRpc0Nvbm5lY3Rpb25FcnJvcigiQ29ubmVjdGlvbiBjbG9zZWQi
KQogICAgICAgICAgICBzZWxmLl9idWZmZXIgKz0gY2h1bmsKCiAgICAgICAgcmVzdWx0ID0gc2Vs
Zi5fYnVmZmVyWzpuXQogICAgICAgIHNlbGYuX2J1ZmZlciA9IHNlbGYuX2J1ZmZlcltuOl0KICAg
ICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIHJlY3ZfbGluZShzZWxmKSAtPiBieXRlczoKICAg
ICAgICAiIiLQn9GA0L7Rh9C40YLQsNGC0Ywg0YHRgtGA0L7QutGDINC00L4gXHJcbiIiIgogICAg
ICAgIHdoaWxlIGInXHJcbicgbm90IGluIHNlbGYuX2J1ZmZlcjoKICAgICAgICAgICAgY2h1bmsg
PSBzZWxmLl9zb2NrLnJlY3Yoc2VsZi5fYnVmZmVyX3NpemUpCiAgICAgICAgICAgIGlmIG5vdCBj
aHVuazoKICAgICAgICAgICAgICAgIHJhaXNlIFJlZGlzQ29ubmVjdGlvbkVycm9yKCJDb25uZWN0
aW9uIGNsb3NlZCIpCiAgICAgICAgICAgIHNlbGYuX2J1ZmZlciArPSBjaHVuawoKICAgICAgICBp
ZHggPSBzZWxmLl9idWZmZXIuaW5kZXgoYidcclxuJykKICAgICAgICBsaW5lID0gc2VsZi5fYnVm
ZmVyWzppZHhdCiAgICAgICAgc2VsZi5fYnVmZmVyID0gc2VsZi5fYnVmZmVyW2lkeCArIDI6XQog
ICAgICAgIHJldHVybiBsaW5lCgogICAgZGVmIHNlbmRhbGwoc2VsZiwgZGF0YTogYnl0ZXMpOgog
ICAgICAgICIiItCe0YLQv9GA0LDQstC40YLRjCDQtNCw0L3QvdGL0LUiIiIKICAgICAgICByZXR1
cm4gc2VsZi5fc29jay5zZW5kYWxsKGRhdGEpCgogICAgZGVmIGNsb3NlKHNlbGYpOgogICAgICAg
ICIiItCX0LDQutGA0YvRgtGMINGB0L7QutC10YIiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAg
IHNlbGYuX3NvY2suY2xvc2UoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKCiMg
PT09PT09PT09PT09IFJFU1AgUGFyc2VyID09PT09PT09PT09PQoKY2xhc3MgUkVTUFBhcnNlcjoK
ICAgICIiItCf0LDRgNGB0LXRgCBSRVNQINC/0YDQvtGC0L7QutC+0LvQsCDRgSDQsdGD0YTQtdGA
0LjQt9Cw0YbQuNC10LkiIiIKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZW5jb2RlX2NvbW1h
bmQoKmFyZ3MpIC0+IGJ5dGVzOgogICAgICAgICIiItCa0L7QtNC40YDQvtCy0LDQvdC40LUg0LrQ
vtC80LDQvdC00Ysg0LIgUkVTUCDRhNC+0YDQvNCw0YIiIiIKICAgICAgICBwYXJ0cyA9IFtmJyp7
bGVuKGFyZ3MpfVxyXG4nLmVuY29kZSgpXQogICAgICAgIGZvciBhcmcgaW4gYXJnczoKICAgICAg
ICAgICAgaWYgaXNpbnN0YW5jZShhcmcsIGJ5dGVzKToKICAgICAgICAgICAgICAgIGRhdGEgPSBh
cmcKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKGFyZywgc3RyKToKICAgICAgICAgICAgICAg
IGRhdGEgPSBhcmcuZW5jb2RlKCd1dGYtOCcpCiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShh
cmcsIChpbnQsIGZsb2F0KSk6CiAgICAgICAgICAgICAgICBkYXRhID0gc3RyKGFyZykuZW5jb2Rl
KCd1dGYtOCcpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkYXRhID0gc3RyKGFy
ZykuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICBwYXJ0cy5hcHBlbmQoZicke2xlbihkYXRh
KX1cclxuJy5lbmNvZGUoKSkKICAgICAgICAgICAgcGFydHMuYXBwZW5kKGRhdGEpCiAgICAgICAg
ICAgIHBhcnRzLmFwcGVuZChiJ1xyXG4nKQoKICAgICAgICByZXR1cm4gYicnLmpvaW4ocGFydHMp
CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGVuY29kZV9jb21tYW5kcyhjb21tYW5kczogTGlz
dFtUdXBsZV0pIC0+IGJ5dGVzOgogICAgICAgICIiItCa0L7QtNC40YDQvtCy0LDQvdC40LUg0L3Q
tdGB0LrQvtC70YzQutC40YUg0LrQvtC80LDQvdC0INCyINC+0LTQuNC9INCx0YPRhNC10YAgKNC0
0LvRjyBwaXBlbGluZSkiIiIKICAgICAgICByZXR1cm4gYicnLmpvaW4oUkVTUFBhcnNlci5lbmNv
ZGVfY29tbWFuZCgqY21kKSBmb3IgY21kIGluIGNvbW1hbmRzKQoKICAgIEBzdGF0aWNtZXRob2QK
ICAgIGRlZiBkZWNvZGVfcmVzcG9uc2Uoc29jazogQnVmZmVyZWRTb2NrZXQpIC0+IEFueToKICAg
ICAgICAiIiLQlNC10LrQvtC00LjRgNC+0LLQsNC90LjQtSDQvtGC0LLQtdGC0LAgUkVTUCIiIgog
ICAgICAgIGxpbmUgPSBzb2NrLnJlY3ZfbGluZSgpCiAgICAgICAgaWYgbm90IGxpbmU6CiAgICAg
ICAgICAgIHJhaXNlIFJlZGlzQ29ubmVjdGlvbkVycm9yKCJDb25uZWN0aW9uIGNsb3NlZCIpCgog
ICAgICAgIHByZWZpeCA9IGNocihsaW5lWzBdKQogICAgICAgIGRhdGEgPSBsaW5lWzE6XQoKICAg
ICAgICBpZiBwcmVmaXggPT0gJysnOgogICAgICAgICAgICByZXR1cm4gZGF0YS5kZWNvZGUoJ3V0
Zi04JywgZXJyb3JzPSdyZXBsYWNlJykKICAgICAgICBlbGlmIHByZWZpeCA9PSAnLSc6CiAgICAg
ICAgICAgIGVycm9yX21zZyA9IGRhdGEuZGVjb2RlKCd1dGYtOCcsIGVycm9ycz0ncmVwbGFjZScp
CiAgICAgICAgICAgIHJhaXNlIFJlZGlzRXJyb3IoZXJyb3JfbXNnKQogICAgICAgIGVsaWYgcHJl
Zml4ID09ICc6JzoKICAgICAgICAgICAgcmV0dXJuIGludChkYXRhKQogICAgICAgIGVsaWYgcHJl
Zml4ID09ICckJzoKICAgICAgICAgICAgbGVuZ3RoID0gaW50KGRhdGEpCiAgICAgICAgICAgIGlm
IGxlbmd0aCA9PSAtMToKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgICAgIGJ1
bGtfZGF0YSA9IHNvY2sucmVjdihsZW5ndGgpCiAgICAgICAgICAgIHNvY2sucmVjdigyKSAgIyBc
clxuCiAgICAgICAgICAgIHJldHVybiBidWxrX2RhdGEKICAgICAgICBlbGlmIHByZWZpeCA9PSAn
Kic6CiAgICAgICAgICAgIGNvdW50ID0gaW50KGRhdGEpCiAgICAgICAgICAgIGlmIGNvdW50ID09
IC0xOgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAgICAgcmV0dXJuIFtSRVNQ
UGFyc2VyLmRlY29kZV9yZXNwb25zZShzb2NrKSBmb3IgXyBpbiByYW5nZShjb3VudCldCiAgICAg
ICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgUmVkaXNFcnJvcihmIlVua25vd24gUkVTUCBwcmVm
aXg6IHtwcmVmaXh9IikKCgojID09PT09PT09PT09PSBDb25uZWN0aW9uID09PT09PT09PT09PQoK
Y2xhc3MgUmVkaXNDb25uZWN0aW9uOgogICAgIiIi0J/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiDQ
vtC00L3QvtC80YMgUmVkaXMg0YPQt9C70YMg0YEgYXV0by1yZWNvbm5lY3QiIiIKCiAgICBkZWYg
X19pbml0X18oc2VsZiwgaG9zdDogc3RyID0gJ2xvY2FsaG9zdCcsIHBvcnQ6IGludCA9IDYzNzks
CiAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCB1c2VybmFt
ZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICAgICAgZGI6IGludCA9IDAsIHNv
Y2tldF90aW1lb3V0OiBpbnQgPSA1LAogICAgICAgICAgICAgICAgIHNzbDogYm9vbCA9IEZhbHNl
LCBzc2xfY2FfY2VydHM6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICAgICAgIHNz
bF9jZXJ0ZmlsZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsIHNzbF9rZXlmaWxlOiBPcHRpb25hbFtz
dHJdID0gTm9uZSwKICAgICAgICAgICAgICAgICBzc2xfY2hlY2tfaG9zdG5hbWU6IGJvb2wgPSBU
cnVlLCBzc2xfdmVyaWZ5OiBib29sID0gVHJ1ZSwKICAgICAgICAgICAgICAgICBtYXhfcmVjb25u
ZWN0X2F0dGVtcHRzOiBpbnQgPSAzLCByZWNvbm5lY3RfYmFja29mZl9iYXNlOiBmbG9hdCA9IDAu
MSwKICAgICAgICAgICAgICAgICByZWNvbm5lY3RfYmFja29mZl9tYXg6IGZsb2F0ID0gNS4wLAog
ICAgICAgICAgICAgICAgIG9uX2Nvbm5lY3Q6IE9wdGlvbmFsW0NhbGxhYmxlXSA9IE5vbmUsCiAg
ICAgICAgICAgICAgICAgb25fZGlzY29ubmVjdDogT3B0aW9uYWxbQ2FsbGFibGVdID0gTm9uZSwK
ICAgICAgICAgICAgICAgICBvbl9yZWNvbm5lY3Q6IE9wdGlvbmFsW0NhbGxhYmxlXSA9IE5vbmUp
OgoKICAgICAgICBzZWxmLmhvc3QgPSBob3N0CiAgICAgICAgc2VsZi5wb3J0ID0gcG9ydAogICAg
ICAgIHNlbGYucGFzc3dvcmQgPSBwYXNzd29yZAogICAgICAgIHNlbGYudXNlcm5hbWUgPSB1c2Vy
bmFtZQogICAgICAgIHNlbGYuZGIgPSBkYgogICAgICAgIHNlbGYuc29ja2V0X3RpbWVvdXQgPSBz
b2NrZXRfdGltZW91dAogICAgICAgIHNlbGYuc3NsID0gc3NsCiAgICAgICAgc2VsZi5zc2xfY2Ff
Y2VydHMgPSBzc2xfY2FfY2VydHMKICAgICAgICBzZWxmLnNzbF9jZXJ0ZmlsZSA9IHNzbF9jZXJ0
ZmlsZQogICAgICAgIHNlbGYuc3NsX2tleWZpbGUgPSBzc2xfa2V5ZmlsZQogICAgICAgIHNlbGYu
c3NsX2NoZWNrX2hvc3RuYW1lID0gc3NsX2NoZWNrX2hvc3RuYW1lCiAgICAgICAgc2VsZi5zc2xf
dmVyaWZ5ID0gc3NsX3ZlcmlmeQoKICAgICAgICAjIFJlY29ubmVjdCDQv9Cw0YDQsNC80LXRgtGA
0YsKICAgICAgICBzZWxmLm1heF9yZWNvbm5lY3RfYXR0ZW1wdHMgPSBtYXhfcmVjb25uZWN0X2F0
dGVtcHRzCiAgICAgICAgc2VsZi5yZWNvbm5lY3RfYmFja29mZl9iYXNlID0gcmVjb25uZWN0X2Jh
Y2tvZmZfYmFzZQogICAgICAgIHNlbGYucmVjb25uZWN0X2JhY2tvZmZfbWF4ID0gcmVjb25uZWN0
X2JhY2tvZmZfbWF4CgogICAgICAgICMgQ2FsbGJhY2tzCiAgICAgICAgc2VsZi5vbl9jb25uZWN0
ID0gb25fY29ubmVjdAogICAgICAgIHNlbGYub25fZGlzY29ubmVjdCA9IG9uX2Rpc2Nvbm5lY3QK
ICAgICAgICBzZWxmLm9uX3JlY29ubmVjdCA9IG9uX3JlY29ubmVjdAoKICAgICAgICBzZWxmLnNv
Y2s6IE9wdGlvbmFsW0J1ZmZlcmVkU29ja2V0XSA9IE5vbmUKICAgICAgICBzZWxmLl9pc19jb25u
ZWN0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuX2Nvbm5lY3QoKQoKICAgIGRlZiBfY29ubmVjdChz
ZWxmKToKICAgICAgICAiIiLQo9GB0YLQsNC90L7QstC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8i
IiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJhd19zb2NrID0gc29ja2V0LnNvY2tldChzb2Nr
ZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICByYXdfc29jay5zZXR0
aW1lb3V0KHNlbGYuc29ja2V0X3RpbWVvdXQpCiAgICAgICAgICAgIHJhd19zb2NrLmNvbm5lY3Qo
KHNlbGYuaG9zdCwgc2VsZi5wb3J0KSkKCiAgICAgICAgICAgIGlmIHNlbGYuc3NsOgogICAgICAg
ICAgICAgICAgY29udGV4dCA9IHNzbF9tb2R1bGUuY3JlYXRlX2RlZmF1bHRfY29udGV4dCgpCgog
ICAgICAgICAgICAgICAgaWYgc2VsZi5zc2xfY2FfY2VydHM6CiAgICAgICAgICAgICAgICAgICAg
Y29udGV4dC5sb2FkX3ZlcmlmeV9sb2NhdGlvbnMoY2FmaWxlPXNlbGYuc3NsX2NhX2NlcnRzKQoK
ICAgICAgICAgICAgICAgIGlmIHNlbGYuc3NsX2NlcnRmaWxlIGFuZCBzZWxmLnNzbF9rZXlmaWxl
OgogICAgICAgICAgICAgICAgICAgIGNvbnRleHQubG9hZF9jZXJ0X2NoYWluKGNlcnRmaWxlPXNl
bGYuc3NsX2NlcnRmaWxlLCBrZXlmaWxlPXNlbGYuc3NsX2tleWZpbGUpCgogICAgICAgICAgICAg
ICAgaWYgbm90IHNlbGYuc3NsX3ZlcmlmeToKICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmNo
ZWNrX2hvc3RuYW1lID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnZlcmlmeV9t
b2RlID0gc3NsX21vZHVsZS5DRVJUX05PTkUKICAgICAgICAgICAgICAgIGVsaWYgbm90IHNlbGYu
c3NsX2NoZWNrX2hvc3RuYW1lOgogICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY2hlY2tfaG9z
dG5hbWUgPSBGYWxzZQoKICAgICAgICAgICAgICAgIHJhd19zb2NrID0gY29udGV4dC53cmFwX3Nv
Y2tldChyYXdfc29jaywgc2VydmVyX2hvc3RuYW1lPXNlbGYuaG9zdCkKCiAgICAgICAgICAgIHNl
bGYuc29jayA9IEJ1ZmZlcmVkU29ja2V0KHJhd19zb2NrKQoKICAgICAgICAgICAgIyDQkNGD0YLQ
tdC90YLQuNGE0LjQutCw0YbQuNGPCiAgICAgICAgICAgIGlmIHNlbGYucGFzc3dvcmQ6CiAgICAg
ICAgICAgICAgICBpZiBzZWxmLnVzZXJuYW1lOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2V4
ZWN1dGVfY29tbWFuZF9pbnRlcm5hbCgnQVVUSCcsIHNlbGYudXNlcm5hbWUsIHNlbGYucGFzc3dv
cmQpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2V4ZWN1
dGVfY29tbWFuZF9pbnRlcm5hbCgnQVVUSCcsIHNlbGYucGFzc3dvcmQpCgogICAgICAgICAgICAj
INCS0YvQsdC+0YAg0JHQlAogICAgICAgICAgICBpZiBzZWxmLmRiICE9IDA6CiAgICAgICAgICAg
ICAgICBzZWxmLl9leGVjdXRlX2NvbW1hbmRfaW50ZXJuYWwoJ1NFTEVDVCcsIHNlbGYuZGIpCgog
ICAgICAgICAgICBzZWxmLl9pc19jb25uZWN0ZWQgPSBUcnVlCiAgICAgICAgICAgIGxvZ2dlci5p
bmZvKGYiQ29ubmVjdGVkIHRvIHtzZWxmLmhvc3R9OntzZWxmLnBvcnR9IChkYj17c2VsZi5kYn0p
IikKCiAgICAgICAgICAgIGlmIHNlbGYub25fY29ubmVjdDoKICAgICAgICAgICAgICAgIHNlbGYu
b25fY29ubmVjdChzZWxmKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgIGlmIHNlbGYuc29jazoKICAgICAgICAgICAgICAgIHNlbGYuc29jay5jbG9zZSgpCiAgICAg
ICAgICAgICAgICBzZWxmLnNvY2sgPSBOb25lCiAgICAgICAgICAgIHNlbGYuX2lzX2Nvbm5lY3Rl
ZCA9IEZhbHNlCiAgICAgICAgICAgIHJhaXNlIFJlZGlzQ29ubmVjdGlvbkVycm9yKGYiRmFpbGVk
IHRvIGNvbm5lY3QgdG8ge3NlbGYuaG9zdH06e3NlbGYucG9ydH06IHtlfSIpCgogICAgZGVmIF9y
ZWNvbm5lY3Qoc2VsZikgLT4gYm9vbDoKICAgICAgICAiIiLQn9C+0L/Ri9GC0LrQsCDQv9C10YDQ
tdC/0L7QtNC60LvRjtGH0LXQvdC40Y8g0YEg0Y3QutGB0L/QvtC90LXQvdGG0LjQsNC70YzQvdGL
0LwgYmFja29mZiIiIgogICAgICAgIGZvciBhdHRlbXB0IGluIHJhbmdlKHNlbGYubWF4X3JlY29u
bmVjdF9hdHRlbXB0cyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGJhY2tvZmYg
PSBtaW4oCiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNvbm5lY3RfYmFja29mZl9iYXNlICog
KDIgKiogYXR0ZW1wdCksCiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNvbm5lY3RfYmFja29m
Zl9tYXgKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICBpZiBhdHRlbXB0ID4gMDoK
ICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIlJlY29ubmVjdCBhdHRlbXB0IHthdHRl
bXB0ICsgMX0ve3NlbGYubWF4X3JlY29ubmVjdF9hdHRlbXB0c30gIgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBmInRvIHtzZWxmLmhvc3R9OntzZWxmLnBvcnR9IGFmdGVyIHtiYWNrb2Zm
Oi4yZn1zIikKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKGJhY2tvZmYpCgogICAgICAg
ICAgICAgICAgc2VsZi5fY29ubmVjdCgpCgogICAgICAgICAgICAgICAgaWYgc2VsZi5vbl9yZWNv
bm5lY3Q6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbl9yZWNvbm5lY3Qoc2VsZiwgYXR0ZW1w
dCArIDEpCgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgICAgIGV4Y2VwdCBF
eGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiUmVjb25uZWN0
IGF0dGVtcHQge2F0dGVtcHQgKyAxfSBmYWlsZWQ6IHtlfSIpCgogICAgICAgIHJldHVybiBGYWxz
ZQoKICAgIGRlZiBfZXhlY3V0ZV9jb21tYW5kX2ludGVybmFsKHNlbGYsICphcmdzKSAtPiBBbnk6
CiAgICAgICAgIiIi0JLQvdGD0YLRgNC10L3QvdC10LUg0LLRi9C/0L7Qu9C90LXQvdC40LUg0LrQ
vtC80LDQvdC00Ysg0LHQtdC3IHJldHJ5IiIiCiAgICAgICAgaWYgbm90IHNlbGYuc29jazoKICAg
ICAgICAgICAgcmFpc2UgUmVkaXNDb25uZWN0aW9uRXJyb3IoIk5vdCBjb25uZWN0ZWQiKQoKICAg
ICAgICBjb21tYW5kID0gUkVTUFBhcnNlci5lbmNvZGVfY29tbWFuZCgqYXJncykKICAgICAgICBz
ZWxmLnNvY2suc2VuZGFsbChjb21tYW5kKQogICAgICAgIHJldHVybiBSRVNQUGFyc2VyLmRlY29k
ZV9yZXNwb25zZShzZWxmLnNvY2spCgogICAgZGVmIGV4ZWN1dGVfY29tbWFuZChzZWxmLCAqYXJn
cywgcmV0cnk6IGJvb2wgPSBUcnVlKSAtPiBBbnk6CiAgICAgICAgIiIi0JLRi9C/0L7Qu9C90LXQ
vdC40LUg0LrQvtC80LDQvdC00Ysg0YEgYXV0by1yZWNvbm5lY3QiIiIKICAgICAgICBpZiBub3Qg
c2VsZi5faXNfY29ubmVjdGVkOgogICAgICAgICAgICByYWlzZSBSZWRpc0Nvbm5lY3Rpb25FcnJv
cigiTm90IGNvbm5lY3RlZCIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIHNlbGYu
X2V4ZWN1dGVfY29tbWFuZF9pbnRlcm5hbCgqYXJncykKCiAgICAgICAgZXhjZXB0IFJlZGlzRXJy
b3I6CiAgICAgICAgICAgIHJhaXNlCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAg
ICAgICAgICAgbG9nZ2VyLmVycm9yKGYiQ29tbWFuZCBmYWlsZWQ6IHtlfSIpCiAgICAgICAgICAg
IHNlbGYuX2lzX2Nvbm5lY3RlZCA9IEZhbHNlCgogICAgICAgICAgICBpZiBzZWxmLm9uX2Rpc2Nv
bm5lY3Q6CiAgICAgICAgICAgICAgICBzZWxmLm9uX2Rpc2Nvbm5lY3Qoc2VsZikKCiAgICAgICAg
ICAgIGlmIHNlbGYuc29jazoKICAgICAgICAgICAgICAgIHNlbGYuc29jay5jbG9zZSgpCiAgICAg
ICAgICAgICAgICBzZWxmLnNvY2sgPSBOb25lCgogICAgICAgICAgICBpZiByZXRyeToKICAgICAg
ICAgICAgICAgIGlmIHNlbGYuX3JlY29ubmVjdCgpOgogICAgICAgICAgICAgICAgICAgIHJldHVy
biBzZWxmLmV4ZWN1dGVfY29tbWFuZCgqYXJncywgcmV0cnk9RmFsc2UpCgogICAgICAgICAgICBy
YWlzZSBSZWRpc0Nvbm5lY3Rpb25FcnJvcihmIkNvbW1hbmQgZmFpbGVkOiB7ZX0iKQoKICAgIGRl
ZiBleGVjdXRlX3BpcGVsaW5lKHNlbGYsIGNvbW1hbmRzOiBMaXN0W1R1cGxlXSkgLT4gTGlzdFtB
bnldOgogICAgICAgICIiItCS0YvQv9C+0LvQvdC10L3QuNC1INC/0LDQutC10YLQsCDQutC+0LzQ
sNC90LQg0YfQtdGA0LXQtyDQvtC00LjQvSDRgdC+0LrQtdGCIiIiCiAgICAgICAgaWYgbm90IHNl
bGYuX2lzX2Nvbm5lY3RlZCBvciBub3Qgc2VsZi5zb2NrOgogICAgICAgICAgICByYWlzZSBSZWRp
c0Nvbm5lY3Rpb25FcnJvcigiTm90IGNvbm5lY3RlZCIpCgogICAgICAgIHRyeToKICAgICAgICAg
ICAgIyDQntGC0L/RgNCw0LLQu9GP0LXQvCDQstGB0LUg0LrQvtC80LDQvdC00Ysg0L7QtNC90LjQ
vCBzZW5kYWxsCiAgICAgICAgICAgIGVuY29kZWQgPSBSRVNQUGFyc2VyLmVuY29kZV9jb21tYW5k
cyhjb21tYW5kcykKICAgICAgICAgICAgc2VsZi5zb2NrLnNlbmRhbGwoZW5jb2RlZCkKCiAgICAg
ICAgICAgICMg0KfQuNGC0LDQtdC8INCy0YHQtSDQvtGC0LLQtdGC0YsKICAgICAgICAgICAgcmVz
dWx0cyA9IFtdCiAgICAgICAgICAgIGZvciBfIGluIGNvbW1hbmRzOgogICAgICAgICAgICAgICAg
dHJ5OgogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKFJFU1BQYXJzZXIuZGVjb2Rl
X3Jlc3BvbnNlKHNlbGYuc29jaykpCiAgICAgICAgICAgICAgICBleGNlcHQgUmVkaXNFcnJvciBh
cyBlOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKGUpCgogICAgICAgICAgICBy
ZXR1cm4gcmVzdWx0cwoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAg
IGxvZ2dlci5lcnJvcihmIlBpcGVsaW5lIGZhaWxlZDoge2V9IikKICAgICAgICAgICAgc2VsZi5f
aXNfY29ubmVjdGVkID0gRmFsc2UKCiAgICAgICAgICAgIGlmIHNlbGYub25fZGlzY29ubmVjdDoK
ICAgICAgICAgICAgICAgIHNlbGYub25fZGlzY29ubmVjdChzZWxmKQoKICAgICAgICAgICAgaWYg
c2VsZi5zb2NrOgogICAgICAgICAgICAgICAgc2VsZi5zb2NrLmNsb3NlKCkKICAgICAgICAgICAg
ICAgIHNlbGYuc29jayA9IE5vbmUKCiAgICAgICAgICAgIHJhaXNlIFJlZGlzQ29ubmVjdGlvbkVy
cm9yKGYiUGlwZWxpbmUgZmFpbGVkOiB7ZX0iKQoKICAgIGRlZiBpc19oZWFsdGh5KHNlbGYpIC0+
IGJvb2w6CiAgICAgICAgIiIiSGVhbHRoIGNoZWNrINGB0L7QtdC00LjQvdC10L3QuNGPIiIiCiAg
ICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZi5waW5nKCkKICAgICAgICBleGNlcHQ6
CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBwaW5nKHNlbGYpIC0+IGJvb2w6CiAg
ICAgICAgIiIiUElORyDQv9GA0L7QstC10YDQutCwIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAg
ICByZXNwb25zZSA9IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdQSU5HJywgcmV0cnk9RmFsc2UpCiAg
ICAgICAgICAgIHJldHVybiByZXNwb25zZSBpbiAoJ1BPTkcnLCBiJ1BPTkcnKQogICAgICAgIGV4
Y2VwdDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIGNsb3NlKHNlbGYpOgogICAg
ICAgICIiItCX0LDQutGA0YvRgtC40LUg0YHQvtC10LTQuNC90LXQvdC40Y8iIiIKICAgICAgICBp
ZiBzZWxmLnNvY2s6CiAgICAgICAgICAgIHNlbGYuX2lzX2Nvbm5lY3RlZCA9IEZhbHNlCgogICAg
ICAgICAgICBpZiBzZWxmLm9uX2Rpc2Nvbm5lY3Q6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAg
ICAgICAgICAgICAgICAgc2VsZi5vbl9kaXNjb25uZWN0KHNlbGYpCiAgICAgICAgICAgICAgICBl
eGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgc2VsZi5zb2NrLmNs
b3NlKCkKICAgICAgICAgICAgc2VsZi5zb2NrID0gTm9uZQoKCiMgPT09PT09PT09PT09IENvbm5l
Y3Rpb24gUG9vbCA9PT09PT09PT09PT0KCmNsYXNzIENvbm5lY3Rpb25Qb29sOgogICAgIiIi0J/R
g9C7INC/0LXRgNC10LjRgdC/0L7Qu9GM0LfRg9C10LzRi9GFINGB0L7QtdC00LjQvdC10L3QuNC5
IiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhvc3Q6IHN0ciA9ICdsb2NhbGhvc3QnLCBwb3J0
OiBpbnQgPSA2Mzc5LAogICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBPcHRpb25hbFtzdHJdID0g
Tm9uZSwgdXNlcm5hbWU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICAgICAgIGRi
OiBpbnQgPSAwLCBzb2NrZXRfdGltZW91dDogaW50ID0gNSwKICAgICAgICAgICAgICAgICBzc2w6
IGJvb2wgPSBGYWxzZSwgc3NsX2NhX2NlcnRzOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAg
ICAgICAgICAgICBzc2xfY2VydGZpbGU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBzc2xfa2V5Zmls
ZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICAgICAgc3NsX2NoZWNrX2hvc3Ru
YW1lOiBib29sID0gVHJ1ZSwgc3NsX3ZlcmlmeTogYm9vbCA9IFRydWUsCiAgICAgICAgICAgICAg
ICAgbWF4X2Nvbm5lY3Rpb25zOiBpbnQgPSA1MCwgbWluX2lkbGVfY29ubmVjdGlvbnM6IGludCA9
IDEsCiAgICAgICAgICAgICAgICAgaGVhbHRoX2NoZWNrX2ludGVydmFsOiBpbnQgPSAzMCk6Cgog
ICAgICAgIHNlbGYuY29ubmVjdGlvbl9rd2FyZ3MgPSB7CiAgICAgICAgICAgICdob3N0JzogaG9z
dCwKICAgICAgICAgICAgJ3BvcnQnOiBwb3J0LAogICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNz
d29yZCwKICAgICAgICAgICAgJ3VzZXJuYW1lJzogdXNlcm5hbWUsCiAgICAgICAgICAgICdkYic6
IGRiLAogICAgICAgICAgICAnc29ja2V0X3RpbWVvdXQnOiBzb2NrZXRfdGltZW91dCwKICAgICAg
ICAgICAgJ3NzbCc6IHNzbCwKICAgICAgICAgICAgJ3NzbF9jYV9jZXJ0cyc6IHNzbF9jYV9jZXJ0
cywKICAgICAgICAgICAgJ3NzbF9jZXJ0ZmlsZSc6IHNzbF9jZXJ0ZmlsZSwKICAgICAgICAgICAg
J3NzbF9rZXlmaWxlJzogc3NsX2tleWZpbGUsCiAgICAgICAgICAgICdzc2xfY2hlY2tfaG9zdG5h
bWUnOiBzc2xfY2hlY2tfaG9zdG5hbWUsCiAgICAgICAgICAgICdzc2xfdmVyaWZ5Jzogc3NsX3Zl
cmlmeQogICAgICAgIH0KCiAgICAgICAgc2VsZi5tYXhfY29ubmVjdGlvbnMgPSBtYXhfY29ubmVj
dGlvbnMKICAgICAgICBzZWxmLm1pbl9pZGxlX2Nvbm5lY3Rpb25zID0gbWluX2lkbGVfY29ubmVj
dGlvbnMKICAgICAgICBzZWxmLmhlYWx0aF9jaGVja19pbnRlcnZhbCA9IGhlYWx0aF9jaGVja19p
bnRlcnZhbAoKICAgICAgICBzZWxmLl9wb29sOiBMaXN0W1JlZGlzQ29ubmVjdGlvbl0gPSBbXQog
ICAgICAgIHNlbGYuX2luX3VzZTogc2V0ID0gc2V0KCkKICAgICAgICBzZWxmLl9sb2NrID0gTG9j
aygpCiAgICAgICAgc2VsZi5fY3JlYXRlZF9jb25uZWN0aW9ucyA9IDAKICAgICAgICBzZWxmLl9s
YXN0X2hlYWx0aF9jaGVjayA9IDAKCiAgICBkZWYgZ2V0X2Nvbm5lY3Rpb24oc2VsZikgLT4gUmVk
aXNDb25uZWN0aW9uOgogICAgICAgICIiItCf0L7Qu9GD0YfQuNGC0Ywg0YHQvtC10LTQuNC90LXQ
vdC40LUg0LjQtyDQv9GD0LvQsCIiIgogICAgICAgIHdpdGggc2VsZi5fbG9jazoKICAgICAgICAg
ICAgIyBIZWFsdGggY2hlY2sg0L/QtdGA0LjQvtC00LjRh9C10YHQutC4CiAgICAgICAgICAgIGN1
cnJlbnRfdGltZSA9IHRpbWUudGltZSgpCiAgICAgICAgICAgIGlmIGN1cnJlbnRfdGltZSAtIHNl
bGYuX2xhc3RfaGVhbHRoX2NoZWNrID4gc2VsZi5oZWFsdGhfY2hlY2tfaW50ZXJ2YWw6CiAgICAg
ICAgICAgICAgICBzZWxmLl9oZWFsdGhfY2hlY2soKQogICAgICAgICAgICAgICAgc2VsZi5fbGFz
dF9oZWFsdGhfY2hlY2sgPSBjdXJyZW50X3RpbWUKCiAgICAgICAgICAgICMg0JjRidC10Lwg0LPQ
vtGC0L7QstC+0LUg0YHQvtC10LTQuNC90LXQvdC40LUKICAgICAgICAgICAgd2hpbGUgc2VsZi5f
cG9vbDoKICAgICAgICAgICAgICAgIGNvbm4gPSBzZWxmLl9wb29sLnBvcCgpCiAgICAgICAgICAg
ICAgICBpZiBjb25uLmlzX2hlYWx0aHkoKToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbl91
c2UuYWRkKGlkKGNvbm4pKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25uCiAgICAgICAg
ICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKQogICAgICAgICAg
ICAgICAgICAgIHNlbGYuX2NyZWF0ZWRfY29ubmVjdGlvbnMgLT0gMQoKICAgICAgICAgICAgIyDQ
odC+0LfQtNCw0ZHQvCDQvdC+0LLQvtC1CiAgICAgICAgICAgIGlmIHNlbGYuX2NyZWF0ZWRfY29u
bmVjdGlvbnMgPCBzZWxmLm1heF9jb25uZWN0aW9uczoKICAgICAgICAgICAgICAgIGNvbm4gPSBS
ZWRpc0Nvbm5lY3Rpb24oKipzZWxmLmNvbm5lY3Rpb25fa3dhcmdzKQogICAgICAgICAgICAgICAg
c2VsZi5fY3JlYXRlZF9jb25uZWN0aW9ucyArPSAxCiAgICAgICAgICAgICAgICBzZWxmLl9pbl91
c2UuYWRkKGlkKGNvbm4pKQogICAgICAgICAgICAgICAgcmV0dXJuIGNvbm4KCiAgICAgICAgICAg
IHJhaXNlIFJlZGlzQ29ubmVjdGlvbkVycm9yKCJDb25uZWN0aW9uIHBvb2wgZXhoYXVzdGVkIikK
CiAgICBkZWYgcmVsZWFzZShzZWxmLCBjb25uOiBSZWRpc0Nvbm5lY3Rpb24pOgogICAgICAgICIi
ItCS0LXRgNC90YPRgtGMINGB0L7QtdC00LjQvdC10L3QuNC1INCyINC/0YPQuyIiIgogICAgICAg
IHdpdGggc2VsZi5fbG9jazoKICAgICAgICAgICAgY29ubl9pZCA9IGlkKGNvbm4pCiAgICAgICAg
ICAgIGlmIGNvbm5faWQgaW4gc2VsZi5faW5fdXNlOgogICAgICAgICAgICAgICAgc2VsZi5faW5f
dXNlLnJlbW92ZShjb25uX2lkKQoKICAgICAgICAgICAgICAgIGlmIGNvbm4uaXNfaGVhbHRoeSgp
OgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3Bvb2wuYXBwZW5kKGNvbm4pCiAgICAgICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKQogICAgICAgICAgICAg
ICAgICAgIHNlbGYuX2NyZWF0ZWRfY29ubmVjdGlvbnMgLT0gMQoKICAgIGRlZiBfaGVhbHRoX2No
ZWNrKHNlbGYpOgogICAgICAgICIiItCf0YDQvtCy0LXRgNC60LAg0LfQtNC+0YDQvtCy0YzRjyDR
gdC+0LXQtNC40L3QtdC90LjQuSDQsiDQv9GD0LvQtSIiIgogICAgICAgIGhlYWx0aHkgPSBbXQog
ICAgICAgIGZvciBjb25uIGluIHNlbGYuX3Bvb2w6CiAgICAgICAgICAgIGlmIGNvbm4uaXNfaGVh
bHRoeSgpOgogICAgICAgICAgICAgICAgaGVhbHRoeS5hcHBlbmQoY29ubikKICAgICAgICAgICAg
ZWxzZToKICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKQogICAgICAgICAgICAgICAgc2VsZi5f
Y3JlYXRlZF9jb25uZWN0aW9ucyAtPSAxCgogICAgICAgIHNlbGYuX3Bvb2wgPSBoZWFsdGh5Cgog
ICAgZGVmIGNsb3NlX2FsbChzZWxmKToKICAgICAgICAiIiLQl9Cw0LrRgNGL0YLRjCDQstGB0LUg
0YHQvtC10LTQuNC90LXQvdC40Y8iIiIKICAgICAgICB3aXRoIHNlbGYuX2xvY2s6CiAgICAgICAg
ICAgIGZvciBjb25uIGluIHNlbGYuX3Bvb2w6CiAgICAgICAgICAgICAgICBjb25uLmNsb3NlKCkK
ICAgICAgICAgICAgc2VsZi5fcG9vbC5jbGVhcigpCiAgICAgICAgICAgIHNlbGYuX2luX3VzZS5j
bGVhcigpCiAgICAgICAgICAgIHNlbGYuX2NyZWF0ZWRfY29ubmVjdGlvbnMgPSAwCgogICAgZGVm
IGV4ZWN1dGVfY29tbWFuZChzZWxmLCAqYXJncywgKiprd2FyZ3MpIC0+IEFueToKICAgICAgICAi
IiLQntCx0YDQsNGC0L3QsNGPINGB0L7QstC80LXRgdGC0LjQvNC+0YHRgtGMINGBIHYxLjAuMDog
0LLRi9C/0L7Qu9C90LjRgtGMINC60L7QvNCw0L3QtNGDINGH0LXRgNC10Lcg0L/Rg9C7CgogICAg
ICAgINCQ0LLRgtC+0LzQsNGC0LjRh9C10YHQutC4INC/0L7Qu9GD0YfQsNC10YIg0YHQvtC10LTQ
uNC90LXQvdC40LUg0LjQtyDQv9GD0LvQsCwg0LLRi9C/0L7Qu9C90Y/QtdGCINC60L7QvNCw0L3Q
tNGDINC4INCy0L7Qt9Cy0YDQsNGJ0LDQtdGCINGB0L7QtdC00LjQvdC10L3QuNC1LgogICAgICAg
INCt0YLQviDQv9C+0LfQstC+0LvRj9C10YIg0LjRgdC/0L7Qu9GM0LfQvtCy0LDRgtGMIENvbm5l
Y3Rpb25Qb29sINC60LDQuiBSZWRpc0Nvbm5lY3Rpb24g0LjQtyB2MS4wLjAuCgogICAgICAgIEV4
YW1wbGU6CiAgICAgICAgICAgIHBvb2wgPSBjbGllbnQuY2x1c3Rlcl9ub2Rlc1snMTcyLjIyLjAu
Njo3MDA0J10KICAgICAgICAgICAgcmVzcG9uc2UgPSBwb29sLmV4ZWN1dGVfY29tbWFuZCgnU0NB
TicsIDAsICdNQVRDSCcsICd1c2VyOionKQogICAgICAgICIiIgogICAgICAgIGNvbm4gPSBzZWxm
LmdldF9jb25uZWN0aW9uKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBjb25uLmV4
ZWN1dGVfY29tbWFuZCgqYXJncywgKiprd2FyZ3MpCiAgICAgICAgZmluYWxseToKICAgICAgICAg
ICAgc2VsZi5yZWxlYXNlKGNvbm4pCgojID09PT09PT09PT09PSBDbHVzdGVyIE5vZGUgPT09PT09
PT09PT09CgpjbGFzcyBDbHVzdGVyTm9kZToKICAgICIiItCY0L3RhNC+0YDQvNCw0YbQuNGPINC+
0LEg0YPQt9C70LUg0LrQu9Cw0YHRgtC10YDQsCIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBo
b3N0OiBzdHIsIHBvcnQ6IGludCwgbm9kZV9pZDogc3RyLCBzbG90czogTGlzdFtpbnRdLAogICAg
ICAgICAgICAgICAgIHJvbGU6IHN0ciA9ICdtYXN0ZXInLCByZXBsaWNhczogT3B0aW9uYWxbTGlz
dFsnQ2x1c3Rlck5vZGUnXV0gPSBOb25lKToKICAgICAgICBzZWxmLmhvc3QgPSBob3N0CiAgICAg
ICAgc2VsZi5wb3J0ID0gcG9ydAogICAgICAgIHNlbGYubm9kZV9pZCA9IG5vZGVfaWQKICAgICAg
ICBzZWxmLnNsb3RzID0gc2xvdHMKICAgICAgICBzZWxmLnJvbGUgPSByb2xlCiAgICAgICAgc2Vs
Zi5yZXBsaWNhcyA9IHJlcGxpY2FzIG9yIFtdCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAg
ICAgIHJldHVybiBmIkNsdXN0ZXJOb2RlKGhvc3Q9e3NlbGYuaG9zdH0sIHBvcnQ9e3NlbGYucG9y
dH0sIHJvbGU9e3NlbGYucm9sZX0sIHNsb3RzPXtsZW4oc2VsZi5zbG90cyl9KSIKCiAgICBkZWYg
X19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZiJ7c2VsZi5ob3N0fTp7c2VsZi5wb3J0fSIK
CgojID09PT09PT09PT09PSBSZWRpcyBDbGllbnQgPT09PT09PT09PT09CgpjbGFzcyBSZWRpc0Ns
aWVudDoKICAgICIiIlByb2R1Y3Rpb24tcmVhZHkgUmVkaXMg0LrQu9C40LXQvdGCINGBINC/0L7Q
u9C90L7QuSDQv9C+0LTQtNC10YDQttC60L7QuSBDbHVzdGVyIiIiCgogICAgZGVmIF9faW5pdF9f
KHNlbGYsIGhvc3Q6IHN0ciA9ICdsb2NhbGhvc3QnLCBwb3J0OiBpbnQgPSA2Mzc5LAogICAgICAg
ICAgICAgICAgIHBhc3N3b3JkOiBPcHRpb25hbFtzdHJdID0gTm9uZSwgdXNlcm5hbWU6IE9wdGlv
bmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICAgICAgIGRiOiBpbnQgPSAwLCBzb2NrZXRfdGlt
ZW91dDogaW50ID0gNSwKICAgICAgICAgICAgICAgICBzc2w6IGJvb2wgPSBGYWxzZSwgc3NsX2Nh
X2NlcnRzOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICAgICAgICAgICBzc2xfY2VydGZp
bGU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBzc2xfa2V5ZmlsZTogT3B0aW9uYWxbc3RyXSA9IE5v
bmUsCiAgICAgICAgICAgICAgICAgc3NsX2NoZWNrX2hvc3RuYW1lOiBib29sID0gVHJ1ZSwgc3Ns
X3ZlcmlmeTogYm9vbCA9IFRydWUsCiAgICAgICAgICAgICAgICAgZGVjb2RlX3Jlc3BvbnNlczog
Ym9vbCA9IEZhbHNlLCBpc19jbHVzdGVyOiBib29sID0gRmFsc2UsCiAgICAgICAgICAgICAgICAg
bWF4X2Nvbm5lY3Rpb25zOiBpbnQgPSA1MCwKICAgICAgICAgICAgICAgICByZWFkX2Zyb21fcmVw
bGljYXM6IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgICAgICByZXBsaWNhX3NlbGVjdG9yOiBz
dHIgPSAncmFuZG9tJywKICAgICAgICAgICAgICAgICBhdXRvX3JlZnJlc2hfdG9wb2xvZ3k6IGJv
b2wgPSBUcnVlLAogICAgICAgICAgICAgICAgIHRvcG9sb2d5X3JlZnJlc2hfaW50ZXJ2YWw6IGlu
dCA9IDMwMCwKICAgICAgICAgICAgICAgICBzZW50aW5lbF9zZXJ2aWNlX25hbWU6IE9wdGlvbmFs
W3N0cl0gPSBOb25lLAogICAgICAgICAgICAgICAgIHNlbnRpbmVsczogT3B0aW9uYWxbTGlzdFtU
dXBsZVtzdHIsIGludF1dXSA9IE5vbmUpOgoKICAgICAgICBzZWxmLmhvc3QgPSBob3N0CiAgICAg
ICAgc2VsZi5wb3J0ID0gcG9ydAogICAgICAgIHNlbGYucGFzc3dvcmQgPSBwYXNzd29yZAogICAg
ICAgIHNlbGYudXNlcm5hbWUgPSB1c2VybmFtZQogICAgICAgIHNlbGYuZGIgPSBkYgogICAgICAg
IHNlbGYuc29ja2V0X3RpbWVvdXQgPSBzb2NrZXRfdGltZW91dAogICAgICAgIHNlbGYuc3NsID0g
c3NsCiAgICAgICAgc2VsZi5zc2xfY2FfY2VydHMgPSBzc2xfY2FfY2VydHMKICAgICAgICBzZWxm
LnNzbF9jZXJ0ZmlsZSA9IHNzbF9jZXJ0ZmlsZQogICAgICAgIHNlbGYuc3NsX2tleWZpbGUgPSBz
c2xfa2V5ZmlsZQogICAgICAgIHNlbGYuc3NsX2NoZWNrX2hvc3RuYW1lID0gc3NsX2NoZWNrX2hv
c3RuYW1lCiAgICAgICAgc2VsZi5zc2xfdmVyaWZ5ID0gc3NsX3ZlcmlmeQogICAgICAgIHNlbGYu
ZGVjb2RlX3Jlc3BvbnNlcyA9IGRlY29kZV9yZXNwb25zZXMKICAgICAgICBzZWxmLmlzX2NsdXN0
ZXIgPSBpc19jbHVzdGVyCiAgICAgICAgc2VsZi5tYXhfY29ubmVjdGlvbnMgPSBtYXhfY29ubmVj
dGlvbnMKCiAgICAgICAgIyBSZXBsaWNhIHN1cHBvcnQKICAgICAgICBzZWxmLnJlYWRfZnJvbV9y
ZXBsaWNhcyA9IHJlYWRfZnJvbV9yZXBsaWNhcwogICAgICAgIHNlbGYucmVwbGljYV9zZWxlY3Rv
ciA9IHJlcGxpY2Ffc2VsZWN0b3IKCiAgICAgICAgIyBUb3BvbG9neSByZWZyZXNoCiAgICAgICAg
c2VsZi5hdXRvX3JlZnJlc2hfdG9wb2xvZ3kgPSBhdXRvX3JlZnJlc2hfdG9wb2xvZ3kKICAgICAg
ICBzZWxmLnRvcG9sb2d5X3JlZnJlc2hfaW50ZXJ2YWwgPSB0b3BvbG9neV9yZWZyZXNoX2ludGVy
dmFsCiAgICAgICAgc2VsZi5fbGFzdF90b3BvbG9neV9yZWZyZXNoID0gMAoKICAgICAgICAjIFNl
bnRpbmVsIHN1cHBvcnQKICAgICAgICBzZWxmLnNlbnRpbmVsX3NlcnZpY2VfbmFtZSA9IHNlbnRp
bmVsX3NlcnZpY2VfbmFtZQogICAgICAgIHNlbGYuc2VudGluZWxzID0gc2VudGluZWxzCgogICAg
ICAgICMgQ2x1c3RlciBzdGF0ZQogICAgICAgIHNlbGYuY2x1c3Rlcl9wb29sczogRGljdFtzdHIs
IENvbm5lY3Rpb25Qb29sXSA9IHt9CiAgICAgICAgc2VsZi5jbHVzdGVyX3Nsb3RzOiBEaWN0W2lu
dCwgc3RyXSA9IHt9CiAgICAgICAgc2VsZi5jbHVzdGVyX25vZGVzX2luZm86IERpY3Rbc3RyLCBD
bHVzdGVyTm9kZV0gPSB7fQogICAgICAgIHNlbGYuX3Bvb2xfbG9jayA9IExvY2soKQoKICAgICAg
ICAjIEx1YSBzY3JpcHQgY2FjaGUgKFNIQTEg0YXQtdGI0LgpCiAgICAgICAgc2VsZi5fc2NyaXB0
X2NhY2hlOiBEaWN0W3N0ciwgc3RyXSA9IHt9CgogICAgICAgICMgTWFpbiBjb25uZWN0aW9uIHBv
b2wKICAgICAgICBpZiBzZW50aW5lbHMgYW5kIHNlbnRpbmVsX3NlcnZpY2VfbmFtZToKICAgICAg
ICAgICAgbWFzdGVyX2hvc3QsIG1hc3Rlcl9wb3J0ID0gc2VsZi5fZGlzY292ZXJfbWFzdGVyX2Zy
b21fc2VudGluZWwoKQogICAgICAgICAgICBzZWxmLmhvc3QgPSBtYXN0ZXJfaG9zdAogICAgICAg
ICAgICBzZWxmLnBvcnQgPSBtYXN0ZXJfcG9ydAoKICAgICAgICBzZWxmLm1haW5fcG9vbCA9IENv
bm5lY3Rpb25Qb29sKAogICAgICAgICAgICBob3N0PXNlbGYuaG9zdCwgcG9ydD1zZWxmLnBvcnQs
CiAgICAgICAgICAgIHBhc3N3b3JkPXBhc3N3b3JkLCB1c2VybmFtZT11c2VybmFtZSwKICAgICAg
ICAgICAgZGI9ZGIsIHNvY2tldF90aW1lb3V0PXNvY2tldF90aW1lb3V0LAogICAgICAgICAgICBz
c2w9c3NsLCBzc2xfY2FfY2VydHM9c3NsX2NhX2NlcnRzLAogICAgICAgICAgICBzc2xfY2VydGZp
bGU9c3NsX2NlcnRmaWxlLCBzc2xfa2V5ZmlsZT1zc2xfa2V5ZmlsZSwKICAgICAgICAgICAgc3Ns
X2NoZWNrX2hvc3RuYW1lPXNzbF9jaGVja19ob3N0bmFtZSwgc3NsX3ZlcmlmeT1zc2xfdmVyaWZ5
LAogICAgICAgICAgICBtYXhfY29ubmVjdGlvbnM9bWF4X2Nvbm5lY3Rpb25zCiAgICAgICAgKQoK
ICAgICAgICBpZiBzZWxmLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgIHNlbGYuX2xvYWRfY2x1c3Rl
cl90b3BvbG9neSgpCgogICAgIyA9PT09PT09PT09PT0gQmFja3dhcmQgQ29tcGF0aWJpbGl0eSBQ
cm9wZXJ0aWVzID09PT09PT09PT09PQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGNsdXN0ZXJfbm9k
ZXMoc2VsZikgLT4gRGljdFtzdHIsIENvbm5lY3Rpb25Qb29sXToKICAgICAgICAiIiJCYWNrd2Fy
ZCBjb21wYXRpYmlsaXR5OiBjbHVzdGVyX25vZGVzINGC0LXQv9C10YDRjCDRg9C60LDQt9GL0LLQ
sNC10YIg0L3QsCBjbHVzdGVyX3Bvb2xzCgogICAgICAgINCSIHYxLjAuMDogY2x1c3Rlcl9ub2Rl
cyDQsdGL0LsgRGljdFtzdHIsIFJlZGlzQ29ubmVjdGlvbl0KICAgICAgICDQkiB2Mi4xLjArOiBj
bHVzdGVyX3Bvb2xzIC0gRGljdFtzdHIsIENvbm5lY3Rpb25Qb29sXQoKICAgICAgICDQlNC70Y8g
0YHQvtCy0LzQtdGB0YLQuNC80L7RgdGC0Lgg0LLQvtC30LLRgNCw0YnQsNC10LwgY2x1c3Rlcl9w
b29scy4KICAgICAgICDQp9GC0L7QsdGLINC/0L7Qu9GD0YfQuNGC0Ywg0YHQvtC10LTQuNC90LXQ
vdC40LU6IHBvb2wuZ2V0X2Nvbm5lY3Rpb24oKQogICAgICAgICIiIgogICAgICAgIHJldHVybiBz
ZWxmLmNsdXN0ZXJfcG9vbHMKCiAgICBkZWYgX2Rpc2NvdmVyX21hc3Rlcl9mcm9tX3NlbnRpbmVs
KHNlbGYpIC0+IFR1cGxlW3N0ciwgaW50XToKICAgICAgICAiIiLQn9C+0LvRg9GH0LjRgtGMINCw
0LTRgNC10YEg0LzQsNGB0YLQtdGA0LAg0YfQtdGA0LXQtyBTZW50aW5lbCIiIgogICAgICAgIGlm
IG5vdCBzZWxmLnNlbnRpbmVscyBvciBub3Qgc2VsZi5zZW50aW5lbF9zZXJ2aWNlX25hbWU6CiAg
ICAgICAgICAgIHJhaXNlIFJlZGlzRXJyb3IoIlNlbnRpbmVscyBub3QgY29uZmlndXJlZCIpCgog
ICAgICAgIGZvciBzZW50aW5lbF9ob3N0LCBzZW50aW5lbF9wb3J0IGluIHNlbGYuc2VudGluZWxz
OgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZW50aW5lbF9jb25uID0gUmVkaXND
b25uZWN0aW9uKAogICAgICAgICAgICAgICAgICAgIGhvc3Q9c2VudGluZWxfaG9zdCwgcG9ydD1z
ZW50aW5lbF9wb3J0LAogICAgICAgICAgICAgICAgICAgIHNvY2tldF90aW1lb3V0PXNlbGYuc29j
a2V0X3RpbWVvdXQKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICByZXNwb25zZSA9
IHNlbnRpbmVsX2Nvbm4uZXhlY3V0ZV9jb21tYW5kKAogICAgICAgICAgICAgICAgICAgICdTRU5U
SU5FTCcsICdnZXQtbWFzdGVyLWFkZHItYnktbmFtZScsIHNlbGYuc2VudGluZWxfc2VydmljZV9u
YW1lCiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgc2VudGluZWxfY29ubi5jbG9z
ZSgpCgogICAgICAgICAgICAgICAgaWYgcmVzcG9uc2UgYW5kIGxlbihyZXNwb25zZSkgPT0gMjoK
ICAgICAgICAgICAgICAgICAgICBtYXN0ZXJfaG9zdCA9IHJlc3BvbnNlWzBdLmRlY29kZSgndXRm
LTgnKSBpZiBpc2luc3RhbmNlKHJlc3BvbnNlWzBdLCBieXRlcykgZWxzZSByZXNwb25zZVswXQog
ICAgICAgICAgICAgICAgICAgIG1hc3Rlcl9wb3J0ID0gaW50KHJlc3BvbnNlWzFdKQogICAgICAg
ICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiRGlzY292ZXJlZCBtYXN0ZXIgZnJvbSBzZW50aW5l
bDoge21hc3Rlcl9ob3N0fTp7bWFzdGVyX3BvcnR9IikKICAgICAgICAgICAgICAgICAgICByZXR1
cm4gbWFzdGVyX2hvc3QsIG1hc3Rlcl9wb3J0CgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9u
IGFzIGU6CiAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIkZhaWxlZCB0byBjb250YWN0
IHNlbnRpbmVsIHtzZW50aW5lbF9ob3N0fTp7c2VudGluZWxfcG9ydH06IHtlfSIpCgogICAgICAg
IHJhaXNlIFJlZGlzQ29ubmVjdGlvbkVycm9yKCJGYWlsZWQgdG8gZGlzY292ZXIgbWFzdGVyIGZy
b20gYWxsIHNlbnRpbmVscyIpCgogICAgZGVmIF9sb2FkX2NsdXN0ZXJfdG9wb2xvZ3koc2VsZiwg
Zm9yY2U6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgIiIi0JfQsNCz0YDRg9C30LrQsCDRgtC+0L/Q
vtC70L7Qs9C40Lgg0LrQu9Cw0YHRgtC10YDQsCIiIgogICAgICAgIGN1cnJlbnRfdGltZSA9IHRp
bWUudGltZSgpCgogICAgICAgIGlmIG5vdCBmb3JjZSBhbmQgY3VycmVudF90aW1lIC0gc2VsZi5f
bGFzdF90b3BvbG9neV9yZWZyZXNoIDwgc2VsZi50b3BvbG9neV9yZWZyZXNoX2ludGVydmFsOgog
ICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb25uID0gc2VsZi5t
YWluX3Bvb2wuZ2V0X2Nvbm5lY3Rpb24oKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAg
ICBzbG90c19pbmZvID0gY29ubi5leGVjdXRlX2NvbW1hbmQoJ0NMVVNURVInLCAnU0xPVFMnKQog
ICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgc2VsZi5tYWluX3Bvb2wucmVsZWFz
ZShjb25uKQoKICAgICAgICAgICAgbmV3X3Nsb3RzID0ge30KICAgICAgICAgICAgbmV3X25vZGVz
ID0ge30KCiAgICAgICAgICAgIGZvciBzbG90X3JhbmdlIGluIHNsb3RzX2luZm86CiAgICAgICAg
ICAgICAgICBzdGFydF9zbG90ID0gc2xvdF9yYW5nZVswXQogICAgICAgICAgICAgICAgZW5kX3Ns
b3QgPSBzbG90X3JhbmdlWzFdCiAgICAgICAgICAgICAgICBtYXN0ZXJfaW5mbyA9IHNsb3RfcmFu
Z2VbMl0KCiAgICAgICAgICAgICAgICBtYXN0ZXJfaG9zdCA9IG1hc3Rlcl9pbmZvWzBdLmRlY29k
ZSgndXRmLTgnKSBpZiBpc2luc3RhbmNlKG1hc3Rlcl9pbmZvWzBdLCBieXRlcykgZWxzZSBtYXN0
ZXJfaW5mb1swXQogICAgICAgICAgICAgICAgbWFzdGVyX3BvcnQgPSBtYXN0ZXJfaW5mb1sxXQog
ICAgICAgICAgICAgICAgbWFzdGVyX2lkID0gZiJ7bWFzdGVyX2hvc3R9OnttYXN0ZXJfcG9ydH0i
CgogICAgICAgICAgICAgICAgIyDQoNC10L/Qu9C40LrQuAogICAgICAgICAgICAgICAgcmVwbGlj
YXMgPSBbXQogICAgICAgICAgICAgICAgZm9yIHJlcGxpY2FfaW5mbyBpbiBzbG90X3JhbmdlWzM6
XToKICAgICAgICAgICAgICAgICAgICByZXBsaWNhX2hvc3QgPSByZXBsaWNhX2luZm9bMF0uZGVj
b2RlKCd1dGYtOCcpIGlmIGlzaW5zdGFuY2UocmVwbGljYV9pbmZvWzBdLCBieXRlcykgZWxzZSBy
ZXBsaWNhX2luZm9bMF0KICAgICAgICAgICAgICAgICAgICByZXBsaWNhX3BvcnQgPSByZXBsaWNh
X2luZm9bMV0KICAgICAgICAgICAgICAgICAgICByZXBsaWNhX2lkID0gZiJ7cmVwbGljYV9ob3N0
fTp7cmVwbGljYV9wb3J0fSIKCiAgICAgICAgICAgICAgICAgICAgcmVwbGljYV9ub2RlID0gQ2x1
c3Rlck5vZGUoCiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q9cmVwbGljYV9ob3N0LAogICAg
ICAgICAgICAgICAgICAgICAgICBwb3J0PXJlcGxpY2FfcG9ydCwKICAgICAgICAgICAgICAgICAg
ICAgICAgbm9kZV9pZD1yZXBsaWNhX2lkLAogICAgICAgICAgICAgICAgICAgICAgICBzbG90cz1b
XSwKICAgICAgICAgICAgICAgICAgICAgICAgcm9sZT0ncmVwbGljYScKICAgICAgICAgICAgICAg
ICAgICApCiAgICAgICAgICAgICAgICAgICAgcmVwbGljYXMuYXBwZW5kKHJlcGxpY2Ffbm9kZSkK
CiAgICAgICAgICAgICAgICAgICAgIyDQodC+0LfQtNCw0ZHQvCDQv9GD0Lsg0LTQu9GPINGA0LXQ
v9C70LjQutC4CiAgICAgICAgICAgICAgICAgICAgaWYgcmVwbGljYV9pZCBub3QgaW4gc2VsZi5j
bHVzdGVyX3Bvb2xzOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsdXN0ZXJfcG9vbHNb
cmVwbGljYV9pZF0gPSBDb25uZWN0aW9uUG9vbCgKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGhvc3Q9cmVwbGljYV9ob3N0LCBwb3J0PXJlcGxpY2FfcG9ydCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBhc3N3b3JkPXNlbGYucGFzc3dvcmQsIHVzZXJuYW1lPXNlbGYudXNlcm5hbWUs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRfdGltZW91dD1zZWxmLnNvY2tldF90
aW1lb3V0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3NsPXNlbGYuc3NsLCBzc2xfY2Ff
Y2VydHM9c2VsZi5zc2xfY2FfY2VydHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzc2xf
Y2VydGZpbGU9c2VsZi5zc2xfY2VydGZpbGUsIHNzbF9rZXlmaWxlPXNlbGYuc3NsX2tleWZpbGUs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzc2xfY2hlY2tfaG9zdG5hbWU9c2VsZi5zc2xf
Y2hlY2tfaG9zdG5hbWUsIHNzbF92ZXJpZnk9c2VsZi5zc2xfdmVyaWZ5LAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbWF4X2Nvbm5lY3Rpb25zPXNlbGYubWF4X2Nvbm5lY3Rpb25zCiAgICAg
ICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICAjINCh0L7Qt9C00LDRkdC8INC4
0LvQuCDQvtCx0L3QvtCy0LvRj9C10Lwg0YPQt9C10Lsg0LzQsNGB0YLQtdGA0LAKICAgICAgICAg
ICAgICAgIHNsb3RzX2Zvcl9tYXN0ZXIgPSBsaXN0KHJhbmdlKHN0YXJ0X3Nsb3QsIGVuZF9zbG90
ICsgMSkpCgogICAgICAgICAgICAgICAgaWYgbWFzdGVyX2lkIGluIG5ld19ub2RlczoKICAgICAg
ICAgICAgICAgICAgICBuZXdfbm9kZXNbbWFzdGVyX2lkXS5zbG90cy5leHRlbmQoc2xvdHNfZm9y
X21hc3RlcikKICAgICAgICAgICAgICAgICAgICBuZXdfbm9kZXNbbWFzdGVyX2lkXS5yZXBsaWNh
cy5leHRlbmQocmVwbGljYXMpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAg
ICAgIG5ld19ub2Rlc1ttYXN0ZXJfaWRdID0gQ2x1c3Rlck5vZGUoCiAgICAgICAgICAgICAgICAg
ICAgICAgIGhvc3Q9bWFzdGVyX2hvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcnQ9bWFz
dGVyX3BvcnQsCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfaWQ9bWFzdGVyX2lkLAogICAg
ICAgICAgICAgICAgICAgICAgICBzbG90cz1zbG90c19mb3JfbWFzdGVyLAogICAgICAgICAgICAg
ICAgICAgICAgICByb2xlPSdtYXN0ZXInLAogICAgICAgICAgICAgICAgICAgICAgICByZXBsaWNh
cz1yZXBsaWNhcwogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICAjINCc0LDQ
v9C/0LjQvdCzINGB0LvQvtGC0L7QsgogICAgICAgICAgICAgICAgZm9yIHNsb3QgaW4gc2xvdHNf
Zm9yX21hc3RlcjoKICAgICAgICAgICAgICAgICAgICBuZXdfc2xvdHNbc2xvdF0gPSBtYXN0ZXJf
aWQKCiAgICAgICAgICAgICAgICAjINCh0L7Qt9C00LDRkdC8INC/0YPQuyDQtNC70Y8g0LzQsNGB
0YLQtdGA0LAKICAgICAgICAgICAgICAgIGlmIG1hc3Rlcl9pZCBub3QgaW4gc2VsZi5jbHVzdGVy
X3Bvb2xzOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY2x1c3Rlcl9wb29sc1ttYXN0ZXJfaWRd
ID0gQ29ubmVjdGlvblBvb2woCiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q9bWFzdGVyX2hv
c3QsIHBvcnQ9bWFzdGVyX3BvcnQsCiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPXNl
bGYucGFzc3dvcmQsIHVzZXJuYW1lPXNlbGYudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgICAg
ICAgIHNvY2tldF90aW1lb3V0PXNlbGYuc29ja2V0X3RpbWVvdXQsCiAgICAgICAgICAgICAgICAg
ICAgICAgIHNzbD1zZWxmLnNzbCwgc3NsX2NhX2NlcnRzPXNlbGYuc3NsX2NhX2NlcnRzLAogICAg
ICAgICAgICAgICAgICAgICAgICBzc2xfY2VydGZpbGU9c2VsZi5zc2xfY2VydGZpbGUsIHNzbF9r
ZXlmaWxlPXNlbGYuc3NsX2tleWZpbGUsCiAgICAgICAgICAgICAgICAgICAgICAgIHNzbF9jaGVj
a19ob3N0bmFtZT1zZWxmLnNzbF9jaGVja19ob3N0bmFtZSwgc3NsX3ZlcmlmeT1zZWxmLnNzbF92
ZXJpZnksCiAgICAgICAgICAgICAgICAgICAgICAgIG1heF9jb25uZWN0aW9ucz1zZWxmLm1heF9j
b25uZWN0aW9ucwogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIHNlbGYuY2x1c3Rl
cl9zbG90cyA9IG5ld19zbG90cwogICAgICAgICAgICBzZWxmLmNsdXN0ZXJfbm9kZXNfaW5mbyA9
IG5ld19ub2RlcwogICAgICAgICAgICBzZWxmLl9sYXN0X3RvcG9sb2d5X3JlZnJlc2ggPSBjdXJy
ZW50X3RpbWUKCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiTG9hZGVkIGNsdXN0ZXIgdG9wb2xv
Z3k6IHtsZW4obmV3X25vZGVzKX0gbm9kZXMsIHtsZW4obmV3X3Nsb3RzKX0gc2xvdHMiKQoKICAg
ICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZh
aWxlZCB0byBsb2FkIGNsdXN0ZXIgdG9wb2xvZ3k6IHtlfSIpCgogICAgZGVmIF9nZXRfc2xvdChz
ZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6CiAgICAgICAgIiIiQ1JDMTYgaGFz
aCBzbG90IGNhbGN1bGF0aW9uIiIiCiAgICAgICAgaWYgaXNpbnN0YW5jZShrZXksIHN0cik6CiAg
ICAgICAgICAgIGtleSA9IGtleS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgIyBIYXNoIHRhZyBz
dXBwb3J0CiAgICAgICAgc3RhcnQgPSBrZXkuZmluZChiJ3snKQogICAgICAgIGlmIHN0YXJ0ICE9
IC0xOgogICAgICAgICAgICBlbmQgPSBrZXkuZmluZChiJ30nLCBzdGFydCArIDEpCiAgICAgICAg
ICAgIGlmIGVuZCAhPSAtMSBhbmQgZW5kID4gc3RhcnQgKyAxOgogICAgICAgICAgICAgICAga2V5
ID0ga2V5W3N0YXJ0ICsgMTplbmRdCgogICAgICAgIGNyYyA9IDAKICAgICAgICBmb3IgYnl0ZSBp
biBrZXk6CiAgICAgICAgICAgIGNyYyBePSBieXRlIDw8IDgKICAgICAgICAgICAgZm9yIF8gaW4g
cmFuZ2UoOCk6CiAgICAgICAgICAgICAgICBpZiBjcmMgJiAweDgwMDA6CiAgICAgICAgICAgICAg
ICAgICAgY3JjID0gKGNyYyA8PCAxKSBeIDB4MTAyMQogICAgICAgICAgICAgICAgZWxzZToKICAg
ICAgICAgICAgICAgICAgICBjcmMgPSBjcmMgPDwgMQogICAgICAgICAgICBjcmMgJj0gMHhGRkZG
CgogICAgICAgIHJldHVybiBjcmMgJSAxNjM4NAoKICAgIGRlZiBfZ2V0X3Bvb2xfZm9yX2tleShz
ZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCBmb3JfcmVhZDogYm9vbCA9IEZhbHNlKSAtPiBD
b25uZWN0aW9uUG9vbDoKICAgICAgICAiIiLQn9C+0LvRg9GH0LjRgtGMINC/0YPQuyDRgdC+0LXQ
tNC40L3QtdC90LjQuSDQtNC70Y8g0LrQu9GO0YfQsCIiIgogICAgICAgIGlmIG5vdCBzZWxmLmlz
X2NsdXN0ZXI6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm1haW5fcG9vbAoKICAgICAgICAjINCQ
0LLRgtC+0L7QsdC90L7QstC70LXQvdC40LUg0YLQvtC/0L7Qu9C+0LPQuNC4CiAgICAgICAgaWYg
c2VsZi5hdXRvX3JlZnJlc2hfdG9wb2xvZ3k6CiAgICAgICAgICAgIHNlbGYuX2xvYWRfY2x1c3Rl
cl90b3BvbG9neSgpCgogICAgICAgIHNsb3QgPSBzZWxmLl9nZXRfc2xvdChrZXkpCiAgICAgICAg
bm9kZV9pZCA9IHNlbGYuY2x1c3Rlcl9zbG90cy5nZXQoc2xvdCkKCiAgICAgICAgaWYgbm90IG5v
ZGVfaWQ6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm1haW5fcG9vbAoKICAgICAgICAjINCV0YHQ
u9C4INGH0LjRgtCw0LXQvCDQuCDQstC60LvRjtGH0LXQvdC+INGH0YLQtdC90LjQtSDRgSDRgNC1
0L/Qu9C40LoKICAgICAgICBpZiBmb3JfcmVhZCBhbmQgc2VsZi5yZWFkX2Zyb21fcmVwbGljYXM6
CiAgICAgICAgICAgIG5vZGVfaW5mbyA9IHNlbGYuY2x1c3Rlcl9ub2Rlc19pbmZvLmdldChub2Rl
X2lkKQogICAgICAgICAgICBpZiBub2RlX2luZm8gYW5kIG5vZGVfaW5mby5yZXBsaWNhczoKICAg
ICAgICAgICAgICAgIGlmIHNlbGYucmVwbGljYV9zZWxlY3RvciA9PSAncmFuZG9tJzoKICAgICAg
ICAgICAgICAgICAgICByZXBsaWNhID0gcmFuZG9tLmNob2ljZShub2RlX2luZm8ucmVwbGljYXMp
CiAgICAgICAgICAgICAgICAgICAgcmVwbGljYV9wb29sID0gc2VsZi5jbHVzdGVyX3Bvb2xzLmdl
dChyZXBsaWNhLm5vZGVfaWQpCiAgICAgICAgICAgICAgICAgICAgaWYgcmVwbGljYV9wb29sOgog
ICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVwbGljYV9wb29sCiAgICAgICAgICAgICAg
ICBlbGlmIHNlbGYucmVwbGljYV9zZWxlY3RvciA9PSAncm91bmRfcm9iaW4nOgogICAgICAgICAg
ICAgICAgICAgICMg0J/RgNC+0YHRgtCw0Y8g0YDQtdCw0LvQuNC30LDRhtC40Y8gcm91bmQtcm9i
aW4KICAgICAgICAgICAgICAgICAgICByZXBsaWNhID0gbm9kZV9pbmZvLnJlcGxpY2FzW2hhc2go
a2V5KSAlIGxlbihub2RlX2luZm8ucmVwbGljYXMpXQogICAgICAgICAgICAgICAgICAgIHJlcGxp
Y2FfcG9vbCA9IHNlbGYuY2x1c3Rlcl9wb29scy5nZXQocmVwbGljYS5ub2RlX2lkKQogICAgICAg
ICAgICAgICAgICAgIGlmIHJlcGxpY2FfcG9vbDoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIHJlcGxpY2FfcG9vbAoKICAgICAgICBwb29sID0gc2VsZi5jbHVzdGVyX3Bvb2xzLmdldChu
b2RlX2lkKQogICAgICAgIHJldHVybiBwb29sIGlmIHBvb2wgZWxzZSBzZWxmLm1haW5fcG9vbAoK
ICAgIGRlZiBleGVjdXRlX2NvbW1hbmQoc2VsZiwgKmFyZ3MsIGtleTogT3B0aW9uYWxbVW5pb25b
c3RyLCBieXRlc11dID0gTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICBmb3JfcmVhZDogYm9v
bCA9IEZhbHNlKSAtPiBBbnk6CiAgICAgICAgIiIi0JLRi9C/0L7Qu9C90LXQvdC40LUg0LrQvtC8
0LDQvdC00Ysg0YEg0L/QvtC00LTQtdGA0LbQutC+0Lkg0LrQu9Cw0YHRgtC10YDQsCDQuCDRgNC1
0LTQuNGA0LXQutGC0L7QsiIiIgogICAgICAgIG1heF9yZWRpcmVjdHMgPSA1CiAgICAgICAgcmVk
aXJlY3RfY291bnQgPSAwCgogICAgICAgIGlmIGtleSBpcyBOb25lIGFuZCBsZW4oYXJncykgPiAx
OgogICAgICAgICAgICBrZXkgPSBhcmdzWzFdCgogICAgICAgIHBvb2wgPSBzZWxmLl9nZXRfcG9v
bF9mb3Jfa2V5KGtleSwgZm9yX3JlYWQ9Zm9yX3JlYWQpIGlmIGtleSBlbHNlIHNlbGYubWFpbl9w
b29sCgogICAgICAgIHdoaWxlIHJlZGlyZWN0X2NvdW50IDwgbWF4X3JlZGlyZWN0czoKICAgICAg
ICAgICAgY29ubiA9IHBvb2wuZ2V0X2Nvbm5lY3Rpb24oKQogICAgICAgICAgICB0cnk6CiAgICAg
ICAgICAgICAgICByZXNwb25zZSA9IGNvbm4uZXhlY3V0ZV9jb21tYW5kKCphcmdzKQoKICAgICAg
ICAgICAgICAgIGlmIHNlbGYuZGVjb2RlX3Jlc3BvbnNlczoKICAgICAgICAgICAgICAgICAgICBy
ZXNwb25zZSA9IHNlbGYuX2RlY29kZV9yZXNwb25zZShyZXNwb25zZSkKCiAgICAgICAgICAgICAg
ICByZXR1cm4gcmVzcG9uc2UKCiAgICAgICAgICAgIGV4Y2VwdCBSZWRpc0Vycm9yIGFzIGU6CiAg
ICAgICAgICAgICAgICBlcnJvcl9tc2cgPSBzdHIoZSkKCiAgICAgICAgICAgICAgICBpZiBlcnJv
cl9tc2cuc3RhcnRzd2l0aCgnTU9WRUQnKToKICAgICAgICAgICAgICAgICAgICAjINCe0LHQvdC+
0LLQu9GP0LXQvCDRgtC+0L/QvtC70L7Qs9C40Y4KICAgICAgICAgICAgICAgICAgICBwYXJ0cyA9
IGVycm9yX21zZy5zcGxpdCgpCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHBhcnRzKSA+PSAz
OgogICAgICAgICAgICAgICAgICAgICAgICBzbG90ID0gaW50KHBhcnRzWzFdKQogICAgICAgICAg
ICAgICAgICAgICAgICBub2RlX2FkZHIgPSBwYXJ0c1syXQogICAgICAgICAgICAgICAgICAgICAg
ICBob3N0LCBwb3J0X3N0ciA9IG5vZGVfYWRkci5zcGxpdCgnOicpCiAgICAgICAgICAgICAgICAg
ICAgICAgIHBvcnQgPSBpbnQocG9ydF9zdHIpCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVf
aWQgPSBmIntob3N0fTp7cG9ydH0iCgogICAgICAgICAgICAgICAgICAgICAgICAjINCh0L7Qt9C0
0LDRkdC8INC90L7QstGL0Lkg0L/Rg9C7INC10YHQu9C4INC90YPQttC90L4KICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgbm9kZV9pZCBub3QgaW4gc2VsZi5jbHVzdGVyX3Bvb2xzOgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2VsZi5jbHVzdGVyX3Bvb2xzW25vZGVfaWRdID0gQ29ubmVj
dGlvblBvb2woCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdD1ob3N0LCBwb3J0
PXBvcnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ9c2VsZi5wYXNz
d29yZCwgdXNlcm5hbWU9c2VsZi51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzb2NrZXRfdGltZW91dD1zZWxmLnNvY2tldF90aW1lb3V0LAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHNzbD1zZWxmLnNzbCwgc3NsX2NhX2NlcnRzPXNlbGYuc3NsX2NhX2Nl
cnRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNzbF9jZXJ0ZmlsZT1zZWxmLnNz
bF9jZXJ0ZmlsZSwgc3NsX2tleWZpbGU9c2VsZi5zc2xfa2V5ZmlsZSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzc2xfY2hlY2tfaG9zdG5hbWU9c2VsZi5zc2xfY2hlY2tfaG9zdG5h
bWUsIHNzbF92ZXJpZnk9c2VsZi5zc2xfdmVyaWZ5LAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG1heF9jb25uZWN0aW9ucz1zZWxmLm1heF9jb25uZWN0aW9ucwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jbHVzdGVyX3Ns
b3RzW3Nsb3RdID0gbm9kZV9pZAogICAgICAgICAgICAgICAgICAgICAgICBwb29sID0gc2VsZi5j
bHVzdGVyX3Bvb2xzW25vZGVfaWRdCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0X2Nv
dW50ICs9IDEKCiAgICAgICAgICAgICAgICAgICAgICAgICMg0KTQvtGA0YHQuNGA0YPQtdC8INC+
0LHQvdC+0LLQu9C10L3QuNC1INGC0L7Qv9C+0LvQvtCz0LjQuAogICAgICAgICAgICAgICAgICAg
ICAgICBpZiBzZWxmLmF1dG9fcmVmcmVzaF90b3BvbG9neToKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHNlbGYuX2xvYWRfY2x1c3Rlcl90b3BvbG9neShmb3JjZT1UcnVlKQoKICAgICAgICAg
ICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICAgICBlbGlmIGVycm9yX21zZy5z
dGFydHN3aXRoKCdBU0snKToKICAgICAgICAgICAgICAgICAgICBwYXJ0cyA9IGVycm9yX21zZy5z
cGxpdCgpCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHBhcnRzKSA+PSAzOgogICAgICAgICAg
ICAgICAgICAgICAgICBub2RlX2FkZHIgPSBwYXJ0c1syXQogICAgICAgICAgICAgICAgICAgICAg
ICBob3N0LCBwb3J0X3N0ciA9IG5vZGVfYWRkci5zcGxpdCgnOicpCgogICAgICAgICAgICAgICAg
ICAgICAgICB0ZW1wX2Nvbm4gPSBSZWRpc0Nvbm5lY3Rpb24oCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBob3N0PWhvc3QsIHBvcnQ9aW50KHBvcnRfc3RyKSwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBhc3N3b3JkPXNlbGYucGFzc3dvcmQsIHVzZXJuYW1lPXNlbGYudXNlcm5hbWUs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRfdGltZW91dD1zZWxmLnNvY2tldF90
aW1lb3V0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3NsPXNlbGYuc3NsLCBzc2xfY2Ff
Y2VydHM9c2VsZi5zc2xfY2FfY2VydHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzc2xf
Y2VydGZpbGU9c2VsZi5zc2xfY2VydGZpbGUsIHNzbF9rZXlmaWxlPXNlbGYuc3NsX2tleWZpbGUs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzc2xfY2hlY2tfaG9zdG5hbWU9c2VsZi5zc2xf
Y2hlY2tfaG9zdG5hbWUsIHNzbF92ZXJpZnk9c2VsZi5zc2xfdmVyaWZ5CiAgICAgICAgICAgICAg
ICAgICAgICAgICkKCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRlbXBfY29ubi5leGVjdXRlX2NvbW1hbmQoJ0FTS0lORycpCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IHRlbXBfY29ubi5leGVjdXRlX2NvbW1hbmQo
KmFyZ3MpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5kZWNvZGVfcmVzcG9u
c2VzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5fZGVj
b2RlX3Jlc3BvbnNlKHJlc3BvbnNlKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
biByZXNwb25zZQogICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdGVtcF9jb25uLmNsb3NlKCkKCiAgICAgICAgICAgICAgICByYWlzZQoK
ICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHBvb2wucmVsZWFzZShjb25uKQoK
ICAgICAgICByYWlzZSBSZWRpc0NsdXN0ZXJFcnJvcigiVG9vIG1hbnkgcmVkaXJlY3RzIikKCiAg
ICBkZWYgX2RlY29kZV9yZXNwb25zZShzZWxmLCByZXNwb25zZSk6CiAgICAgICAgIiIi0JTQtdC6
0L7QtNC40YDQvtCy0LDQvdC40LUg0L7RgtCy0LXRgtCwIiIiCiAgICAgICAgaWYgaXNpbnN0YW5j
ZShyZXNwb25zZSwgYnl0ZXMpOgogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGVjb2RlKCd1
dGYtOCcsIGVycm9ycz0ncmVwbGFjZScpCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3BvbnNl
LCBsaXN0KToKICAgICAgICAgICAgcmV0dXJuIFtzZWxmLl9kZWNvZGVfcmVzcG9uc2UoaXRlbSkg
Zm9yIGl0ZW0gaW4gcmVzcG9uc2VdCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3BvbnNlLCBk
aWN0KToKICAgICAgICAgICAgcmV0dXJuIHtzZWxmLl9kZWNvZGVfcmVzcG9uc2Uoayk6IHNlbGYu
X2RlY29kZV9yZXNwb25zZSh2KSAKICAgICAgICAgICAgICAgICAgIGZvciBrLCB2IGluIHJlc3Bv
bnNlLml0ZW1zKCl9CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlCgogICAgIyA9PT09PT09PT09PT0g
TXVsdGkta2V5INC60L7QvNCw0L3QtNGLID09PT09PT09PT09PQoKICAgIGRlZiBtZ2V0KHNlbGYs
ICprZXlzKSAtPiBMaXN0W09wdGlvbmFsW2J5dGVzXV06CiAgICAgICAgIiIiTUdFVCDRgSDQs9GA
0YPQv9C/0LjRgNC+0LLQutC+0Lkg0L/QviDRgdC70L7RgtCw0LwiIiIKICAgICAgICBpZiBub3Qg
c2VsZi5pc19jbHVzdGVyOgogICAgICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQo
J01HRVQnLCAqa2V5cykKCiAgICAgICAgIyDQk9GA0YPQv9C/0LjRgNC+0LLQutCwINC60LvRjtGH
0LXQuSDQv9C+INGB0LvQvtGC0LDQvAogICAgICAgIHNsb3RfZ3JvdXBzID0gZGVmYXVsdGRpY3Qo
bGlzdCkKICAgICAgICBrZXlfb3JkZXIgPSB7fQoKICAgICAgICBmb3IgaWR4LCBrZXkgaW4gZW51
bWVyYXRlKGtleXMpOgogICAgICAgICAgICBzbG90ID0gc2VsZi5fZ2V0X3Nsb3Qoa2V5KQogICAg
ICAgICAgICBzbG90X2dyb3Vwc1tzbG90XS5hcHBlbmQoa2V5KQogICAgICAgICAgICBrZXlfb3Jk
ZXJba2V5XSA9IGlkeAoKICAgICAgICAjINCV0YHQu9C4INCy0YHQtSDQutC70Y7Rh9C4INCyINC+
0LTQvdC+0Lwg0YHQu9C+0YLQtQogICAgICAgIGlmIGxlbihzbG90X2dyb3VwcykgPT0gMToKICAg
ICAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdNR0VUJywgKmtleXMsIGtleT1r
ZXlzWzBdLCBmb3JfcmVhZD1UcnVlKQoKICAgICAgICAjINCS0YvQv9C+0LvQvdGP0LXQvCBHRVQg
0LTQu9GPINC60LDQttC00L7Qs9C+INC60LvRjtGH0LAKICAgICAgICByZXN1bHRzID0gW05vbmVd
ICogbGVuKGtleXMpCiAgICAgICAgZm9yIHNsb3QsIHNsb3Rfa2V5cyBpbiBzbG90X2dyb3Vwcy5p
dGVtcygpOgogICAgICAgICAgICBmb3Iga2V5IGluIHNsb3Rfa2V5czoKICAgICAgICAgICAgICAg
IHZhbHVlID0gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0dFVCcsIGtleSwga2V5PWtleSwgZm9yX3Jl
YWQ9VHJ1ZSkKICAgICAgICAgICAgICAgIHJlc3VsdHNba2V5X29yZGVyW2tleV1dID0gdmFsdWUK
CiAgICAgICAgcmV0dXJuIHJlc3VsdHMKCiAgICBkZWYgbXNldChzZWxmLCBtYXBwaW5nOiBEaWN0
W1VuaW9uW3N0ciwgYnl0ZXNdLCBVbmlvbltzdHIsIGJ5dGVzXV0pIC0+IHN0cjoKICAgICAgICAi
IiJNU0VUINGBINCz0YDRg9C/0L/QuNGA0L7QstC60L7QuSDQv9C+INGB0LvQvtGC0LDQvCIiIgog
ICAgICAgIGlmIG5vdCBzZWxmLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgIGFyZ3MgPSBbJ01TRVQn
XQogICAgICAgICAgICBmb3IgaywgdiBpbiBtYXBwaW5nLml0ZW1zKCk6CiAgICAgICAgICAgICAg
ICBhcmdzLmV4dGVuZChbaywgdl0pCiAgICAgICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29t
bWFuZCgqYXJncykKCiAgICAgICAgIyDQk9GA0YPQv9C/0LjRgNC+0LLQutCwINC/0L4g0YHQu9C+
0YLQsNC8CiAgICAgICAgc2xvdF9ncm91cHMgPSBkZWZhdWx0ZGljdChkaWN0KQogICAgICAgIGZv
ciBrZXksIHZhbHVlIGluIG1hcHBpbmcuaXRlbXMoKToKICAgICAgICAgICAgc2xvdCA9IHNlbGYu
X2dldF9zbG90KGtleSkKICAgICAgICAgICAgc2xvdF9ncm91cHNbc2xvdF1ba2V5XSA9IHZhbHVl
CgogICAgICAgICMg0JXRgdC70Lgg0LLRgdC1INCyINC+0LTQvdC+0Lwg0YHQu9C+0YLQtQogICAg
ICAgIGlmIGxlbihzbG90X2dyb3VwcykgPT0gMToKICAgICAgICAgICAgYXJncyA9IFsnTVNFVCdd
CiAgICAgICAgICAgIGZvciBrLCB2IGluIG1hcHBpbmcuaXRlbXMoKToKICAgICAgICAgICAgICAg
IGFyZ3MuZXh0ZW5kKFtrLCB2XSkKICAgICAgICAgICAgZmlyc3Rfa2V5ID0gbmV4dChpdGVyKG1h
cHBpbmcua2V5cygpKSkKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCph
cmdzLCBrZXk9Zmlyc3Rfa2V5KQoKICAgICAgICAjINCS0YvQv9C+0LvQvdGP0LXQvCBTRVQg0LTQ
u9GPINC60LDQttC00L7Qs9C+INC60LvRjtGH0LAKICAgICAgICBmb3Igc2xvdCwgc2xvdF9tYXBw
aW5nIGluIHNsb3RfZ3JvdXBzLml0ZW1zKCk6CiAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGlu
IHNsb3RfbWFwcGluZy5pdGVtcygpOgogICAgICAgICAgICAgICAgc2VsZi5leGVjdXRlX2NvbW1h
bmQoJ1NFVCcsIGtleSwgdmFsdWUsIGtleT1rZXkpCgogICAgICAgIHJldHVybiAnT0snCgogICAg
ZGVmIGRlbGV0ZShzZWxmLCAqa2V5cykgLT4gaW50OgogICAgICAgICIiIkRFTCDRgSDQs9GA0YPQ
v9C/0LjRgNC+0LLQutC+0Lkg0L/QviDRgdC70L7RgtCw0LwiIiIKICAgICAgICBpZiBub3Qgc2Vs
Zi5pc19jbHVzdGVyOgogICAgICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0RF
TCcsICprZXlzLCBrZXk9a2V5c1swXSBpZiBrZXlzIGVsc2UgTm9uZSkKCiAgICAgICAgIyDQk9GA
0YPQv9C/0LjRgNC+0LLQutCwINC/0L4g0YHQu9C+0YLQsNC8CiAgICAgICAgc2xvdF9ncm91cHMg
PSBkZWZhdWx0ZGljdChsaXN0KQogICAgICAgIGZvciBrZXkgaW4ga2V5czoKICAgICAgICAgICAg
c2xvdCA9IHNlbGYuX2dldF9zbG90KGtleSkKICAgICAgICAgICAgc2xvdF9ncm91cHNbc2xvdF0u
YXBwZW5kKGtleSkKCiAgICAgICAgIyDQldGB0LvQuCDQstGB0LUg0LIg0L7QtNC90L7QvCDRgdC7
0L7RgtC1CiAgICAgICAgaWYgbGVuKHNsb3RfZ3JvdXBzKSA9PSAxOgogICAgICAgICAgICByZXR1
cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0RFTCcsICprZXlzLCBrZXk9a2V5c1swXSkKCiAgICAg
ICAgIyDQo9C00LDQu9GP0LXQvCDQv9C+INCz0YDRg9C/0L/QsNC8CiAgICAgICAgdG90YWwgPSAw
CiAgICAgICAgZm9yIHNsb3QsIHNsb3Rfa2V5cyBpbiBzbG90X2dyb3Vwcy5pdGVtcygpOgogICAg
ICAgICAgICB0b3RhbCArPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnREVMJywgKnNsb3Rfa2V5cywg
a2V5PXNsb3Rfa2V5c1swXSkKCiAgICAgICAgcmV0dXJuIHRvdGFsCgogICAgIyA9PT09PT09PT09
PT0gTHVhIFNjcmlwdHMgPT09PT09PT09PT09CgogICAgZGVmIF9zY3JpcHRfc2hhMShzZWxmLCBz
Y3JpcHQ6IHN0cikgLT4gc3RyOgogICAgICAgICIiItCS0YvRh9C40YHQu9C40YLRjCBTSEExINGF
0LXRiCDRgdC60YDQuNC/0YLQsCIiIgogICAgICAgIHJldHVybiBoYXNobGliLnNoYTEoc2NyaXB0
LmVuY29kZSgndXRmLTgnKSkuaGV4ZGlnZXN0KCkKCiAgICBkZWYgZXZhbChzZWxmLCBzY3JpcHQ6
IHN0ciwgbnVta2V5czogaW50LCAqa2V5c19hbmRfYXJncykgLT4gQW55OgogICAgICAgICIiIkVW
QUwgLSDQstGL0L/QvtC70L3QuNGC0YwgTHVhINGB0LrRgNC40L/RggoKICAgICAgICBBcmdzOgog
ICAgICAgICAgICBzY3JpcHQ6IEx1YSDRgdC60YDQuNC/0YIKICAgICAgICAgICAgbnVta2V5czog
0JrQvtC70LjRh9C10YHRgtCy0L4g0LrQu9GO0YfQtdC5CiAgICAgICAgICAgICprZXlzX2FuZF9h
cmdzOiDQodC90LDRh9Cw0LvQsCDQutC70Y7Rh9C4LCDQv9C+0YLQvtC8INCw0YDQs9GD0LzQtdC9
0YLRiwoKICAgICAgICBFeGFtcGxlOgogICAgICAgICAgICBjbGllbnQuZXZhbCgicmV0dXJuIHJl
ZGlzLmNhbGwoJ0dFVCcsIEtFWVNbMV0pIiwgMSwgJ215a2V5JykKICAgICAgICAiIiIKICAgICAg
ICAjINCSINC60LvQsNGB0YLQtdGA0LUg0L7Qv9GA0LXQtNC10LvRj9C10Lwg0YPQt9C10Lsg0L/Q
viDQv9C10YDQstC+0LzRgyDQutC70Y7Rh9GDCiAgICAgICAga2V5ID0ga2V5c19hbmRfYXJnc1sw
XSBpZiBudW1rZXlzID4gMCBhbmQga2V5c19hbmRfYXJncyBlbHNlIE5vbmUKCiAgICAgICAgIyDQ
n9GA0L7QstC10YDRj9C10Lwg0YfRgtC+INCy0YHQtSDQutC70Y7Rh9C4INCyINC+0LTQvdC+0Lwg
0YHQu9C+0YLQtSAo0LrQu9Cw0YHRgtC10YApCiAgICAgICAgaWYgc2VsZi5pc19jbHVzdGVyIGFu
ZCBudW1rZXlzID4gMToKICAgICAgICAgICAgZmlyc3Rfc2xvdCA9IHNlbGYuX2dldF9zbG90KGtl
eXNfYW5kX2FyZ3NbMF0pCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDEsIG51bWtleXMpOgog
ICAgICAgICAgICAgICAgaWYgc2VsZi5fZ2V0X3Nsb3Qoa2V5c19hbmRfYXJnc1tpXSkgIT0gZmly
c3Rfc2xvdDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBSZWRpc0NsdXN0ZXJFcnJvcigKICAg
ICAgICAgICAgICAgICAgICAgICAgZiJBbGwga2V5cyBtdXN0IGJlIGluIHRoZSBzYW1lIHNsb3Qg
Zm9yIEVWQUwuICIKICAgICAgICAgICAgICAgICAgICAgICAgZiJVc2UgaGFzaCB0YWdzIGxpa2Ug
e3t0YWd9fSB0byBlbnN1cmUgc2FtZSBzbG90LiIKICAgICAgICAgICAgICAgICAgICApCgogICAg
ICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnRVZBTCcsIHNjcmlwdCwgbnVta2V5cywg
KmtleXNfYW5kX2FyZ3MsIGtleT1rZXkpCgogICAgZGVmIGV2YWxzaGEoc2VsZiwgc2hhOiBzdHIs
IG51bWtleXM6IGludCwgKmtleXNfYW5kX2FyZ3MpIC0+IEFueToKICAgICAgICAiIiJFVkFMU0hB
IC0g0LLRi9C/0L7Qu9C90LjRgtGMINGB0LrRgNC40L/RgiDQv9C+IFNIQTEKCiAgICAgICAgQXJn
czoKICAgICAgICAgICAgc2hhOiBTSEExINGF0LXRiCDRgdC60YDQuNC/0YLQsAogICAgICAgICAg
ICBudW1rZXlzOiDQmtC+0LvQuNGH0LXRgdGC0LLQviDQutC70Y7Rh9C10LkKICAgICAgICAgICAg
KmtleXNfYW5kX2FyZ3M6INCh0L3QsNGH0LDQu9CwINC60LvRjtGH0LgsINC/0L7RgtC+0Lwg0LDR
gNCz0YPQvNC10L3RgtGLCiAgICAgICAgIiIiCiAgICAgICAga2V5ID0ga2V5c19hbmRfYXJnc1sw
XSBpZiBudW1rZXlzID4gMCBhbmQga2V5c19hbmRfYXJncyBlbHNlIE5vbmUKCiAgICAgICAgIyDQ
n9GA0L7QstC10YDQutCwINGB0LvQvtGC0L7QsiDQutCw0Log0LIgZXZhbAogICAgICAgIGlmIHNl
bGYuaXNfY2x1c3RlciBhbmQgbnVta2V5cyA+IDE6CiAgICAgICAgICAgIGZpcnN0X3Nsb3QgPSBz
ZWxmLl9nZXRfc2xvdChrZXlzX2FuZF9hcmdzWzBdKQogICAgICAgICAgICBmb3IgaSBpbiByYW5n
ZSgxLCBudW1rZXlzKToKICAgICAgICAgICAgICAgIGlmIHNlbGYuX2dldF9zbG90KGtleXNfYW5k
X2FyZ3NbaV0pICE9IGZpcnN0X3Nsb3Q6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgUmVkaXND
bHVzdGVyRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAgIGYiQWxsIGtleXMgbXVzdCBiZSBp
biB0aGUgc2FtZSBzbG90IGZvciBFVkFMU0hBLiAiCiAgICAgICAgICAgICAgICAgICAgICAgIGYi
VXNlIGhhc2ggdGFncyBsaWtlIHt7dGFnfX0gdG8gZW5zdXJlIHNhbWUgc2xvdC4iCiAgICAgICAg
ICAgICAgICAgICAgKQoKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0VWQUxT
SEEnLCBzaGEsIG51bWtleXMsICprZXlzX2FuZF9hcmdzLCBrZXk9a2V5KQoKICAgIGRlZiBzY3Jp
cHRfbG9hZChzZWxmLCBzY3JpcHQ6IHN0ciwga2V5OiBPcHRpb25hbFtVbmlvbltzdHIsIGJ5dGVz
XV0gPSBOb25lKSAtPiBzdHI6CiAgICAgICAgIiIiU0NSSVBUIExPQUQgLSDQt9Cw0LPRgNGD0LfQ
uNGC0Ywg0YHQutGA0LjQv9GCINC90LAg0YHQtdGA0LLQtdGACgogICAgICAgIEFyZ3M6CiAgICAg
ICAgICAgIHNjcmlwdDogTHVhINGB0LrRgNC40L/RggogICAgICAgICAgICBrZXk6INCe0L/RhtC4
0L7QvdCw0LvRjNC90YvQuSDQutC70Y7RhyDQtNC70Y8g0L7Qv9GA0LXQtNC10LvQtdC90LjRjyDR
g9C30LvQsCDQsiDQutC70LDRgdGC0LXRgNC1CgogICAgICAgIFJldHVybnM6CiAgICAgICAgICAg
IFNIQTEg0YXQtdGIINGB0LrRgNC40L/RgtCwCiAgICAgICAgIiIiCiAgICAgICAgc2hhID0gc2Vs
Zi5fc2NyaXB0X3NoYTEoc2NyaXB0KQoKICAgICAgICBpZiBzZWxmLmlzX2NsdXN0ZXI6CiAgICAg
ICAgICAgICMg0JIg0LrQu9Cw0YHRgtC10YDQtSDQt9Cw0LPRgNGD0LbQsNC10Lwg0L3QsCDQstGB
0LUg0YPQt9C70YsKICAgICAgICAgICAgZm9yIG5vZGVfaWQsIHBvb2wgaW4gc2VsZi5jbHVzdGVy
X3Bvb2xzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBjb25uID0gcG9vbC5nZXRfY29ubmVjdGlv
bigpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgY29ubi5leGVjdXRl
X2NvbW1hbmQoJ1NDUklQVCcsICdMT0FEJywgc2NyaXB0KQogICAgICAgICAgICAgICAgZXhjZXB0
IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiRmFp
bGVkIHRvIGxvYWQgc2NyaXB0IG9uIHtub2RlX2lkfToge2V9IikKICAgICAgICAgICAgICAgIGZp
bmFsbHk6CiAgICAgICAgICAgICAgICAgICAgcG9vbC5yZWxlYXNlKGNvbm4pCiAgICAgICAgZWxz
ZToKICAgICAgICAgICAgc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1NDUklQVCcsICdMT0FEJywgc2Ny
aXB0LCBrZXk9a2V5KQoKICAgICAgICBzZWxmLl9zY3JpcHRfY2FjaGVbc2NyaXB0XSA9IHNoYQog
ICAgICAgIHJldHVybiBzaGEKCiAgICBkZWYgc2NyaXB0X2V4aXN0cyhzZWxmLCAqc2hhcywga2V5
OiBPcHRpb25hbFtVbmlvbltzdHIsIGJ5dGVzXV0gPSBOb25lKSAtPiBMaXN0W2ludF06CiAgICAg
ICAgIiIiU0NSSVBUIEVYSVNUUyAtINC/0YDQvtCy0LXRgNC40YLRjCDRgdGD0YnQtdGB0YLQstC+
0LLQsNC90LjQtSDRgdC60YDQuNC/0YLQvtCyCgogICAgICAgIFJldHVybnM6CiAgICAgICAgICAg
INCh0L/QuNGB0L7QuiAxLzAg0LTQu9GPINC60LDQttC00L7Qs9C+IFNIQQogICAgICAgICIiIgog
ICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnU0NSSVBUJywgJ0VYSVNUUycsICpz
aGFzLCBrZXk9a2V5KQoKICAgIGRlZiBzY3JpcHRfZmx1c2goc2VsZiwga2V5OiBPcHRpb25hbFtV
bmlvbltzdHIsIGJ5dGVzXV0gPSBOb25lKSAtPiBzdHI6CiAgICAgICAgIiIiU0NSSVBUIEZMVVNI
IC0g0YPQtNCw0LvQuNGC0Ywg0LLRgdC1INGB0LrRgNC40L/RgtGLIiIiCiAgICAgICAgaWYgc2Vs
Zi5pc19jbHVzdGVyOgogICAgICAgICAgICAjINCSINC60LvQsNGB0YLQtdGA0LUg0YTQu9Cw0YjQ
uNC8INCy0YHQtSDRg9C30LvRiwogICAgICAgICAgICBmb3Igbm9kZV9pZCwgcG9vbCBpbiBzZWxm
LmNsdXN0ZXJfcG9vbHMuaXRlbXMoKToKICAgICAgICAgICAgICAgIGNvbm4gPSBwb29sLmdldF9j
b25uZWN0aW9uKCkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBjb25u
LmV4ZWN1dGVfY29tbWFuZCgnU0NSSVBUJywgJ0ZMVVNIJykKICAgICAgICAgICAgICAgIGV4Y2Vw
dCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIkZh
aWxlZCB0byBmbHVzaCBzY3JpcHRzIG9uIHtub2RlX2lkfToge2V9IikKICAgICAgICAgICAgICAg
IGZpbmFsbHk6CiAgICAgICAgICAgICAgICAgICAgcG9vbC5yZWxlYXNlKGNvbm4pCiAgICAgICAg
ICAgIHJlc3VsdCA9ICdPSycKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXN1bHQgPSBzZWxm
LmV4ZWN1dGVfY29tbWFuZCgnU0NSSVBUJywgJ0ZMVVNIJywga2V5PWtleSkKCiAgICAgICAgc2Vs
Zi5fc2NyaXB0X2NhY2hlLmNsZWFyKCkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIHJl
Z2lzdGVyX3NjcmlwdChzZWxmLCBzY3JpcHQ6IHN0cikgLT4gJ1NjcmlwdCc6CiAgICAgICAgIiIi
0JfQsNGA0LXQs9C40YHRgtGA0LjRgNC+0LLQsNGC0Ywg0YHQutGA0LjQv9GCINC00LvRjyDRg9C0
0L7QsdC90L7Qs9C+INC40YHQv9C+0LvRjNC30L7QstCw0L3QuNGPCgogICAgICAgIFJldHVybnM6
CiAgICAgICAgICAgINCe0LHRitC10LrRgiBTY3JpcHQg0YEg0LzQtdGC0L7QtNC+0LwgX19jYWxs
X18KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gU2NyaXB0KHNlbGYsIHNjcmlwdCkKCiAgICAj
ID09PT09PT09PT09PSBCYXNpYyBDb21tYW5kcyA9PT09PT09PT09PT0KCiAgICBkZWYgcGluZyhz
ZWxmKSAtPiBib29sOgogICAgICAgICIiIlBJTkciIiIKICAgICAgICB0cnk6CiAgICAgICAgICAg
IHJlc3BvbnNlID0gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1BJTkcnKQogICAgICAgICAgICByZXR1
cm4gcmVzcG9uc2UgaW4gKCdQT05HJywgYidQT05HJykKICAgICAgICBleGNlcHQ6CiAgICAgICAg
ICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBnZXQoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVz
XSkgLT4gT3B0aW9uYWxbYnl0ZXNdOgogICAgICAgICIiIkdFVCIiIgogICAgICAgIHJldHVybiBz
ZWxmLmV4ZWN1dGVfY29tbWFuZCgnR0VUJywga2V5LCBrZXk9a2V5LCBmb3JfcmVhZD1UcnVlKQoK
ICAgIGRlZiBzZXQoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSwgdmFsdWU6IFVuaW9uW3N0
ciwgYnl0ZXMsIGludCwgZmxvYXRdLAogICAgICAgICAgICBleDogT3B0aW9uYWxbaW50XSA9IE5v
bmUsIHB4OiBPcHRpb25hbFtpbnRdID0gTm9uZSwKICAgICAgICAgICAgbng6IGJvb2wgPSBGYWxz
ZSwgeHg6IGJvb2wgPSBGYWxzZSkgLT4gT3B0aW9uYWxbc3RyXToKICAgICAgICAiIiJTRVQiIiIK
ICAgICAgICBhcmdzID0gWydTRVQnLCBrZXksIHZhbHVlXQoKICAgICAgICBpZiBleCBpcyBub3Qg
Tm9uZToKICAgICAgICAgICAgYXJncy5leHRlbmQoWydFWCcsIGV4XSkKICAgICAgICBpZiBweCBp
cyBub3QgTm9uZToKICAgICAgICAgICAgYXJncy5leHRlbmQoWydQWCcsIHB4XSkKICAgICAgICBp
ZiBueDoKICAgICAgICAgICAgYXJncy5hcHBlbmQoJ05YJykKICAgICAgICBpZiB4eDoKICAgICAg
ICAgICAgYXJncy5hcHBlbmQoJ1hYJykKCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21t
YW5kKCphcmdzLCBrZXk9a2V5KQoKICAgIGRlZiBpbmNyKHNlbGYsIGtleTogVW5pb25bc3RyLCBi
eXRlc10pIC0+IGludDoKICAgICAgICAiIiJJTkNSIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuZXhl
Y3V0ZV9jb21tYW5kKCdJTkNSJywga2V5LCBrZXk9a2V5KQoKICAgIGRlZiBkZWNyKHNlbGYsIGtl
eTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAgICAgICAiIiJERUNSIiIiCiAgICAgICAg
cmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdERUNSJywga2V5LCBrZXk9a2V5KQoKICAgIGRl
ZiBleGlzdHMoc2VsZiwgKmtleXMpIC0+IGludDoKICAgICAgICAiIiJFWElTVFMiIiIKICAgICAg
ICBpZiBub3Qga2V5czoKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICByZXR1cm4gc2VsZi5l
eGVjdXRlX2NvbW1hbmQoJ0VYSVNUUycsICprZXlzLCBrZXk9a2V5c1swXSwgZm9yX3JlYWQ9VHJ1
ZSkKCiAgICBkZWYgdHRsKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAg
ICAgICAiIiJUVEwiIiIKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1RUTCcs
IGtleSwga2V5PWtleSwgZm9yX3JlYWQ9VHJ1ZSkKCiAgICBkZWYgZXhwaXJlKHNlbGYsIGtleTog
VW5pb25bc3RyLCBieXRlc10sIHNlY29uZHM6IGludCkgLT4gaW50OgogICAgICAgICIiIkVYUElS
RSIiIgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnRVhQSVJFJywga2V5LCBz
ZWNvbmRzLCBrZXk9a2V5KQoKICAgIGRlZiB0eXBlKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRl
c10pIC0+IGJ5dGVzOgogICAgICAgICIiIlRZUEUgLSDQv9C+0LvRg9GH0LjRgtGMINGC0LjQvyDQ
utC70Y7Rh9CwIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdUWVBFJywg
a2V5LCBrZXk9a2V5LCBmb3JfcmVhZD1UcnVlKQoKICAgIGRlZiByZW5hbWUoc2VsZiwgb2xkX2tl
eTogVW5pb25bc3RyLCBieXRlc10sIG5ld19rZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBzdHI6
CiAgICAgICAgIiIiUkVOQU1FIC0g0L/QtdGA0LXQuNC80LXQvdC+0LLQsNGC0Ywg0LrQu9GO0Yci
IiIKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1JFTkFNRScsIG9sZF9rZXks
IG5ld19rZXksIGtleT1vbGRfa2V5KQoKICAgIGRlZiBzdHJsZW4oc2VsZiwga2V5OiBVbmlvbltz
dHIsIGJ5dGVzXSkgLT4gaW50OgogICAgICAgICIiIlNUUkxFTiAtINC00LvQuNC90LAg0YHRgtGA
0L7QutC+0LLQvtCz0L4g0LfQvdCw0YfQtdC90LjRjyIiIgogICAgICAgIHJldHVybiBzZWxmLmV4
ZWN1dGVfY29tbWFuZCgnU1RSTEVOJywga2V5LCBrZXk9a2V5LCBmb3JfcmVhZD1UcnVlKQoKICAg
IGRlZiBpbmNyYnkoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSwgYW1vdW50OiBpbnQpIC0+
IGludDoKICAgICAgICAiIiJJTkNSQlkgLSDRg9Cy0LXQu9C40YfQuNGC0Ywg0L3QsCDQt9C90LDR
h9C10L3QuNC1IiIiCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdJTkNSQlkn
LCBrZXksIGFtb3VudCwga2V5PWtleSkKCiAgICBkZWYgZGVjcmJ5KHNlbGYsIGtleTogVW5pb25b
c3RyLCBieXRlc10sIGFtb3VudDogaW50KSAtPiBpbnQ6CiAgICAgICAgIiIiREVDUkJZIC0g0YPQ
vNC10L3RjNGI0LjRgtGMINC90LAg0LfQvdCw0YfQtdC90LjQtSIiIgogICAgICAgIHJldHVybiBz
ZWxmLmV4ZWN1dGVfY29tbWFuZCgnREVDUkJZJywga2V5LCBhbW91bnQsIGtleT1rZXkpCgogICAg
ZGVmIHBlcnNpc3Qoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSkgLT4gaW50OgogICAgICAg
ICIiIlBFUlNJU1QiIiIKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1BFUlNJ
U1QnLCBrZXksIGtleT1rZXkpCgogICAgIyA9PT09PT09PT09PT0gSGFzaCBDb21tYW5kcyA9PT09
PT09PT09PT0KCiAgICBkZWYgaGdldChzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCBmaWVs
ZDogVW5pb25bc3RyLCBieXRlc10pIC0+IE9wdGlvbmFsW2J5dGVzXToKICAgICAgICAiIiJIR0VU
IiIiCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdIR0VUJywga2V5LCBmaWVs
ZCwga2V5PWtleSwgZm9yX3JlYWQ9VHJ1ZSkKCiAgICBkZWYgaHNldChzZWxmLCBrZXk6IFVuaW9u
W3N0ciwgYnl0ZXNdLCBmaWVsZDogT3B0aW9uYWxbVW5pb25bc3RyLCBieXRlc11dID0gTm9uZSwK
ICAgICAgICAgICAgIHZhbHVlOiBPcHRpb25hbFtVbmlvbltzdHIsIGJ5dGVzXV0gPSBOb25lLCBt
YXBwaW5nOiBPcHRpb25hbFtEaWN0XSA9IE5vbmUpIC0+IGludDoKICAgICAgICAiIiJIU0VUIiIi
CiAgICAgICAgYXJncyA9IFsnSFNFVCcsIGtleV0KCiAgICAgICAgaWYgbWFwcGluZzoKICAgICAg
ICAgICAgZm9yIGssIHYgaW4gbWFwcGluZy5pdGVtcygpOgogICAgICAgICAgICAgICAgYXJncy5l
eHRlbmQoW2ssIHZdKQogICAgICAgIGVsaWYgZmllbGQgaXMgbm90IE5vbmUgYW5kIHZhbHVlIGlz
IG5vdCBOb25lOgogICAgICAgICAgICBhcmdzLmV4dGVuZChbZmllbGQsIHZhbHVlXSkKICAgICAg
ICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJmaWVsZCt2YWx1ZSBvciBtYXBw
aW5nIHJlcXVpcmVkIikKCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCphcmdz
LCBrZXk9a2V5KQoKICAgIGRlZiBoZ2V0YWxsKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10p
IC0+IERpY3RbYnl0ZXMsIGJ5dGVzXToKICAgICAgICAiIiJIR0VUQUxMIiIiCiAgICAgICAgcmVz
cG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnSEdFVEFMTCcsIGtleSwga2V5PWtleSwgZm9y
X3JlYWQ9VHJ1ZSkKICAgICAgICByZXN1bHQgPSB7fQogICAgICAgIGZvciBpIGluIHJhbmdlKDAs
IGxlbihyZXNwb25zZSksIDIpOgogICAgICAgICAgICByZXN1bHRbcmVzcG9uc2VbaV1dID0gcmVz
cG9uc2VbaSArIDFdCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBobGVuKHNlbGYsIGtl
eTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAgICAgICAiIiJITEVOIiIiCiAgICAgICAg
cmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdITEVOJywga2V5LCBrZXk9a2V5LCBmb3JfcmVh
ZD1UcnVlKQoKICAgIGRlZiBoZGVsKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10sICpmaWVs
ZHMpIC0+IGludDoKICAgICAgICAiIiJIREVMIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0
ZV9jb21tYW5kKCdIREVMJywga2V5LCAqZmllbGRzLCBrZXk9a2V5KQoKICAgICMgPT09PT09PT09
PT09IExpc3QgQ29tbWFuZHMgPT09PT09PT09PT09CgogICAgZGVmIGxwdXNoKHNlbGYsIGtleTog
VW5pb25bc3RyLCBieXRlc10sICp2YWx1ZXMpIC0+IGludDoKICAgICAgICAiIiJMUFVTSCIiIgog
ICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnTFBVU0gnLCBrZXksICp2YWx1ZXMs
IGtleT1rZXkpCgogICAgZGVmIHJwdXNoKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10sICp2
YWx1ZXMpIC0+IGludDoKICAgICAgICAiIiJSUFVTSCIiIgogICAgICAgIHJldHVybiBzZWxmLmV4
ZWN1dGVfY29tbWFuZCgnUlBVU0gnLCBrZXksICp2YWx1ZXMsIGtleT1rZXkpCgogICAgZGVmIGxw
b3Aoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSkgLT4gT3B0aW9uYWxbYnl0ZXNdOgogICAg
ICAgICIiIkxQT1AiIiIKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0xQT1An
LCBrZXksIGtleT1rZXkpCgogICAgZGVmIHJwb3Aoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVz
XSkgLT4gT3B0aW9uYWxbYnl0ZXNdOgogICAgICAgICIiIlJQT1AiIiIKICAgICAgICByZXR1cm4g
c2VsZi5leGVjdXRlX2NvbW1hbmQoJ1JQT1AnLCBrZXksIGtleT1rZXkpCgogICAgZGVmIGxsZW4o
c2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSkgLT4gaW50OgogICAgICAgICIiIkxMRU4iIiIK
ICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ0xMRU4nLCBrZXksIGtleT1rZXks
IGZvcl9yZWFkPVRydWUpCgogICAgZGVmIGxyYW5nZShzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0
ZXNdLCBzdGFydDogaW50LCBzdG9wOiBpbnQpIC0+IExpc3RbYnl0ZXNdOgogICAgICAgICIiIkxS
QU5HRSIiIgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnTFJBTkdFJywga2V5
LCBzdGFydCwgc3RvcCwga2V5PWtleSwgZm9yX3JlYWQ9VHJ1ZSkKCiAgICAjID09PT09PT09PT09
PSBTZXQgQ29tbWFuZHMgPT09PT09PT09PT09CgogICAgZGVmIHNhZGQoc2VsZiwga2V5OiBVbmlv
bltzdHIsIGJ5dGVzXSwgKm1lbWJlcnMpIC0+IGludDoKICAgICAgICAiIiJTQUREIiIiCiAgICAg
ICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdTQUREJywga2V5LCAqbWVtYmVycywga2V5
PWtleSkKCiAgICBkZWYgc21lbWJlcnMoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSkgLT4g
c2V0OgogICAgICAgICIiIlNNRU1CRVJTIiIiCiAgICAgICAgcmVzdWx0ID0gc2VsZi5leGVjdXRl
X2NvbW1hbmQoJ1NNRU1CRVJTJywga2V5LCBrZXk9a2V5LCBmb3JfcmVhZD1UcnVlKQogICAgICAg
IHJldHVybiBzZXQocmVzdWx0KSBpZiByZXN1bHQgZWxzZSBzZXQoKQoKICAgIGRlZiBzY2FyZChz
ZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6CiAgICAgICAgIiIiU0NBUkQiIiIK
ICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoJ1NDQVJEJywga2V5LCBrZXk9a2V5
LCBmb3JfcmVhZD1UcnVlKQoKICAgIGRlZiBzaXNtZW1iZXIoc2VsZiwga2V5OiBVbmlvbltzdHIs
IGJ5dGVzXSwgbWVtYmVyOiBVbmlvbltzdHIsIGJ5dGVzXSkgLT4gaW50OgogICAgICAgICIiIlNJ
U01FTUJFUiIiIgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnU0lTTUVNQkVS
Jywga2V5LCBtZW1iZXIsIGtleT1rZXksIGZvcl9yZWFkPVRydWUpCgogICAgZGVmIHNyZW0oc2Vs
Ziwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSwgKm1lbWJlcnMpIC0+IGludDoKICAgICAgICAiIiJT
UkVNIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdTUkVNJywga2V5LCAq
bWVtYmVycywga2V5PWtleSkKCiAgICAjID09PT09PT09PT09PSBTb3J0ZWQgU2V0IENvbW1hbmRz
ID09PT09PT09PT09PQoKICAgIGRlZiB6YWRkKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10s
IG1hcHBpbmc6IERpY3RbVW5pb25bc3RyLCBieXRlc10sIGZsb2F0XSwKICAgICAgICAgICAgIG54
OiBib29sID0gRmFsc2UsIHh4OiBib29sID0gRmFsc2UsIGd0OiBib29sID0gRmFsc2UsIGx0OiBi
b29sID0gRmFsc2UpIC0+IGludDoKICAgICAgICAiIiJaQUREIiIiCiAgICAgICAgYXJncyA9IFsn
WkFERCcsIGtleV0KCiAgICAgICAgaWYgbng6CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCdOWCcp
CiAgICAgICAgaWYgeHg6CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCdYWCcpCiAgICAgICAgaWYg
Z3Q6CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCdHVCcpCiAgICAgICAgaWYgbHQ6CiAgICAgICAg
ICAgIGFyZ3MuYXBwZW5kKCdMVCcpCgogICAgICAgIGZvciBtZW1iZXIsIHNjb3JlIGluIG1hcHBp
bmcuaXRlbXMoKToKICAgICAgICAgICAgYXJncy5leHRlbmQoW3Njb3JlLCBtZW1iZXJdKQoKICAg
ICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2NvbW1hbmQoKmFyZ3MsIGtleT1rZXkpCgogICAgZGVm
IHpjYXJkKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10pIC0+IGludDoKICAgICAgICAiIiJa
Q0FSRCIiIgogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnWkNBUkQnLCBrZXks
IGtleT1rZXksIGZvcl9yZWFkPVRydWUpCgogICAgZGVmIHpyYW5nZShzZWxmLCBrZXk6IFVuaW9u
W3N0ciwgYnl0ZXNdLCBzdGFydDogaW50LCBzdG9wOiBpbnQsCiAgICAgICAgICAgICAgIHdpdGhz
Y29yZXM6IGJvb2wgPSBGYWxzZSkgLT4gTGlzdDoKICAgICAgICAiIiJaUkFOR0UiIiIKICAgICAg
ICBhcmdzID0gWydaUkFOR0UnLCBrZXksIHN0YXJ0LCBzdG9wXQoKICAgICAgICBpZiB3aXRoc2Nv
cmVzOgogICAgICAgICAgICBhcmdzLmFwcGVuZCgnV0lUSFNDT1JFUycpCgogICAgICAgIHJlc3Bv
bnNlID0gc2VsZi5leGVjdXRlX2NvbW1hbmQoKmFyZ3MsIGtleT1rZXksIGZvcl9yZWFkPVRydWUp
CgogICAgICAgIGlmIHdpdGhzY29yZXMgYW5kIHJlc3BvbnNlOgogICAgICAgICAgICByZXN1bHQg
PSBbXQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4ocmVzcG9uc2UpLCAyKToKICAg
ICAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoKHJlc3BvbnNlW2ldLCBmbG9hdChyZXNwb25zZVtp
ICsgMV0pKSkKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgICAgICByZXR1cm4gcmVzcG9u
c2UKCiAgICBkZWYgenJlbShzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCAqbWVtYmVycykg
LT4gaW50OgogICAgICAgICIiIlpSRU0iIiIKICAgICAgICByZXR1cm4gc2VsZi5leGVjdXRlX2Nv
bW1hbmQoJ1pSRU0nLCBrZXksICptZW1iZXJzLCBrZXk9a2V5KQoKICAgIGRlZiBzZWxlY3Qoc2Vs
ZiwgZGI6IGludCk6CiAgICAgICAgIiIiU0VMRUNUIC0g0LLRi9Cx0YDQsNGC0Ywg0LHQsNC30YMg
0LTQsNC90L3Ri9GFICjQvdC1INGA0LDQsdC+0YLQsNC10YIg0LIg0LrQu9Cw0YHRgtC10YDQtSki
IiIKICAgICAgICBpZiBzZWxmLmlzX2NsdXN0ZXI6CiAgICAgICAgICAgIHJhaXNlIFJlZGlzRXJy
b3IoJ1NFTEVDVCBub3QgYWxsb3dlZCBpbiBjbHVzdGVyIG1vZGUnKQoKICAgICAgICAjINCS0YvQ
v9C+0LvQvdGP0LXQvCBTRUxFQ1Qg0YfQtdGA0LXQtyBtYWluX3Bvb2wKICAgICAgICBjb25uID0g
c2VsZi5tYWluX3Bvb2wuZ2V0X2Nvbm5lY3Rpb24oKQogICAgICAgIHRyeToKICAgICAgICAgICAg
Y29ubi5leGVjdXRlX2NvbW1hbmQoJ1NFTEVDVCcsIGRiKQogICAgICAgICAgICBzZWxmLmRiID0g
ZGIKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBzZWxmLm1haW5fcG9vbC5yZWxlYXNlKGNv
bm4pCgogICAgIyA9PT09PT09PT09PT0gU2NhbiA9PT09PT09PT09PT0KCiAgICBkZWYgc2Nhbihz
ZWxmLCBjdXJzb3I6IGludCA9IDAsIG1hdGNoOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAg
ICAgICAgIGNvdW50OiBPcHRpb25hbFtpbnRdID0gTm9uZSkgLT4gVHVwbGVbaW50LCBMaXN0W2J5
dGVzXV06CiAgICAgICAgIiIiU0NBTiIiIgogICAgICAgIGFyZ3MgPSBbJ1NDQU4nLCBjdXJzb3Jd
CgogICAgICAgIGlmIG1hdGNoOgogICAgICAgICAgICBhcmdzLmV4dGVuZChbJ01BVENIJywgbWF0
Y2hdKQogICAgICAgIGlmIGNvdW50OgogICAgICAgICAgICBhcmdzLmV4dGVuZChbJ0NPVU5UJywg
Y291bnRdKQoKICAgICAgICByZXNwb25zZSA9IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCphcmdzLCBm
b3JfcmVhZD1UcnVlKQogICAgICAgIHJldHVybiBpbnQocmVzcG9uc2VbMF0pLCByZXNwb25zZVsx
XQoKICAgIGRlZiBzY2FuX2l0ZXIoc2VsZiwgbWF0Y2g6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBj
b3VudDogaW50ID0gMTAwKSAtPiBJdGVyYXRvcltieXRlc106CiAgICAgICAgIiIi0JjRgtC10YDQ
sNGC0L7RgCBTQ0FOIiIiCiAgICAgICAgY3Vyc29yID0gMAogICAgICAgIHdoaWxlIFRydWU6CiAg
ICAgICAgICAgIGN1cnNvciwga2V5cyA9IHNlbGYuc2NhbihjdXJzb3IsIG1hdGNoPW1hdGNoLCBj
b3VudD1jb3VudCkKICAgICAgICAgICAgZm9yIGtleSBpbiBrZXlzOgogICAgICAgICAgICAgICAg
eWllbGQga2V5CiAgICAgICAgICAgIGlmIGN1cnNvciA9PSAwOgogICAgICAgICAgICAgICAgYnJl
YWsKCiAgICBkZWYgc2Nhbl9hbGxfbm9kZXNfaXRlcihzZWxmLCBtYXRjaDogT3B0aW9uYWxbc3Ry
XSA9IE5vbmUsIGNvdW50OiBpbnQgPSAxMDApIC0+IEl0ZXJhdG9yW2J5dGVzXToKICAgICAgICAi
IiLQmNGC0LXRgNCw0YLQvtGAINC/0L4g0JLQodCV0Jwg0LrQu9GO0YfQsNC8INC60LvQsNGB0YLQ
tdGA0LAgKNCy0YHQtSDRg9C30LvRiykKCiAgICAgICAg0KHQvtCy0LzQtdGB0YLQuNC80L7RgdGC
0Ywg0YEgdjEuMC4wOiDRgNCw0LHQvtGC0LDQtdGCINGBIGNsdXN0ZXJfcG9vbHMgKENvbm5lY3Rp
b25Qb29sKQogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLmlzX2NsdXN0ZXI6CiAgICAg
ICAgICAgIHlpZWxkIGZyb20gc2VsZi5zY2FuX2l0ZXIobWF0Y2g9bWF0Y2gsIGNvdW50PWNvdW50
KQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2Vlbl9rZXlzID0gc2V0KCkKICAgICAgICBm
b3Igbm9kZV9pZCwgcG9vbCBpbiBzZWxmLmNsdXN0ZXJfcG9vbHMuaXRlbXMoKToKICAgICAgICAg
ICAgbG9nZ2VyLmRlYnVnKGYiU2Nhbm5pbmcgbm9kZSB7bm9kZV9pZH0iKQogICAgICAgICAgICBj
b25uID0gcG9vbC5nZXRfY29ubmVjdGlvbigpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAg
ICAgIGN1cnNvciA9IDAKICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAg
ICAgICAgYXJncyA9IFsnU0NBTicsIGN1cnNvcl0KICAgICAgICAgICAgICAgICAgICBpZiBtYXRj
aDoKICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5leHRlbmQoWydNQVRDSCcsIG1hdGNoXSkK
ICAgICAgICAgICAgICAgICAgICBpZiBjb3VudDoKICAgICAgICAgICAgICAgICAgICAgICAgYXJn
cy5leHRlbmQoWydDT1VOVCcsIGNvdW50XSkKCiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAg
ICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IGNvbm4uZXhlY3V0ZV9jb21tYW5kKCphcmdz
KQogICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IgPSBpbnQocmVzcG9uc2VbMF0pCiAgICAg
ICAgICAgICAgICAgICAgICAgIGtleXMgPSByZXNwb25zZVsxXQoKICAgICAgICAgICAgICAgICAg
ICAgICAgZm9yIGtleSBpbiBrZXlzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYga2V5
IG5vdCBpbiBzZWVuX2tleXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vlbl9r
ZXlzLmFkZChrZXkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQga2V5Cgog
ICAgICAgICAgICAgICAgICAgICAgICBpZiBjdXJzb3IgPT0gMDoKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMg
ZToKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3Igc2Nhbm5pbmcg
bm9kZSB7bm9kZV9pZH06IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAg
ICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBwb29sLnJlbGVhc2UoY29ubikKCiAgICAj
ID09PT09PT09PT09PSBDbHVzdGVyIFV0aWxpdGllcyA9PT09PT09PT09PT0KCiAgICBkZWYga2V5
c2xvdChzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6CiAgICAgICAgIiIi0JLR
i9GH0LjRgdC70Y/QtdGCIGhhc2ggc2xvdCDQtNC70Y8g0LrQu9GO0YfQsCIiIgogICAgICAgIHJl
dHVybiBzZWxmLl9nZXRfc2xvdChrZXkpCgogICAgZGVmIGdldF9jbHVzdGVyX25vZGVzKHNlbGYp
IC0+IExpc3RbQ2x1c3Rlck5vZGVdOgogICAgICAgICIiItCh0L/QuNGB0L7QuiDQstGB0LXRhSDR
g9C30LvQvtCyINC60LvQsNGB0YLQtdGA0LAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5pc19jbHVz
dGVyOgogICAgICAgICAgICByZXR1cm4gW0NsdXN0ZXJOb2RlKAogICAgICAgICAgICAgICAgaG9z
dD1zZWxmLmhvc3QsCiAgICAgICAgICAgICAgICBwb3J0PXNlbGYucG9ydCwKICAgICAgICAgICAg
ICAgIG5vZGVfaWQ9ZiJ7c2VsZi5ob3N0fTp7c2VsZi5wb3J0fSIsCiAgICAgICAgICAgICAgICBz
bG90cz1bXSwKICAgICAgICAgICAgICAgIHJvbGU9J21hc3RlcicKICAgICAgICAgICAgKV0KCiAg
ICAgICAgcmV0dXJuIGxpc3Qoc2VsZi5jbHVzdGVyX25vZGVzX2luZm8udmFsdWVzKCkpCgogICAg
ZGVmIHJlZnJlc2hfY2x1c3Rlcl90b3BvbG9neShzZWxmKToKICAgICAgICAiIiLQn9GA0LjQvdGD
0LTQuNGC0LXQu9GM0L3QvtC1INC+0LHQvdC+0LLQu9C10L3QuNC1INGC0L7Qv9C+0LvQvtCz0LjQ
uCDQutC70LDRgdGC0LXRgNCwIiIiCiAgICAgICAgaWYgc2VsZi5pc19jbHVzdGVyOgogICAgICAg
ICAgICBzZWxmLl9sb2FkX2NsdXN0ZXJfdG9wb2xvZ3koZm9yY2U9VHJ1ZSkKCiAgICAjID09PT09
PT09PT09PSBQaXBlbGluZSA9PT09PT09PT09PT0KCiAgICBkZWYgcGlwZWxpbmUoc2VsZiwgdHJh
bnNhY3Rpb246IGJvb2wgPSBGYWxzZSkgLT4gJ1JlZGlzUGlwZWxpbmUnOgogICAgICAgICIiItCh
0L7Qt9C00LDRgtGMIHBpcGVsaW5lIiIiCiAgICAgICAgcmV0dXJuIFJlZGlzUGlwZWxpbmUoc2Vs
ZiwgdHJhbnNhY3Rpb249dHJhbnNhY3Rpb24pCgogICAgIyA9PT09PT09PT09PT0gQ2xvc2UgPT09
PT09PT09PT09CgogICAgZGVmIGNsb3NlKHNlbGYpOgogICAgICAgICIiItCX0LDQutGA0YvRgtGM
INCy0YHQtSDRgdC+0LXQtNC40L3QtdC90LjRjyIiIgogICAgICAgIHNlbGYubWFpbl9wb29sLmNs
b3NlX2FsbCgpCgogICAgICAgIGZvciBwb29sIGluIHNlbGYuY2x1c3Rlcl9wb29scy52YWx1ZXMo
KToKICAgICAgICAgICAgcG9vbC5jbG9zZV9hbGwoKQoKICAgICAgICBzZWxmLmNsdXN0ZXJfcG9v
bHMuY2xlYXIoKQoKCiAgICAjID09PT09PT09PT09PSDQndC10LTQvtGB0YLQsNGO0YnQuNC1INC8
0LXRgtC+0LTRiyDQuNC3IHYxLjAuMCA9PT09PT09PT09PT0KCiAgICBkZWYgaW5mbyhzZWxmLCBz
ZWN0aW9uOiBPcHRpb25hbFtzdHJdID0gTm9uZSkgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAg
IiIiSU5GTyAtINC40L3RhNC+0YDQvNCw0YbQuNGPINC+INGB0LXRgNCy0LXRgNC1IiIiCiAgICAg
ICAgaWYgc2VjdGlvbjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFu
ZCgnSU5GTycsIHNlY3Rpb24sIGZvcl9yZWFkPVRydWUpCiAgICAgICAgZWxzZToKICAgICAgICAg
ICAgcmVzcG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnSU5GTycsIGZvcl9yZWFkPVRydWUp
CgogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzcG9uc2UsIGJ5dGVzKToKICAgICAgICAgICAgcmVz
cG9uc2UgPSByZXNwb25zZS5kZWNvZGUoJ3V0Zi04JykKCiAgICAgICAgcmVzdWx0ID0ge30KICAg
ICAgICBjdXJyZW50X3NlY3Rpb24gPSBOb25lCiAgICAgICAgZm9yIGxpbmUgaW4gcmVzcG9uc2Uu
c3BsaXQoJ1xuJyk6CiAgICAgICAgICAgIGxpbmUgPSBsaW5lLnN0cmlwKCkKICAgICAgICAgICAg
aWYgbm90IGxpbmUgb3IgbGluZS5zdGFydHN3aXRoKCcjJyk6CiAgICAgICAgICAgICAgICBpZiBs
aW5lLnN0YXJ0c3dpdGgoJyMnKToKICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3NlY3Rpb24g
PSBsaW5lWzE6XS5zdHJpcCgpLmxvd2VyKCkKICAgICAgICAgICAgICAgICAgICByZXN1bHRbY3Vy
cmVudF9zZWN0aW9uXSA9IHt9CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAg
aWYgJzonIGluIGxpbmU6CiAgICAgICAgICAgICAgICBrZXksIHZhbHVlID0gbGluZS5zcGxpdCgn
OicsIDEpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBm
bG9hdCh2YWx1ZSkgaWYgJy4nIGluIHZhbHVlIGVsc2UgaW50KHZhbHVlKQogICAgICAgICAgICAg
ICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgICAgICBpZiBj
dXJyZW50X3NlY3Rpb246CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2N1cnJlbnRfc2VjdGlv
bl1ba2V5XSA9IHZhbHVlCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAg
IHJlc3VsdFtrZXldID0gdmFsdWUKCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBkYnNp
emUoc2VsZikgLT4gaW50OgogICAgICAgICIiIkRCU0laRSAtINC60L7Qu9C40YfQtdGB0YLQstC+
INC60LvRjtGH0LXQuSDQsiDRgtC10LrRg9GJ0LXQuSDQkdCUIiIiCiAgICAgICAgaWYgc2VsZi5p
c19jbHVzdGVyOgogICAgICAgICAgICBsb2dnZXIud2FybmluZygiREJTSVpFIGluIGNsdXN0ZXIg
bW9kZSByZXR1cm5zIGFwcHJveGltYXRlIGNvdW50IikKICAgICAgICByZXR1cm4gc2VsZi5leGVj
dXRlX2NvbW1hbmQoJ0RCU0laRScsIGZvcl9yZWFkPVRydWUpCgogICAgZGVmIGZsdXNoZGIoc2Vs
ZiwgYXN5bmNocm9ub3VzOiBib29sID0gRmFsc2UpIC0+IHN0cjoKICAgICAgICAiIiJGTFVTSERC
IC0g0L7Rh9C40YHRgtC40YLRjCDRgtC10LrRg9GJ0YPRjiDQkdCUIiIiCiAgICAgICAgaWYgc2Vs
Zi5pc19jbHVzdGVyOgogICAgICAgICAgICByYWlzZSBSZWRpc0Vycm9yKCdGTFVTSERCIHJlcXVp
cmVzIGNsdXN0ZXItd2lkZSBvcGVyYXRpb24nKQoKICAgICAgICBpZiBhc3luY2hyb25vdXM6CiAg
ICAgICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnRkxVU0hEQicsICdBU1lOQycp
CiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5kKCdGTFVTSERCJykKCiAgICBkZWYg
Zmx1c2hhbGwoc2VsZiwgYXN5bmNocm9ub3VzOiBib29sID0gRmFsc2UpIC0+IHN0cjoKICAgICAg
ICAiIiJGTFVTSEFMTCAtINC+0YfQuNGB0YLQuNGC0Ywg0LLRgdC1INCR0JQiIiIKICAgICAgICBp
ZiBhc3luY2hyb25vdXM6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgn
RkxVU0hBTEwnLCAnQVNZTkMnKQogICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgn
RkxVU0hBTEwnKQoKICAgIGRlZiBrZXlzKHNlbGYsIHBhdHRlcm46IHN0ciA9ICcqJykgLT4gTGlz
dFtieXRlc106CiAgICAgICAgIiIiS0VZUyAtINC/0L7Qu9GD0YfQuNGC0Ywg0LLRgdC1INC60LvR
jtGH0Lgg0L/QviDQv9Cw0YLRgtC10YDQvdGDICjQvtGB0YLQvtGA0L7QttC90L4g0L3QsCDQv9GA
0L7QtNCw0LrRiNC10L3QtSEpIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuZXhlY3V0ZV9jb21tYW5k
KCdLRVlTJywgcGF0dGVybiwgZm9yX3JlYWQ9VHJ1ZSkKCiAgICBkZWYgaHNjYW4oc2VsZiwga2V5
OiBVbmlvbltzdHIsIGJ5dGVzXSwgY3Vyc29yOiBpbnQgPSAwLAogICAgICAgICAgICAgIG1hdGNo
OiBPcHRpb25hbFtzdHJdID0gTm9uZSwgY291bnQ6IE9wdGlvbmFsW2ludF0gPSBOb25lKSAtPiBU
dXBsZVtpbnQsIERpY3RdOgogICAgICAgICIiIkhTQ0FOIC0g0LjRgtC10YDQsNGC0LjQstC90L7Q
tSDRgdC60LDQvdC40YDQvtCy0LDQvdC40LUgaGFzaCIiIgogICAgICAgIGFyZ3MgPSBbJ0hTQ0FO
Jywga2V5LCBjdXJzb3JdCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICAgIGFyZ3MuZXh0ZW5k
KFsnTUFUQ0gnLCBtYXRjaF0pCiAgICAgICAgaWYgY291bnQ6CiAgICAgICAgICAgIGFyZ3MuZXh0
ZW5kKFsnQ09VTlQnLCBjb3VudF0pCgogICAgICAgIHJlc3BvbnNlID0gc2VsZi5leGVjdXRlX2Nv
bW1hbmQoKmFyZ3MsIGtleT1rZXksIGZvcl9yZWFkPVRydWUpCiAgICAgICAgbmV3X2N1cnNvciA9
IGludChyZXNwb25zZVswXSkKICAgICAgICBpdGVtcyA9IHJlc3BvbnNlWzFdCiAgICAgICAgcmVz
dWx0ID0ge30KICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4oaXRlbXMpLCAyKToKICAgICAg
ICAgICAgcmVzdWx0W2l0ZW1zW2ldXSA9IGl0ZW1zW2kgKyAxXQogICAgICAgIHJldHVybiBuZXdf
Y3Vyc29yLCByZXN1bHQKCiAgICBkZWYgaHNjYW5faXRlcihzZWxmLCBrZXk6IFVuaW9uW3N0ciwg
Ynl0ZXNdLCBtYXRjaDogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICAgICAgICBj
b3VudDogaW50ID0gMTAwKSAtPiBJdGVyYXRvcltUdXBsZVtieXRlcywgYnl0ZXNdXToKICAgICAg
ICAiIiJIU0NBTiDQuNGC0LXRgNCw0YLQvtGAIiIiCiAgICAgICAgY3Vyc29yID0gMAogICAgICAg
IHdoaWxlIFRydWU6CiAgICAgICAgICAgIGN1cnNvciwgZGF0YSA9IHNlbGYuaHNjYW4oa2V5LCBj
dXJzb3IsIG1hdGNoPW1hdGNoLCBjb3VudD1jb3VudCkKICAgICAgICAgICAgZm9yIGZpZWxkLCB2
YWx1ZSBpbiBkYXRhLml0ZW1zKCk6CiAgICAgICAgICAgICAgICB5aWVsZCBmaWVsZCwgdmFsdWUK
ICAgICAgICAgICAgaWYgY3Vyc29yID09IDA6CiAgICAgICAgICAgICAgICBicmVhawoKICAgIGRl
ZiBzc2NhbihzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCBjdXJzb3I6IGludCA9IDAsCiAg
ICAgICAgICAgICAgbWF0Y2g6IE9wdGlvbmFsW3N0cl0gPSBOb25lLCBjb3VudDogT3B0aW9uYWxb
aW50XSA9IE5vbmUpIC0+IFR1cGxlW2ludCwgTGlzdFtieXRlc11dOgogICAgICAgICIiIlNTQ0FO
IC0g0LjRgtC10YDQsNGC0LjQstC90L7QtSDRgdC60LDQvdC40YDQvtCy0LDQvdC40LUgc2V0IiIi
CiAgICAgICAgYXJncyA9IFsnU1NDQU4nLCBrZXksIGN1cnNvcl0KICAgICAgICBpZiBtYXRjaDoK
ICAgICAgICAgICAgYXJncy5leHRlbmQoWydNQVRDSCcsIG1hdGNoXSkKICAgICAgICBpZiBjb3Vu
dDoKICAgICAgICAgICAgYXJncy5leHRlbmQoWydDT1VOVCcsIGNvdW50XSkKCiAgICAgICAgcmVz
cG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgqYXJncywga2V5PWtleSwgZm9yX3JlYWQ9VHJ1
ZSkKICAgICAgICByZXR1cm4gaW50KHJlc3BvbnNlWzBdKSwgcmVzcG9uc2VbMV0KCiAgICBkZWYg
c3NjYW5faXRlcihzZWxmLCBrZXk6IFVuaW9uW3N0ciwgYnl0ZXNdLCBtYXRjaDogT3B0aW9uYWxb
c3RyXSA9IE5vbmUsCiAgICAgICAgICAgICAgICAgICBjb3VudDogaW50ID0gMTAwKSAtPiBJdGVy
YXRvcltieXRlc106CiAgICAgICAgIiIiU1NDQU4g0LjRgtC10YDQsNGC0L7RgCIiIgogICAgICAg
IGN1cnNvciA9IDAKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjdXJzb3IsIG1lbWJl
cnMgPSBzZWxmLnNzY2FuKGtleSwgY3Vyc29yLCBtYXRjaD1tYXRjaCwgY291bnQ9Y291bnQpCiAg
ICAgICAgICAgIGZvciBtZW1iZXIgaW4gbWVtYmVyczoKICAgICAgICAgICAgICAgIHlpZWxkIG1l
bWJlcgogICAgICAgICAgICBpZiBjdXJzb3IgPT0gMDoKICAgICAgICAgICAgICAgIGJyZWFrCgog
ICAgZGVmIHpzY2FuKHNlbGYsIGtleTogVW5pb25bc3RyLCBieXRlc10sIGN1cnNvcjogaW50ID0g
MCwKICAgICAgICAgICAgICBtYXRjaDogT3B0aW9uYWxbc3RyXSA9IE5vbmUsIGNvdW50OiBPcHRp
b25hbFtpbnRdID0gTm9uZSkgLT4gVHVwbGVbaW50LCBMaXN0XToKICAgICAgICAiIiJaU0NBTiAt
INC40YLQtdGA0LDRgtC40LLQvdC+0LUg0YHQutCw0L3QuNGA0L7QstCw0L3QuNC1IHNvcnRlZCBz
ZXQiIiIKICAgICAgICBhcmdzID0gWydaU0NBTicsIGtleSwgY3Vyc29yXQogICAgICAgIGlmIG1h
dGNoOgogICAgICAgICAgICBhcmdzLmV4dGVuZChbJ01BVENIJywgbWF0Y2hdKQogICAgICAgIGlm
IGNvdW50OgogICAgICAgICAgICBhcmdzLmV4dGVuZChbJ0NPVU5UJywgY291bnRdKQoKICAgICAg
ICByZXNwb25zZSA9IHNlbGYuZXhlY3V0ZV9jb21tYW5kKCphcmdzLCBrZXk9a2V5LCBmb3JfcmVh
ZD1UcnVlKQogICAgICAgIG5ld19jdXJzb3IgPSBpbnQocmVzcG9uc2VbMF0pCiAgICAgICAgaXRl
bXMgPSByZXNwb25zZVsxXQogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgZm9yIGkgaW4gcmFu
Z2UoMCwgbGVuKGl0ZW1zKSwgMik6CiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoKGl0ZW1zW2ld
LCBmbG9hdChpdGVtc1tpICsgMV0pKSkKICAgICAgICByZXR1cm4gbmV3X2N1cnNvciwgcmVzdWx0
CgogICAgZGVmIHpzY2FuX2l0ZXIoc2VsZiwga2V5OiBVbmlvbltzdHIsIGJ5dGVzXSwgbWF0Y2g6
IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICAgICAgICAgY291bnQ6IGludCA9IDEw
MCkgLT4gSXRlcmF0b3JbVHVwbGVbYnl0ZXMsIGZsb2F0XV06CiAgICAgICAgIiIiWlNDQU4g0LjR
gtC10YDQsNGC0L7RgCIiIgogICAgICAgIGN1cnNvciA9IDAKICAgICAgICB3aGlsZSBUcnVlOgog
ICAgICAgICAgICBjdXJzb3IsIGl0ZW1zID0gc2VsZi56c2NhbihrZXksIGN1cnNvciwgbWF0Y2g9
bWF0Y2gsIGNvdW50PWNvdW50KQogICAgICAgICAgICBmb3IgbWVtYmVyLCBzY29yZSBpbiBpdGVt
czoKICAgICAgICAgICAgICAgIHlpZWxkIG1lbWJlciwgc2NvcmUKICAgICAgICAgICAgaWYgY3Vy
c29yID09IDA6CiAgICAgICAgICAgICAgICBicmVhawoKICAgIGRlZiBjb25maWdfZ2V0KHNlbGYs
IHBhcmFtZXRlcjogc3RyKSAtPiBEaWN0OgogICAgICAgICIiIkNPTkZJRyBHRVQgLSDQv9C+0LvR
g9GH0LjRgtGMINC/0LDRgNCw0LzQtdGC0YAg0LrQvtC90YTQuNCz0YPRgNCw0YbQuNC4IiIiCiAg
ICAgICAgcmVzcG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnQ09ORklHJywgJ0dFVCcsIHBh
cmFtZXRlcikKICAgICAgICByZXN1bHQgPSB7fQogICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGxl
bihyZXNwb25zZSksIDIpOgogICAgICAgICAgICBrZXkgPSByZXNwb25zZVtpXQogICAgICAgICAg
ICBpZiBpc2luc3RhbmNlKGtleSwgYnl0ZXMpOgogICAgICAgICAgICAgICAga2V5ID0ga2V5LmRl
Y29kZSgndXRmLTgnKQogICAgICAgICAgICB2YWx1ZSA9IHJlc3BvbnNlW2kgKyAxXQogICAgICAg
ICAgICBpZiBpc2luc3RhbmNlKHZhbHVlLCBieXRlcyk6CiAgICAgICAgICAgICAgICB2YWx1ZSA9
IHZhbHVlLmRlY29kZSgndXRmLTgnKQogICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlCiAg
ICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBjbGllbnRfbGlzdChzZWxmKSAtPiBzdHI6CiAg
ICAgICAgIiIiQ0xJRU5UIExJU1QgLSDRgdC/0LjRgdC+0Log0L/QvtC00LrQu9GO0YfRkdC90L3R
i9GFINC60LvQuNC10L3RgtC+0LIiIiIKICAgICAgICByZXNwb25zZSA9IHNlbGYuZXhlY3V0ZV9j
b21tYW5kKCdDTElFTlQnLCAnTElTVCcpCiAgICAgICAgaWYgaXNpbnN0YW5jZShyZXNwb25zZSwg
Ynl0ZXMpOgogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGVjb2RlKCd1dGYtOCcpCiAgICAg
ICAgcmV0dXJuIHJlc3BvbnNlCgogICAgZGVmIGNsdXN0ZXJfa2V5c2xvdChzZWxmLCBrZXk6IFVu
aW9uW3N0ciwgYnl0ZXNdKSAtPiBpbnQ6CiAgICAgICAgIiIiQ0xVU1RFUiBLRVlTTE9UIC0g0LLR
i9GH0LjRgdC70LjRgtGMIHNsb3Qg0LTQu9GPINC60LvRjtGH0LAiIiIKICAgICAgICBpZiBub3Qg
c2VsZi5pc19jbHVzdGVyOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X3Nsb3Qoa2V5KQoK
ICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnQ0xV
U1RFUicsICdLRVlTTE9UJywga2V5KQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcmV0dXJu
IHNlbGYuX2dldF9zbG90KGtleSkKCiAgICBkZWYgZ2V0X25vZGVfZnJvbV9rZXkoc2VsZiwga2V5
OiBVbmlvbltzdHIsIGJ5dGVzXSkgLT4gQ2x1c3Rlck5vZGU6CiAgICAgICAgIiIi0J/QvtC70YPR
h9C40YLRjCDRg9C30LXQuyDQutC70LDRgdGC0LXRgNCwINC00LvRjyDQutC70Y7Rh9CwIiIiCiAg
ICAgICAgaWYgbm90IHNlbGYuaXNfY2x1c3RlcjoKICAgICAgICAgICAgcmV0dXJuIENsdXN0ZXJO
b2RlKAogICAgICAgICAgICAgICAgaG9zdD1zZWxmLmhvc3QsCiAgICAgICAgICAgICAgICBwb3J0
PXNlbGYucG9ydCwKICAgICAgICAgICAgICAgIG5vZGVfaWQ9ZiJ7c2VsZi5ob3N0fTp7c2VsZi5w
b3J0fSIsCiAgICAgICAgICAgICAgICBzbG90cz1bXSwKICAgICAgICAgICAgICAgIHJvbGU9J21h
c3RlcicKICAgICAgICAgICAgKQoKICAgICAgICBzbG90ID0gc2VsZi5fZ2V0X3Nsb3Qoa2V5KQog
ICAgICAgIG5vZGVfaWQgPSBzZWxmLmNsdXN0ZXJfc2xvdHMuZ2V0KHNsb3QpCgogICAgICAgIGlm
IG5vZGVfaWQgYW5kIG5vZGVfaWQgaW4gc2VsZi5jbHVzdGVyX25vZGVzX2luZm86CiAgICAgICAg
ICAgIG5vZGVfaW5mbyA9IHNlbGYuY2x1c3Rlcl9ub2Rlc19pbmZvW25vZGVfaWRdCiAgICAgICAg
ICAgIHJldHVybiBub2RlX2luZm8KCiAgICAgICAgcmV0dXJuIENsdXN0ZXJOb2RlKAogICAgICAg
ICAgICBob3N0PXNlbGYuaG9zdCwKICAgICAgICAgICAgcG9ydD1zZWxmLnBvcnQsCiAgICAgICAg
ICAgIG5vZGVfaWQ9ZiJ7c2VsZi5ob3N0fTp7c2VsZi5wb3J0fSIsCiAgICAgICAgICAgIHNsb3Rz
PVtzbG90XSwKICAgICAgICAgICAgcm9sZT0nbWFzdGVyJwogICAgICAgICkKCiAgICBkZWYgY2x1
c3Rlcl9pbmZvKHNlbGYpIC0+IHN0cjoKICAgICAgICAiIiJDTFVTVEVSIElORk8gLSDQuNC90YTQ
vtGA0LzQsNGG0LjRjyDQviDQutC70LDRgdGC0LXRgNC1IiIiCiAgICAgICAgcmVzcG9uc2UgPSBz
ZWxmLmV4ZWN1dGVfY29tbWFuZCgnQ0xVU1RFUicsICdJTkZPJykKICAgICAgICBpZiBpc2luc3Rh
bmNlKHJlc3BvbnNlLCBieXRlcyk6CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kZWNvZGUo
J3V0Zi04JykKICAgICAgICByZXR1cm4gcmVzcG9uc2UKCiAgICAjIGRlZiBjbHVzdGVyX25vZGVz
KHNlbGYpIC0+IHN0cjoKICAgICMgICAgICIiIkNMVVNURVIgTk9ERVMgLSDQuNC90YTQvtGA0LzQ
sNGG0LjRjyDQvtCxINGD0LfQu9Cw0YUg0LrQu9Cw0YHRgtC10YDQsCIiIgogICAgIyAgICAgcmVz
cG9uc2UgPSBzZWxmLmV4ZWN1dGVfY29tbWFuZCgnQ0xVU1RFUicsICdOT0RFUycpCiAgICAjICAg
ICBpZiBpc2luc3RhbmNlKHJlc3BvbnNlLCBieXRlcyk6CiAgICAjICAgICAgICAgcmV0dXJuIHJl
c3BvbnNlLmRlY29kZSgndXRmLTgnKQogICAgIyAgICAgcmV0dXJuIHJlc3BvbnNlCgoKIyA9PT09
PT09PT09PT0gU2NyaXB0IEhlbHBlciA9PT09PT09PT09PT0KCmNsYXNzIFNjcmlwdDoKICAgICIi
ItCe0LHRkdGA0YLQutCwINC00LvRjyDRg9C00L7QsdC90L7QuSDRgNCw0LHQvtGC0Ysg0YEgTHVh
INGB0LrRgNC40L/RgtCw0LzQuCIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjbGllbnQ6IFJl
ZGlzQ2xpZW50LCBzY3JpcHQ6IHN0cik6CiAgICAgICAgc2VsZi5jbGllbnQgPSBjbGllbnQKICAg
ICAgICBzZWxmLnNjcmlwdCA9IHNjcmlwdAogICAgICAgIHNlbGYuc2hhID0gY2xpZW50Ll9zY3Jp
cHRfc2hhMShzY3JpcHQpCiAgICAgICAgc2VsZi5fbG9hZGVkID0gRmFsc2UKCiAgICBkZWYgX19j
YWxsX18oc2VsZiwga2V5czogTGlzdCA9IE5vbmUsIGFyZ3M6IExpc3QgPSBOb25lLCBjbGllbnQ6
IE9wdGlvbmFsW1JlZGlzQ2xpZW50XSA9IE5vbmUpOgogICAgICAgICIiItCS0YvQv9C+0LvQvdC4
0YLRjCDRgdC60YDQuNC/0YIKCiAgICAgICAgQXJnczoKICAgICAgICAgICAga2V5czog0KHQv9C4
0YHQvtC6INC60LvRjtGH0LXQuSAoS0VZUyDQsiBMdWEpCiAgICAgICAgICAgIGFyZ3M6INCh0L/Q
uNGB0L7QuiDQsNGA0LPRg9C80LXQvdGC0L7QsiAoQVJHViDQsiBMdWEpCiAgICAgICAgICAgIGNs
aWVudDog0J7Qv9GG0LjQvtC90LDQu9GM0L3Ri9C5INC00YDRg9Cz0L7QuSDQutC70LjQtdC90YIK
ICAgICAgICAiIiIKICAgICAgICBpZiBjbGllbnQgaXMgTm9uZToKICAgICAgICAgICAgY2xpZW50
ID0gc2VsZi5jbGllbnQKCiAgICAgICAga2V5cyA9IGtleXMgb3IgW10KICAgICAgICBhcmdzID0g
YXJncyBvciBbXQoKICAgICAgICB0cnk6CiAgICAgICAgICAgICMg0J/RgNC+0LHRg9C10LwgRVZB
TFNIQQogICAgICAgICAgICByZXR1cm4gY2xpZW50LmV2YWxzaGEoc2VsZi5zaGEsIGxlbihrZXlz
KSwgKihrZXlzICsgYXJncykpCiAgICAgICAgZXhjZXB0IFJlZGlzRXJyb3IgYXMgZToKICAgICAg
ICAgICAgaWYgJ05PU0NSSVBUJyBpbiBzdHIoZSk6CiAgICAgICAgICAgICAgICAjINCh0LrRgNC4
0L/RgiDQvdC1INC30LDQs9GA0YPQttC10L0sINC30LDQs9GA0YPQttCw0LXQvCDQuCDQstGL0L/Q
vtC70L3Rj9C10Lwg0YfQtdGA0LXQtyBFVkFMCiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50
LmV2YWwoc2VsZi5zY3JpcHQsIGxlbihrZXlzKSwgKihrZXlzICsgYXJncykpCiAgICAgICAgICAg
IHJhaXNlCgoKIyA9PT09PT09PT09PT0gUGlwZWxpbmUgPT09PT09PT09PT09CgpjbGFzcyBSZWRp
c1BpcGVsaW5lOgogICAgIiIi0J3QsNGB0YLQvtGP0YnQuNC5IFBpcGVsaW5lINGBIGJhdGNoINC+
0YLQv9GA0LDQstC60L7QuSDRh9C10YDQtdC3INC+0LTQuNC9INGB0L7QutC10YIiIiIKCiAgICBk
ZWYgX19pbml0X18oc2VsZiwgY2xpZW50OiBSZWRpc0NsaWVudCwgdHJhbnNhY3Rpb246IGJvb2wg
PSBGYWxzZSk6CiAgICAgICAgc2VsZi5jbGllbnQgPSBjbGllbnQKICAgICAgICBzZWxmLnRyYW5z
YWN0aW9uID0gdHJhbnNhY3Rpb24KICAgICAgICBzZWxmLmNvbW1hbmRzOiBMaXN0W1R1cGxlXSA9
IFtdCiAgICAgICAgc2VsZi5jb21tYW5kX2tleXM6IExpc3RbT3B0aW9uYWxbVW5pb25bc3RyLCBi
eXRlc11dXSA9IFtdCgogICAgZGVmIGV4ZWN1dGUoc2VsZikgLT4gTGlzdFtBbnldOgogICAgICAg
ICIiItCS0YvQv9C+0LvQvdC40YLRjCDQstGB0LUg0LrQvtC80LDQvdC00YsiIiIKICAgICAgICBp
ZiBub3Qgc2VsZi5jb21tYW5kczoKICAgICAgICAgICAgcmV0dXJuIFtdCgogICAgICAgICMg0JIg
0YDQtdC20LjQvNC1INC60LvQsNGB0YLQtdGA0LAg0LPRgNGD0L/Qv9C40YDRg9C10Lwg0L/QviDR
g9C30LvQsNC8CiAgICAgICAgaWYgc2VsZi5jbGllbnQuaXNfY2x1c3RlcjoKICAgICAgICAgICAg
cmV0dXJuIHNlbGYuX2V4ZWN1dGVfY2x1c3RlcigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAg
cmV0dXJuIHNlbGYuX2V4ZWN1dGVfc2luZ2xlKCkKCiAgICBkZWYgX2V4ZWN1dGVfc2luZ2xlKHNl
bGYpIC0+IExpc3RbQW55XToKICAgICAgICAiIiLQktGL0L/QvtC70L3QtdC90LjQtSDQvdCwINC+
0LTQvdC+0Lwg0YPQt9C70LUiIiIKICAgICAgICBwb29sID0gc2VsZi5jbGllbnQubWFpbl9wb29s
CiAgICAgICAgY29ubiA9IHBvb2wuZ2V0X2Nvbm5lY3Rpb24oKQoKICAgICAgICB0cnk6CiAgICAg
ICAgICAgIGlmIHNlbGYudHJhbnNhY3Rpb246CiAgICAgICAgICAgICAgICAjIE1VTFRJL0VYRUMg
0YLRgNCw0L3Qt9Cw0LrRhtC40Y8KICAgICAgICAgICAgICAgIGNvbW1hbmRzX3dpdGhfbXVsdGkg
PSBbKCdNVUxUSScsKV0gKyBzZWxmLmNvbW1hbmRzICsgWygnRVhFQycsKV0KICAgICAgICAgICAg
ICAgIHJlc3VsdHMgPSBjb25uLmV4ZWN1dGVfcGlwZWxpbmUoY29tbWFuZHNfd2l0aF9tdWx0aSkK
ICAgICAgICAgICAgICAgICMg0JLQvtC30LLRgNCw0YnQsNC10Lwg0YLQvtC70YzQutC+INGA0LXQ
t9GD0LvRjNGC0LDRgtGLIEVYRUMKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzWy0xXSBp
ZiByZXN1bHRzWy0xXSBlbHNlIFtdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAj
INCf0YDQvtGB0YLQvtC5IHBpcGVsaW5lCiAgICAgICAgICAgICAgICByZXN1bHRzID0gY29ubi5l
eGVjdXRlX3BpcGVsaW5lKHNlbGYuY29tbWFuZHMpCgogICAgICAgICAgICAgICAgaWYgc2VsZi5j
bGllbnQuZGVjb2RlX3Jlc3BvbnNlczoKICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gW3Nl
bGYuY2xpZW50Ll9kZWNvZGVfcmVzcG9uc2UocikgaWYgbm90IGlzaW5zdGFuY2UociwgRXhjZXB0
aW9uKSBlbHNlIHIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHIgaW4gcmVzdWx0
c10KCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cwoKICAgICAgICBmaW5hbGx5OgogICAg
ICAgICAgICBwb29sLnJlbGVhc2UoY29ubikKICAgICAgICAgICAgc2VsZi5jb21tYW5kcy5jbGVh
cigpCiAgICAgICAgICAgIHNlbGYuY29tbWFuZF9rZXlzLmNsZWFyKCkKCiAgICBkZWYgX2V4ZWN1
dGVfY2x1c3RlcihzZWxmKSAtPiBMaXN0W0FueV06CiAgICAgICAgIiIi0JLRi9C/0L7Qu9C90LXQ
vdC40LUg0LIg0LrQu9Cw0YHRgtC10YDQtSDRgSDQs9GA0YPQv9C/0LjRgNC+0LLQutC+0Lkg0L/Q
viDRg9C30LvQsNC8IiIiCiAgICAgICAgIyDQk9GA0YPQv9C/0LjRgNGD0LXQvCDQutC+0LzQsNC9
0LTRiyDQv9C+INGD0LfQu9Cw0LwKICAgICAgICBub2RlX2NvbW1hbmRzID0gZGVmYXVsdGRpY3Qo
bGlzdCkKICAgICAgICBjb21tYW5kX29yZGVyID0gW10KCiAgICAgICAgZm9yIGlkeCwgKGNtZCwg
a2V5KSBpbiBlbnVtZXJhdGUoemlwKHNlbGYuY29tbWFuZHMsIHNlbGYuY29tbWFuZF9rZXlzKSk6
CiAgICAgICAgICAgIGlmIGtleToKICAgICAgICAgICAgICAgIHBvb2wgPSBzZWxmLmNsaWVudC5f
Z2V0X3Bvb2xfZm9yX2tleShrZXkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBw
b29sID0gc2VsZi5jbGllbnQubWFpbl9wb29sCgogICAgICAgICAgICBub2RlX2lkID0gaWQocG9v
bCkKICAgICAgICAgICAgbm9kZV9jb21tYW5kc1tub2RlX2lkXS5hcHBlbmQoKGlkeCwgY21kLCBw
b29sKSkKICAgICAgICAgICAgY29tbWFuZF9vcmRlci5hcHBlbmQoKG5vZGVfaWQsIGxlbihub2Rl
X2NvbW1hbmRzW25vZGVfaWRdKSAtIDEpKQoKICAgICAgICAjINCS0YvQv9C+0LvQvdGP0LXQvCDQ
vdCwINC60LDQttC00L7QvCDRg9C30LvQtQogICAgICAgIG5vZGVfcmVzdWx0cyA9IHt9CiAgICAg
ICAgZm9yIG5vZGVfaWQsIGNvbW1hbmRzX2xpc3QgaW4gbm9kZV9jb21tYW5kcy5pdGVtcygpOgog
ICAgICAgICAgICBwb29sID0gY29tbWFuZHNfbGlzdFswXVsyXQogICAgICAgICAgICBjb21tYW5k
cyA9IFtjbWQgZm9yIF8sIGNtZCwgXyBpbiBjb21tYW5kc19saXN0XQoKICAgICAgICAgICAgY29u
biA9IHBvb2wuZ2V0X2Nvbm5lY3Rpb24oKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAg
ICByZXN1bHRzID0gY29ubi5leGVjdXRlX3BpcGVsaW5lKGNvbW1hbmRzKQogICAgICAgICAgICAg
ICAgbm9kZV9yZXN1bHRzW25vZGVfaWRdID0gcmVzdWx0cwogICAgICAgICAgICBmaW5hbGx5Ogog
ICAgICAgICAgICAgICAgcG9vbC5yZWxlYXNlKGNvbm4pCgogICAgICAgICMg0JLQvtGB0YHRgtCw
0L3QsNCy0LvQuNCy0LDQtdC8INC/0L7RgNGP0LTQvtC6CiAgICAgICAgZmluYWxfcmVzdWx0cyA9
IFtdCiAgICAgICAgZm9yIG5vZGVfaWQsIGlkeF9pbl9ub2RlIGluIGNvbW1hbmRfb3JkZXI6CiAg
ICAgICAgICAgIHJlc3VsdCA9IG5vZGVfcmVzdWx0c1tub2RlX2lkXVtpZHhfaW5fbm9kZV0KCiAg
ICAgICAgICAgIGlmIHNlbGYuY2xpZW50LmRlY29kZV9yZXNwb25zZXMgYW5kIG5vdCBpc2luc3Rh
bmNlKHJlc3VsdCwgRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuY2xp
ZW50Ll9kZWNvZGVfcmVzcG9uc2UocmVzdWx0KQoKICAgICAgICAgICAgZmluYWxfcmVzdWx0cy5h
cHBlbmQocmVzdWx0KQoKICAgICAgICBzZWxmLmNvbW1hbmRzLmNsZWFyKCkKICAgICAgICBzZWxm
LmNvbW1hbmRfa2V5cy5jbGVhcigpCgogICAgICAgIHJldHVybiBmaW5hbF9yZXN1bHRzCgogICAg
ZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2V4aXRf
XyhzZWxmLCBleGNfdHlwZSwgZXhjX3ZhbCwgZXhjX3RiKToKICAgICAgICBpZiBleGNfdHlwZSBp
cyBOb25lOgogICAgICAgICAgICBzZWxmLmV4ZWN1dGUoKQogICAgICAgIHJldHVybiBGYWxzZQoK
ICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKICAgICAgICAiIiLQn9C10YDQtdGF0LLQ
sNGCINC80LXRgtC+0LTQvtCyINC60LvQuNC10L3RgtCwIiIiCiAgICAgICAgZGVmIG1ldGhvZCgq
YXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICAjINCe0L/RgNC10LTQtdC70Y/QtdC8INC60LvR
jtGHINC40Lcg0LDRgNCz0YPQvNC10L3RgtC+0LIKICAgICAgICAgICAga2V5ID0ga3dhcmdzLmdl
dCgna2V5JykKICAgICAgICAgICAgaWYga2V5IGlzIE5vbmUgYW5kIGxlbihhcmdzKSA+IDA6CiAg
ICAgICAgICAgICAgICBrZXkgPSBhcmdzWzBdCgogICAgICAgICAgICAjINCk0L7RgNC80LjRgNGD
0LXQvCDQutC+0LzQsNC90LTRgwogICAgICAgICAgICBjbWRfbmFtZSA9IG5hbWUudXBwZXIoKQoK
ICAgICAgICAgICAgIyDQntGB0L7QsdGL0LUg0YHQu9GD0YfQsNC4CiAgICAgICAgICAgIGlmIGNt
ZF9uYW1lID09ICdTRVQnOgogICAgICAgICAgICAgICAgY21kX2FyZ3MgPSBbJ1NFVCcsIGFyZ3Nb
MF0sIGFyZ3NbMV1dCiAgICAgICAgICAgICAgICBpZiBsZW4oYXJncykgPiAyOgogICAgICAgICAg
ICAgICAgICAgIGNtZF9hcmdzLmV4dGVuZChhcmdzWzI6XSkKICAgICAgICAgICAgZWxpZiBjbWRf
bmFtZSA9PSAnSFNFVCc6CiAgICAgICAgICAgICAgICBjbWRfYXJncyA9IFsnSFNFVCcsIGFyZ3Nb
MF1dCiAgICAgICAgICAgICAgICBpZiAnbWFwcGluZycgaW4ga3dhcmdzIGFuZCBrd2FyZ3NbJ21h
cHBpbmcnXToKICAgICAgICAgICAgICAgICAgICBmb3IgaywgdiBpbiBrd2FyZ3NbJ21hcHBpbmcn
XS5pdGVtcygpOgogICAgICAgICAgICAgICAgICAgICAgICBjbWRfYXJncy5leHRlbmQoW2ssIHZd
KQogICAgICAgICAgICAgICAgZWxpZiBsZW4oYXJncykgPj0gMzoKICAgICAgICAgICAgICAgICAg
ICBjbWRfYXJncy5leHRlbmQoW2FyZ3NbMV0sIGFyZ3NbMl1dKQogICAgICAgICAgICBlbHNlOgog
ICAgICAgICAgICAgICAgY21kX2FyZ3MgPSBbY21kX25hbWVdICsgbGlzdChhcmdzKQoKICAgICAg
ICAgICAgc2VsZi5jb21tYW5kcy5hcHBlbmQodHVwbGUoY21kX2FyZ3MpKQogICAgICAgICAgICBz
ZWxmLmNvbW1hbmRfa2V5cy5hcHBlbmQoa2V5KQoKICAgICAgICAgICAgcmV0dXJuIHNlbGYKCiAg
ICAgICAgcmV0dXJuIG1ldGhvZAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGNvbmZpZ19lbmNyeXB0b3IucHkAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwNzcwADAwMDAwMDAAMDAwMTczNAAwMDAwMDAwMzczNgAx
NTEzMTc3MDY0MQAwMTQwNjEAIDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAdXN0YXIgIAByb290AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZib3hzZgAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwpp
bXBvcnQgc3lzCmltcG9ydCBqc29uCmltcG9ydCBiYXNlNjQKaW1wb3J0IG9zCmltcG9ydCBnZXRw
YXNzCmZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmZyb20gY3J5cHRvZ3Jh
cGh5Lmhhem1hdC5wcmltaXRpdmVzIGltcG9ydCBoYXNoZXMKZnJvbSBjcnlwdG9ncmFwaHkuaGF6
bWF0LnByaW1pdGl2ZXMua2RmLnBia2RmMiBpbXBvcnQgUEJLREYySE1BQwpmcm9tIGNyeXB0b2dy
YXBoeS5oYXptYXQuYmFja2VuZHMgaW1wb3J0IGRlZmF1bHRfYmFja2VuZAoKZGVmIGRlcml2ZV9r
ZXkocGFzc3dvcmQsIHNhbHQpOgogICAgIiIi0JPQtdC90LXRgNCw0YbQuNGPINC60LvRjtGH0LAg
0LjQtyDQv9Cw0YDQvtC70Y8g0Lgg0YHQvtC70LgiIiIKICAgIGtkZiA9IFBCS0RGMkhNQUMoCiAg
ICAgICAgYWxnb3JpdGhtPWhhc2hlcy5TSEEyNTYoKSwKICAgICAgICBsZW5ndGg9MzIsCiAgICAg
ICAgc2FsdD1zYWx0LAogICAgICAgIGl0ZXJhdGlvbnM9MTAwMDAwLAogICAgICAgIGJhY2tlbmQ9
ZGVmYXVsdF9iYWNrZW5kKCkgCiAgICApCiAgICByZXR1cm4gYmFzZTY0LnVybHNhZmVfYjY0ZW5j
b2RlKGtkZi5kZXJpdmUocGFzc3dvcmQuZW5jb2RlKCkpKQoKZGVmIGVuY3J5cHRfZmlsZShpbnB1
dF9maWxlLCBvdXRwdXRfZmlsZSk6CiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoaW5wdXRfZmls
ZSk6CiAgICAgICAgcHJpbnQoZiJFcnJvcjogSW5wdXQgZmlsZSAne2lucHV0X2ZpbGV9JyBub3Qg
Zm91bmQuIikKICAgICAgICByZXR1cm4KCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKGlucHV0
X2ZpbGUsICdyYicpIGFzIGY6CiAgICAgICAgICAgIGRhdGEgPSBmLnJlYWQoKQogICAgICAgICAg
ICAjINCf0YDQvtCy0LXRgNC60LAg0LLQsNC70LjQtNC90L7RgdGC0LggSlNPTiDQv9C10YDQtdC0
INGI0LjRhNGA0L7QstCw0L3QuNC10LwKICAgICAgICAgICAganNvbi5sb2FkcyhkYXRhKQogICAg
ZXhjZXB0IGpzb24uSlNPTkRlY29kZUVycm9yOgogICAgICAgIHByaW50KCJFcnJvcjogSW5wdXQg
ZmlsZSBpcyBub3QgdmFsaWQgSlNPTi4iKQogICAgICAgIHJldHVybgoKICAgIHBhc3N3b3JkID0g
Z2V0cGFzcy5nZXRwYXNzKCJFbnRlciBwYXNzd29yZCBmb3IgZW5jcnlwdGlvbjogIikKICAgIGNv
bmZpcm0gPSBnZXRwYXNzLmdldHBhc3MoIkNvbmZpcm0gcGFzc3dvcmQ6ICIpCiAgICAKICAgIGlm
IHBhc3N3b3JkICE9IGNvbmZpcm06CiAgICAgICAgcHJpbnQoIkVycm9yOiBQYXNzd29yZHMgZG8g
bm90IG1hdGNoLiIpCiAgICAgICAgcmV0dXJuCgogICAgIyDQk9C10L3QtdGA0LjRgNGD0LXQvCDR
gdC70YPRh9Cw0LnQvdGD0Y4g0YHQvtC70YwgKDE2INCx0LDQudGCKQogICAgc2FsdCA9IG9zLnVy
YW5kb20oMTYpCiAgICBrZXkgPSBkZXJpdmVfa2V5KHBhc3N3b3JkLCBzYWx0KQogICAgZiA9IEZl
cm5ldChrZXkpCiAgICAKICAgIGVuY3J5cHRlZF9kYXRhID0gZi5lbmNyeXB0KGRhdGEpCgogICAg
IyDQodC+0YXRgNCw0L3Rj9C10Lw6INC/0LXRgNCy0YvQtSAxNiDQsdCw0LnRgiAtINGB0L7Qu9GM
LCDQvtGB0YLQsNC70YzQvdC+0LUgLSDQtNCw0L3QvdGL0LUKICAgIHdpdGggb3BlbihvdXRwdXRf
ZmlsZSwgJ3diJykgYXMgZjoKICAgICAgICBmLndyaXRlKHNhbHQgKyBlbmNyeXB0ZWRfZGF0YSkK
ICAgIAogICAgcHJpbnQoZiJTdWNjZXNzISBFbmNyeXB0ZWQgY29uZmlnIHNhdmVkIHRvICd7b3V0
cHV0X2ZpbGV9JyIpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaWYgbGVuKHN5cy5h
cmd2KSAhPSAzOgogICAgICAgIHByaW50KCJVc2FnZTogcHl0aG9uMyBjb25maWdfZW5jcnlwdG9y
LnB5IDxpbnB1dF9qc29uPiA8b3V0cHV0X2VuYz4iKQogICAgICAgIHByaW50KCJFeGFtcGxlOiBw
eXRob24zIGNvbmZpZ19lbmNyeXB0b3IucHkgY29uZmlnLmpzb24gY29uZmlnLmVuYyIpCiAgICBl
bHNlOgogICAgICAgIGVuY3J5cHRfZmlsZShzeXMuYXJndlsxXSwgc3lzLmFyZ3ZbMl0pCgAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAA==
