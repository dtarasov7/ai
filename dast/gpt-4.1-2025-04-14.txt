Dynamic Application Security Testing (DAST) — это тестирование безопасности приложения "на лету" («чёрный ящик»), то есть сканирование API, веб-интерфейса, сервисов на предмет уязвимостей. Для Ceph RADOS Gateway (RGW, s3-совместимый интерфейс) DAST-тестирование включает, как правило, сканирование HTTP(S) API, попытки эксплуатации уязвимостей, связанных с аутентификацией, управлением доступом, неверной конфигурацией и т.д.

## Шаги по проведению DAST тестирования RADOS Gateway

---

### 1. **Определение области тестирования**

   - Внешний адрес/URI вашего RADOS Gateway (например, `https://s3.example.com`)
   - Примеры учётных данных (user, access key, secret)
   - Ограничить область тестирования (production vs test / dev instance)

---

### 2. **Выбор DAST-инструмента**

- **OWASP ZAP** — открытый, для web/API-тестирования.
- **Burp Suite** — коммерческий, очень продвинутый.
- **Arachni, w3af** — альтернативные open-source сканеры.
- **Nessus Pro**, **Acunetix** — для расширенных (и платных) DAST-сканов.

---

### 3. **Развёртывание прокси/сканера**

   - Настраиваете ZAP или Burp Suite как прокси: все http(s)-запросы к s3 отправляются через него.
   - Можно использовать встроенные сканеры API (или OpenAPI-файл, если есть, но для s3 — используйте стандартные методы).

---

### 4. **Сканирование API и тестовых ресурсов**

**a. Атакуйте web-интерфейс / административные панели RGW:**  
  Если включён dashboard или web-gui, сканируете их стандартным образом DAST-сканером.

**b. Тестируйте S3 REST API:**  
DAST-сканер (например, ZAP) позволяет воспроизвести вызовы S3 API (PUT, GET, DELETE, LIST).  
- **Проводите сканирование основных эндпоинтов:** `GET /bucket`, `PUT /bucket/object`, `DELETE /bucket/object`.

**c. Используйте автоматизацию:**
- Можно записать сессию с помощью s3cmd/aws-cli через прокси Burp Suite или ZAP.
- Затем инструменты смогут "рекурсивно" тестировать дополнительные векторы (например, path traversal, auth bypass, метод-чек).

---

### 5. **Тестируйте доступность "корнер-кейсов"**

- **Проверьте CORS/OPTIONS методы**  
- **Test Pre-Signed URLs** — возможен ли доступ третьими лицами?
- **Тест для анонимного пользователя** — доступна ли информация без подписи?
- **Bucket/Listing permission bypass** — можно ли получить список бакетов/объектов неавторизованно?
- **Path Traversal** — попытки LFI/RFI через имена объектов.

---

### 6. **Тестирование на CVE-конфиги**

- Проверьте свои версии Ceph на наличие уязвимостей [https://www.cvedetails.com/vulnerability-list/vendor_id-16753/product_id-35455/Ceph-Ceph.html](https://www.cvedetails.com/vulnerability-list/vendor_id-16753/product_id-35455/Ceph-Ceph.html)
- Попробуйте Metasploit- или аналогичные эксплойты, если они есть для вашей версии RGW.

---

### 7. **Анализируйте результаты и закрывайте уязвимости**

- Проверяйте отчёты сканера на предмет XSS, небезопасных настроек HTTP-заголовков, directory listing, misconfiguration, exposure buckets.
- Исправляйте выявленные проблемы (например, ужесточите CORS, отключите ненужные методы, обновите Ceph).

---

## Примеры

**Сканирование с помощью ZAP:**

1. Запустите ZAP.
2. В настройках браузера пропишите прокси ZAP.
3. Через s3cmd или AWS CLI (c вашим RADOSGW endpoint) выполняйте сценарии доступа (создание, чтение, удаление объектов).
4. После фиксации сессии запустите авто DAST-сканирование по зафиксированным эндпоинтам.
5. Анализируйте отчёт.

---

## Доп. советы:

- Для сложных случаев пишите кастомные скрипты на Python с [boto3](https://boto3.amazonaws.com/v1/documentation/api/latest/index.html) через прокси (например, Burp), чтобы генералить специфические запросы.
- Для production крайне рекомендуется сначала тестировать на отдельном стенде!

---

**Документация Ceph:**
- [RadosGW S3 API compatibility](https://docs.ceph.com/en/quincy/radosgw/s3/)
- [Security Best Practices](https://docs.ceph.com/en/quincy/security/)

---

**Чек-лист:**
- [ ] Перепроверены все публичные bucket’ы?
- [ ] Firewalls/proxy на внешнем интерфейсе RGW?
- [ ] Отключены ненужные анонимные операции?
- [ ] CORS и заголовки безопасности?

---

Если нужна конкретная инструкция под ваш DAST-инструмент — уточните, каким сканером планируете пользоваться.
